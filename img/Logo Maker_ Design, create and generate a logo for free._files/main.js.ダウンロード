!function(){function ImagesLoader(completeCallback){this.images=[],this.imageCount=0,this.completeCallback=completeCallback}function TransformTool(container){this.container=container,this.target=null,this.startMatrix=new Matrix,this.regStartU=.5,this.regStartV=.5,this.startX=0,this.startY=0,this.preMatrix=new Matrix,this.postMatrix=new Matrix,this.endMatrix=new Matrix,this.regEndU=.5,this.regEndV=.5,this.endX=0,this.endY=0,this.dU=0,this.dV=0,this.regX=0,this.regY=0,this.inv=new Matrix,this.control=null,this.controls=[],this.fillStyle="#FFF",this.strokeStyle="#8F0887",this.lineWidth=2}function Transformable(width,height,matrix,owner){this.width=width||0,this.height=height||0,this.matrix=matrix||new Matrix(1,0,0,1,0,0),this.owner=owner,this.changed=null}function Control(type,u,v,offsetX,offsetY,size){this.tool=null,this.type=type,this.x=0,this.y=0,this.offsetX=offsetX||0,this.offsetY=offsetY||0,this.hitTestTarget=!1,this.size=size||15,this.shape=null,this.setDefaultShape(),this.u=u,this.v=v,this.dynamicUV=!1,this.drawCallback=null,this.transformCallback=null}function Matrix(a,b,c,d,x,y){this.a=null!=a?a:1,this.b=b||0,this.c=c||0,this.d=null!=d?d:1,this.x=x||0,this.y=y||0}function DOMTransformTool(container){DOMTransformTool.prototype._super.call(this,container),this.uAlignments=[0,.5,1],this.vAlignments=[0,.5,1],this.horizAligns=[],this.vertAligns=[]}function DOMControl(type,u,v,offsetX,offsetY,size,ctype){DOMControl.prototype._super.call(this,type,u,v,offsetX,offsetY,size),this.id=DOMControl.idPrefix+ ++DOMControl.idCounter,this.ctype=ctype}function RGBColor(e){this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e=e.replace(/ /g,""),e=e.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var n in t)e==n&&(e=t[n]);for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],i=0;i<r.length;i++){var s=r[i].re,o=r[i].process,u=s.exec(e);u&&(channels=o(u),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),"#"+e+t+n},this.getHelpXML=function(){for(var e=new Array,n=0;n<r.length;n++)for(var i=r[n].example,s=0;s<i.length;s++)e[e.length]=i[s];for(var o in t)e[e.length]=o;var u=document.createElement("ul");u.setAttribute("id","rgbcolor-examples");for(var n=0;n<e.length;n++)try{var a=document.createElement("li"),f=new RGBColor(e[n]),l=document.createElement("div");l.style.cssText="margin: 3px; border: 1px solid black; background:"+f.toHex()+"; color:"+f.toHex(),l.appendChild(document.createTextNode("test"));var c=document.createTextNode(" "+e[n]+" -> "+f.toRGB()+" -> "+f.toHex());a.appendChild(l),a.appendChild(c),u.appendChild(a)}catch(h){}return u}}var requirejs,require,define;!function(global){function isFunction(it){return"[object Function]"===ostring.call(it)}function isArray(it){return"[object Array]"===ostring.call(it)}function each(ary,func){if(ary){var i;for(i=0;i<ary.length&&(!ary[i]||!func(ary[i],i,ary));i+=1);}}function eachReverse(ary,func){if(ary){var i;for(i=ary.length-1;i>-1&&(!ary[i]||!func(ary[i],i,ary));i-=1);}}function hasProp(obj,prop){return hasOwn.call(obj,prop)}function getOwn(obj,prop){return hasProp(obj,prop)&&obj[prop]}function eachProp(obj,func){var prop;for(prop in obj)if(hasProp(obj,prop)&&func(obj[prop],prop))break}function mixin(target,source,force,deepStringMixin){return source&&eachProp(source,function(value,prop){(force||!hasProp(target,prop))&&(!deepStringMixin||"object"!=typeof value||!value||isArray(value)||isFunction(value)||value instanceof RegExp?target[prop]=value:(target[prop]||(target[prop]={}),mixin(target[prop],value,force,deepStringMixin)))}),target}function bind(obj,fn){return function(){return fn.apply(obj,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(err){throw err}function getGlobal(value){if(!value)return value;var g=global;return each(value.split("."),function(part){g=g[part]}),g}function makeError(id,msg,err,requireModules){var e=new Error(msg+"\nhttp://requirejs.org/docs/errors.html#"+id);return e.requireType=id,e.requireModules=requireModules,err&&(e.originalError=err),e}function newContext(contextName){function trimDots(ary){var i,part;for(i=0;i<ary.length;i++)if(part=ary[i],"."===part)ary.splice(i,1),i-=1;else if(".."===part){if(0===i||1===i&&".."===ary[2]||".."===ary[i-1])continue;i>0&&(ary.splice(i-1,2),i-=2)}}function normalize(name,baseName,applyMap){var pkgMain,mapValue,nameParts,i,j,nameSegment,lastIndex,foundMap,foundI,foundStarMap,starI,normalizedBaseParts,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"];if(name&&(name=name.split("/"),lastIndex=name.length-1,config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])&&(name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"")),"."===name[0].charAt(0)&&baseParts&&(normalizedBaseParts=baseParts.slice(0,baseParts.length-1),name=normalizedBaseParts.concat(name)),trimDots(name),name=name.join("/")),applyMap&&map&&(baseParts||starMap)){nameParts=name.split("/");outerLoop:for(i=nameParts.length;i>0;i-=1){if(nameSegment=nameParts.slice(0,i).join("/"),baseParts)for(j=baseParts.length;j>0;j-=1)if(mapValue=getOwn(map,baseParts.slice(0,j).join("/")),mapValue&&(mapValue=getOwn(mapValue,nameSegment))){foundMap=mapValue,foundI=i;break outerLoop}!foundStarMap&&starMap&&getOwn(starMap,nameSegment)&&(foundStarMap=getOwn(starMap,nameSegment),starI=i)}!foundMap&&foundStarMap&&(foundMap=foundStarMap,foundI=starI),foundMap&&(nameParts.splice(0,foundI,foundMap),name=nameParts.join("/"))}return pkgMain=getOwn(config.pkgs,name),pkgMain?pkgMain:name}function removeScript(name){isBrowser&&each(scripts(),function(scriptNode){return scriptNode.getAttribute("data-requiremodule")===name&&scriptNode.getAttribute("data-requirecontext")===context.contextName?(scriptNode.parentNode.removeChild(scriptNode),!0):void 0})}function hasPathFallback(id){var pathConfig=getOwn(config.paths,id);return pathConfig&&isArray(pathConfig)&&pathConfig.length>1?(pathConfig.shift(),context.require.undef(id),context.makeRequire(null,{skipMap:!0})([id]),!0):void 0}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;return index>-1&&(prefix=name.substring(0,index),name=name.substring(index+1,name.length)),[prefix,name]}function makeModuleMap(name,parentModuleMap,isNormalized,applyMap){var url,pluginModule,suffix,nameParts,prefix=null,parentName=parentModuleMap?parentModuleMap.name:null,originalName=name,isDefine=!0,normalizedName="";return name||(isDefine=!1,name="_@r"+(requireCounter+=1)),nameParts=splitPrefix(name),prefix=nameParts[0],name=nameParts[1],prefix&&(prefix=normalize(prefix,parentName,applyMap),pluginModule=getOwn(defined,prefix)),name&&(prefix?normalizedName=pluginModule&&pluginModule.normalize?pluginModule.normalize(name,function(name){return normalize(name,parentName,applyMap)}):-1===name.indexOf("!")?normalize(name,parentName,applyMap):name:(normalizedName=normalize(name,parentName,applyMap),nameParts=splitPrefix(normalizedName),prefix=nameParts[0],normalizedName=nameParts[1],isNormalized=!0,url=context.nameToUrl(normalizedName))),suffix=!prefix||pluginModule||isNormalized?"":"_unnormalized"+(unnormalizedCounter+=1),{prefix:prefix,name:normalizedName,parentMap:parentModuleMap,unnormalized:!!suffix,url:url,originalName:originalName,isDefine:isDefine,id:(prefix?prefix+"!"+normalizedName:normalizedName)+suffix}}function getModule(depMap){var id=depMap.id,mod=getOwn(registry,id);return mod||(mod=registry[id]=new context.Module(depMap)),mod}function on(depMap,name,fn){var id=depMap.id,mod=getOwn(registry,id);!hasProp(defined,id)||mod&&!mod.defineEmitComplete?(mod=getModule(depMap),mod.error&&"error"===name?fn(mod.error):mod.on(name,fn)):"defined"===name&&fn(defined[id])}function onError(err,errback){var ids=err.requireModules,notified=!1;errback?errback(err):(each(ids,function(id){var mod=getOwn(registry,id);mod&&(mod.error=err,mod.events.error&&(notified=!0,mod.emit("error",err)))}),notified||req.onError(err))}function takeGlobalQueue(){globalDefQueue.length&&(each(globalDefQueue,function(queueItem){var id=queueItem[0];"string"==typeof id&&(context.defQueueMap[id]=!0),defQueue.push(queueItem)}),globalDefQueue=[])}function cleanRegistry(id){delete registry[id],delete enabledRegistry[id]}function breakCycle(mod,traced,processed){var id=mod.map.id;mod.error?mod.emit("error",mod.error):(traced[id]=!0,each(mod.depMaps,function(depMap,i){var depId=depMap.id,dep=getOwn(registry,depId);!dep||mod.depMatched[i]||processed[depId]||(getOwn(traced,depId)?(mod.defineDep(i,defined[depId]),mod.check()):breakCycle(dep,traced,processed))}),processed[id]=!0)}function checkLoaded(){var err,usingPathFallback,waitInterval=1e3*config.waitSeconds,expired=waitInterval&&context.startTime+waitInterval<(new Date).getTime(),noLoads=[],reqCalls=[],stillLoading=!1,needCycleCheck=!0;if(!inCheckLoaded){if(inCheckLoaded=!0,eachProp(enabledRegistry,function(mod){var map=mod.map,modId=map.id;if(mod.enabled&&(map.isDefine||reqCalls.push(mod),!mod.error))if(!mod.inited&&expired)hasPathFallback(modId)?(usingPathFallback=!0,stillLoading=!0):(noLoads.push(modId),removeScript(modId));else if(!mod.inited&&mod.fetched&&map.isDefine&&(stillLoading=!0,!map.prefix))return needCycleCheck=!1}),expired&&noLoads.length)return err=makeError("timeout","Load timeout for modules: "+noLoads,null,noLoads),err.contextName=context.contextName,onError(err);needCycleCheck&&each(reqCalls,function(mod){breakCycle(mod,{},{})}),expired&&!usingPathFallback||!stillLoading||!isBrowser&&!isWebWorker||checkLoadedTimeoutId||(checkLoadedTimeoutId=setTimeout(function(){checkLoadedTimeoutId=0,checkLoaded()},50)),inCheckLoaded=!1}}function callGetModule(args){hasProp(defined,args[0])||getModule(makeModuleMap(args[0],null,!0)).init(args[1],args[2])}function removeListener(node,func,name,ieName){node.detachEvent&&!isOpera?ieName&&node.detachEvent(ieName,func):node.removeEventListener(name,func,!1)}function getScriptData(evt){var node=evt.currentTarget||evt.srcElement;return removeListener(node,context.onScriptLoad,"load","onreadystatechange"),removeListener(node,context.onScriptError,"error"),{node:node,id:node&&node.getAttribute("data-requiremodule")}}function intakeDefines(){var args;for(takeGlobalQueue();defQueue.length;){if(args=defQueue.shift(),null===args[0])return onError(makeError("mismatch","Mismatched anonymous define() module: "+args[args.length-1]));callGetModule(args)}context.defQueueMap={}}var inCheckLoaded,Module,context,handlers,checkLoadedTimeoutId,config={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},registry={},enabledRegistry={},undefEvents={},defQueue=[],defined={},urlFetched={},bundlesMap={},requireCounter=1,unnormalizedCounter=1;return handlers={require:function(mod){return mod.require?mod.require:mod.require=context.makeRequire(mod.map)},exports:function(mod){return mod.usingExports=!0,mod.map.isDefine?mod.exports?defined[mod.map.id]=mod.exports:mod.exports=defined[mod.map.id]={}:void 0},module:function(mod){return mod.module?mod.module:mod.module={id:mod.map.id,uri:mod.map.url,config:function(){return getOwn(config.config,mod.map.id)||{}},exports:mod.exports||(mod.exports={})}}},Module=function(map){this.events=getOwn(undefEvents,map.id)||{},this.map=map,this.shim=getOwn(config.shim,map.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},Module.prototype={init:function(depMaps,factory,errback,options){options=options||{},this.inited||(this.factory=factory,errback?this.on("error",errback):this.events.error&&(errback=bind(this,function(err){this.emit("error",err)})),this.depMaps=depMaps&&depMaps.slice(0),this.errback=errback,this.inited=!0,this.ignore=options.ignore,options.enabled||this.enabled?this.enable():this.check())},defineDep:function(i,depExports){this.depMatched[i]||(this.depMatched[i]=!0,this.depCount-=1,this.depExports[i]=depExports)},fetch:function(){if(!this.fetched){this.fetched=!0,context.startTime=(new Date).getTime();var map=this.map;return this.shim?void context.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return map.prefix?this.callPlugin():this.load()})):map.prefix?this.callPlugin():this.load()}},load:function(){var url=this.map.url;urlFetched[url]||(urlFetched[url]=!0,context.load(this.map.id,url))},check:function(){if(this.enabled&&!this.enabling){var err,cjsModule,id=this.map.id,depExports=this.depExports,exports=this.exports,factory=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(factory)){try{exports=context.execCb(id,factory,depExports,exports)}catch(e){err=e}if(this.map.isDefine&&void 0===exports&&(cjsModule=this.module,cjsModule?exports=cjsModule.exports:this.usingExports&&(exports=this.exports)),err){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)return err.requireMap=this.map,err.requireModules=this.map.isDefine?[this.map.id]:null,err.requireType=this.map.isDefine?"define":"require",onError(this.error=err);"undefined"!=typeof console&&console.error?console.error(err):req.onError(err)}}else exports=factory;if(this.exports=exports,this.map.isDefine&&!this.ignore&&(defined[id]=exports,req.onResourceLoad)){var resLoadMaps=[];each(this.depMaps,function(depMap){resLoadMaps.push(depMap.normalizedMap||depMap)}),req.onResourceLoad(context,this.map,resLoadMaps)}cleanRegistry(id),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(context.defQueueMap,id)||this.fetch()}},callPlugin:function(){var map=this.map,id=map.id,pluginMap=makeModuleMap(map.prefix);this.depMaps.push(pluginMap),on(pluginMap,"defined",bind(this,function(plugin){var load,normalizedMap,normalizedMod,bundleId=getOwn(bundlesMap,this.map.id),name=this.map.name,parentName=this.map.parentMap?this.map.parentMap.name:null,localRequire=context.makeRequire(map.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(plugin.normalize&&(name=plugin.normalize(name,function(name){return normalize(name,parentName,!0)})||""),normalizedMap=makeModuleMap(map.prefix+"!"+name,this.map.parentMap),on(normalizedMap,"defined",bind(this,function(value){this.map.normalizedMap=normalizedMap,this.init([],function(){return value},null,{enabled:!0,ignore:!0})})),normalizedMod=getOwn(registry,normalizedMap.id),void(normalizedMod&&(this.depMaps.push(normalizedMap),this.events.error&&normalizedMod.on("error",bind(this,function(err){this.emit("error",err)})),normalizedMod.enable()))):bundleId?(this.map.url=context.nameToUrl(bundleId),void this.load()):(load=bind(this,function(value){this.init([],function(){return value},null,{enabled:!0})}),load.error=bind(this,function(err){this.inited=!0,this.error=err,err.requireModules=[id],eachProp(registry,function(mod){0===mod.map.id.indexOf(id+"_unnormalized")&&cleanRegistry(mod.map.id)}),onError(err)}),load.fromText=bind(this,function(text,textAlt){var moduleName=map.name,moduleMap=makeModuleMap(moduleName),hasInteractive=useInteractive;textAlt&&(text=textAlt),hasInteractive&&(useInteractive=!1),getModule(moduleMap),hasProp(config.config,id)&&(config.config[moduleName]=config.config[id]);try{req.exec(text)}catch(e){return onError(makeError("fromtexteval","fromText eval for "+id+" failed: "+e,e,[id]))}hasInteractive&&(useInteractive=!0),this.depMaps.push(moduleMap),context.completeLoad(moduleName),localRequire([moduleName],load)}),void plugin.load(map.name,localRequire,load,config))})),context.enable(pluginMap,this),this.pluginMaps[pluginMap.id]=pluginMap},enable:function(){enabledRegistry[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(depMap,i){var id,mod,handler;if("string"==typeof depMap){if(depMap=makeModuleMap(depMap,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[i]=depMap,handler=getOwn(handlers,depMap.id))return void(this.depExports[i]=handler(this));this.depCount+=1,on(depMap,"defined",bind(this,function(depExports){this.undefed||(this.defineDep(i,depExports),this.check())})),this.errback?on(depMap,"error",bind(this,this.errback)):this.events.error&&on(depMap,"error",bind(this,function(err){this.emit("error",err)}))}id=depMap.id,mod=registry[id],hasProp(handlers,id)||!mod||mod.enabled||context.enable(depMap,this)})),eachProp(this.pluginMaps,bind(this,function(pluginMap){var mod=getOwn(registry,pluginMap.id);mod&&!mod.enabled&&context.enable(pluginMap,this)})),this.enabling=!1,this.check()},on:function(name,cb){var cbs=this.events[name];cbs||(cbs=this.events[name]=[]),cbs.push(cb)},emit:function(name,evt){each(this.events[name],function(cb){cb(evt)}),"error"===name&&delete this.events[name]}},context={config:config,contextName:contextName,registry:registry,defined:defined,urlFetched:urlFetched,defQueue:defQueue,defQueueMap:{},Module:Module,makeModuleMap:makeModuleMap,nextTick:req.nextTick,onError:onError,configure:function(cfg){cfg.baseUrl&&"/"!==cfg.baseUrl.charAt(cfg.baseUrl.length-1)&&(cfg.baseUrl+="/");var shim=config.shim,objs={paths:!0,bundles:!0,config:!0,map:!0};eachProp(cfg,function(value,prop){objs[prop]?(config[prop]||(config[prop]={}),mixin(config[prop],value,!0,!0)):config[prop]=value}),cfg.bundles&&eachProp(cfg.bundles,function(value,prop){each(value,function(v){v!==prop&&(bundlesMap[v]=prop)})}),cfg.shim&&(eachProp(cfg.shim,function(value,id){isArray(value)&&(value={deps:value}),!value.exports&&!value.init||value.exportsFn||(value.exportsFn=context.makeShimExports(value)),shim[id]=value}),config.shim=shim),cfg.packages&&each(cfg.packages,function(pkgObj){var location,name;pkgObj="string"==typeof pkgObj?{name:pkgObj}:pkgObj,name=pkgObj.name,location=pkgObj.location,location&&(config.paths[name]=pkgObj.location),config.pkgs[name]=pkgObj.name+"/"+(pkgObj.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(registry,function(mod,id){mod.inited||mod.map.unnormalized||(mod.map=makeModuleMap(id,null,!0))}),(cfg.deps||cfg.callback)&&context.require(cfg.deps||[],cfg.callback)},makeShimExports:function(value){function fn(){var ret;return value.init&&(ret=value.init.apply(global,arguments)),ret||value.exports&&getGlobal(value.exports)}return fn},makeRequire:function(relMap,options){function localRequire(deps,callback,errback){var id,map,requireMod;return options.enableBuildCallback&&callback&&isFunction(callback)&&(callback.__requireJsBuild=!0),"string"==typeof deps?isFunction(callback)?onError(makeError("requireargs","Invalid require call"),errback):relMap&&hasProp(handlers,deps)?handlers[deps](registry[relMap.id]):req.get?req.get(context,deps,relMap,localRequire):(map=makeModuleMap(deps,relMap,!1,!0),id=map.id,hasProp(defined,id)?defined[id]:onError(makeError("notloaded",'Module name "'+id+'" has not been loaded yet for context: '+contextName+(relMap?"":". Use require([])")))):(intakeDefines(),context.nextTick(function(){intakeDefines(),requireMod=getModule(makeModuleMap(null,relMap)),requireMod.skipMap=options.skipMap,requireMod.init(deps,callback,errback,{enabled:!0}),checkLoaded()}),localRequire)}return options=options||{},mixin(localRequire,{isBrowser:isBrowser,toUrl:function(moduleNamePlusExt){var ext,index=moduleNamePlusExt.lastIndexOf("."),segment=moduleNamePlusExt.split("/")[0],isRelative="."===segment||".."===segment;return-1!==index&&(!isRelative||index>1)&&(ext=moduleNamePlusExt.substring(index,moduleNamePlusExt.length),moduleNamePlusExt=moduleNamePlusExt.substring(0,index)),context.nameToUrl(normalize(moduleNamePlusExt,relMap&&relMap.id,!0),ext,!0)},defined:function(id){return hasProp(defined,makeModuleMap(id,relMap,!1,!0).id)},specified:function(id){return id=makeModuleMap(id,relMap,!1,!0).id,hasProp(defined,id)||hasProp(registry,id)}}),relMap||(localRequire.undef=function(id){takeGlobalQueue();var map=makeModuleMap(id,relMap,!0),mod=getOwn(registry,id);mod.undefed=!0,removeScript(id),delete defined[id],delete urlFetched[map.url],delete undefEvents[id],eachReverse(defQueue,function(args,i){args[0]===id&&defQueue.splice(i,1)}),delete context.defQueueMap[id],mod&&(mod.events.defined&&(undefEvents[id]=mod.events),cleanRegistry(id))}),localRequire},enable:function(depMap){var mod=getOwn(registry,depMap.id);mod&&getModule(depMap).enable()},completeLoad:function(moduleName){var found,args,mod,shim=getOwn(config.shim,moduleName)||{},shExports=shim.exports;for(takeGlobalQueue();defQueue.length;){if(args=defQueue.shift(),null===args[0]){if(args[0]=moduleName,found)break;found=!0}else args[0]===moduleName&&(found=!0);callGetModule(args)}if(context.defQueueMap={},mod=getOwn(registry,moduleName),!found&&!hasProp(defined,moduleName)&&mod&&!mod.inited){if(!(!config.enforceDefine||shExports&&getGlobal(shExports)))return hasPathFallback(moduleName)?void 0:onError(makeError("nodefine","No define call for "+moduleName,null,[moduleName]));callGetModule([moduleName,shim.deps||[],shim.exportsFn])}checkLoaded()},nameToUrl:function(moduleName,ext,skipExt){var paths,syms,i,parentModule,url,parentPath,bundleId,pkgMain=getOwn(config.pkgs,moduleName);if(pkgMain&&(moduleName=pkgMain),bundleId=getOwn(bundlesMap,moduleName))return context.nameToUrl(bundleId,ext,skipExt);if(req.jsExtRegExp.test(moduleName))url=moduleName+(ext||"");else{for(paths=config.paths,syms=moduleName.split("/"),i=syms.length;i>0;i-=1)if(parentModule=syms.slice(0,i).join("/"),parentPath=getOwn(paths,parentModule)){isArray(parentPath)&&(parentPath=parentPath[0]),syms.splice(0,i,parentPath);break}url=syms.join("/"),url+=ext||(/^data\:|\?/.test(url)||skipExt?"":".js"),url=("/"===url.charAt(0)||url.match(/^[\w\+\.\-]+:/)?"":config.baseUrl)+url}return config.urlArgs?url+((-1===url.indexOf("?")?"?":"&")+config.urlArgs):url},load:function(id,url){req.load(context,id,url)},execCb:function(name,callback,args,exports){return callback.apply(exports,args)},onScriptLoad:function(evt){if("load"===evt.type||readyRegExp.test((evt.currentTarget||evt.srcElement).readyState)){interactiveScript=null;var data=getScriptData(evt);context.completeLoad(data.id)}},onScriptError:function(evt){var data=getScriptData(evt);if(!hasPathFallback(data.id)){var parents=[];return eachProp(registry,function(value,key){0!==key.indexOf("_@r")&&each(value.depMaps,function(depMap){return depMap.id===data.id&&parents.push(key),!0})}),onError(makeError("scripterror",'Script error for "'+data.id+(parents.length?'", needed by: '+parents.join(", "):'"'),evt,[data.id]))}}},context.require=context.makeRequire(),context}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(script){return"interactive"===script.readyState?interactiveScript=script:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.22",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(deps,callback,errback,optional){var context,config,contextName=defContextName;return isArray(deps)||"string"==typeof deps||(config=deps,isArray(callback)?(deps=callback,callback=errback,errback=optional):deps=[]),config&&config.context&&(contextName=config.context),context=getOwn(contexts,contextName),context||(context=contexts[contextName]=req.s.newContext(contextName)),config&&context.configure(config),context.require(deps,callback,errback)},req.config=function(config){return req(config)},req.nextTick="undefined"!=typeof setTimeout?function(fn){setTimeout(fn,4)}:function(fn){fn()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(prop){req[prop]=function(){var ctx=contexts[defContextName];return ctx.require[prop].apply(ctx,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(config,moduleName,url){var node=config.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return node.type=config.scriptType||"text/javascript",node.charset="utf-8",node.async=!0,node},req.load=function(context,moduleName,url){var node,config=context&&context.config||{};if(isBrowser)return node=req.createNode(config,moduleName,url),config.onNodeCreated&&config.onNodeCreated(node,config,moduleName,url),node.setAttribute("data-requirecontext",context.contextName),node.setAttribute("data-requiremodule",moduleName),!node.attachEvent||node.attachEvent.toString&&node.attachEvent.toString().indexOf("[native code")<0||isOpera?(node.addEventListener("load",context.onScriptLoad,!1),node.addEventListener("error",context.onScriptError,!1)):(useInteractive=!0,node.attachEvent("onreadystatechange",context.onScriptLoad)),node.src=url,currentlyAddingScript=node,baseElement?head.insertBefore(node,baseElement):head.appendChild(node),currentlyAddingScript=null,node;if(isWebWorker)try{importScripts(url),context.completeLoad(moduleName)}catch(e){context.onError(makeError("importscripts","importScripts failed for "+moduleName+" at "+url,e,[moduleName]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(script){return head||(head=script.parentNode),dataMain=script.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(name,deps,callback){var node,context;"string"!=typeof name&&(callback=deps,deps=name,name=null),isArray(deps)||(callback=deps,deps=null),!deps&&isFunction(callback)&&(deps=[],callback.length&&(callback.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(match,dep){deps.push(dep)}),deps=(1===callback.length?["require"]:["require","exports","module"]).concat(deps))),useInteractive&&(node=currentlyAddingScript||getInteractiveScript(),node&&(name||(name=node.getAttribute("data-requiremodule")),context=contexts[node.getAttribute("data-requirecontext")])),context?(context.defQueue.push([name,deps,callback]),context.defQueueMap[name]=!0):globalDefQueue.push([name,deps,callback])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("requireJsLib",function(){}),function(global,factory){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){function DOMEval(code,doc){doc=doc||document;var script=doc.createElement("script");script.text=code,doc.head.appendChild(script).parentNode.removeChild(script)}function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=jQuery.type(obj);return"function"===type||jQuery.isWindow(obj)?!1:"array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj}function nodeName(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()}function winnow(elements,qualifier,not){return jQuery.isFunction(qualifier)?jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not}):qualifier.nodeType?jQuery.grep(elements,function(elem){return elem===qualifier!==not;
}):"string"!=typeof qualifier?jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not}):risSimple.test(qualifier)?jQuery.filter(qualifier,elements,not):(qualifier=jQuery.filter(qualifier,elements),jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not&&1===elem.nodeType}))}function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}function createOptions(options){var object={};return jQuery.each(options.match(rnothtmlwhite)||[],function(_,flag){object[flag]=!0}),object}function Identity(v){return v}function Thrower(ex){throw ex}function adoptValue(value,resolve,reject,noValue){var method;try{value&&jQuery.isFunction(method=value.promise)?method.call(value).done(resolve).fail(reject):value&&jQuery.isFunction(method=value.then)?method.call(value,resolve,reject):resolve.apply(void 0,[value].slice(noValue))}catch(value){reject.apply(void 0,[value])}}function completed(){document.removeEventListener("DOMContentLoaded",completed),window.removeEventListener("load",completed),jQuery.ready()}function Data(){this.expando=jQuery.expando+Data.uid++}function getData(data){return"true"===data?!0:"false"===data?!1:"null"===data?null:data===+data+""?+data:rbrace.test(data)?JSON.parse(data):data}function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$&").toLowerCase(),data=elem.getAttribute(name),"string"==typeof data){try{data=getData(data)}catch(e){}dataUser.set(elem,key,data)}else data=void 0;return data}function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale=1,maxIterations=20,currentValue=tween?function(){return tween.cur()}:function(){return jQuery.css(elem,prop,"")},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=(jQuery.cssNumber[prop]||"px"!==unit&&+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){unit=unit||initialInUnit[3],valueParts=valueParts||[],initialInUnit=+initial||1;do scale=scale||".5",initialInUnit/=scale,jQuery.style(elem,prop,initialInUnit+unit);while(scale!==(scale=currentValue()/initial)&&1!==scale&&--maxIterations)}return valueParts&&(initialInUnit=+initialInUnit||+initial||0,adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2],tween&&(tween.unit=unit,tween.start=initialInUnit,tween.end=adjusted)),adjusted}function getDefaultDisplay(elem){var temp,doc=elem.ownerDocument,nodeName=elem.nodeName,display=defaultDisplayMap[nodeName];return display?display:(temp=doc.body.appendChild(doc.createElement(nodeName)),display=jQuery.css(temp,"display"),temp.parentNode.removeChild(temp),"none"===display&&(display="block"),defaultDisplayMap[nodeName]=display,display)}function showHide(elements,show){for(var display,elem,values=[],index=0,length=elements.length;length>index;index++)elem=elements[index],elem.style&&(display=elem.style.display,show?("none"===display&&(values[index]=dataPriv.get(elem,"display")||null,values[index]||(elem.style.display="")),""===elem.style.display&&isHiddenWithinTree(elem)&&(values[index]=getDefaultDisplay(elem))):"none"!==display&&(values[index]="none",dataPriv.set(elem,"display",display)));for(index=0;length>index;index++)null!=values[index]&&(elements[index].style.display=values[index]);return elements}function getAll(context,tag){var ret;return ret="undefined"!=typeof context.getElementsByTagName?context.getElementsByTagName(tag||"*"):"undefined"!=typeof context.querySelectorAll?context.querySelectorAll(tag||"*"):[],void 0===tag||tag&&nodeName(context,tag)?jQuery.merge([context],ret):ret}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;l>i;i++)dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],"globalEval"))}function buildFragment(elems,context,scripts,selection,ignored){for(var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;l>i;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}else nodes.push(context.createTextNode(elem));for(fragment.textContent="",i=0;elem=nodes[i++];)if(selection&&jQuery.inArray(elem,selection)>-1)ignored&&ignored.push(elem);else if(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(fragment.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts)for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return fragment}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function on(elem,types,selector,data,fn,one){var origFn,type;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)on(elem,type,selector,data,types[type],one);return elem}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),fn===!1)fn=returnFalse;else if(!fn)return elem;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),elem.each(function(){jQuery.event.add(this,types,fn,data,selector)})}function manipulationTarget(elem,content){return nodeName(elem,"table")&&nodeName(11!==content.nodeType?content:content.firstChild,"tr")?jQuery(">tbody",elem)[0]||elem:elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(1===dest.nodeType){if(dataPriv.hasData(src)&&(pdataOld=dataPriv.access(src),pdataCur=dataPriv.set(dest,pdataOld),events=pdataOld.events)){delete pdataCur.handle,pdataCur.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}dataUser.hasData(src)&&(udataOld=dataUser.access(src),udataCur=jQuery.extend({},udataOld),dataUser.set(dest,udataCur))}}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();"input"===nodeName&&rcheckableType.test(src.type)?dest.checked=src.checked:("input"===nodeName||"textarea"===nodeName)&&(dest.defaultValue=src.defaultValue)}function domManip(collection,args,callback,ignored){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return collection.each(function(index){var self=collection.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),domManip(self,args,callback,ignored)});if(l&&(fragment=buildFragment(args,collection[0].ownerDocument,!1,collection,ignored),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first||ignored)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;l>i;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(collection[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;hasScripts>i;i++)node=scripts[i],rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):DOMEval(node.textContent.replace(rcleanScript,""),doc))}return collection}function remove(elem,selector,keepData){for(var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;null!=(node=nodes[i]);i++)keepData||1!==node.nodeType||jQuery.cleanData(getAll(node)),node.parentNode&&(keepData&&jQuery.contains(node.ownerDocument,node)&&setGlobalEval(getAll(node,"script")),node.parentNode.removeChild(node));return elem}function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),computed&&(ret=computed.getPropertyValue(name)||computed[name],""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),!support.pixelMarginRight()&&rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0!==ret?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){return conditionFn()?void delete this.get:(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(name){if(name in emptyStyle)return name;for(var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in emptyStyle)return name}function finalPropName(name){var ret=jQuery.cssProps[name];return ret||(ret=jQuery.cssProps[name]=vendorPropName(name)||name),ret}function setPositiveNumber(elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i,val=0;for(i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0;4>i;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox,styles=getStyles(elem),val=curCSS(elem,name,styles),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles);return rnumnonpx.test(val)?val:(valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),"auto"===val&&(val=elem["offset"+name[0].toUpperCase()+name.slice(1)]),val=parseFloat(val)||0,val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px")}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function schedule(){inProgress&&(document.hidden===!1&&window.requestAnimationFrame?window.requestAnimationFrame(schedule):window.setTimeout(schedule,jQuery.fx.interval),jQuery.fx.tick())}function createFxNow(){return window.setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length;length>index;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,hooks,oldfire,propTween,restoreDisplay,display,isBox="width"in props||"height"in props,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHiddenWithinTree(elem),dataShow=dataPriv.get(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})}));for(prop in props)if(value=props[prop],rfxtypes.test(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if(propTween=!jQuery.isEmptyObject(props),propTween||!jQuery.isEmptyObject(orig)){isBox&&1===elem.nodeType&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],restoreDisplay=dataShow&&dataShow.display,null==restoreDisplay&&(restoreDisplay=dataPriv.get(elem,"display")),display=jQuery.css(elem,"display"),"none"===display&&(restoreDisplay?display=restoreDisplay:(showHide([elem],!0),restoreDisplay=elem.style.display||restoreDisplay,display=jQuery.css(elem,"display"),showHide([elem]))),("inline"===display||"inline-block"===display&&null!=restoreDisplay)&&"none"===jQuery.css(elem,"float")&&(propTween||(anim.done(function(){style.display=restoreDisplay}),null==restoreDisplay&&(display=style.display,restoreDisplay="none"===display?"":display)),style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]})),propTween=!1;for(prop in orig)propTween||(dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=dataPriv.access(elem,"fxshow",{display:restoreDisplay}),toggle&&(dataShow.hidden=!hidden),hidden&&showHide([elem],!0),anim.done(function(){hidden||showHide([elem]),dataPriv.remove(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])})),propTween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=propTween.start,hidden&&(propTween.end=propTween.start,propTween.start=0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],Array.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length?remaining:(length||deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;length>index;index++)animation.tweens[index].run(1);return gotoEnd?(deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation,gotoEnd])):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);length>index;index++)if(result=Animation.prefilters[index].call(animation,elem,props,animation.opts))return jQuery.isFunction(result.stop)&&(jQuery._queueHooks(animation.elem,animation.opts.queue).stop=jQuery.proxy(result.stop,result)),result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation}function stripAndCollapse(value){var tokens=value.match(rnothtmlwhite)||[];return tokens.join(" ")}function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||""}function buildParams(prefix,obj,traditional,add){var name;if(Array.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v&&null!=v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnothtmlwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}var arr=[],document=window.document,getProto=Object.getPrototypeOf,slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,fnToString=hasOwn.toString,ObjectFunctionString=fnToString.call(Object),support={},version="3.2.1",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([a-z])/g,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,length:0,toArray:function(){return slice.call(this)},get:function(num){return null==num?slice.call(this):0>num?this[num+this.length]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret},each:function(callback){return jQuery.each(this,callback)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},end:function(){return this.prevObject||this.constructor()},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&Array.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isWindow:function(obj){return null!=obj&&obj===obj.window},isNumeric:function(obj){var type=jQuery.type(obj);return("number"===type||"string"===type)&&!isNaN(obj-parseFloat(obj))},isPlainObject:function(obj){var proto,Ctor;return obj&&"[object Object]"===toString.call(obj)?(proto=getProto(obj))?(Ctor=hasOwn.call(proto,"constructor")&&proto.constructor,"function"==typeof Ctor&&fnToString.call(Ctor)===ObjectFunctionString):!0:!1},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){DOMEval(code)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},each:function(obj,callback){var length,i=0;if(isArrayLike(obj))for(length=obj.length;length>i&&callback.call(obj[i],i,obj[i])!==!1;i++);else for(i in obj)if(callback.call(obj[i],i,obj[i])===!1)break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArrayLike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;len>j;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;length>i;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems))for(length=elems.length;length>i;i++)value=callback(elems[i],i,arg),null!=value&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;return"string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn)?(args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):void 0},now:Date.now,support:support}),"function"==typeof Symbol&&(jQuery.fn[Symbol.iterator]=arr[Symbol.iterator]),jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var m,i,elem,nid,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;if(results=results||[],"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,documentIsHTML)){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(!(elem=context.getElementById(m)))return results;if(elem.id===m)return results.push(elem),results}else if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&!compilerCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(1!==nodeType)newContext=context,newSelector=selector;else if("object"!==context.nodeName.toLowerCase()){for((nid=context.getAttribute("id"))?nid=nid.replace(rcssescape,fcssescape):context.setAttribute("id",nid=expando),groups=tokenize(selector),i=groups.length;i--;)groups[i]="#"+nid+" "+toSelector(groups[i]);newSelector=groups.join(","),newContext=rsibling.test(selector)&&testContext(context.parentNode)||context}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{nid===expando&&context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var el=document.createElement("fieldset");try{return!!fn(el)}catch(e){return!1}finally{el.parentNode&&el.parentNode.removeChild(el),el=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=arr.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createDisabledPseudo(disabled){return function(elem){return"form"in elem?elem.parentNode&&elem.disabled===!1?"label"in elem?"label"in elem.parentNode?elem.parentNode.disabled===disabled:elem.disabled===disabled:elem.isDisabled===disabled||elem.isDisabled!==!disabled&&disabledAncestor(elem)===disabled:elem.disabled===disabled:"label"in elem?elem.disabled===disabled:!1}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&"undefined"!=typeof context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,skip=combinator.next,key=skip||dir,checkNonElements=base&&"parentNode"===key,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml);return!1}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)if(outerCache=elem[expando]||(elem[expando]={}),uniqueCache=outerCache[elem.uniqueID]||(outerCache[elem.uniqueID]={}),skip&&skip===elem.nodeName.toLowerCase())elem=elem[dir]||elem;else{if((oldCache=uniqueCache[key])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(uniqueCache[key]=newCache,newCache[2]=matcher(elem,context,xml))return!0}return!1}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),mapped&&map.push(i));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));
return checkContext=null,ret}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context===document||context||outermost);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0,context||elem.ownerDocument===document||(setDocument(elem),xml=!documentIsHTML);matcher=elementMatchers[j++];)if(matcher(elem,context||document,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;len>i;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\x00-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)},rcssescape=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,fcssescape=function(ch,asCodePoint){return asCodePoint?"\x00"===ch?"�":ch.slice(0,-1)+"\\"+ch.charCodeAt(ch.length-1).toString(16)+" ":"\\"+ch},unloadHandler=function(){setDocument()},disabledAncestor=addCombinator(function(elem){return elem.disabled===!0&&("form"in elem||"label"in elem)},{dir:"parentNode",next:"legend"});try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},setDocument=Sizzle.setDocument=function(node){var hasCompare,subWindow,doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=document.documentElement,documentIsHTML=!isXML(document),preferredDoc!==document&&(subWindow=document.defaultView)&&subWindow.top!==subWindow&&(subWindow.addEventListener?subWindow.addEventListener("unload",unloadHandler,!1):subWindow.attachEvent&&subWindow.attachEvent("onunload",unloadHandler)),support.attributes=assert(function(el){return el.className="i",!el.getAttribute("className")}),support.getElementsByTagName=assert(function(el){return el.appendChild(document.createComment("")),!el.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(document.getElementsByClassName),support.getById=assert(function(el){return docElem.appendChild(el).id=expando,!document.getElementsByName||!document.getElementsByName(expando).length}),support.getById?(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}},Expr.find.ID=function(id,context){if("undefined"!=typeof context.getElementById&&documentIsHTML){var elem=context.getElementById(id);return elem?[elem]:[]}}):(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node="undefined"!=typeof elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}},Expr.find.ID=function(id,context){if("undefined"!=typeof context.getElementById&&documentIsHTML){var node,i,elems,elem=context.getElementById(id);if(elem){if(node=elem.getAttributeNode("id"),node&&node.value===id)return[elem];for(elems=context.getElementsByName(id),i=0;elem=elems[i++];)if(node=elem.getAttributeNode("id"),node&&node.value===id)return[elem]}return[]}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return"undefined"!=typeof context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return"undefined"!=typeof context.getElementsByClassName&&documentIsHTML?context.getElementsByClassName(className):void 0},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(document.querySelectorAll))&&(assert(function(el){docElem.appendChild(el).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\r\\' msallowcapture=''><option selected=''></option></select>",el.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),el.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),el.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),el.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),el.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")}),assert(function(el){el.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var input=document.createElement("input");input.setAttribute("type","hidden"),el.appendChild(input).setAttribute("name","D"),el.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),2!==el.querySelectorAll(":enabled").length&&rbuggyQSA.push(":enabled",":disabled"),docElem.appendChild(el).disabled=!0,2!==el.querySelectorAll(":disabled").length&&rbuggyQSA.push(":enabled",":disabled"),el.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(el){support.disconnectedMatch=matches.call(el,"*"),matches.call(el,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===document||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===document||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===document?-1:b===document?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},document):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&!compilerCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.escape=function(sel){return(sel+"").replace(rcssescape,fcssescape)},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||"undefined"!=typeof elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=!1;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(node=parent,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(node=elem,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex),diff===!1)for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&(outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),uniqueCache[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:createDisabledPseudo(!1),disabled:createDisabledPseudo(!0),checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(el){return 1&el.compareDocumentPosition(document.createElement("fieldset"))}),assert(function(el){return el.innerHTML="<a href='#'></a>","#"===el.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(el){return el.innerHTML="<input/>",el.firstChild.setAttribute("value",""),""===el.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){return isXML||"input"!==elem.nodeName.toLowerCase()?void 0:elem.defaultValue}),assert(function(el){return null==el.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains,jQuery.escapeSelector=Sizzle.escape;var dir=function(elem,dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},siblings=function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched},rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,ret,len=this.length,self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0}));for(ret=this.pushStack([]),i=0;len>i;i++)jQuery.find(selector,self[i],ret);return len>1?jQuery.uniqueSort(ret):ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,init=jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector)return this;if(root=root||rootjQuery,"string"==typeof selector){if(match="<"===selector[0]&&">"===selector[selector.length-1]&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||root).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return elem=document.getElementById(match[2]),elem&&(this[0]=elem,this.length=1),this}return selector.nodeType?(this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?void 0!==root.ready?root.ready(selector):selector(jQuery):jQuery.makeArray(selector,this)};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;l>i;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],targets="string"!=typeof selectors&&jQuery(selectors);if(!rneedsContext.test(selectors))for(;l>i;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(targets?targets.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.uniqueSort(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return dir(elem,"nextSibling")},prevAll:function(elem){return dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return dir(elem,"previousSibling",until)},siblings:function(elem){return siblings((elem.parentNode||{}).firstChild,elem)},children:function(elem){return siblings(elem.firstChild)},contents:function(elem){return nodeName(elem,"iframe")?elem.contentDocument:(nodeName(elem,"template")&&(elem=elem.content||elem),jQuery.merge([],elem.childNodes))}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),this.length>1&&(guaranteedUnique[name]||jQuery.uniqueSort(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnothtmlwhite=/[^\x20\t\r\n\f]+/g;jQuery.Callbacks=function(options){options="string"==typeof options?createOptions(options):jQuery.extend({},options);var firing,memory,fired,locked,list=[],queue=[],firingIndex=-1,fire=function(){for(locked=locked||options.once,fired=firing=!0;queue.length;firingIndex=-1)for(memory=queue.shift();++firingIndex<list.length;)list[firingIndex].apply(memory[0],memory[1])===!1&&options.stopOnFalse&&(firingIndex=list.length,memory=!1);options.memory||(memory=!1),firing=!1,locked&&(list=memory?[]:"")},self={add:function(){return list&&(memory&&!firing&&(firingIndex=list.length-1,queue.push(memory)),function add(args){jQuery.each(args,function(_,arg){jQuery.isFunction(arg)?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==jQuery.type(arg)&&add(arg)})}(arguments),memory&&!firing&&fire()),this},remove:function(){return jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firingIndex>=index&&firingIndex--}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:list.length>0},empty:function(){return list&&(list=[]),this},disable:function(){return locked=queue=[],list=memory="",this},disabled:function(){return!list},lock:function(){return locked=queue=[],memory||firing||(list=memory=""),this},locked:function(){return!!locked},fireWith:function(context,args){return locked||(args=args||[],args=[context,args.slice?args.slice():args],queue.push(args),firing||fire()),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["notify","progress",jQuery.Callbacks("memory"),jQuery.Callbacks("memory"),2],["resolve","done",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),0,"resolved"],["reject","fail",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),1,"rejected"]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},"catch":function(fn){return promise.then(null,fn)},pipe:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[tuple[4]])&&fns[tuple[4]];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject):newDefer[tuple[0]+"With"](this,fn?[returned]:arguments);
})}),fns=null}).promise()},then:function(onFulfilled,onRejected,onProgress){function resolve(depth,deferred,handler,special){return function(){var that=this,args=arguments,mightThrow=function(){var returned,then;if(!(maxDepth>depth)){if(returned=handler.apply(that,args),returned===deferred.promise())throw new TypeError("Thenable self-resolution");then=returned&&("object"==typeof returned||"function"==typeof returned)&&returned.then,jQuery.isFunction(then)?special?then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special)):(maxDepth++,then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special),resolve(maxDepth,deferred,Identity,deferred.notifyWith))):(handler!==Identity&&(that=void 0,args=[returned]),(special||deferred.resolveWith)(that,args))}},process=special?mightThrow:function(){try{mightThrow()}catch(e){jQuery.Deferred.exceptionHook&&jQuery.Deferred.exceptionHook(e,process.stackTrace),depth+1>=maxDepth&&(handler!==Thrower&&(that=void 0,args=[e]),deferred.rejectWith(that,args))}};depth?process():(jQuery.Deferred.getStackHook&&(process.stackTrace=jQuery.Deferred.getStackHook()),window.setTimeout(process))}}var maxDepth=0;return jQuery.Deferred(function(newDefer){tuples[0][3].add(resolve(0,newDefer,jQuery.isFunction(onProgress)?onProgress:Identity,newDefer.notifyWith)),tuples[1][3].add(resolve(0,newDefer,jQuery.isFunction(onFulfilled)?onFulfilled:Identity)),tuples[2][3].add(resolve(0,newDefer,jQuery.isFunction(onRejected)?onRejected:Thrower))}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[5];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[3-i][2].disable,tuples[0][2].lock),list.add(tuple[3].fire),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?void 0:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(singleValue){var remaining=arguments.length,i=remaining,resolveContexts=Array(i),resolveValues=slice.call(arguments),master=jQuery.Deferred(),updateFunc=function(i){return function(value){resolveContexts[i]=this,resolveValues[i]=arguments.length>1?slice.call(arguments):value,--remaining||master.resolveWith(resolveContexts,resolveValues)}};if(1>=remaining&&(adoptValue(singleValue,master.done(updateFunc(i)).resolve,master.reject,!remaining),"pending"===master.state()||jQuery.isFunction(resolveValues[i]&&resolveValues[i].then)))return master.then();for(;i--;)adoptValue(resolveValues[i],updateFunc(i),master.reject);return master.promise()}});var rerrorNames=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;jQuery.Deferred.exceptionHook=function(error,stack){window.console&&window.console.warn&&error&&rerrorNames.test(error.name)&&window.console.warn("jQuery.Deferred exception: "+error.message,error.stack,stack)},jQuery.readyException=function(error){window.setTimeout(function(){throw error})};var readyList=jQuery.Deferred();jQuery.fn.ready=function(fn){return readyList.then(fn)["catch"](function(error){jQuery.readyException(error)}),this},jQuery.extend({isReady:!1,readyWait:1,ready:function(wait){(wait===!0?--jQuery.readyWait:jQuery.isReady)||(jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||readyList.resolveWith(document,[jQuery]))}}),jQuery.ready.then=readyList.then,"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?window.setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed),window.addEventListener("load",completed));var access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;len>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet},acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType};Data.uid=1,Data.prototype={cache:function(owner){var value=owner[this.expando];return value||(value={},acceptData(owner)&&(owner.nodeType?owner[this.expando]=value:Object.defineProperty(owner,this.expando,{value:value,configurable:!0}))),value},set:function(owner,data,value){var prop,cache=this.cache(owner);if("string"==typeof data)cache[jQuery.camelCase(data)]=value;else for(prop in data)cache[jQuery.camelCase(prop)]=data[prop];return cache},get:function(owner,key){return void 0===key?this.cache(owner):owner[this.expando]&&owner[this.expando][jQuery.camelCase(key)]},access:function(owner,key,value){return void 0===key||key&&"string"==typeof key&&void 0===value?this.get(owner,key):(this.set(owner,key,value),void 0!==value?value:key)},remove:function(owner,key){var i,cache=owner[this.expando];if(void 0!==cache){if(void 0!==key){Array.isArray(key)?key=key.map(jQuery.camelCase):(key=jQuery.camelCase(key),key=key in cache?[key]:key.match(rnothtmlwhite)||[]),i=key.length;for(;i--;)delete cache[key[i]]}(void 0===key||jQuery.isEmptyObject(cache))&&(owner.nodeType?owner[this.expando]=void 0:delete owner[this.expando])}},hasData:function(owner){var cache=owner[this.expando];return void 0!==cache&&!jQuery.isEmptyObject(cache)}};var dataPriv=new Data,dataUser=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem)},data:function(elem,name,data){return dataUser.access(elem,name,data)},removeData:function(elem,name){dataUser.remove(elem,name)},_data:function(elem,name,data){return dataPriv.access(elem,name,data)},_removeData:function(elem,name){dataPriv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=dataUser.get(elem),1===elem.nodeType&&!dataPriv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)attrs[i]&&(name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name])));dataPriv.set(elem,"hasDataAttrs",!0)}return data}return"object"==typeof key?this.each(function(){dataUser.set(this,key)}):access(this,function(value){var data;if(elem&&void 0===value){if(data=dataUser.get(elem,key),void 0!==data)return data;if(data=dataAttr(elem,key),void 0!==data)return data}else this.each(function(){dataUser.set(this,key,value)})},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){dataUser.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;return elem?(type=(type||"fx")+"queue",queue=dataPriv.get(elem,type),data&&(!queue||Array.isArray(data)?queue=dataPriv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)tmp=dataPriv.get(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),cssExpand=["Top","Right","Bottom","Left"],isHiddenWithinTree=function(elem,el){return elem=el||elem,"none"===elem.style.display||""===elem.style.display&&jQuery.contains(elem.ownerDocument,elem)&&"none"===jQuery.css(elem,"display")},swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret},defaultDisplayMap={};jQuery.fn.extend({show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHiddenWithinTree(this)?jQuery(this).show():jQuery(this).hide()})}});var rcheckableType=/^(?:checkbox|radio)$/i,rtagName=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,rscriptType=/^$|\/(?:java|ecma)script/i,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var rhtml=/<|&#?\w+;/;!function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio"),input.setAttribute("checked","checked"),input.setAttribute("name","t"),div.appendChild(input),support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue}();var documentElement=document.documentElement,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(elemData)for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),selector&&jQuery.find.matchesSelector(documentElement,selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return"undefined"!=typeof jQuery&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),types=(types||"").match(rnothtmlwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||elem.addEventListener&&elem.addEventListener(type,eventHandle)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnothtmlwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&dataPriv.remove(elem,"handle events")}},dispatch:function(nativeEvent){var i,j,ret,matched,handleObj,handlerQueue,event=jQuery.event.fix(nativeEvent),args=new Array(arguments.length),handlers=(dataPriv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};for(args[0]=event,i=1;i<arguments.length;i++)args[i]=arguments[i];if(event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)(!event.rnamespace||event.rnamespace.test(handleObj.namespace))&&(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),void 0!==ret&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var i,handleObj,sel,matchedHandlers,matchedSelectors,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&!("click"===event.type&&event.button>=1))for(;cur!==this;cur=cur.parentNode||this)if(1===cur.nodeType&&("click"!==event.type||cur.disabled!==!0)){for(matchedHandlers=[],matchedSelectors={},i=0;delegateCount>i;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matchedSelectors[sel]&&(matchedSelectors[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>-1:jQuery.find(sel,this,null,[cur]).length),matchedSelectors[sel]&&matchedHandlers.push(handleObj);matchedHandlers.length&&handlerQueue.push({elem:cur,handlers:matchedHandlers})}return cur=this,delegateCount<handlers.length&&handlerQueue.push({elem:cur,handlers:handlers.slice(delegateCount)}),handlerQueue},addProp:function(name,hook){Object.defineProperty(jQuery.Event.prototype,name,{enumerable:!0,configurable:!0,get:jQuery.isFunction(hook)?function(){return this.originalEvent?hook(this.originalEvent):void 0}:function(){return this.originalEvent?this.originalEvent[name]:void 0},set:function(value){Object.defineProperty(this,name,{enumerable:!0,configurable:!0,writable:!0,value:value})}})},fix:function(originalEvent){return originalEvent[jQuery.expando]?originalEvent:new jQuery.Event(originalEvent)},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==safeActiveElement()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===safeActiveElement()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&nodeName(this,"input")?(this.click(),!1):void 0},_default:function(event){return nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle)},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&src.returnValue===!1?returnTrue:returnFalse,this.target=src.target&&3===src.target.nodeType?src.target.parentNode:src.target,this.currentTarget=src.currentTarget,this.relatedTarget=src.relatedTarget):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),void(this[jQuery.expando]=!0)):new jQuery.Event(src,props)},jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(event){var button=event.button;return null==event.which&&rkeyEvent.test(event.type)?null!=event.charCode?event.charCode:event.keyCode:!event.which&&void 0!==button&&rmouseEvent.test(event.type)?1&button?1:2&button?3:4&button?2:0:event.which}},jQuery.event.addProp),jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return(!related||related!==target&&!jQuery.contains(target,related))&&(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),jQuery.fn.extend({on:function(types,selector,data,fn){return on(this,types,selector,data,fn)},one:function(types,selector,data,fn){return on(this,types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return(selector===!1||"function"==typeof selector)&&(fn=selector,selector=void 0),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;jQuery.extend({htmlPrefilter:function(html){return html.replace(rxhtmlTag,"<$1></$2>")},clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0,l=srcElements.length;l>i;i++)fixInput(srcElements[i],destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;l>i;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},cleanData:function(elems){for(var data,elem,type,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++)if(acceptData(elem)){if(data=elem[dataPriv.expando]){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);elem[dataPriv.expando]=void 0}elem[dataUser.expando]&&(elem[dataUser.expando]=void 0)}}}),jQuery.fn.extend({detach:function(selector){return remove(this,selector,!0)},remove:function(selector){return remove(this,selector)},text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=value)})},null,value,arguments.length)},append:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null==dataAndEvents?!1:dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;l>i;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;jQuery.inArray(this,ignored)<0&&(jQuery.cleanData(getAll(this)),parent&&parent.replaceChild(elem,this))},ignored)}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;last>=i;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){var view=elem.ownerDocument.defaultView;return view&&view.opener||(view=window),view.getComputedStyle(elem)};!function(){function computeStyleTests(){if(div){div.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",div.innerHTML="",documentElement.appendChild(container);var divStyle=window.getComputedStyle(div);pixelPositionVal="1%"!==divStyle.top,reliableMarginLeftVal="2px"===divStyle.marginLeft,boxSizingReliableVal="4px"===divStyle.width,div.style.marginRight="50%",pixelMarginRightVal="4px"===divStyle.marginRight,documentElement.removeChild(container),div=null}}var pixelPositionVal,boxSizingReliableVal,pixelMarginRightVal,reliableMarginLeftVal,container=document.createElement("div"),div=document.createElement("div");div.style&&(div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,container.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",container.appendChild(div),jQuery.extend(support,{pixelPosition:function(){return computeStyleTests(),pixelPositionVal},boxSizingReliable:function(){return computeStyleTests(),boxSizingReliableVal},pixelMarginRight:function(){return computeStyleTests(),pixelMarginRightVal},reliableMarginLeft:function(){return computeStyleTests(),reliableMarginLeftVal}}))}();var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rcustomProp=/^--/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","Moz","ms"],emptyStyle=document.createElement("div").style;jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),isCustomProp=rcustomProp.test(name),style=elem.style;return isCustomProp||(name=finalPropName(origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value?hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name]:(type=typeof value,"string"===type&&(ret=rcssNum.exec(value))&&ret[1]&&(value=adjustCSS(elem,name,ret),type="number"),null!=value&&value===value&&("number"===type&&(value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px")),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(isCustomProp?style.setProperty(name,value):style[name]=value)),void 0)}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name),isCustomProp=rcustomProp.test(name);return isCustomProp||(name=finalPropName(origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||isFinite(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?!rdisplayswap.test(jQuery.css(elem,"display"))||elem.getClientRects().length&&elem.getBoundingClientRect().width?getWidthOrHeight(elem,name,extra):swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):void 0},set:function(elem,value,extra){var matches,styles=extra&&getStyles(elem),subtract=extra&&augmentWidthOrHeight(elem,name,extra,"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles);return subtract&&(matches=rcssNum.exec(value))&&"px"!==(matches[3]||"px")&&(elem.style[name]=value,value=jQuery.css(elem,name)),setPositiveNumber(elem,value,subtract)}}}),jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){return computed?(parseFloat(curCSS(elem,"marginLeft"))||elem.getBoundingClientRect().left-swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left}))+"px":void 0}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(Array.isArray(name)){for(styles=getStyles(elem),len=name.length;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||jQuery.easing._default,this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return 1!==tween.elem.nodeType||null!=tween.elem[tween.prop]&&null==tween.elem.style[tween.prop]?tween.elem[tween.prop]:(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0)},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):1!==tween.elem.nodeType||null==tween.elem.style[jQuery.cssProps[tween.prop]]&&!jQuery.cssHooks[tween.prop]?tween.elem[tween.prop]=tween.now:jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2},_default:"swing"},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,inProgress,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);return adjustCSS(tween.elem,prop,rcssNum.exec(value),tween),tween}]},tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.match(rnothtmlwhite);for(var prop,index=0,length=props.length;length>index;index++)prop=props[index],Animation.tweeners[prop]=Animation.tweeners[prop]||[],Animation.tweeners[prop].unshift(callback)},prefilters:[defaultPrefilter],prefilter:function(callback,prepend){prepend?Animation.prefilters.unshift(callback):Animation.prefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return jQuery.fx.off?opt.duration=0:"number"!=typeof opt.duration&&(opt.duration in jQuery.fx.speeds?opt.duration=jQuery.fx.speeds[opt.duration]:opt.duration=jQuery.fx.speeds._default),(null==opt.queue||opt.queue===!0)&&(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),
opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHiddenWithinTree).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||dataPriv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));(dequeue||!gotoEnd)&&jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=dataPriv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){inProgress||(inProgress=!0,schedule())},jQuery.fx.stop=function(){inProgress=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout)}})},function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,input=document.createElement("input"),input.value="t",input.type="radio",support.radioValue="t"===input.value}();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return"undefined"==typeof elem.getAttribute?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(hooks=jQuery.attrHooks[name.toLowerCase()]||(jQuery.expr.match.bool.test(name)?boolHook:void 0)),void 0!==value?null===value?void jQuery.removeAttr(elem,name):hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret))},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}},removeAttr:function(elem,value){var name,i=0,attrNames=value&&value.match(rnothtmlwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)elem.removeAttribute(name)}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle,lowercaseName=name.toLowerCase();return isXML||(handle=attrHandle[lowercaseName],attrHandle[lowercaseName]=ret,ret=null!=getter(elem,name,isXML)?lowercaseName:null,attrHandle[lowercaseName]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}}),jQuery.extend({prop:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return 1===nType&&jQuery.isXMLDoc(elem)||(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null},set:function(elem){var parent=elem.parentNode;parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex)}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.fn.extend({addClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)))});if("string"==typeof value&&value)for(classes=value.match(rnothtmlwhite)||[];elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=stripAndCollapse(cur),curValue!==finalValue&&elem.setAttribute("class",finalValue)}return this},removeClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof value&&value)for(classes=value.match(rnothtmlwhite)||[];elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>-1;)cur=cur.replace(" "+clazz+" "," ");finalValue=stripAndCollapse(cur),curValue!==finalValue&&elem.setAttribute("class",finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal)}):this.each(function(){var className,i,self,classNames;if("string"===type)for(i=0,self=jQuery(this),classNames=value.match(rnothtmlwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else(void 0===value||"boolean"===type)&&(className=getClass(this),className&&dataPriv.set(this,"__className__",className),this.setAttribute&&this.setAttribute("class",className||value===!1?"":dataPriv.get(this,"__className__")||""))})},hasClass:function(selector){var className,elem,i=0;for(className=" "+selector+" ";elem=this[i++];)if(1===elem.nodeType&&(" "+stripAndCollapse(getClass(elem))+" ").indexOf(className)>-1)return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":Array.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:stripAndCollapse(jQuery.text(elem))}},select:{get:function(elem){var value,option,i,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type,values=one?null:[],max=one?index+1:options.length;for(i=0>index?max:one?index:0;max>i;i++)if(option=options[i],(option.selected||i===index)&&!option.disabled&&(!option.parentNode.disabled||!nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)option=options[i],(option.selected=jQuery.inArray(jQuery.valHooks.option.get(option),values)>-1)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){return Array.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>-1:void 0}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/;jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>-1&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(dataPriv.get(cur,"events")||{})[event.type]&&dataPriv.get(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&acceptData(cur)&&(event.result=handle.apply(cur,data),event.result===!1&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&special._default.apply(eventPath.pop(),data)!==!1||!acceptData(elem)||ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)&&(tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type,elem[type](),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0});jQuery.event.trigger(e,null,elem)}}),jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}}),jQuery.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}}),support.focusin="onfocusin"in window,support.focusin||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event))};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),dataPriv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix)-1;attaches?dataPriv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),dataPriv.remove(doc,fix))}}});var location=window.location,nonce=jQuery.now(),rquery=/\?/;jQuery.parseXML=function(data){var xml;if(!data||"string"!=typeof data)return null;try{xml=(new window.DOMParser).parseFromString(data,"text/xml")}catch(e){xml=void 0}return(!xml||xml.getElementsByTagName("parsererror").length)&&jQuery.error("Invalid XML: "+data),xml};var rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,valueOrFunction){var value=jQuery.isFunction(valueOrFunction)?valueOrFunction():valueOrFunction;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(null==value?"":value)};if(Array.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:Array.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});var r20=/%20/g,rhash=/#.*$/,rantiCache=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");originAnchor.href=location.href,jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:"GET",isLocal:rlocalProtocol.test(location.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;completed||(completed=!0,timeoutTimer&&window.clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&300>status||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,(status||!statusText)&&(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,completed,fireGlobals,i,uncached,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(completed){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return completed?responseHeadersString:null},setRequestHeader:function(name,value){return null==completed&&(name=requestHeadersNames[name.toLowerCase()]=requestHeadersNames[name.toLowerCase()]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return null==completed&&(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(completed)jqXHR.always(map[jqXHR.status]);else for(code in map)statusCode[code]=[statusCode[code],map[code]];return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR),s.url=((url||s.url||location.href)+"").replace(rprotocol,location.protocol+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=(s.dataType||"*").toLowerCase().match(rnothtmlwhite)||[""],null==s.crossDomain){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url,urlAnchor.href=urlAnchor.href,s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!=urlAnchor.protocol+"//"+urlAnchor.host}catch(e){s.crossDomain=!0}}if(s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),completed)return jqXHR;fireGlobals=jQuery.event&&s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url.replace(rhash,""),s.hasContent?s.data&&s.processData&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&(s.data=s.data.replace(r20,"+")):(uncached=s.url.slice(cacheURL.length),s.data&&(cacheURL+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(cacheURL=cacheURL.replace(rantiCache,"$1"),uncached=(rquery.test(cacheURL)?"&":"?")+"_="+nonce++ +uncached),s.url=cacheURL+uncached),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||completed))return jqXHR.abort();if(strAbort="abort",completeDeferred.add(s.complete),jqXHR.done(s.success),jqXHR.fail(s.error),transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){if(jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),completed)return jqXHR;s.async&&s.timeout>0&&(timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{completed=!1,transport.send(requestHeaders,done)}catch(e){if(completed)throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url))}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(html){var wrap;return this[0]&&(jQuery.isFunction(html)&&(html=html.call(this[0])),wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(selector){return this.parent(selector).not("body").each(function(){jQuery(this).replaceWith(this.childNodes)}),this}}),jQuery.expr.pseudos.hidden=function(elem){return!jQuery.expr.pseudos.visible(elem)},jQuery.expr.pseudos.visible=function(elem){return!!(elem.offsetWidth||elem.offsetHeight||elem.getClientRects().length)},jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var callback,errorCallback;return support.cors||xhrSupported&&!options.crossDomain?{send:function(headers,complete){var i,xhr=options.xhr();if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){callback&&(callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.onreadystatechange=null,"abort"===type?xhr.abort():"error"===type?"number"!=typeof xhr.status?complete(0,"error"):complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"text"!==(xhr.responseType||"text")||"string"!=typeof xhr.responseText?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders()))}},xhr.onload=callback(),errorCallback=xhr.onerror=callback("error"),void 0!==xhr.onabort?xhr.onabort=errorCallback:xhr.onreadystatechange=function(){4===xhr.readyState&&window.setTimeout(function(){callback&&errorCallback()})},callback=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback)throw e}},abort:function(){callback&&callback()}}:void 0}),jQuery.ajaxPrefilter(function(s){s.crossDomain&&(s.contents.script=!1)}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove(),callback=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){callback&&callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");return jsonProp||"jsonp"===s.dataTypes[0]?(callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){void 0===overwritten?jQuery(window).removeProp(callbackName):window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"):void 0}),support.createHTMLDocument=function(){var body=document.implementation.createHTMLDocument("").body;return body.innerHTML="<form></form><form></form>",2===body.childNodes.length}(),jQuery.parseHTML=function(data,context,keepScripts){if("string"!=typeof data)return[];"boolean"==typeof context&&(keepScripts=context,context=!1);var base,parsed,scripts;return context||(support.createHTMLDocument?(context=document.implementation.createHTMLDocument(""),base=context.createElement("base"),base.href=document.location.href,context.head.appendChild(base)):context=document),parsed=rsingleTag.exec(data),scripts=!keepScripts&&[],parsed?[context.createElement(parsed[1])]:(parsed=buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))},jQuery.fn.load=function(url,params,callback){var selector,type,response,self=this,off=url.indexOf(" ");return off>-1&&(selector=stripAndCollapse(url.slice(off)),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR])})}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.expr.pseudos.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length},jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&(curCSSTop+curCSSLeft).indexOf("auto")>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,jQuery.extend({},curOffset))),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var doc,docElem,rect,win,elem=this[0];if(elem)return elem.getClientRects().length?(rect=elem.getBoundingClientRect(),doc=elem.ownerDocument,docElem=doc.documentElement,win=doc.defaultView,{top:rect.top+win.pageYOffset-docElem.clientTop,left:rect.left+win.pageXOffset-docElem.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset={top:parentOffset.top+jQuery.css(offsetParent[0],"borderTopWidth",!0),left:parentOffset.left+jQuery.css(offsetParent[0],"borderLeftWidth",!0)}),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent;offsetParent&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||documentElement;
})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win;return jQuery.isWindow(elem)?win=elem:9===elem.nodeType&&(win=elem.defaultView),void 0===val?win?win[prop]:elem[method]:void(win?win.scrollTo(top?win.pageXOffset:val,top?val:win.pageYOffset):elem[method]=val)},method,val,arguments.length)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed):void 0})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?0===funcName.indexOf("outer")?elem["inner"+name]:elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable)}})}),jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}}),jQuery.holdReady=function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},jQuery.isArray=Array.isArray,jQuery.parseJSON=JSON.parse,jQuery.nodeName=nodeName,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},noGlobal||(window.jQuery=window.$=jQuery),jQuery}),function(window,document,undefined){"use strict";function minErr(module,ErrorConstructor){return ErrorConstructor=ErrorConstructor||Error,function(){var paramPrefix,i,SKIP_INDEXES=2,templateArgs=arguments,code=templateArgs[0],message="["+(module?module+":":"")+code+"] ",template=templateArgs[1];for(message+=template.replace(/\{\d+\}/g,function(match){var index=+match.slice(1,-1),shiftedIndex=index+SKIP_INDEXES;return shiftedIndex<templateArgs.length?toDebugString(templateArgs[shiftedIndex]):match}),message+="\nhttp://errors.angularjs.org/1.4.12/"+(module?module+"/":"")+code,i=SKIP_INDEXES,paramPrefix="?";i<templateArgs.length;i++,paramPrefix="&")message+=paramPrefix+"p"+(i-SKIP_INDEXES)+"="+encodeURIComponent(toDebugString(templateArgs[i]));return new ErrorConstructor(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;if(isArray(obj)||isString(obj)||jqLite&&obj instanceof jqLite)return!0;var length="length"in Object(obj)&&obj.length;return isNumber(length)&&(length>=0&&(length-1 in obj||obj instanceof Array)||"function"==typeof obj.item)}function forEach(obj,iterator,context){var key,length;if(obj)if(isFunction(obj))for(key in obj)"prototype"==key||"length"==key||"name"==key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key,obj);else if(isArray(obj)||isArrayLike(obj)){var isPrimitive="object"!=typeof obj;for(key=0,length=obj.length;length>key;key++)(isPrimitive||key in obj)&&iterator.call(context,obj[key],key,obj)}else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context,obj);else if(isBlankObject(obj))for(key in obj)iterator.call(context,obj[key],key,obj);else if("function"==typeof obj.hasOwnProperty)for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key,obj);else for(key in obj)hasOwnProperty.call(obj,key)&&iterator.call(context,obj[key],key,obj);return obj}function forEachSorted(obj,iterator,context){for(var keys=Object.keys(obj).sort(),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){return++uid}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function baseExtend(dst,objs,deep){for(var h=dst.$$hashKey,i=0,ii=objs.length;ii>i;++i){var obj=objs[i];if(isObject(obj)||isFunction(obj))for(var keys=Object.keys(obj),j=0,jj=keys.length;jj>j;j++){var key=keys[j],src=obj[key];deep&&isObject(src)?isDate(src)?dst[key]=new Date(src.valueOf()):isRegExp(src)?dst[key]=new RegExp(src):src.nodeName?dst[key]=src.cloneNode(!0):isElement(src)?dst[key]=src.clone():(isObject(dst[key])||(dst[key]=isArray(src)?[]:{}),baseExtend(dst[key],[src],!0)):dst[key]=src}}return setHashKey(dst,h),dst}function extend(dst){return baseExtend(dst,slice.call(arguments,1),!1)}function merge(dst){return baseExtend(dst,slice.call(arguments,1),!0)}function toInt(str){return parseInt(str,10)}function inherit(parent,extra){return extend(Object.create(parent),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function hasCustomToString(obj){return isFunction(obj.toString)&&obj.toString!==toString}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!==value&&"object"==typeof value}function isBlankObject(value){return null!==value&&"object"==typeof value&&!getPrototypeOf(value)}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.window===obj}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.call(obj)}function isFormData(obj){return"[object FormData]"===toString.call(obj)}function isBlob(obj){return"[object Blob]"===toString.call(obj)}function isBoolean(value){return"boolean"==typeof value}function isPromiseLike(obj){return obj&&isFunction(obj.then)}function isTypedArray(value){return value&&isNumber(value.length)&&TYPED_ARRAY_REGEXP.test(toString.call(value))}function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function nodeName_(element){return lowercase(element.nodeName||element[0]&&element[0].nodeName)}function arrayRemove(array,value){var index=array.indexOf(value);return index>=0&&array.splice(index,1),index}function copy(source,destination){function copyRecurse(source,destination){var key,h=destination.$$hashKey;if(isArray(source))for(var i=0,ii=source.length;ii>i;i++)destination.push(copyElement(source[i]));else if(isBlankObject(source))for(key in source)destination[key]=copyElement(source[key]);else if(source&&"function"==typeof source.hasOwnProperty)for(key in source)source.hasOwnProperty(key)&&(destination[key]=copyElement(source[key]));else for(key in source)hasOwnProperty.call(source,key)&&(destination[key]=copyElement(source[key]));return setHashKey(destination,h),destination}function copyElement(source){if(!isObject(source))return source;var index=stackSource.indexOf(source);if(-1!==index)return stackDest[index];if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");var destination,needsRecurse=!1;return isArray(source)?(destination=[],needsRecurse=!0):isTypedArray(source)?destination=new source.constructor(source):isDate(source)?destination=new Date(source.getTime()):isRegExp(source)?(destination=new RegExp(source.source,source.toString().match(/[^\/]*$/)[0]),destination.lastIndex=source.lastIndex):isBlob(source)?destination=new source.constructor([source],{type:source.type}):isFunction(source.cloneNode)?destination=source.cloneNode(!0):(destination=Object.create(getPrototypeOf(source)),needsRecurse=!0),stackSource.push(source),stackDest.push(destination),needsRecurse?copyRecurse(source,destination):destination}var stackSource=[],stackDest=[];if(destination){if(isTypedArray(destination))throw ngMinErr("cpta","Can't copy! TypedArray destination cannot be mutated.");if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");return isArray(destination)?destination.length=0:forEach(destination,function(value,key){"$$hashKey"!==key&&delete destination[key]}),stackSource.push(source),stackDest.push(destination),copyRecurse(source,destination)}return copyElement(source)}function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0,ii=src.length;ii>i;i++)dst[i]=src[i]}else if(isObject(src)){dst=dst||{};for(var key in src)("$"!==key.charAt(0)||"$"!==key.charAt(1))&&(dst[key]=src[key])}return dst||src}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return isDate(o2)?equals(o1.getTime(),o2.getTime()):!1;if(isRegExp(o1))return isRegExp(o2)?o1.toString()==o2.toString():!1;if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2)||isDate(o2)||isRegExp(o2))return!1;keySet=createMap();for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!(key in keySet)&&"$"!==key.charAt(0)&&isDefined(o2[key])&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;length>key;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,concat(curryArgs,arguments,0)):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)&&"$"===key.charAt(1)?val=undefined:isWindow(value)?val="$WINDOW":value&&document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){return isUndefined(obj)?undefined:(isNumber(pretty)||(pretty=pretty?2:null),JSON.stringify(obj,toJsonReplacer,pretty))}function fromJson(json){return isString(json)?JSON.parse(json):json}function timezoneToOffset(timezone,fallback){timezone=timezone.replace(ALL_COLONS,"");var requestedTimezoneOffset=Date.parse("Jan 01, 1970 00:00:00 "+timezone)/6e4;return isNaN(requestedTimezoneOffset)?fallback:requestedTimezoneOffset}function addDateMinutes(date,minutes){return date=new Date(date.getTime()),date.setMinutes(date.getMinutes()+minutes),date}function convertTimezoneToLocal(date,timezone,reverse){reverse=reverse?-1:1;var dateTimezoneOffset=date.getTimezoneOffset(),timezoneOffset=timezoneToOffset(timezone,dateTimezoneOffset);return addDateMinutes(date,reverse*(timezoneOffset-dateTimezoneOffset))}function startingTag(element){element=jqLite(element).clone();try{element.empty()}catch(e){}var elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===NODE_TYPE_TEXT?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var obj={};return forEach((keyValue||"").split("&"),function(keyValue){var splitPoint,key,val;keyValue&&(key=keyValue=keyValue.replace(/\+/g,"%20"),splitPoint=keyValue.indexOf("="),-1!==splitPoint&&(key=keyValue.substring(0,splitPoint),val=keyValue.substring(splitPoint+1)),key=tryDecodeURIComponent(key),isDefined(key)&&(val=isDefined(val)?tryDecodeURIComponent(val):!0,hasOwnProperty.call(obj,key)?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val))}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function getNgAttribute(element,ngAttr){var attr,i,ii=ngAttrPrefixes.length;for(i=0;ii>i;++i)if(attr=ngAttrPrefixes[i]+ngAttr,isString(attr=element.getAttribute(attr)))return attr;return null}function angularInit(element,bootstrap){var appElement,module,config={};forEach(ngAttrPrefixes,function(prefix){var name=prefix+"app";!appElement&&element.hasAttribute&&element.hasAttribute(name)&&(appElement=element,module=element.getAttribute(name))}),forEach(ngAttrPrefixes,function(prefix){var candidate,name=prefix+"app";!appElement&&(candidate=element.querySelector("["+name.replace(":","\\:")+"]"))&&(appElement=candidate,module=candidate.getAttribute(name))}),appElement&&(config.strictDi=null!==getNgAttribute(appElement,"strict-di"),bootstrap(appElement,module?[module]:[],config))}function bootstrap(element,modules,config){isObject(config)||(config={});var defaultConfig={strictDi:!1};config=extend(defaultConfig,config);var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===document?"document":startingTag(element);throw ngMinErr("btstrpd","App already bootstrapped with this element '{0}'",tag.replace(/</,"&lt;").replace(/>/,"&gt;"))}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),config.debugInfoEnabled&&modules.push(["$compileProvider",function($compileProvider){$compileProvider.debugInfoEnabled(!0)}]),modules.unshift("ng");var injector=createInjector(modules,config.strictDi);return injector.invoke(["$rootScope","$rootElement","$compile","$injector",function(scope,element,compile,injector){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_ENABLE_DEBUG_INFO=/^NG_ENABLE_DEBUG_INFO!/,NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&NG_ENABLE_DEBUG_INFO.test(window.name)&&(config.debugInfoEnabled=!0,window.name=window.name.replace(NG_ENABLE_DEBUG_INFO,"")),window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),angular.resumeBootstrap=function(extraModules){return forEach(extraModules,function(module){modules.push(module)}),doBootstrap()},void(isFunction(angular.resumeDeferredBootstrap)&&angular.resumeDeferredBootstrap()))}function reloadWithDebugInfo(){window.name="NG_ENABLE_DEBUG_INFO!"+window.name,window.location.reload()}function getTestability(rootElement){var injector=angular.element(rootElement).injector();if(!injector)throw ngMinErr("test","no injector found for element argument to getTestability");return injector.get("$$testability")}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){var originalCleanData;if(!bindJQueryFired){var jqName=jq();jQuery=isUndefined(jqName)?window.jQuery:jqName?window[jqName]:undefined,jQuery&&jQuery.fn.on?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),originalCleanData=jQuery.cleanData,jQuery.cleanData=function(elems){var events;if(skipDestroyOnNextJQueryCleanData)skipDestroyOnNextJQueryCleanData=!1;else for(var elem,i=0;null!=(elem=elems[i]);i++)events=jQuery._data(elem,"events"),events&&events.$destroy&&jQuery(elem).triggerHandler("$destroy");originalCleanData(elems)}):jqLite=JQLite,angular.element=jqLite,bindJQueryFired=!0}}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;len>i;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function getBlockNodes(nodes){for(var blockNodes,node=nodes[0],endNode=nodes[nodes.length-1],i=1;node!==endNode&&(node=node.nextSibling);i++)(blockNodes||nodes[i]!==node)&&(blockNodes||(blockNodes=jqLite(slice.call(nodes,0,i))),blockNodes.push(node));return blockNodes||nodes}function createMap(){return Object.create(null)}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng"),angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function(name,requires,configFn){var assertNotHasOwnProperty=function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)};return assertNotHasOwnProperty(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod,queue){return queue||(queue=invokeQueue),function(){return queue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}function invokeLaterAndSetModuleName(provider,method){return function(recipeName,factoryFunction){return factoryFunction&&isFunction(factoryFunction)&&(factoryFunction.$$moduleName=name),invokeQueue.push([provider,method,arguments]),moduleInstance}}if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],configBlocks=[],runBlocks=[],config=invokeLater("$injector","invoke","push",configBlocks),moduleInstance={_invokeQueue:invokeQueue,_configBlocks:configBlocks,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLaterAndSetModuleName("$provide","provider"),factory:invokeLaterAndSetModuleName("$provide","factory"),service:invokeLaterAndSetModuleName("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),decorator:invokeLaterAndSetModuleName("$provide","decorator"),animation:invokeLaterAndSetModuleName("$animateProvider","register"),filter:invokeLaterAndSetModuleName("$filterProvider","register"),controller:invokeLaterAndSetModuleName("$controllerProvider","register"),directive:invokeLaterAndSetModuleName("$compileProvider","directive"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance})}})}function serializeObject(obj){var seen=[];return JSON.stringify(obj,function(key,val){if(val=toJsonReplacer(key,val),isObject(val)){if(seen.indexOf(val)>=0)return"...";seen.push(val)}return val})}function toDebugString(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):isUndefined(obj)?"undefined":"string"!=typeof obj?serializeObject(obj):obj}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,merge:merge,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{counter:0},getTestability:getTestability,$$minErr:minErr,$$csp:csp,reloadWithDebugInfo:reloadWithDebugInfo}),(angularModule=setupModuleLoader(window))("ng",["ngLocale"],["$provide",function($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,pattern:patternDirective,ngPattern:patternDirective,required:requiredDirective,ngRequired:requiredDirective,minlength:minlengthDirective,ngMinlength:minlengthDirective,maxlength:maxlengthDirective,ngMaxlength:maxlengthDirective,ngValue:ngValueDirective,ngModelOptions:ngModelOptionsDirective}).directive({ngInclude:ngIncludeFillContentDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$animateCss:$CoreAnimateCssProvider,$$animateJs:$$CoreAnimateJsProvider,$$animateQueue:$$CoreAnimateQueueProvider,$$AnimateRunner:$$AnimateRunnerFactoryProvider,$$animateAsyncRun:$$AnimateAsyncRunFactoryProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$$forceReflow:$$ForceReflowProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$http:$HttpProvider,$httpParamSerializer:$HttpParamSerializerProvider,$httpParamSerializerJQLike:$HttpParamSerializerJQLikeProvider,$httpBackend:$HttpBackendProvider,$xhrFactory:$xhrFactoryProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$$q:$$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$templateRequest:$TemplateRequestProvider,$$testability:$$TestabilityProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$jqLite:$$jqLiteProvider,$$HashMap:$$HashMapProvider,$$cookieReader:$$CookieReaderProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function jqLiteIsTextNode(html){return!HTML_REGEXP.test(html)}function jqLiteAcceptsData(node){var nodeType=node.nodeType;return nodeType===NODE_TYPE_ELEMENT||!nodeType||nodeType===NODE_TYPE_DOCUMENT}function jqLiteHasData(node){for(var key in jqCache[node.ng339])return!0;return!1}function jqLiteBuildFragment(html,context){var tmp,tag,wrap,i,fragment=context.createDocumentFragment(),nodes=[];if(jqLiteIsTextNode(html))nodes.push(context.createTextNode(html));else{for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(TAG_NAME_REGEXP.exec(html)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+html.replace(XHTML_TAG_REGEXP,"<$1></$2>")+wrap[2],i=wrap[0];i--;)tmp=tmp.lastChild;nodes=concat(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}return fragment.textContent="",fragment.innerHTML="",forEach(nodes,function(node){fragment.appendChild(node)}),fragment}function jqLiteParseHTML(html,context){context=context||document;var parsed;return(parsed=SINGLE_TAG_REGEXP.exec(html))?[context.createElement(parsed[1])]:(parsed=jqLiteBuildFragment(html,context))?parsed.childNodes:[]}function jqLiteWrapNode(node,wrapper){var parent=node.parentNode;parent&&parent.replaceChild(wrapper,node),wrapper.appendChild(node)}function JQLite(element){if(element instanceof JQLite)return element;var argIsString;if(isString(element)&&(element=trim(element),argIsString=!0),!(this instanceof JQLite)){if(argIsString&&"<"!=element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}argIsString?jqLiteAddNodes(this,jqLiteParseHTML(element)):jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element,onlyDescendants){if(onlyDescendants||jqLiteRemoveData(element),element.querySelectorAll)for(var descendants=element.querySelectorAll("*"),i=0,l=descendants.length;l>i;i++)jqLiteRemoveData(descendants[i])}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,handle=expandoStore&&expandoStore.handle;if(handle)if(type){var removeHandler=function(type){var listenerFns=events[type];isDefined(fn)&&arrayRemove(listenerFns||[],fn),isDefined(fn)&&listenerFns&&listenerFns.length>0||(removeEventListenerFn(element,type,handle),delete events[type])};forEach(type.split(" "),function(type){removeHandler(type),MOUSE_EVENT_MAP[type]&&removeHandler(MOUSE_EVENT_MAP[type])})}else for(type in events)"$destroy"!==type&&removeEventListenerFn(element,type,handle),delete events[type]}function jqLiteRemoveData(element,name){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];if(expandoStore){if(name)return void delete expandoStore.data[name];expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),jqLiteOff(element)),delete jqCache[expandoId],element.ng339=undefined}}function jqLiteExpandoStore(element,createIfNecessary){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];return createIfNecessary&&!expandoStore&&(element.ng339=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={events:{},data:{},handle:undefined}),expandoStore}function jqLiteData(element,key,value){if(jqLiteAcceptsData(element)){var isSimpleSetter=isDefined(value),isSimpleGetter=!isSimpleSetter&&key&&!isObject(key),massGetter=!key,expandoStore=jqLiteExpandoStore(element,!isSimpleGetter),data=expandoStore&&expandoStore.data;if(isSimpleSetter)data[key]=value;else{if(massGetter)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}}function jqLiteHasClass(element,selector){return element.getAttribute?(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1:!1}function jqLiteRemoveClass(element,cssClasses){cssClasses&&element.setAttribute&&forEach(cssClasses.split(" "),function(cssClass){element.setAttribute("class",trim((" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," ")))})}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),-1===existingClasses.indexOf(" "+cssClass+" ")&&(existingClasses+=cssClass+" ")}),element.setAttribute("class",trim(existingClasses))}}function jqLiteAddNodes(root,elements){if(elements)if(elements.nodeType)root[root.length++]=elements;else{var length=elements.length;if("number"==typeof length&&elements.window!==elements){if(length)for(var i=0;length>i;i++)root[root.length++]=elements[i]}else root[root.length++]=elements}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){element.nodeType==NODE_TYPE_DOCUMENT&&(element=element.documentElement);for(var names=isArray(name)?name:[name];element;){for(var i=0,ii=names.length;ii>i;i++)if(isDefined(value=jqLite.data(element,names[i])))return value;element=element.parentNode||element.nodeType===NODE_TYPE_DOCUMENT_FRAGMENT&&element.host}}function jqLiteEmpty(element){for(jqLiteDealoc(element,!0);element.firstChild;)element.removeChild(element.firstChild)}function jqLiteRemove(element,keepData){keepData||jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)}function jqLiteDocumentLoaded(action,win){win=win||window,"complete"===win.document.readyState?win.setTimeout(action):jqLite(win).on("load",action)}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[nodeName_(element)]&&booleanAttr}function getAliasedAttrName(name){return ALIASED_ATTR[name]}function createEventHandler(element,events){var eventHandler=function(event,type){event.isDefaultPrevented=function(){return event.defaultPrevented};var eventFns=events[type||event.type],eventFnsLength=eventFns?eventFns.length:0;if(eventFnsLength){if(isUndefined(event.immediatePropagationStopped)){var originalStopImmediatePropagation=event.stopImmediatePropagation;event.stopImmediatePropagation=function(){event.immediatePropagationStopped=!0,event.stopPropagation&&event.stopPropagation(),originalStopImmediatePropagation&&originalStopImmediatePropagation.call(event)}}event.isImmediatePropagationStopped=function(){return event.immediatePropagationStopped===!0};var handlerWrapper=eventFns.specialHandlerWrapper||defaultHandlerWrapper;eventFnsLength>1&&(eventFns=shallowCopy(eventFns));for(var i=0;eventFnsLength>i;i++)event.isImmediatePropagationStopped()||handlerWrapper(element,event,eventFns[i])}};return eventHandler.elem=element,eventHandler}function defaultHandlerWrapper(element,event,handler){handler.call(element,event)}function specialMouseHandlerWrapper(target,event,handler){var related=event.relatedTarget;(!related||related!==target&&!jqLiteContains.call(target,related))&&handler.call(target,event)}function $$jqLiteProvider(){this.$get=function(){return extend(JQLite,{hasClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteHasClass(node,classes)},addClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteAddClass(node,classes)},removeClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteRemoveClass(node,classes)}})}}function hashKey(obj,nextUidFn){var key=obj&&obj.$$hashKey;if(key)return"function"==typeof key&&(key=obj.$$hashKey()),key;var objType=typeof obj;
return key="function"==objType||"object"==objType&&null!==obj?obj.$$hashKey=objType+":"+(nextUidFn||nextUid)():objType+":"+obj}function HashMap(array,isolatedUid){if(isolatedUid){var uid=0;this.nextUid=function(){return++uid}}forEach(array,this.put,this)}function anonFn(fn){var fnText=fn.toString().replace(STRIP_COMMENTS,""),args=fnText.match(FN_ARGS);return args?"function("+(args[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function annotate(fn,strictDi,name){var $inject,fnText,argDecl,last;if("function"==typeof fn){if(!($inject=fn.$inject)){if($inject=[],fn.length){if(strictDi)throw isString(name)&&name||(name=fn.name||anonFn(fn)),$injectorMinErr("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",name);fnText=fn.toString().replace(STRIP_COMMENTS,""),argDecl=fnText.match(FN_ARGS),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})}fn.$inject=$inject}}else isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0);return $inject}function createInjector(modulesToLoad,strictDi){function supportObject(delegate){return function(key,value){return isObject(key)?void forEach(key,reverseParams(delegate)):delegate(key,value)}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function enforceReturnValue(name,factory){return function(){var result=instanceInjector.invoke(factory,this);if(isUndefined(result))throw $injectorMinErr("undef","Provider '{0}' must return a value from $get factory method.",name);return result}}function factory(name,factoryFn,enforce){return provider(name,{$get:enforce!==!1?enforceReturnValue(name,factoryFn):factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,val){return factory(name,valueFn(val),!1)}function constant(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){assertArg(isUndefined(modulesToLoad)||isArray(modulesToLoad),"modulesToLoad","not an array");var moduleFn,runBlocks=[];return forEach(modulesToLoad,function(module){function runInvokeQueue(queue){var i,ii;for(i=0,ii=queue.length;ii>i;i++){var invokeArgs=queue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}}if(!loadedModules.get(module)){loadedModules.put(module,!0);try{isString(module)?(moduleFn=angularModule(module),runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),runInvokeQueue(moduleFn._invokeQueue),runInvokeQueue(moduleFn._configBlocks)):isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName,caller){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",serviceName+" <- "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName,caller)}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function invoke(fn,self,locals,serviceName){"string"==typeof locals&&(serviceName=locals,locals=null);var length,i,key,args=[],$inject=createInjector.$$annotate(fn,strictDi,serviceName);for(i=0,length=$inject.length;length>i;i++){if(key=$inject[i],"string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key,serviceName))}return isArray(fn)&&(fn=fn[length]),fn.apply(self,args)}function instantiate(Type,locals,serviceName){var instance=Object.create((isArray(Type)?Type[Type.length-1]:Type).prototype||null),returnedValue=invoke(Type,instance,locals,serviceName);return isObject(returnedValue)||isFunction(returnedValue)?returnedValue:instance}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:createInjector.$$annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}strictDi=strictDi===!0;var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap([],!0),providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(serviceName,caller){throw angular.isString(caller)&&path.push(caller),$injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},instanceInjector=instanceCache.$injector=createInternalInjector(instanceCache,function(serviceName,caller){var provider=providerInjector.get(serviceName+providerSuffix,caller);return instanceInjector.invoke(provider.$get,provider,undefined,serviceName)});return forEach(loadModules(modulesToLoad),function(fn){fn&&instanceInjector.invoke(fn)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return Array.prototype.some.call(list,function(element){return"a"===nodeName_(element)?(result=element,!0):void 0}),result}function getYOffset(){var offset=scroll.yOffset;if(isFunction(offset))offset=offset();else if(isElement(offset)){var elem=offset[0],style=$window.getComputedStyle(elem);offset="fixed"!==style.position?0:elem.getBoundingClientRect().bottom}else isNumber(offset)||(offset=0);return offset}function scrollTo(elem){if(elem){elem.scrollIntoView();var offset=getYOffset();if(offset){var elemTop=elem.getBoundingClientRect().top;$window.scrollBy(0,elemTop-offset)}}else $window.scrollTo(0,0)}function scroll(hash){hash=isString(hash)?hash:$location.hash();var elm;hash?(elm=document.getElementById(hash))?scrollTo(elm):(elm=getFirstAnchor(document.getElementsByName(hash)))?scrollTo(elm):"top"===hash&&scrollTo(null):scrollTo(null)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(newVal,oldVal){(newVal!==oldVal||""!==newVal)&&jqLiteDocumentLoaded(function(){$rootScope.$evalAsync(scroll)})}),scroll}]}function mergeClasses(a,b){return a||b?a?b?(isArray(a)&&(a=a.join(" ")),isArray(b)&&(b=b.join(" ")),a+" "+b):a:b:""}function extractElementNode(element){for(var i=0;i<element.length;i++){var elm=element[i];if(elm.nodeType===ELEMENT_NODE)return elm}}function splitClasses(classes){isString(classes)&&(classes=classes.split(" "));var obj=createMap();return forEach(classes,function(klass){klass.length&&(obj[klass]=!0)}),obj}function prepareAnimateOptions(options){return isObject(options)?options:{}}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function getHash(url){var index=url.indexOf("#");return-1===index?"":url.substr(index)}function cacheStateAndFireUrlChange(){pendingLocation=null,cacheState(),fireUrlChange()}function getCurrentState(){try{return history.state}catch(e){}}function cacheState(){cachedState=getCurrentState(),cachedState=isUndefined(cachedState)?null:cachedState,equals(cachedState,lastCachedState)&&(cachedState=lastCachedState),lastCachedState=cachedState}function fireUrlChange(){(lastBrowserUrl!==self.url()||lastHistoryState!==cachedState)&&(lastBrowserUrl=self.url(),lastHistoryState=cachedState,forEach(urlChangeListeners,function(listener){listener(self.url(),cachedState)}))}var self=this,location=(document[0],window.location),history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var cachedState,lastHistoryState,lastBrowserUrl=location.href,baseElement=document.find("base"),pendingLocation=null;cacheState(),lastHistoryState=cachedState,self.url=function(url,replace,state){if(isUndefined(state)&&(state=null),location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){var sameState=lastHistoryState===state;if(lastBrowserUrl===url&&(!$sniffer.history||sameState))return self;var sameBase=lastBrowserUrl&&stripHash(lastBrowserUrl)===stripHash(url);return lastBrowserUrl=url,lastHistoryState=state,!$sniffer.history||sameBase&&sameState?((!sameBase||pendingLocation)&&(pendingLocation=url),replace?location.replace(url):sameBase?location.hash=getHash(url):location.href=url,location.href!==url&&(pendingLocation=url)):(history[replace?"replaceState":"pushState"](state,"",url),cacheState(),lastHistoryState=cachedState),self}return pendingLocation||location.href.replace(/%27/g,"'")},self.state=function(){return cachedState};var urlChangeListeners=[],urlChangeInit=!1,lastCachedState=null;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",cacheStateAndFireUrlChange),jqLite(window).on("hashchange",cacheStateAndFireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.$$applicationDestroyed=function(){jqLite(window).off("hashchange popstate",cacheStateAndFireUrlChange)},self.$$checkUrlChange=fireUrlChange,self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?\:)?\/\/[^\/]*/,""):""},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return pendingDeferIds[deferId]?(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0):!1}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data=createMap(),capacity=options&&options.capacity||Number.MAX_VALUE,lruHash=createMap(),freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(!isUndefined(value)){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry)}return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value}},get:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}key in data&&(delete data[key],size--)},removeAll:function(){data=createMap(),size=0,lruHash=createMap(),freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function $CompileProvider($provide,$$sanitizeUriProvider){function parseIsolateBindings(scope,directiveName,isController){var LOCAL_REGEXP=/^\s*([@&]|=(\*?))(\??)\s*(\w*)\s*$/,bindings=createMap();return forEach(scope,function(definition,scopeName){if(definition in bindingCache)return void(bindings[scopeName]=bindingCache[definition]);var match=definition.match(LOCAL_REGEXP);if(!match)throw $compileMinErr("iscp","Invalid {3} for directive '{0}'. Definition: {... {1}: '{2}' ...}",directiveName,scopeName,definition,isController?"controller bindings definition":"isolate scope definition");bindings[scopeName]={mode:match[1][0],collection:"*"===match[2],optional:"?"===match[3],attrName:match[4]||scopeName},match[4]&&(bindingCache[definition]=bindings[scopeName])}),bindings}function parseDirectiveBindings(directive,directiveName){var bindings={isolateScope:null,bindToController:null};if(isObject(directive.scope)&&(directive.bindToController===!0?(bindings.bindToController=parseIsolateBindings(directive.scope,directiveName,!0),bindings.isolateScope={}):bindings.isolateScope=parseIsolateBindings(directive.scope,directiveName,!1)),isObject(directive.bindToController)&&(bindings.bindToController=parseIsolateBindings(directive.bindToController,directiveName,!0)),isObject(bindings.bindToController)){var controller=directive.controller,controllerAs=directive.controllerAs;if(!controller)throw $compileMinErr("noctrl","Cannot bind to controller without directive '{0}'s controller.",directiveName);if(!identifierForController(controller,controllerAs))throw $compileMinErr("noident","Cannot bind to controller without identifier for directive '{0}'.",directiveName)}return bindings}function assertValidDirectiveName(name){var letter=name.charAt(0);if(!letter||letter!==lowercase(letter))throw $compileMinErr("baddir","Directive name '{0}' is invalid. The first character must be a lowercase letter",name);if(name!==name.trim())throw $compileMinErr("baddir","Directive name '{0}' is invalid. The name should not contain leading or trailing whitespaces",name)}var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\w\-]+)(?:\:([^;]+))?;?)/,ALL_OR_NOTHING_ATTRS=makeMap("ngSrc,ngSrcset,src,srcset"),REQUIRE_PREFIX_REGEXP=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/,bindingCache=createMap();this.directive=function registerDirective(name,directiveFactory){return assertNotHasOwnProperty(name,"directive"),isString(name)?(assertValidDirectiveName(name),assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=directive.require||directive.controller&&directive.name,directive.restrict=directive.restrict||"EA",directive.$$moduleName=directiveFactory.$$moduleName,directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()};var debugInfoEnabled=!0;this.debugInfoEnabled=function(enabled){return isDefined(enabled)?(debugInfoEnabled=enabled,this):debugInfoEnabled},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function($injector,$interpolate,$exceptionHandler,$templateRequest,$parse,$controller,$rootScope,$sce,$animate,$$sanitizeUri){function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes));for(var NOT_EMPTY=/\S+/,i=0,len=$compileNodes.length;len>i;i++){var domNode=$compileNodes[i];domNode.nodeType===NODE_TYPE_TEXT&&domNode.nodeValue.match(NOT_EMPTY)&&jqLiteWrapNode(domNode,$compileNodes[i]=document.createElement("span"))}var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);compile.$$addScopeClass($compileNodes);var namespace=null;return function(scope,cloneConnectFn,options){assertArg(scope,"scope"),previousCompileContext&&previousCompileContext.needsNewScope&&(scope=scope.$parent.$new()),options=options||{};var parentBoundTranscludeFn=options.parentBoundTranscludeFn,transcludeControllers=options.transcludeControllers,futureParentElement=options.futureParentElement;parentBoundTranscludeFn&&parentBoundTranscludeFn.$$boundTransclude&&(parentBoundTranscludeFn=parentBoundTranscludeFn.$$boundTransclude),namespace||(namespace=detectNamespaceForChildElements(futureParentElement));var $linkNode;if($linkNode="html"!==namespace?jqLite(wrapTemplate(namespace,jqLite("<div>").append($compileNodes).html())):cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes,transcludeControllers)for(var controllerName in transcludeControllers)$linkNode.data("$"+controllerName+"Controller",transcludeControllers[controllerName].instance);return compile.$$addScopeInfo($linkNode,scope),cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode,parentBoundTranscludeFn),$linkNode}}function detectNamespaceForChildElements(parentElement){var node=parentElement&&parentElement[0];return node&&"foreignobject"!==nodeName_(node)&&node.toString().match(/SVG/)?"svg":"html"}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){function compositeLinkFn(scope,nodeList,$rootElement,parentBoundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,i,ii,idx,childBoundTranscludeFn,stableNodeList;if(nodeLinkFnFound){var nodeListLength=nodeList.length;for(stableNodeList=new Array(nodeListLength),i=0;i<linkFns.length;i+=3)idx=linkFns[i],stableNodeList[idx]=nodeList[idx]}else stableNodeList=nodeList;for(i=0,ii=linkFns.length;ii>i;)node=stableNodeList[linkFns[i++]],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(),compile.$$addScopeInfo(jqLite(node),childScope)):childScope=scope,childBoundTranscludeFn=nodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,nodeLinkFn.transclude,parentBoundTranscludeFn):!nodeLinkFn.templateOnThisElement&&parentBoundTranscludeFn?parentBoundTranscludeFn:!parentBoundTranscludeFn&&transcludeFn?createBoundTranscludeFn(scope,transcludeFn):null,nodeLinkFn(childLinkFn,childScope,node,$rootElement,childBoundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,undefined,parentBoundTranscludeFn)}for(var attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,nodeLinkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:undefined,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null,nodeLinkFn&&nodeLinkFn.scope&&compile.$$addScopeClass(attrs.$$element),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?(nodeLinkFn.transcludeOnThisElement||!nodeLinkFn.templateOnThisElement)&&nodeLinkFn.transclude:transcludeFn),(nodeLinkFn||childLinkFn)&&(linkFns.push(i,nodeLinkFn,childLinkFn),linkFnFound=!0,nodeLinkFnFound=nodeLinkFnFound||nodeLinkFn),previousCompileContext=null;return linkFnFound?compositeLinkFn:null}function createBoundTranscludeFn(scope,transcludeFn,previousBoundTranscludeFn){var boundTranscludeFn=function(transcludedScope,cloneFn,controllers,futureParentElement,containingScope){return transcludedScope||(transcludedScope=scope.$new(!1,containingScope),transcludedScope.$$transcluded=!0),transcludeFn(transcludedScope,cloneFn,{parentBoundTranscludeFn:previousBoundTranscludeFn,transcludeControllers:controllers,futureParentElement:futureParentElement})};return boundTranscludeFn}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case NODE_TYPE_ELEMENT:addDirective(directives,directiveNormalize(nodeName_(node)),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,isNgAttr,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;jj>j;j++){var attrStartName=!1,attrEndName=!1;attr=nAttrs[j],name=attr.name,value=trim(attr.value),ngAttrName=directiveNormalize(name),(isNgAttr=NG_ATTR_BINDING.test(ngAttrName))&&(name=name.replace(PREFIX_REGEXP,"").substr(8).replace(/_(.)/g,function(match,letter){return letter.toUpperCase()}));var multiElementMatch=ngAttrName.match(MULTI_ELEMENT_DIR_RE);multiElementMatch&&directiveIsMultiElement(multiElementMatch[1])&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,(isNgAttr||!attrs.hasOwnProperty(nName))&&(attrs[nName]=value,getBooleanAttrName(node,nName)&&(attrs[nName]=!0)),addAttrInterpolateDirective(node,directives,value,nName,isNgAttr),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName)}if(className=node.className,isObject(className)&&(className=className.animVal),isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case NODE_TYPE_TEXT:if(11===msie)for(;node.parentNode&&node.nextSibling&&node.nextSibling.nodeType===NODE_TYPE_TEXT;)node.nodeValue=node.nodeValue+node.nextSibling.nodeValue,node.parentNode.removeChild(node.nextSibling);addTextInterpolateDirective(directives,node.nodeValue);break;case NODE_TYPE_COMMENT:try{match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue),match&&(nName=directiveNormalize(match[1]),addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2])))}catch(e){}}return directives.sort(byPriority),directives}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);node.nodeType==NODE_TYPE_ELEMENT&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,pre.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,post.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function getControllers(directiveName,require,$element,elementControllers){var value;if(isString(require)){var match=require.match(REQUIRE_PREFIX_REGEXP),name=require.substring(match[0].length),inheritType=match[1]||match[3],optional="?"===match[2];if("^^"===inheritType?$element=$element.parent():(value=elementControllers&&elementControllers[name],value=value&&value.instance),!value){var dataName="$"+name+"Controller";value=inheritType?$element.inheritedData(dataName):$element.data(dataName)}if(!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",name,directiveName)}else if(isArray(require)){value=[];for(var i=0,ii=require.length;ii>i;i++)value[i]=getControllers(directiveName,require[i],$element,elementControllers)}return value||null}function setupControllers($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope){var elementControllers=createMap();for(var controllerKey in controllerDirectives){var directive=controllerDirectives[controllerKey],locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn},controller=directive.controller;"@"==controller&&(controller=attrs[directive.name]);var controllerInstance=$controller(controller,locals,!0,directive.controllerAs);elementControllers[directive.name]=controllerInstance,$element.data("$"+directive.name+"Controller",controllerInstance.instance)}return elementControllers}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){function controllersBoundTransclude(scope,cloneAttachFn,futureParentElement){var transcludeControllers;return isScope(scope)||(futureParentElement=cloneAttachFn,cloneAttachFn=scope,scope=undefined),hasElementTranscludeDirective&&(transcludeControllers=elementControllers),futureParentElement||(futureParentElement=hasElementTranscludeDirective?$element.parent():$element),boundTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild)}var linkFn,isolateScope,controllerScope,elementControllers,transcludeFn,$element,attrs,removeScopeBindingWatches,removeControllerBindingWatches;compileNode===linkNode?(attrs=templateAttrs,$element=templateAttrs.$$element):($element=jqLite(linkNode),attrs=new Attributes($element,templateAttrs)),controllerScope=scope,newIsolateScopeDirective?isolateScope=scope.$new(!0):newScopeDirective&&(controllerScope=scope.$parent),boundTranscludeFn&&(transcludeFn=controllersBoundTransclude,transcludeFn.$$boundTransclude=boundTranscludeFn),controllerDirectives&&(elementControllers=setupControllers($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope)),newIsolateScopeDirective&&(compile.$$addScopeInfo($element,isolateScope,!0,!(templateDirective&&(templateDirective===newIsolateScopeDirective||templateDirective===newIsolateScopeDirective.$$originalDirective))),compile.$$addScopeClass($element,!0),isolateScope.$$isolateBindings=newIsolateScopeDirective.$$isolateBindings,removeScopeBindingWatches=initializeDirectiveBindings(scope,attrs,isolateScope,isolateScope.$$isolateBindings,newIsolateScopeDirective),removeScopeBindingWatches&&isolateScope.$on("$destroy",removeScopeBindingWatches));for(var name in elementControllers){var controllerDirective=controllerDirectives[name],controller=elementControllers[name],bindings=controllerDirective.$$bindings.bindToController;controller.identifier&&bindings&&(removeControllerBindingWatches=initializeDirectiveBindings(controllerScope,attrs,controller.instance,bindings,controllerDirective));var controllerResult=controller();controllerResult!==controller.instance&&(controller.instance=controllerResult,$element.data("$"+controllerDirective.name+"Controller",controllerResult),removeControllerBindingWatches&&removeControllerBindingWatches(),removeControllerBindingWatches=initializeDirectiveBindings(controllerScope,attrs,controller.instance,bindings,controllerDirective))}for(i=0,ii=preLinkFns.length;ii>i;i++)linkFn=preLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,undefined,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)linkFn=postLinkFns[i],invokeLinkFn(linkFn,linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn)}previousCompileContext=previousCompileContext||{};for(var directive,directiveName,$template,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,newScopeDirective=previousCompileContext.newScopeDirective,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasTemplate=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,i=0,ii=directives.length;ii>i;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=undefined,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(directive.templateUrl||(isObject(directiveValue)?(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective||newScopeDirective,directive,$compileNode),newIsolateScopeDirective=directive):assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode)),newScopeDirective=newScopeDirective||directive),directiveName=directive.name,!directive.templateUrl&&directive.controller&&(directiveValue=directive.controller,
controllerDirectives=controllerDirectives||createMap(),assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),(directiveValue=directive.transclude)&&(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"==directiveValue?(hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=$compileNode,$compileNode=templateAttrs.$$element=jqLite(document.createComment(" "+directiveName+": "+templateAttrs[directiveName]+" ")),compileNode=$compileNode[0],replaceWith(jqCollection,sliceArgs($template),compileNode),childTranscludeFn=compile($template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective})):($template=jqLite(jqLiteClone(compileNode)).contents(),$compileNode.empty(),childTranscludeFn=compile($template,transcludeFn,undefined,undefined,{needsNewScope:directive.$$isolateScope||directive.$$newScope}))),directive.template)if(hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLiteIsTextNode(directiveValue)?[]:removeComments(wrapTemplate(directive.templateNamespace,trim(directiveValue))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));(newIsolateScopeDirective||newScopeDirective)&&markDirectiveScope(templateDirectives,newIsolateScopeDirective,newScopeDirective),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,hasTranscludeDirective&&childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newScopeDirective:newScopeDirective!==directive&&newScopeDirective,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn),isFunction(linkFn)?addLinkFns(null,linkFn,attrStart,attrEnd):linkFn&&addLinkFns(linkFn.pre,linkFn.post,attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope===!0,nodeLinkFn.transcludeOnThisElement=hasTranscludeDirective,nodeLinkFn.templateOnThisElement=hasTemplate,nodeLinkFn.transclude=childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn}function markDirectiveScope(directives,isolateScope,newScope){for(var j=0,jj=directives.length;jj>j;j++)directives[j]=inherit(directives[j],{$$isolateScope:isolateScope,$$newScope:newScope})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)try{if(directive=directives[i],(isUndefined(maxPriority)||maxPriority>directive.priority)&&-1!=directive.restrict.indexOf(location)){if(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),!directive.$$bindings){var bindings=directive.$$bindings=parseDirectiveBindings(directive,directive.name);isObject(bindings.isolateScope)&&(directive.$$isolateBindings=bindings.isolateScope)}tDirectives.push(directive),match=directive}}catch(e){$exceptionHandler(e)}return match}function directiveIsMultiElement(name){if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)if(directive=directives[i],directive.multiElement)return!0;return!1}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr,$element=dst.$$element;forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&src[key]!==value&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){"class"==key?(safeAddClass($element,value),dst["class"]=(dst["class"]?dst["class"]+" ":"")+value):"style"==key?($element.attr("style",$element.attr("style")+";"+value),dst.style=(dst.style?dst.style+";":"")+value):"$"==key.charAt(0)||dst.hasOwnProperty(key)||(dst[key]=value,dstAttr[key]=srcAttr[key])})}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=inherit(origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl,templateNamespace=origAsyncDirective.templateNamespace;return $compileNode.empty(),$templateRequest(templateUrl).then(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLiteIsTextNode(content)?[]:removeComments(wrapTemplate(templateNamespace,trim(content))),compileNode=$template[0],1!=$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectiveScope(templateDirectives,!0),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node==compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(!scope.$$destroyed){if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn)}}linkQueue=null}),function(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){var childBoundTranscludeFn=boundTranscludeFn;scope.$$destroyed||(linkQueue?linkQueue.push(scope,node,rootElement,childBoundTranscludeFn):(afterTemplateNodeLinkFn.transcludeOnThisElement&&(childBoundTranscludeFn=createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn)),afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,childBoundTranscludeFn)))}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){function wrapModuleNameIfDefined(moduleName){return moduleName?" (module: "+moduleName+")":""}if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}",previousDirective.name,wrapModuleNameIfDefined(previousDirective.$$moduleName),directive.name,wrapModuleNameIfDefined(directive.$$moduleName),what,startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:function(templateNode){var templateNodeParent=templateNode.parent(),hasCompileParent=!!templateNodeParent.length;return hasCompileParent&&compile.$$addBindingClass(templateNodeParent),function(scope,node){var parent=node.parent();hasCompileParent||compile.$$addBindingClass(parent),compile.$$addBindingInfo(parent,interpolateFn.expressions),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})}}})}function wrapTemplate(type,template){switch(type=lowercase(type||"html")){case"svg":case"math":var wrapper=document.createElement("div");return wrapper.innerHTML="<"+type+">"+template+"</"+type+">",wrapper.childNodes[0].childNodes;default:return template}}function getTrustedContext(node,attrNormalizedName){if("srcdoc"==attrNormalizedName)return $sce.HTML;var tag=nodeName_(node);return"xlinkHref"==attrNormalizedName||"form"==tag&&"action"==attrNormalizedName||"img"!=tag&&("src"==attrNormalizedName||"ngSrc"==attrNormalizedName)?$sce.RESOURCE_URL:void 0}function addAttrInterpolateDirective(node,directives,value,name,allOrNothing){var trustedContext=getTrustedContext(node,name);allOrNothing=ALL_OR_NOTHING_ATTRS[name]||allOrNothing;var interpolateFn=$interpolate(value,!0,trustedContext,allOrNothing);if(interpolateFn){if("multiple"===name&&"select"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:function(){return{pre:function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers=createMap());if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");var newValue=attr[name];newValue!==value&&(interpolateFn=newValue&&$interpolate(newValue,!0,trustedContext,allOrNothing),value=newValue),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(newValue,oldValue){"class"===name&&newValue!=oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)}))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;ii>i;i++)if($rootElement[i]==firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;jj>j;j++,j2++)jj>j2?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1,$rootElement.context===firstElementToRemove&&($rootElement.context=newNode);break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=document.createDocumentFragment();fragment.appendChild(firstElementToRemove),jqLite.hasData(firstElementToRemove)&&(jqLite.data(newNode,jqLite.data(firstElementToRemove)),jQuery?(skipDestroyOnNextJQueryCleanData=!0,jQuery.cleanData([firstElementToRemove])):delete jqLite.cache[firstElementToRemove[jqLite.expando]]);for(var k=1,kk=elementsToRemove.length;kk>k;k++){var element=elementsToRemove[k];jqLite(element).remove(),fragment.appendChild(element),delete elementsToRemove[k]}elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}function invokeLinkFn(linkFn,scope,$element,attrs,controllers,transcludeFn){try{linkFn(scope,$element,attrs,controllers,transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}function initializeDirectiveBindings(scope,attrs,destination,bindings,directive){var removeWatchCollection=[];return forEach(bindings,function(definition,scopeName){var lastValue,parentGet,parentSet,compare,attrName=definition.attrName,optional=definition.optional,mode=definition.mode;switch(mode){case"@":optional||hasOwnProperty.call(attrs,attrName)||(destination[scopeName]=attrs[attrName]=void 0),attrs.$observe(attrName,function(value){isString(value)&&(destination[scopeName]=value)}),attrs.$$observers[attrName].$$scope=scope,lastValue=attrs[attrName],isString(lastValue)?destination[scopeName]=$interpolate(lastValue)(scope):isBoolean(lastValue)&&(destination[scopeName]=lastValue);break;case"=":if(!hasOwnProperty.call(attrs,attrName)){if(optional)break;attrs[attrName]=void 0}if(optional&&!attrs[attrName])break;parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:function(a,b){return a===b||a!==a&&b!==b},parentSet=parentGet.assign||function(){throw lastValue=destination[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' in attribute '{1}' used with directive '{2}' is non-assignable!",attrs[attrName],attrName,directive.name)},lastValue=destination[scopeName]=parentGet(scope);var parentValueWatch=function(parentValue){return compare(parentValue,destination[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=destination[scopeName]):destination[scopeName]=parentValue),lastValue=parentValue};parentValueWatch.$stateful=!0;var removeWatch;removeWatch=definition.collection?scope.$watchCollection(attrs[attrName],parentValueWatch):scope.$watch($parse(attrs[attrName],parentValueWatch),null,parentGet.literal),removeWatchCollection.push(removeWatch);break;case"&":if(parentGet=attrs.hasOwnProperty(attrName)?$parse(attrs[attrName]):noop,parentGet===noop&&optional)break;destination[scopeName]=function(locals){return parentGet(scope,locals)}}}),removeWatchCollection.length&&function(){for(var i=0,ii=removeWatchCollection.length;ii>i;++i)removeWatchCollection[i]()}}var Attributes=function(element,attributesToCopy){if(attributesToCopy){var i,l,key,keys=Object.keys(attributesToCopy);for(i=0,l=keys.length;l>i;i++)key=keys[i],this[key]=attributesToCopy[key]}else this.$attr={};this.$$element=element};Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses);toAdd&&toAdd.length&&$animate.addClass(this.$$element,toAdd);var toRemove=tokenDifference(oldClasses,newClasses);toRemove&&toRemove.length&&$animate.removeClass(this.$$element,toRemove)},$set:function(key,value,writeAttr,attrName){var nodeName,node=this.$$element[0],booleanKey=getBooleanAttrName(node,key),aliasedKey=getAliasedAttrName(key),observer=key;if(booleanKey?(this.$$element.prop(key,value),attrName=booleanKey):aliasedKey&&(this[aliasedKey]=value,observer=aliasedKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),"a"===nodeName&&"href"===key||"img"===nodeName&&"src"===key)this[key]=value=$$sanitizeUri(value,"src"===key);else if("img"===nodeName&&"srcset"===key&&isDefined(value)){for(var result="",trimmedSrcset=trim(value),srcPattern=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,pattern=/\s/.test(trimmedSrcset)?srcPattern:/(,)/,rawUris=trimmedSrcset.split(pattern),nbrUrisWith2parts=Math.floor(rawUris.length/2),i=0;nbrUrisWith2parts>i;i++){var innerIdx=2*i;result+=$$sanitizeUri(trim(rawUris[innerIdx]),!0),result+=" "+trim(rawUris[innerIdx+1])}var lastTuple=trim(rawUris[2*i]).split(/\s/);result+=$$sanitizeUri(trim(lastTuple[0]),!0),2===lastTuple.length&&(result+=" "+trim(lastTuple[1])),this[key]=value=result}writeAttr!==!1&&(null===value||isUndefined(value)?this.$$element.removeAttr(attrName):this.$$element.attr(attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[observer],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers=createMap()),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||!attrs.hasOwnProperty(key)||isUndefined(attrs[key])||fn(attrs[key])}),function(){arrayRemove(listeners,fn)}}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol&&"}}"==endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/,MULTI_ELEMENT_DIR_RE=/^(.+)Start$/;return compile.$$addBindingInfo=debugInfoEnabled?function($element,binding){var bindings=$element.data("$binding")||[];isArray(binding)?bindings=bindings.concat(binding):bindings.push(binding),$element.data("$binding",bindings)}:noop,compile.$$addBindingClass=debugInfoEnabled?function($element){safeAddClass($element,"ng-binding")}:noop,compile.$$addScopeInfo=debugInfoEnabled?function($element,scope,isolated,noTemplate){var dataName=isolated?noTemplate?"$isolateScopeNoTemplate":"$isolateScope":"$scope";$element.data(dataName,scope)}:noop,compile.$$addScopeClass=debugInfoEnabled?function($element,isolated){safeAddClass($element,isolated?"ng-isolate-scope":"ng-scope")}:noop,compile}]}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function removeComments(jqNodes){jqNodes=jqLite(jqNodes);var i=jqNodes.length;if(1>=i)return jqNodes;for(;i--;){var node=jqNodes[i];node.nodeType===NODE_TYPE_COMMENT&&splice.call(jqNodes,i,1)}return jqNodes}function identifierForController(controller,ident){if(ident&&isString(ident))return ident;if(isString(controller)){var match=CNTRL_REG.exec(controller);if(match)return match[3]}}function $ControllerProvider(){var controllers={},globals=!1;this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.allowGlobals=function(){globals=!0},this.$get=["$injector","$window",function($injector,$window){function addIdentifier(locals,identifier,instance,name){if(!locals||!isObject(locals.$scope))throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",name,identifier);locals.$scope[identifier]=instance}return function(expression,locals,later,ident){var instance,match,constructor,identifier;if(later=later===!0,ident&&isString(ident)&&(identifier=ident),isString(expression)){if(match=expression.match(CNTRL_REG),!match)throw $controllerMinErr("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",expression);constructor=match[1],identifier=identifier||match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||(globals?getter($window,constructor,!0):undefined),assertArgFn(expression,constructor,!0)}if(later){var controllerPrototype=(isArray(expression)?expression[expression.length-1]:expression).prototype;instance=Object.create(controllerPrototype||null),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name);var instantiate;return instantiate=extend(function(){var result=$injector.invoke(expression,instance,locals,constructor);return result!==instance&&(isObject(result)||isFunction(result))&&(instance=result,identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name)),instance},{instance:instance,identifier:identifier})}return instance=$injector.instantiate(expression,locals,constructor),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name),instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(exception,cause){$log.error.apply($log,arguments)}}]}function serializeValue(v){return isObject(v)?isDate(v)?v.toISOString():toJson(v):v}function $HttpParamSerializerProvider(){this.$get=function(){return function(params){if(!params)return"";var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||(isArray(value)?forEach(value,function(v,k){parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(v)))}):parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(value))))}),parts.join("&")}}}function $HttpParamSerializerJQLikeProvider(){this.$get=function(){return function(params){function serialize(toSerialize,prefix,topLevel){null===toSerialize||isUndefined(toSerialize)||(isArray(toSerialize)?forEach(toSerialize,function(value,index){serialize(value,prefix+"["+(isObject(value)?index:"")+"]")}):isObject(toSerialize)&&!isDate(toSerialize)?forEachSorted(toSerialize,function(value,key){serialize(value,prefix+(topLevel?"":"[")+key+(topLevel?"":"]"))}):parts.push(encodeUriQuery(prefix)+"="+encodeUriQuery(serializeValue(toSerialize))))}if(!params)return"";var parts=[];return serialize(params,"",!0),parts.join("&")}}}function defaultHttpResponseTransform(data,headers){if(isString(data)){var tempData=data.replace(JSON_PROTECTION_PREFIX,"").trim();if(tempData){var contentType=headers("Content-Type");(contentType&&0===contentType.indexOf(APPLICATION_JSON)||isJsonLike(tempData))&&(data=fromJson(tempData))}}return data}function isJsonLike(str){var jsonStart=str.match(JSON_START);return jsonStart&&JSON_ENDS[jsonStart[0]].test(str)}function parseHeaders(headers){function fillInParsed(key,val){key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)}var i,parsed=createMap();return isString(headers)?forEach(headers.split("\n"),function(line){i=line.indexOf(":"),fillInParsed(lowercase(trim(line.substr(0,i))),trim(line.substr(i+1)))}):isObject(headers)&&forEach(headers,function(headerVal,headerKey){fillInParsed(lowercase(headerKey),trim(headerVal))}),parsed}function headersGetter(headers){var headersObj;return function(name){if(headersObj||(headersObj=parseHeaders(headers)),name){var value=headersObj[lowercase(name)];return void 0===value&&(value=null),value}return headersObj}}function transformData(data,headers,status,fns){return isFunction(fns)?fns(data,headers,status):(forEach(fns,function(fn){data=fn(data,headers,status)}),data)}function isSuccess(status){return status>=200&&300>status}function $HttpProvider(){var defaults=this.defaults={transformResponse:[defaultHttpResponseTransform],transformRequest:[function(d){return!isObject(d)||isFile(d)||isBlob(d)||isFormData(d)?d:toJson(d)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),put:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),patch:shallowCopy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},useApplyAsync=!1;this.useApplyAsync=function(value){return isDefined(value)?(useApplyAsync=!!value,this):useApplyAsync};var useLegacyPromise=!0;this.useLegacyPromiseExtensions=function(value){return isDefined(value)?(useLegacyPromise=!!value,this):useLegacyPromise};var interceptorFactories=this.interceptors=[];this.$get=["$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$$cookieReader,$cacheFactory,$rootScope,$q,$injector){function $http(requestConfig){function transformResponse(response){var resp=extend({},response);return resp.data=transformData(response.data,response.headers,response.status,config.transformResponse),isSuccess(response.status)?resp:$q.reject(resp)}function executeHeaderFns(headers,config){var headerContent,processedHeaders={};return forEach(headers,function(headerFn,header){isFunction(headerFn)?(headerContent=headerFn(config),null!=headerContent&&(processedHeaders[header]=headerContent)):processedHeaders[header]=headerFn}),processedHeaders}function mergeHeaders(config){var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return executeHeaderFns(reqHeaders,shallowCopy(config))}if(!angular.isObject(requestConfig))throw minErr("$http")("badreq","Http request configuration must be an object.  Received: {0}",requestConfig);if(!isString(requestConfig.url))throw minErr("$http")("badreq","Http request configuration url must be a string.  Received: {0}",requestConfig.url);var config=extend({method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse,paramSerializer:defaults.paramSerializer},requestConfig);config.headers=mergeHeaders(requestConfig),config.method=uppercase(config.method),config.paramSerializer=isString(config.paramSerializer)?$injector.get(config.paramSerializer):config.paramSerializer;var serverRequest=function(config){var headers=config.headers,reqData=transformData(config.data,headersGetter(headers),undefined,config.transformRequest);return isUndefined(reqData)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData).then(transformResponse,transformResponse)},chain=[serverRequest,undefined],promise=$q.when(config);for(forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&chain.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&chain.push(interceptor.response,interceptor.responseError)});chain.length;){var thenFn=chain.shift(),rejectFn=chain.shift();promise=promise.then(thenFn,rejectFn)}return useLegacyPromise?(promise.success=function(fn){return assertArgFn(fn,"fn"),promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return assertArgFn(fn,"fn"),promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise}):(promise.success=$httpMinErrLegacyFn("success"),promise.error=$httpMinErrLegacyFn("error")),promise}function createShortMethods(names){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend({},config||{},{method:name,url:url}))}})}function createShortMethodsWithData(name){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend({},config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData){function done(status,response,headersString,statusText){function resolveHttpPromise(){resolvePromise(response,status,headersString,statusText)}cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString),statusText]):cache.remove(url)),useApplyAsync?$rootScope.$applyAsync(resolveHttpPromise):(resolveHttpPromise(),$rootScope.$$phase||$rootScope.$apply())}function resolvePromise(response,status,headers,statusText){status=status>=-1?status:0,(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config,statusText:statusText})}function resolvePromiseWithResult(result){resolvePromise(result.data,result.status,shallowCopy(result.headers()),result.statusText)}function removePendingReq(){var idx=$http.pendingRequests.indexOf(config);-1!==idx&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,reqHeaders=config.headers,url=buildUrl(config.url,config.paramSerializer(config.params));if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),!config.cache&&!defaults.cache||config.cache===!1||"GET"!==config.method&&"JSONP"!==config.method||(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache&&(cachedResp=cache.get(url),isDefined(cachedResp)?isPromiseLike(cachedResp)?cachedResp.then(resolvePromiseWithResult,resolvePromiseWithResult):isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],shallowCopy(cachedResp[2]),cachedResp[3]):resolvePromise(cachedResp,200,{},"OK"):cache.put(url,promise)),isUndefined(cachedResp)){var xsrfValue=urlIsSameOrigin(config.url)?$$cookieReader()[config.xsrfCookieName||defaults.xsrfCookieName]:undefined;xsrfValue&&(reqHeaders[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue),$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType)}return promise}function buildUrl(url,serializedParams){return serializedParams.length>0&&(url+=(-1==url.indexOf("?")?"?":"&")+serializedParams),url}var defaultCache=$cacheFactory("$http");defaults.paramSerializer=isString(defaults.paramSerializer)?$injector.get(defaults.paramSerializer):defaults.paramSerializer;var reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put","patch"),$http.defaults=defaults,$http}]}function $xhrFactoryProvider(){this.$get=function(){return function(){return new window.XMLHttpRequest}}}function $HttpBackendProvider(){this.$get=["$browser","$window","$document","$xhrFactory",function($browser,$window,$document,$xhrFactory){return createHttpBackend($browser,$xhrFactory,$browser.defer,$window.angular.callbacks,$document[0])}]}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument){function jsonpReq(url,callbackId,done){var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks[callbackId].called||(event={
type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),rawDocument.body.appendChild(script),callback}return function(method,url,post,callback,headers,timeout,withCredentials,responseType){function timeoutRequest(){jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){isDefined(timeoutId)&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(noop)}if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"==lowercase(method)){var callbackId="_"+(callbacks.counter++).toString(36);callbacks[callbackId]=function(data){callbacks[callbackId].data=data,callbacks[callbackId].called=!0};var jsonpDone=jsonpReq(url.replace("JSON_CALLBACK","angular.callbacks."+callbackId),callbackId,function(status,text){completeRequest(callback,status,callbacks[callbackId].data,"",text),callbacks[callbackId]=noop})}else{var xhr=createXhr(method,url);xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onload=function(){var statusText=xhr.statusText||"",response="response"in xhr?xhr.response:xhr.responseText,status=1223===xhr.status?204:xhr.status;0===status&&(status=response?200:"file"==urlResolve(url).protocol?404:0),completeRequest(callback,status,response,xhr.getAllResponseHeaders(),statusText)};var requestError=function(){completeRequest(callback,-1,null,null,"")};if(xhr.onerror=requestError,xhr.onabort=requestError,withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(isUndefined(post)?null:post)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else isPromiseLike(timeout)&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function escape(ch){return"\\\\\\"+ch}function unescapeText(text){return text.replace(escapedStartRegexp,startSymbol).replace(escapedEndRegexp,endSymbol)}function stringify(value){if(null==value)return"";switch(typeof value){case"string":break;case"number":value=""+value;break;default:value=toJson(value)}return value}function $interpolate(text,mustHaveExpression,trustedContext,allOrNothing){function parseStringifyInterceptor(value){try{return value=getValue(value),allOrNothing&&!isDefined(value)?value:stringify(value)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}}allOrNothing=!!allOrNothing;for(var startIndex,endIndex,exp,index=0,expressions=[],parseFns=[],textLength=text.length,concat=[],expressionPositions=[];textLength>index;){if(-1==(startIndex=text.indexOf(startSymbol,index))||-1==(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))){index!==textLength&&concat.push(unescapeText(text.substring(index)));break}index!==startIndex&&concat.push(unescapeText(text.substring(index,startIndex))),exp=text.substring(startIndex+startSymbolLength,endIndex),expressions.push(exp),parseFns.push($parse(exp,parseStringifyInterceptor)),index=endIndex+endSymbolLength,expressionPositions.push(concat.length),concat.push("")}if(trustedContext&&concat.length>1&&$interpolateMinErr.throwNoconcat(text),!mustHaveExpression||expressions.length){var compute=function(values){for(var i=0,ii=expressions.length;ii>i;i++){if(allOrNothing&&isUndefined(values[i]))return;concat[expressionPositions[i]]=values[i]}return concat.join("")},getValue=function(value){return trustedContext?$sce.getTrusted(trustedContext,value):$sce.valueOf(value)};return extend(function(context){var i=0,ii=expressions.length,values=new Array(ii);try{for(;ii>i;i++)values[i]=parseFns[i](context);return compute(values)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}},{exp:text,expressions:expressions,$$watchDelegate:function(scope,listener){var lastValue;return scope.$watchGroup(parseFns,function(values,oldValues){var currValue=compute(values);isFunction(listener)&&listener.call(this,currValue,values!==oldValues?lastValue:currValue,scope),lastValue=currValue})}})}}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length,escapedStartRegexp=new RegExp(startSymbol.replace(/./g,escape),"g"),escapedEndRegexp=new RegExp(endSymbol.replace(/./g,escape),"g");return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $IntervalProvider(){this.$get=["$rootScope","$window","$q","$$q",function($rootScope,$window,$q,$$q){function interval(fn,delay,count,invokeApply){var hasParams=arguments.length>4,args=hasParams?sliceArgs(arguments,4):[],setInterval=$window.setInterval,clearInterval=$window.clearInterval,iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return count=isDefined(count)?count:0,promise.then(null,null,hasParams?function(){fn.apply(null,args)}:fn),promise.$$intervalId=setInterval(function(){deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId]),skipApply||$rootScope.$apply()},delay),intervals[promise.$$intervalId]=deferred,promise}var intervals={};return interval.cancel=function(promise){return promise&&promise.$$intervalId in intervals?(intervals[promise.$$intervalId].reject("canceled"),$window.clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId],!0):!1},interval}]}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function parseAbsoluteUrl(absoluteUrl,locationObj){var parsedUrl=urlResolve(absoluteUrl);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=toInt(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}function parseAppUrl(relativeUrl,locationObj){var prefixed="/"!==relativeUrl.charAt(0);prefixed&&(relativeUrl="/"+relativeUrl);var match=urlResolve(relativeUrl);locationObj.$$path=decodeURIComponent(prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!=locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)}function beginsWith(begin,whole){return 0===whole.indexOf(begin)?whole.substr(begin.length):void 0}function stripHash(url){var index=url.indexOf("#");return-1==index?url:url.substr(0,index)}function trimEmptyHash(url){return url.replace(/(#.+)|#$/,"$1")}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,appBaseNoFile,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"",parseAbsoluteUrl(appBase,this),this.$$parse=function(url){var pathUrl=beginsWith(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var appUrl,prevAppUrl,rewrittenUrl;return isDefined(appUrl=beginsWith(appBase,url))?(prevAppUrl=appUrl,rewrittenUrl=isDefined(appUrl=beginsWith(basePrefix,appUrl))?appBaseNoFile+(beginsWith("/",appUrl)||appUrl):appBase+prevAppUrl):isDefined(appUrl=beginsWith(appBaseNoFile,url))?rewrittenUrl=appBaseNoFile+appUrl:appBaseNoFile==url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl}}function LocationHashbangUrl(appBase,appBaseNoFile,hashPrefix){parseAbsoluteUrl(appBase,this),this.$$parse=function(url){function removeWindowsDriveName(path,url,base){var firstPathSegmentMatch,windowsFilePathExp=/^\/[A-Z]:(\/.*)/;return 0===url.indexOf(base)&&(url=url.replace(base,"")),windowsFilePathExp.exec(url)?path:(firstPathSegmentMatch=windowsFilePathExp.exec(path),firstPathSegmentMatch?firstPathSegmentMatch[1]:path)}var withoutHashUrl,withoutBaseUrl=beginsWith(appBase,url)||beginsWith(appBaseNoFile,url);isUndefined(withoutBaseUrl)||"#"!==withoutBaseUrl.charAt(0)?this.$$html5?withoutHashUrl=withoutBaseUrl:(withoutHashUrl="",isUndefined(withoutBaseUrl)&&(appBase=url,this.replace())):(withoutHashUrl=beginsWith(hashPrefix,withoutBaseUrl),isUndefined(withoutHashUrl)&&(withoutHashUrl=withoutBaseUrl)),parseAppUrl(withoutHashUrl,this),this.$$path=removeWindowsDriveName(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$parseLinkUrl=function(url,relHref){return stripHash(appBase)==stripHash(url)?(this.$$parse(url),!0):!1}}function LocationHashbangInHtml5Url(appBase,appBaseNoFile,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments),this.$$parseLinkUrl=function(url,relHref){if(relHref&&"#"===relHref[0])return this.hash(relHref.slice(1)),!0;var rewrittenUrl,appUrl;return appBase==stripHash(url)?rewrittenUrl=url:(appUrl=beginsWith(appBaseNoFile,url))?rewrittenUrl=appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+hashPrefix+this.$$url}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isBoolean(mode)?(html5Mode.enabled=mode,this):isObject(mode)?(isBoolean(mode.enabled)&&(html5Mode.enabled=mode.enabled),isBoolean(mode.requireBase)&&(html5Mode.requireBase=mode.requireBase),isBoolean(mode.rewriteLinks)&&(html5Mode.rewriteLinks=mode.rewriteLinks),this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function($rootScope,$browser,$sniffer,$rootElement,$window){function setBrowserUrlWithFallback(url,replace,state){var oldUrl=$location.url(),oldState=$location.$$state;try{$browser.url(url,replace,state),$location.$$state=$browser.state()}catch(e){throw $location.url(oldUrl),$location.$$state=oldState,e}}function afterLocationChange(oldUrl,oldState){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl,$location.$$state,oldState)}var $location,LocationMode,appBase,baseHref=$browser.baseHref(),initialUrl=$browser.url();if(html5Mode.enabled){if(!baseHref&&html5Mode.requireBase)throw $locationMinErr("nobase","$location in HTML5 mode requires a <base> tag to be present!");appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url}else appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl;var appBaseNoFile=stripFile(appBase);$location=new LocationMode(appBase,appBaseNoFile,"#"+hashPrefix),$location.$$parseLinkUrl(initialUrl,initialUrl),$location.$$state=$browser.state();var IGNORE_URI_REGEXP=/^\s*(javascript|mailto):/i;$rootElement.on("click",function(event){if(html5Mode.rewriteLinks&&!event.ctrlKey&&!event.metaKey&&!event.shiftKey&&2!=event.which&&2!=event.button){for(var elm=jqLite(event.target);"a"!==nodeName_(elm[0]);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href"),relHref=elm.attr("href")||elm.attr("xlink:href");isObject(absHref)&&"[object SVGAnimatedString]"===absHref.toString()&&(absHref=urlResolve(absHref.animVal).href),IGNORE_URI_REGEXP.test(absHref)||!absHref||elm.attr("target")||event.isDefaultPrevented()||$location.$$parseLinkUrl(absHref,relHref)&&(event.preventDefault(),$location.absUrl()!=$browser.url()&&($rootScope.$apply(),$window.angular["ff-684208-preventDefault"]=!0))}}),trimEmptyHash($location.absUrl())!=trimEmptyHash(initialUrl)&&$browser.url($location.absUrl(),!0);var initializing=!0;return $browser.onUrlChange(function(newUrl,newState){return isUndefined(beginsWith(appBaseNoFile,newUrl))?void($window.location.href=newUrl):($rootScope.$evalAsync(function(){var defaultPrevented,oldUrl=$location.absUrl(),oldState=$location.$$state;newUrl=trimEmptyHash(newUrl),$location.$$parse(newUrl),$location.$$state=newState,defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,newState,oldState).defaultPrevented,$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState,setBrowserUrlWithFallback(oldUrl,!1,oldState)):(initializing=!1,afterLocationChange(oldUrl,oldState)))}),void($rootScope.$$phase||$rootScope.$digest()))}),$rootScope.$watch(function(){var oldUrl=trimEmptyHash($browser.url()),newUrl=trimEmptyHash($location.absUrl()),oldState=$browser.state(),currentReplace=$location.$$replace,urlOrStateChanged=oldUrl!==newUrl||$location.$$html5&&$sniffer.history&&oldState!==$location.$$state;(initializing||urlOrStateChanged)&&(initializing=!1,$rootScope.$evalAsync(function(){var newUrl=$location.absUrl(),defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,$location.$$state,oldState).defaultPrevented;$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState):(urlOrStateChanged&&setBrowserUrlWithFallback(newUrl,currentReplace,oldState===$location.$$state?null:$location.$$state),afterLocationChange(oldUrl,oldState)))})),$location.$$replace=!1}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&-1===arg.stack.indexOf(arg.message)?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop,hasApply=!1;try{hasApply=!!logFn.apply}catch(e){}return hasApply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,null==arg2?"":arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("__defineGetter__"===name||"__defineSetter__"===name||"__lookupGetter__"===name||"__lookupSetter__"===name||"__proto__"===name)throw $parseMinErr("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",fullExpression);return name}function getStringValue(name,fullExpression){if(name+="",!isString(name))throw $parseMinErr("iseccst","Cannot convert object to primitive value! Expression: {0}",fullExpression);return name}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.window===obj)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===Object)throw $parseMinErr("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function ensureSafeFunction(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===CALL||obj===APPLY||obj===BIND)throw $parseMinErr("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",fullExpression)}}function ensureSafeAssignContext(obj,fullExpression){if(obj&&(obj===0..constructor||obj===(!1).constructor||obj==="".constructor||obj==={}.constructor||obj===[].constructor||obj===Function.constructor))throw $parseMinErr("isecaf","Assigning to a constructor is disallowed! Expression: {0}",fullExpression)}function ifDefined(v,d){return"undefined"!=typeof v?v:d}function plusFn(l,r){return"undefined"==typeof l?r:"undefined"==typeof r?l:l+r}function isStateless($filter,filterName){var fn=$filter(filterName);return!fn.$stateful}function findConstantAndWatchExpressions(ast,$filter){var allConstants,argsToWatch;switch(ast.type){case AST.Program:allConstants=!0,forEach(ast.body,function(expr){findConstantAndWatchExpressions(expr.expression,$filter),allConstants=allConstants&&expr.expression.constant}),ast.constant=allConstants;break;case AST.Literal:ast.constant=!0,ast.toWatch=[];break;case AST.UnaryExpression:findConstantAndWatchExpressions(ast.argument,$filter),ast.constant=ast.argument.constant,ast.toWatch=ast.argument.toWatch;break;case AST.BinaryExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.left.toWatch.concat(ast.right.toWatch);break;case AST.LogicalExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.constant?[]:[ast];break;case AST.ConditionalExpression:findConstantAndWatchExpressions(ast.test,$filter),findConstantAndWatchExpressions(ast.alternate,$filter),findConstantAndWatchExpressions(ast.consequent,$filter),ast.constant=ast.test.constant&&ast.alternate.constant&&ast.consequent.constant,ast.toWatch=ast.constant?[]:[ast];break;case AST.Identifier:ast.constant=!1,ast.toWatch=[ast];break;case AST.MemberExpression:findConstantAndWatchExpressions(ast.object,$filter),ast.computed&&findConstantAndWatchExpressions(ast.property,$filter),ast.constant=ast.object.constant&&(!ast.computed||ast.property.constant),ast.toWatch=[ast];break;case AST.CallExpression:allConstants=ast.filter?isStateless($filter,ast.callee.name):!1,argsToWatch=[],forEach(ast.arguments,function(expr){findConstantAndWatchExpressions(expr,$filter),allConstants=allConstants&&expr.constant,expr.constant||argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=ast.filter&&isStateless($filter,ast.callee.name)?argsToWatch:[ast];break;case AST.AssignmentExpression:findConstantAndWatchExpressions(ast.left,$filter),findConstantAndWatchExpressions(ast.right,$filter),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=[ast];break;case AST.ArrayExpression:allConstants=!0,argsToWatch=[],forEach(ast.elements,function(expr){findConstantAndWatchExpressions(expr,$filter),allConstants=allConstants&&expr.constant,expr.constant||argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ObjectExpression:allConstants=!0,argsToWatch=[],forEach(ast.properties,function(property){findConstantAndWatchExpressions(property.value,$filter),allConstants=allConstants&&property.value.constant,property.value.constant||argsToWatch.push.apply(argsToWatch,property.value.toWatch)}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ThisExpression:ast.constant=!1,ast.toWatch=[]}}function getInputs(body){if(1==body.length){var lastExpression=body[0].expression,candidate=lastExpression.toWatch;return 1!==candidate.length?candidate:candidate[0]!==lastExpression?candidate:undefined}}function isAssignable(ast){return ast.type===AST.Identifier||ast.type===AST.MemberExpression}function assignableAST(ast){return 1===ast.body.length&&isAssignable(ast.body[0].expression)?{type:AST.AssignmentExpression,left:ast.body[0].expression,right:{type:AST.NGValueParameter},operator:"="}:void 0}function isLiteral(ast){return 0===ast.body.length||1===ast.body.length&&(ast.body[0].expression.type===AST.Literal||ast.body[0].expression.type===AST.ArrayExpression||ast.body[0].expression.type===AST.ObjectExpression)}function isConstant(ast){return ast.constant}function ASTCompiler(astBuilder,$filter){this.astBuilder=astBuilder,this.$filter=$filter}function ASTInterpreter(astBuilder,$filter){this.astBuilder=astBuilder,this.$filter=$filter}function isPossiblyDangerousMemberName(name){return"constructor"==name}function getValueOf(value){return isFunction(value.valueOf)?value.valueOf():objectValueOf.call(value)}function $ParseProvider(){var cacheDefault=createMap(),cacheExpensive=createMap();this.$get=["$filter",function($filter){function $parse(exp,interceptorFn,expensiveChecks){var parsedExpression,oneTime,cacheKey;switch(expensiveChecks=expensiveChecks||runningChecksEnabled,typeof exp){case"string":exp=exp.trim(),cacheKey=exp;var cache=expensiveChecks?cacheExpensive:cacheDefault;if(parsedExpression=cache[cacheKey],!parsedExpression){":"===exp.charAt(0)&&":"===exp.charAt(1)&&(oneTime=!0,exp=exp.substring(2));var parseOptions=expensiveChecks?$parseOptionsExpensive:$parseOptions,lexer=new Lexer(parseOptions),parser=new Parser(lexer,$filter,parseOptions);parsedExpression=parser.parse(exp),parsedExpression.constant?parsedExpression.$$watchDelegate=constantWatchDelegate:oneTime?parsedExpression.$$watchDelegate=parsedExpression.literal?oneTimeLiteralWatchDelegate:oneTimeWatchDelegate:parsedExpression.inputs&&(parsedExpression.$$watchDelegate=inputsWatchDelegate),expensiveChecks&&(parsedExpression=expensiveChecksInterceptor(parsedExpression)),cache[cacheKey]=parsedExpression}return addInterceptor(parsedExpression,interceptorFn);case"function":return addInterceptor(exp,interceptorFn);default:return addInterceptor(noop,interceptorFn)}}function expensiveChecksInterceptor(fn){function expensiveCheckFn(scope,locals,assign,inputs){var expensiveCheckOldValue=runningChecksEnabled;runningChecksEnabled=!0;try{return fn(scope,locals,assign,inputs)}finally{runningChecksEnabled=expensiveCheckOldValue}}if(!fn)return fn;expensiveCheckFn.$$watchDelegate=fn.$$watchDelegate,expensiveCheckFn.assign=expensiveChecksInterceptor(fn.assign),expensiveCheckFn.constant=fn.constant,expensiveCheckFn.literal=fn.literal;for(var i=0;fn.inputs&&i<fn.inputs.length;++i)fn.inputs[i]=expensiveChecksInterceptor(fn.inputs[i]);return expensiveCheckFn.inputs=fn.inputs,expensiveCheckFn}function expressionInputDirtyCheck(newValue,oldValueOfValue){return null==newValue||null==oldValueOfValue?newValue===oldValueOfValue:"object"==typeof newValue&&(newValue=getValueOf(newValue),"object"==typeof newValue)?!1:newValue===oldValueOfValue||newValue!==newValue&&oldValueOfValue!==oldValueOfValue}function inputsWatchDelegate(scope,listener,objectEquality,parsedExpression,prettyPrintExpression){var lastResult,inputExpressions=parsedExpression.inputs;if(1===inputExpressions.length){var oldInputValueOf=expressionInputDirtyCheck;return inputExpressions=inputExpressions[0],scope.$watch(function(scope){var newInputValue=inputExpressions(scope);return expressionInputDirtyCheck(newInputValue,oldInputValueOf)||(lastResult=parsedExpression(scope,undefined,undefined,[newInputValue]),oldInputValueOf=newInputValue&&getValueOf(newInputValue)),lastResult},listener,objectEquality,prettyPrintExpression)}for(var oldInputValueOfValues=[],oldInputValues=[],i=0,ii=inputExpressions.length;ii>i;i++)oldInputValueOfValues[i]=expressionInputDirtyCheck,oldInputValues[i]=null;return scope.$watch(function(scope){for(var changed=!1,i=0,ii=inputExpressions.length;ii>i;i++){var newInputValue=inputExpressions[i](scope);(changed||(changed=!expressionInputDirtyCheck(newInputValue,oldInputValueOfValues[i])))&&(oldInputValues[i]=newInputValue,oldInputValueOfValues[i]=newInputValue&&getValueOf(newInputValue))}return changed&&(lastResult=parsedExpression(scope,undefined,undefined,oldInputValues)),lastResult},listener,objectEquality,prettyPrintExpression)}function oneTimeWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.apply(this,arguments),isDefined(value)&&scope.$$postDigest(function(){isDefined(lastValue)&&unwatch()})},objectEquality)}function oneTimeLiteralWatchDelegate(scope,listener,objectEquality,parsedExpression){function isAllDefined(value){var allDefined=!0;return forEach(value,function(val){isDefined(val)||(allDefined=!1)}),allDefined}var unwatch,lastValue;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){lastValue=value,isFunction(listener)&&listener.call(this,value,old,scope),isAllDefined(value)&&scope.$$postDigest(function(){isAllDefined(lastValue)&&unwatch()})},objectEquality)}function constantWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch;return unwatch=scope.$watch(function(scope){return parsedExpression(scope)},function(value,old,scope){isFunction(listener)&&listener.apply(this,arguments),unwatch()},objectEquality)}function addInterceptor(parsedExpression,interceptorFn){if(!interceptorFn)return parsedExpression;var watchDelegate=parsedExpression.$$watchDelegate,useInputs=!1,regularWatch=watchDelegate!==oneTimeLiteralWatchDelegate&&watchDelegate!==oneTimeWatchDelegate,fn=regularWatch?function(scope,locals,assign,inputs){var value=useInputs&&inputs?inputs[0]:parsedExpression(scope,locals,assign,inputs);return interceptorFn(value,scope,locals)}:function(scope,locals,assign,inputs){var value=parsedExpression(scope,locals,assign,inputs),result=interceptorFn(value,scope,locals);return isDefined(value)?result:value};return parsedExpression.$$watchDelegate&&parsedExpression.$$watchDelegate!==inputsWatchDelegate?fn.$$watchDelegate=parsedExpression.$$watchDelegate:interceptorFn.$stateful||(fn.$$watchDelegate=inputsWatchDelegate,useInputs=!parsedExpression.inputs,fn.inputs=parsedExpression.inputs?parsedExpression.inputs:[parsedExpression]),fn}var noUnsafeEval=csp().noUnsafeEval,$parseOptions={csp:noUnsafeEval,expensiveChecks:!1},$parseOptionsExpensive={csp:noUnsafeEval,expensiveChecks:!0},runningChecksEnabled=!1;return $parse.$$runningExpensiveChecks=function(){return runningChecksEnabled},$parse}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function $$QProvider(){this.$get=["$browser","$exceptionHandler",function($browser,$exceptionHandler){return qFactory(function(callback){$browser.defer(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function callOnce(self,resolveFn,rejectFn){function wrap(fn){return function(value){called||(called=!0,fn.call(self,value))}}var called=!1;return[wrap(resolveFn),wrap(rejectFn)]}function Promise(){this.$$state={status:0}}function simpleBind(context,fn){return function(value){fn.call(context,value)}}function processQueue(state){var fn,deferred,pending;pending=state.pending,state.processScheduled=!1,state.pending=undefined;for(var i=0,ii=pending.length;ii>i;++i){deferred=pending[i][0],fn=pending[i][state.status];try{isFunction(fn)?deferred.resolve(fn(state.value)):1===state.status?deferred.resolve(state.value):deferred.reject(state.value)}catch(e){deferred.reject(e),exceptionHandler(e)}}}function scheduleProcessQueue(state){!state.processScheduled&&state.pending&&(state.processScheduled=!0,nextTick(function(){processQueue(state)}))}function Deferred(){this.promise=new Promise,this.resolve=simpleBind(this,this.resolve),this.reject=simpleBind(this,this.reject),this.notify=simpleBind(this,this.notify)}function all(promises){var deferred=new Deferred,counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,when(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise}var $qMinErr=minErr("$q",TypeError),defer=function(){return new Deferred};extend(Promise.prototype,{then:function(onFulfilled,onRejected,progressBack){if(isUndefined(onFulfilled)&&isUndefined(onRejected)&&isUndefined(progressBack))return this;var result=new Deferred;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([result,onFulfilled,onRejected,progressBack]),this.$$state.status>0&&scheduleProcessQueue(this.$$state),result.promise},"catch":function(callback){return this.then(null,callback)},"finally":function(callback,progressBack){return this.then(function(value){return handleCallback(value,!0,callback)},function(error){return handleCallback(error,!1,callback)},progressBack)}}),extend(Deferred.prototype,{resolve:function(val){this.promise.$$state.status||(val===this.promise?this.$$reject($qMinErr("qcycle","Expected promise to be resolved with value other than itself '{0}'",val)):this.$$resolve(val))},$$resolve:function(val){var then,fns;fns=callOnce(this,this.$$resolve,this.$$reject);try{(isObject(val)||isFunction(val))&&(then=val&&val.then),isFunction(then)?(this.promise.$$state.status=-1,then.call(val,fns[0],fns[1],this.notify)):(this.promise.$$state.value=val,this.promise.$$state.status=1,scheduleProcessQueue(this.promise.$$state))}catch(e){fns[1](e),exceptionHandler(e)}},reject:function(reason){this.promise.$$state.status||this.$$reject(reason)},$$reject:function(reason){this.promise.$$state.value=reason,this.promise.$$state.status=2,scheduleProcessQueue(this.promise.$$state)},notify:function(progress){var callbacks=this.promise.$$state.pending;this.promise.$$state.status<=0&&callbacks&&callbacks.length&&nextTick(function(){for(var callback,result,i=0,ii=callbacks.length;ii>i;i++){result=callbacks[i][0],callback=callbacks[i][3];try{result.notify(isFunction(callback)?callback(progress):progress)}catch(e){exceptionHandler(e)}}})}});var reject=function(reason){var result=new Deferred;return result.reject(reason),result.promise},makePromise=function(value,resolved){var result=new Deferred;return resolved?result.resolve(value):result.reject(value),result.promise},handleCallback=function(value,isResolved,callback){var callbackOutput=null;try{isFunction(callback)&&(callbackOutput=callback())}catch(e){return makePromise(e,!1)}return isPromiseLike(callbackOutput)?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)},when=function(value,callback,errback,progressBack){var result=new Deferred;return result.resolve(value),result.promise.then(callback,errback,progressBack)},resolve=when,$Q=function Q(resolver){function resolveFn(value){
deferred.resolve(value)}function rejectFn(reason){deferred.reject(reason)}if(!isFunction(resolver))throw $qMinErr("norslvr","Expected resolverFn, got '{0}'",resolver);if(!(this instanceof Q))return new Q(resolver);var deferred=new Deferred;return resolver(resolveFn,rejectFn),deferred.promise};return $Q.defer=defer,$Q.reject=reject,$Q.when=when,$Q.resolve=resolve,$Q.all=all,$Q}function $$RAFProvider(){this.$get=["$window","$timeout",function($window,$timeout){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame||$window.webkitCancelRequestAnimationFrame,rafSupported=!!requestAnimationFrame,raf=rafSupported?function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}}:function(fn){var timer=$timeout(fn,16.66,!1);return function(){$timeout.cancel(timer)}};return raf.supported=rafSupported,raf}]}function $RootScopeProvider(){function createChildScopeClass(parent){function ChildScope(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=nextUid(),this.$$ChildScope=null}return ChildScope.prototype=parent,ChildScope}var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null,applyAsyncId=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$injector","$exceptionHandler","$parse","$browser",function($injector,$exceptionHandler,$parse,$browser){function destroyChildScope($event){$event.currentScope.$$destroyed=!0}function cleanUpScope($scope){9===msie&&($scope.$$childHead&&cleanUpScope($scope.$$childHead),$scope.$$nextSibling&&cleanUpScope($scope.$$nextSibling)),$scope.$parent=$scope.$$nextSibling=$scope.$$prevSibling=$scope.$$childHead=$scope.$$childTail=$scope.$root=$scope.$$watchers=null}function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function incrementWatchersCount(current,count){do current.$$watchersCount+=count;while(current=current.$parent)}function decrementListenerCount(current,count,name){do current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name];while(current=current.$parent)}function initWatchVal(){}function flushApplyAsync(){for(;applyAsyncQueue.length;)try{applyAsyncQueue.shift()()}catch(e){$exceptionHandler(e)}applyAsyncId=null}function scheduleApplyAsync(){null===applyAsyncId&&(applyAsyncId=$browser.defer(function(){$rootScope.$apply(flushApplyAsync)}))}Scope.prototype={constructor:Scope,$new:function(isolate,parent){var child;return parent=parent||this,isolate?(child=new Scope,child.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=createChildScopeClass(this)),child=new this.$$ChildScope),child.$parent=parent,child.$$prevSibling=parent.$$childTail,parent.$$childHead?(parent.$$childTail.$$nextSibling=child,parent.$$childTail=child):parent.$$childHead=parent.$$childTail=child,(isolate||parent!=this)&&child.$on("$destroy",destroyChildScope),child},$watch:function(watchExp,listener,objectEquality,prettyPrintExpression){var get=$parse(watchExp);if(get.$$watchDelegate)return get.$$watchDelegate(this,listener,objectEquality,get,watchExp);var scope=this,array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:prettyPrintExpression||watchExp,eq:!!objectEquality};return lastDirtyWatch=null,isFunction(listener)||(watcher.fn=noop),array||(array=scope.$$watchers=[]),array.unshift(watcher),incrementWatchersCount(this,1),function(){arrayRemove(array,watcher)>=0&&incrementWatchersCount(scope,-1),lastDirtyWatch=null}},$watchGroup:function(watchExpressions,listener){function watchGroupAction(){changeReactionScheduled=!1,firstRun?(firstRun=!1,listener(newValues,newValues,self)):listener(newValues,oldValues,self)}var oldValues=new Array(watchExpressions.length),newValues=new Array(watchExpressions.length),deregisterFns=[],self=this,changeReactionScheduled=!1,firstRun=!0;if(!watchExpressions.length){var shouldCall=!0;return self.$evalAsync(function(){shouldCall&&listener(newValues,newValues,self)}),function(){shouldCall=!1}}return 1===watchExpressions.length?this.$watch(watchExpressions[0],function(value,oldValue,scope){newValues[0]=value,oldValues[0]=oldValue,listener(newValues,value===oldValue?newValues:oldValues,scope)}):(forEach(watchExpressions,function(expr,i){var unwatchFn=self.$watch(expr,function(value,oldValue){newValues[i]=value,oldValues[i]=oldValue,changeReactionScheduled||(changeReactionScheduled=!0,self.$evalAsync(watchGroupAction))});deregisterFns.push(unwatchFn)}),function(){for(;deregisterFns.length;)deregisterFns.shift()()})},$watchCollection:function(obj,listener){function $watchCollectionInterceptor(_value){newValue=_value;var newLength,key,bothNaN,newItem,oldItem;if(!isUndefined(newValue)){if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;newLength>i;i++)oldItem=oldValue[i],newItem=newValue[i],bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[i]=newItem)}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)hasOwnProperty.call(newValue,key)&&(newLength++,newItem=newValue[key],oldItem=oldValue[key],key in oldValue?(bothNaN=oldItem!==oldItem&&newItem!==newItem,bothNaN||oldItem===newItem||(changeDetected++,oldValue[key]=newItem)):(oldLength++,oldValue[key]=newItem,changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)hasOwnProperty.call(newValue,key)||(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}}function $watchCollectionAction(){if(initRun?(initRun=!1,listener(newValue,newValue,self)):listener(newValue,veryOldValue,self),trackVeryOldValue)if(isObject(newValue))if(isArrayLike(newValue)){veryOldValue=new Array(newValue.length);for(var i=0;i<newValue.length;i++)veryOldValue[i]=newValue[i]}else{veryOldValue={};for(var key in newValue)hasOwnProperty.call(newValue,key)&&(veryOldValue[key]=newValue[key])}else veryOldValue=newValue}$watchCollectionInterceptor.$stateful=!0;var newValue,oldValue,veryOldValue,self=this,trackVeryOldValue=listener.length>1,changeDetected=0,changeDetector=$parse(obj,$watchCollectionInterceptor),internalArray=[],internalObject={},initRun=!0,oldLength=0;return this.$watch(changeDetector,$watchCollectionAction)},$digest:function(){var watch,value,last,fn,get,watchers,length,dirty,next,current,logIdx,asyncTask,ttl=TTL,target=this,watchLog=[];beginPhase("$digest"),$browser.$$checkUrlChange(),this===$rootScope&&null!==applyAsyncId&&($browser.defer.cancel(applyAsyncId),flushApplyAsync()),lastDirtyWatch=null;do{for(dirty=!1,current=target;asyncQueue.length;){try{asyncTask=asyncQueue.shift(),asyncTask.scope.$eval(asyncTask.expression,asyncTask.locals)}catch(e){$exceptionHandler(e)}lastDirtyWatch=null}traverseScopesLoop:do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{if(watch=watchers[length])if(get=watch.get,(value=get(current))===(last=watch.last)||(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value,null):value,fn=watch.fn,fn(value,last===initWatchVal?value:last,current),5>ttl&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),watchLog[logIdx].push({msg:isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,newVal:value,oldVal:last}))}catch(e){$exceptionHandler(e)}if(!(next=current.$$watchersCount&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,watchLog)}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueue.length;)try{postDigestQueue.shift()()}catch(e){$exceptionHandler(e)}},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this===$rootScope&&$browser.$$applicationDestroyed(),incrementWatchersCount(this,-this.$$watchersCount);for(var eventName in this.$$listenerCount)decrementListenerCount(this,this.$$listenerCount[eventName],eventName);parent&&parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent&&parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=noop,this.$on=this.$watch=this.$watchGroup=function(){return noop},this.$$listeners={},this.$$nextSibling=null,cleanUpScope(this)}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr,locals){$rootScope.$$phase||asyncQueue.length||$browser.defer(function(){asyncQueue.length&&$rootScope.$digest()}),asyncQueue.push({scope:this,expression:$parse(expr),locals:locals})},$$postDigest:function(fn){postDigestQueue.push(fn)},$apply:function(expr){try{beginPhase("$apply");try{return this.$eval(expr)}finally{clearPhase()}}catch(e){$exceptionHandler(e)}finally{try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$applyAsync:function(expr){function $applyAsyncExpression(){scope.$eval(expr)}var scope=this;expr&&applyAsyncQueue.push($applyAsyncExpression),expr=$parse(expr),scheduleApplyAsync()},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++;while(current=current.$parent);var self=this;return function(){var indexOfListener=namedListeners.indexOf(listener);-1!==indexOfListener&&(namedListeners[indexOfListener]=null,decrementListenerCount(self,1,name))}},$emit:function(name,args){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;length>i;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)return event.currentScope=null,event;scope=scope.$parent}while(scope);return event.currentScope=null,event},$broadcast:function(name,args){var target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1};if(!target.$$listenerCount[name])return event;for(var listeners,i,length,listenerArgs=concat([event],arguments,1);current=next;){for(event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;length>i;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}return event.currentScope=null,event}};var $rootScope=new Scope,asyncQueue=$rootScope.$$asyncQueue=[],postDigestQueue=$rootScope.$$postDigestQueue=[],applyAsyncQueue=$rootScope.$$applyAsyncQueue=[];return $rootScope}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function(uri,isImage){var normalizedVal,regex=isImage?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist;return normalizedVal=urlResolve(uri).href,""===normalizedVal||normalizedVal.match(regex)?uri:"unsafe:"+normalizedVal}}}function adjustMatcher(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+matcher+"$")}if(isRegExp(matcher))return new RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(adjustMatcher(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector",function($injector){function matchUrl(matcher,parsedUrl){return"self"===matcher?urlIsSameOrigin(parsedUrl):!!matcher.exec(parsedUrl.href)}function isResourceUrlAllowedByPolicy(url){var i,n,parsedUrl=urlResolve(url.toString()),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;n>i;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;n>i;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(Base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}function trustAs(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||isUndefined(trustedValue)||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||isUndefined(maybeTrusted)||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function(html){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sceDelegate",function($parse,$sceDelegate){if(enabled&&8>msie)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=shallowCopy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:$parse(expr,function(value){return sce.getTrusted(type,value)})};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var vendorPrefix,match,eventSupport={},android=toInt((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},vendorRegex=/^(Moz|webkit|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix.substr(0,1).toUpperCase()+vendorPrefix.substr(1);break}vendorPrefix||(vendorPrefix="WebkitOpacity"in bodyStyle&&"webkit"),transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(bodyStyle.webkitTransition),animations=isString(bodyStyle.webkitAnimation))}return{history:!(!$window.history||!$window.history.pushState||4>android||boxee),hasEvent:function(event){if("input"===event&&11>=msie)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),vendorPrefix:vendorPrefix,transitions:transitions,animations:animations,android:android}}]}function $TemplateRequestProvider(){this.$get=["$templateCache","$http","$q","$sce",function($templateCache,$http,$q,$sce){function handleRequestFn(tpl,ignoreRequestError){function handleError(resp){if(!ignoreRequestError)throw $compileMinErr("tpload","Failed to load template: {0} (HTTP status: {1} {2})",tpl,resp.status,resp.statusText);return $q.reject(resp)}handleRequestFn.totalPendingRequests++,(!isString(tpl)||isUndefined($templateCache.get(tpl)))&&(tpl=$sce.getTrustedResourceUrl(tpl));var transformResponse=$http.defaults&&$http.defaults.transformResponse;isArray(transformResponse)?transformResponse=transformResponse.filter(function(transformer){return transformer!==defaultHttpResponseTransform}):transformResponse===defaultHttpResponseTransform&&(transformResponse=null);var httpOptions={cache:$templateCache,transformResponse:transformResponse};return $http.get(tpl,httpOptions)["finally"](function(){handleRequestFn.totalPendingRequests--}).then(function(response){return $templateCache.put(tpl,response.data),response.data},handleError)}return handleRequestFn.totalPendingRequests=0,handleRequestFn}]}function $$TestabilityProvider(){this.$get=["$rootScope","$browser","$location",function($rootScope,$browser,$location){var testability={};return testability.findBindings=function(element,expression,opt_exactMatch){var bindings=element.getElementsByClassName("ng-binding"),matches=[];return forEach(bindings,function(binding){var dataBinding=angular.element(binding).data("$binding");dataBinding&&forEach(dataBinding,function(bindingName){if(opt_exactMatch){var matcher=new RegExp("(^|\\s)"+escapeForRegexp(expression)+"(\\s|\\||$)");matcher.test(bindingName)&&matches.push(binding)}else-1!=bindingName.indexOf(expression)&&matches.push(binding)})}),matches},testability.findModels=function(element,expression,opt_exactMatch){for(var prefixes=["ng-","data-ng-","ng\\:"],p=0;p<prefixes.length;++p){var attributeEquals=opt_exactMatch?"=":"*=",selector="["+prefixes[p]+"model"+attributeEquals+'"'+expression+'"]',elements=element.querySelectorAll(selector);if(elements.length)return elements}},testability.getLocation=function(){return $location.url()},testability.setLocation=function(url){url!==$location.url()&&($location.url(url),$rootScope.$digest())},testability.whenStable=function(callback){$browser.notifyWhenNoOutstandingRequests(callback)},testability}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function($rootScope,$browser,$q,$$q,$exceptionHandler){function timeout(fn,delay,invokeApply){isFunction(fn)||(invokeApply=delay,delay=fn,fn=noop);var timeoutId,args=sliceArgs(arguments,3),skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn.apply(null,args))}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId]}skipApply||$rootScope.$apply()},delay),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}var deferreds={};return timeout.cancel=function(promise){return promise&&promise.$$timeoutId in deferreds?(deferreds[promise.$$timeoutId].reject("canceled"),delete deferreds[promise.$$timeoutId],$browser.defer.cancel(promise.$$timeoutId)):!1},timeout}]}function urlResolve(url){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlIsSameOrigin(requestUrl){var parsed=isString(requestUrl)?urlResolve(requestUrl):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}function $WindowProvider(){this.$get=valueFn(window)}function $$CookieReader($document){function safeDecodeURIComponent(str){try{return decodeURIComponent(str)}catch(e){return str}}var rawDocument=$document[0]||{},lastCookies={},lastCookieString="";return function(){var cookieArray,cookie,i,index,name,currentCookieString=rawDocument.cookie||"";if(currentCookieString!==lastCookieString)for(lastCookieString=currentCookieString,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)cookie=cookieArray[i],index=cookie.indexOf("="),index>0&&(name=safeDecodeURIComponent(cookie.substring(0,index)),isUndefined(lastCookies[name])&&(lastCookies[name]=safeDecodeURIComponent(cookie.substring(index+1))));return lastCookies}}function $$CookieReaderProvider(){this.$get=$$CookieReader}function $FilterProvider($provide){function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator){if(!isArrayLike(array)){if(null==array)return array;throw minErr("filter")("notarray","Expected array but received: {0}",array)}var predicateFn,matchAgainstAnyProp,expressionType=getTypeForFilter(expression);switch(expressionType){case"function":predicateFn=expression;break;case"boolean":case"null":case"number":case"string":matchAgainstAnyProp=!0;case"object":predicateFn=createPredicateFn(expression,comparator,matchAgainstAnyProp);break;default:return array}return Array.prototype.filter.call(array,predicateFn)}}function createPredicateFn(expression,comparator,matchAgainstAnyProp){var predicateFn,shouldMatchPrimitives=isObject(expression)&&"$"in expression;return comparator===!0?comparator=equals:isFunction(comparator)||(comparator=function(actual,expected){return isUndefined(actual)?!1:null===actual||null===expected?actual===expected:isObject(expected)||isObject(actual)&&!hasCustomToString(actual)?!1:(actual=lowercase(""+actual),expected=lowercase(""+expected),-1!==actual.indexOf(expected))}),predicateFn=function(item){return shouldMatchPrimitives&&!isObject(item)?deepCompare(item,expression.$,comparator,!1):deepCompare(item,expression,comparator,matchAgainstAnyProp)}}function deepCompare(actual,expected,comparator,matchAgainstAnyProp,dontMatchWholeObject){var actualType=getTypeForFilter(actual),expectedType=getTypeForFilter(expected);if("string"===expectedType&&"!"===expected.charAt(0))return!deepCompare(actual,expected.substring(1),comparator,matchAgainstAnyProp);if(isArray(actual))return actual.some(function(item){return deepCompare(item,expected,comparator,matchAgainstAnyProp)});switch(actualType){case"object":var key;if(matchAgainstAnyProp){for(key in actual)if("$"!==key.charAt(0)&&deepCompare(actual[key],expected,comparator,!0))return!0;return dontMatchWholeObject?!1:deepCompare(actual,expected,comparator,!1)}if("object"===expectedType){for(key in expected){var expectedVal=expected[key];if(!isFunction(expectedVal)&&!isUndefined(expectedVal)){var matchAnyProperty="$"===key,actualVal=matchAnyProperty?actual:actual[key];if(!deepCompare(actualVal,expectedVal,comparator,matchAnyProperty,matchAnyProperty))return!1}}return!0}return comparator(actual,expected);case"function":return!1;default:return comparator(actual,expected)}}function getTypeForFilter(val){return null===val?"null":typeof val}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol,fractionSize){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),isUndefined(fractionSize)&&(fractionSize=formats.PATTERNS[1].maxFrac),null==amount?amount:formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return null==number?number:formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function parse(numStr){var digits,numberOfIntegerDigits,i,j,zeros,exponent=0;for((numberOfIntegerDigits=numStr.indexOf(DECIMAL_SEP))>-1&&(numStr=numStr.replace(DECIMAL_SEP,"")),(i=numStr.search(/e/i))>0?(0>numberOfIntegerDigits&&(numberOfIntegerDigits=i),numberOfIntegerDigits+=+numStr.slice(i+1),numStr=numStr.substring(0,i)):0>numberOfIntegerDigits&&(numberOfIntegerDigits=numStr.length),i=0;numStr.charAt(i)==ZERO_CHAR;i++);if(i==(zeros=numStr.length))digits=[0],numberOfIntegerDigits=1;else{for(zeros--;numStr.charAt(zeros)==ZERO_CHAR;)zeros--;for(numberOfIntegerDigits-=i,digits=[],j=0;zeros>=i;i++,j++)digits[j]=+numStr.charAt(i)}return numberOfIntegerDigits>MAX_DIGITS&&(digits=digits.splice(0,MAX_DIGITS-1),exponent=numberOfIntegerDigits-1,numberOfIntegerDigits=1),{d:digits,e:exponent,i:numberOfIntegerDigits}}function roundNumber(parsedNumber,fractionSize,minFrac,maxFrac){var digits=parsedNumber.d,fractionLen=digits.length-parsedNumber.i;fractionSize=isUndefined(fractionSize)?Math.min(Math.max(minFrac,fractionLen),maxFrac):+fractionSize;var roundAt=fractionSize+parsedNumber.i,digit=digits[roundAt];if(roundAt>0)digits.splice(roundAt);else{parsedNumber.i=1,digits.length=roundAt=fractionSize+1;for(var i=0;roundAt>i;i++)digits[i]=0}for(digit>=5&&digits[roundAt-1]++;fractionSize>fractionLen;fractionLen++)digits.push(0);var carry=digits.reduceRight(function(carry,d,i,digits){return d+=carry,digits[i]=d%10,Math.floor(d/10)},0);carry&&(digits.unshift(carry),parsedNumber.i++)}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(!isString(number)&&!isNumber(number)||isNaN(number))return"";var parsedNumber,isInfinity=!isFinite(number),isZero=!1,numStr=Math.abs(number)+"",formattedText="";if(isInfinity)formattedText="∞";else{parsedNumber=parse(numStr),roundNumber(parsedNumber,fractionSize,pattern.minFrac,pattern.maxFrac);var digits=parsedNumber.d,integerLen=parsedNumber.i,exponent=parsedNumber.e,decimals=[];for(isZero=digits.reduce(function(isZero,d){return isZero&&!d},!0);0>integerLen;)digits.unshift(0),integerLen++;integerLen>0?decimals=digits.splice(integerLen,digits.length):(decimals=digits,digits=[0]);var groups=[];for(digits.length>=pattern.lgSize&&groups.unshift(digits.splice(-pattern.lgSize,digits.length).join(""));digits.length>pattern.gSize;)groups.unshift(digits.splice(-pattern.gSize,digits.length).join(""));digits.length&&groups.unshift(digits.join("")),formattedText=groups.join(groupSep),decimals.length&&(formattedText+=decimalSep+decimals.join("")),exponent&&(formattedText+="e+"+exponent)}return 0>number&&!isZero?pattern.negPre+formattedText+pattern.negSuf:pattern.posPre+formattedText+pattern.posSuf}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num=ZERO_CHAR+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12==offset&&(value=12),padNumber(value,size,trim)}}function dateStrGetter(name,shortForm){return function(date,formats){var value=date["get"+name](),get=uppercase(shortForm?"SHORT"+name:name);return formats[get][value]}}function timeZoneGetter(date,formats,offset){var zone=-1*offset,paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function getFirstThursdayOfYear(year){var dayOfWeekOnFirst=new Date(year,0,1).getDay();return new Date(year,0,(4>=dayOfWeekOnFirst?5:12)-dayOfWeekOnFirst)}function getThursdayThisWeek(datetime){return new Date(datetime.getFullYear(),datetime.getMonth(),datetime.getDate()+(4-datetime.getDay()));
}function weekGetter(size){return function(date){var firstThurs=getFirstThursdayOfYear(date.getFullYear()),thisThurs=getThursdayThisWeek(date),diff=+thisThurs-+firstThurs,result=1+Math.round(diff/6048e5);return padNumber(result,size)}}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function eraGetter(date,formats){return date.getFullYear()<=0?formats.ERAS[0]:formats.ERAS[1]}function longEraGetter(date,formats){return date.getFullYear()<=0?formats.ERANAMES[0]:formats.ERANAMES[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=toInt(match[9]+match[10]),tzMin=toInt(match[9]+match[11])),dateSetter.call(date,toInt(match[1]),toInt(match[2])-1,toInt(match[3]));var h=toInt(match[4]||0)-tzHour,m=toInt(match[5]||0)-tzMin,s=toInt(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format,timezone){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?toInt(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date)||!isFinite(date.getTime()))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);var dateTimezoneOffset=date.getTimezoneOffset();return timezone&&(dateTimezoneOffset=timezoneToOffset(timezone,dateTimezoneOffset),date=convertTimezoneToLocal(date,timezone,!0)),forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS,dateTimezoneOffset):"''"===value?"'":value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object,spacing){return isUndefined(spacing)&&(spacing=2),toJson(object,spacing)}}function limitToFilter(){return function(input,limit,begin){return limit=Math.abs(Number(limit))===1/0?Number(limit):toInt(limit),isNaN(limit)?input:(isNumber(input)&&(input=input.toString()),isArray(input)||isString(input)?(begin=!begin||isNaN(begin)?0:toInt(begin),begin=0>begin?Math.max(0,input.length+begin):begin,limit>=0?input.slice(begin,begin+limit):0===begin?input.slice(limit,input.length):input.slice(Math.max(0,begin+limit),begin)):input)}}function orderByFilter($parse){function processPredicates(sortPredicate,reverseOrder){return reverseOrder=reverseOrder?-1:1,sortPredicate.map(function(predicate){var descending=1,get=identity;if(isFunction(predicate))get=predicate;else if(isString(predicate)&&(("+"==predicate.charAt(0)||"-"==predicate.charAt(0))&&(descending="-"==predicate.charAt(0)?-1:1,predicate=predicate.substring(1)),""!==predicate&&(get=$parse(predicate),get.constant))){var key=get();get=function(value){return value[key]}}return{get:get,descending:descending*reverseOrder}})}function isPrimitive(value){switch(typeof value){case"number":case"boolean":case"string":return!0;default:return!1}}function objectValue(value,index){return"function"==typeof value.valueOf&&(value=value.valueOf(),isPrimitive(value))?value:hasCustomToString(value)&&(value=value.toString(),isPrimitive(value))?value:index}function getPredicateValue(value,index){var type=typeof value;return null===value?(type="string",value="null"):"string"===type?value=value.toLowerCase():"object"===type&&(value=objectValue(value,index)),{value:value,type:type}}function compare(v1,v2){var result=0;return v1.type===v2.type?v1.value!==v2.value&&(result=v1.value<v2.value?-1:1):result=v1.type<v2.type?-1:1,result}return function(array,sortPredicate,reverseOrder){function getComparisonObject(value,index){return{value:value,predicateValues:predicates.map(function(predicate){return getPredicateValue(predicate.get(value),index)})}}function doComparison(v1,v2){for(var result=0,index=0,length=predicates.length;length>index&&!(result=compare(v1.predicateValues[index],v2.predicateValues[index])*predicates[index].descending);++index);return result}if(!isArrayLike(array))return array;isArray(sortPredicate)||(sortPredicate=[sortPredicate]),0===sortPredicate.length&&(sortPredicate=["+"]);var predicates=processPredicates(sortPredicate,reverseOrder);predicates.push({get:function(){return{}},descending:reverseOrder?-1:1});var compareValues=Array.prototype.map.call(array,getComparisonObject);return compareValues.sort(doComparison),array=compareValues.map(function(item){return item.value})}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function nullFormRenameControl(control,name){control.$name=name}function FormController(element,attrs,$scope,$animate,$interpolate){var form=this,controls=[];form.$error={},form.$$success={},form.$pending=undefined,form.$name=$interpolate(attrs.name||attrs.ngForm||"")($scope),form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,form.$submitted=!1,form.$$parentForm=nullFormCtrl,form.$rollbackViewValue=function(){forEach(controls,function(control){control.$rollbackViewValue()})},form.$commitViewValue=function(){forEach(controls,function(control){control.$commitViewValue()})},form.$addControl=function(control){assertNotHasOwnProperty(control.$name,"input"),controls.push(control),control.$name&&(form[control.$name]=control),control.$$parentForm=form},form.$$renameControl=function(control,newName){var oldName=control.$name;form[oldName]===control&&delete form[oldName],form[newName]=control,control.$name=newName},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(form.$pending,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$error,function(value,name){form.$setValidity(name,null,control)}),forEach(form.$$success,function(value,name){form.$setValidity(name,null,control)}),arrayRemove(controls,control),control.$$parentForm=nullFormCtrl},addSetValidityMethod({ctrl:this,$element:element,set:function(object,property,controller){var list=object[property];if(list){var index=list.indexOf(controller);-1===index&&list.push(controller)}else object[property]=[controller]},unset:function(object,property,controller){var list=object[property];list&&(arrayRemove(list,controller),0===list.length&&delete object[property])},$animate:$animate}),form.$setDirty=function(){$animate.removeClass(element,PRISTINE_CLASS),$animate.addClass(element,DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,form.$$parentForm.$setDirty()},form.$setPristine=function(){$animate.setClass(element,PRISTINE_CLASS,DIRTY_CLASS+" "+SUBMITTED_CLASS),form.$dirty=!1,form.$pristine=!0,form.$submitted=!1,forEach(controls,function(control){control.$setPristine()})},form.$setUntouched=function(){forEach(controls,function(control){control.$setUntouched()})},form.$setSubmitted=function(){$animate.addClass(element,SUBMITTED_CLASS),form.$submitted=!0,form.$$parentForm.$setSubmitted()}}function stringBasedInputType(ctrl){ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?value:value.toString()})}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl)}function baseInputType(scope,element,attr,ctrl,$sniffer,$browser){var type=lowercase(element[0].type);if(!$sniffer.android){var composing=!1;element.on("compositionstart",function(data){composing=!0}),element.on("compositionend",function(){composing=!1,listener()})}var timeout,listener=function(ev){if(timeout&&($browser.defer.cancel(timeout),timeout=null),!composing){var value=element.val(),event=ev&&ev.type;"password"===type||attr.ngTrim&&"false"===attr.ngTrim||(value=trim(value)),(ctrl.$viewValue!==value||""===value&&ctrl.$$hasNativeValidators)&&ctrl.$setViewValue(value,event)}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var deferListener=function(ev,input,origValue){timeout||(timeout=$browser.defer(function(){timeout=null,input&&input.value===origValue||listener(ev)}))};element.on("keydown",function(event){var key=event.keyCode;91===key||key>15&&19>key||key>=37&&40>=key||deferListener(event,this,this.value)}),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}element.on("change",listener),PARTIAL_VALIDATION_TYPES[type]&&ctrl.$$hasNativeValidators&&type===attr.type&&element.on(PARTIAL_VALIDATION_EVENTS,function(ev){if(!timeout){var validity=this[VALIDITY_STATE_PROPERTY],origBadInput=validity.badInput,origTypeMismatch=validity.typeMismatch;timeout=$browser.defer(function(){timeout=null,(validity.badInput!==origBadInput||validity.typeMismatch!==origTypeMismatch)&&listener(ev)})}}),ctrl.$render=function(){var value=ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue;element.val()!==value&&element.val(value)}}function weekParser(isoWeek,existingDate){if(isDate(isoWeek))return isoWeek;if(isString(isoWeek)){WEEK_REGEXP.lastIndex=0;var parts=WEEK_REGEXP.exec(isoWeek);if(parts){var year=+parts[1],week=+parts[2],hours=0,minutes=0,seconds=0,milliseconds=0,firstThurs=getFirstThursdayOfYear(year),addDays=7*(week-1);return existingDate&&(hours=existingDate.getHours(),minutes=existingDate.getMinutes(),seconds=existingDate.getSeconds(),milliseconds=existingDate.getMilliseconds()),new Date(year,0,firstThurs.getDate()+addDays,hours,minutes,seconds,milliseconds)}}return NaN}function createDateParser(regexp,mapping){return function(iso,date){var parts,map;if(isDate(iso))return iso;if(isString(iso)){if('"'==iso.charAt(0)&&'"'==iso.charAt(iso.length-1)&&(iso=iso.substring(1,iso.length-1)),ISO_DATE_REGEXP.test(iso))return new Date(iso);if(regexp.lastIndex=0,parts=regexp.exec(iso))return parts.shift(),map=date?{yyyy:date.getFullYear(),MM:date.getMonth()+1,dd:date.getDate(),HH:date.getHours(),mm:date.getMinutes(),ss:date.getSeconds(),sss:date.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},forEach(parts,function(part,index){index<mapping.length&&(map[mapping[index]]=+part)}),new Date(map.yyyy,map.MM-1,map.dd,map.HH,map.mm,map.ss||0,1e3*map.sss||0)}return NaN}}function createDateInputType(type,regexp,parseDate,format){return function(scope,element,attr,ctrl,$sniffer,$browser,$filter){function isValidDate(value){return value&&!(value.getTime&&value.getTime()!==value.getTime())}function parseObservedDateValue(val){return isDefined(val)&&!isDate(val)?parseDate(val)||undefined:val}badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser);var previousDate,timezone=ctrl&&ctrl.$options&&ctrl.$options.timezone;if(ctrl.$$parserName=type,ctrl.$parsers.push(function(value){if(ctrl.$isEmpty(value))return null;if(regexp.test(value)){var parsedDate=parseDate(value,previousDate);return timezone&&(parsedDate=convertTimezoneToLocal(parsedDate,timezone)),parsedDate}return undefined}),ctrl.$formatters.push(function(value){if(value&&!isDate(value))throw ngModelMinErr("datefmt","Expected `{0}` to be a date",value);return isValidDate(value)?(previousDate=value,previousDate&&timezone&&(previousDate=convertTimezoneToLocal(previousDate,timezone,!0)),$filter("date")(value,format,timezone)):(previousDate=null,"")}),isDefined(attr.min)||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return!isValidDate(value)||isUndefined(minVal)||parseDate(value)>=minVal},attr.$observe("min",function(val){minVal=parseObservedDateValue(val),ctrl.$validate()})}if(isDefined(attr.max)||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return!isValidDate(value)||isUndefined(maxVal)||parseDate(value)<=maxVal},attr.$observe("max",function(val){maxVal=parseObservedDateValue(val),ctrl.$validate()})}}}function badInputChecker(scope,element,attr,ctrl){var node=element[0],nativeValidation=ctrl.$$hasNativeValidators=isObject(node.validity);nativeValidation&&ctrl.$parsers.push(function(value){var validity=element.prop(VALIDITY_STATE_PROPERTY)||{};return validity.badInput&&!validity.typeMismatch?undefined:value})}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(badInputChecker(scope,element,attr,ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$$parserName="number",ctrl.$parsers.push(function(value){return ctrl.$isEmpty(value)?null:NUMBER_REGEXP.test(value)?parseFloat(value):undefined}),ctrl.$formatters.push(function(value){if(!ctrl.$isEmpty(value)){if(!isNumber(value))throw ngModelMinErr("numfmt","Expected `{0}` to be a number",value);value=value.toString()}return value}),isDefined(attr.min)||attr.ngMin){var minVal;ctrl.$validators.min=function(value){return ctrl.$isEmpty(value)||isUndefined(minVal)||value>=minVal},attr.$observe("min",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val,10)),minVal=isNumber(val)&&!isNaN(val)?val:undefined,ctrl.$validate()})}if(isDefined(attr.max)||attr.ngMax){var maxVal;ctrl.$validators.max=function(value){return ctrl.$isEmpty(value)||isUndefined(maxVal)||maxVal>=value},attr.$observe("max",function(val){isDefined(val)&&!isNumber(val)&&(val=parseFloat(val,10)),maxVal=isNumber(val)&&!isNaN(val)?val:undefined,ctrl.$validate()})}}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="url",ctrl.$validators.url=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||URL_REGEXP.test(value)}}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$$parserName="email",ctrl.$validators.email=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value)}}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid());var listener=function(ev){element[0].checked&&ctrl.$setViewValue(attr.value,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function parseConstantExpr($parse,context,name,expression,fallback){var parseFn;if(isDefined(expression)){if(parseFn=$parse(expression),!parseFn.constant)throw ngModelMinErr("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",name,expression);return parseFn(context)}return fallback}function checkboxInputType(scope,element,attr,ctrl,$sniffer,$browser,$filter,$parse){var trueValue=parseConstantExpr($parse,scope,"ngTrueValue",attr.ngTrueValue,!0),falseValue=parseConstantExpr($parse,scope,"ngFalseValue",attr.ngFalseValue,!1),listener=function(ev){ctrl.$setViewValue(element[0].checked,ev&&ev.type)};element.on("click",listener),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return value===!1},ctrl.$formatters.push(function(value){return equals(value,trueValue)}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,["$animate",function($animate){function arrayDifference(tokens1,tokens2){var values=[];outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values.push(token)}return values}function arrayClasses(classVal){var classes=[];return isArray(classVal)?(forEach(classVal,function(v){classes=classes.concat(arrayClasses(v))}),classes):isString(classVal)?classVal.split(" "):isObject(classVal)?(forEach(classVal,function(v,k){v&&(classes=classes.concat(k.split(" ")))}),classes):classVal}return{restrict:"AC",link:function(scope,element,attr){function addClasses(classes){var newClasses=digestClassCounts(classes,1);attr.$addClass(newClasses)}function removeClasses(classes){var newClasses=digestClassCounts(classes,-1);attr.$removeClass(newClasses)}function digestClassCounts(classes,count){var classCounts=element.data("$classCounts")||createMap(),classesToUpdate=[];return forEach(classes,function(className){(count>0||classCounts[className])&&(classCounts[className]=(classCounts[className]||0)+count,classCounts[className]===+(count>0)&&classesToUpdate.push(className))}),element.data("$classCounts",classCounts),classesToUpdate.join(" ")}function updateClasses(oldClasses,newClasses){var toAdd=arrayDifference(newClasses,oldClasses),toRemove=arrayDifference(oldClasses,newClasses);toAdd=digestClassCounts(toAdd,1),toRemove=digestClassCounts(toRemove,-1),toAdd&&toAdd.length&&$animate.addClass(element,toAdd),toRemove&&toRemove.length&&$animate.removeClass(element,toRemove)}function ngClassWatchAction(newVal){if(selector===!0||scope.$index%2===selector){var newClasses=arrayClasses(newVal||[]);if(oldVal){if(!equals(newVal,oldVal)){var oldClasses=arrayClasses(oldVal);updateClasses(oldClasses,newClasses)}}else addClasses(newClasses)}oldVal=isArray(newVal)?newVal.map(function(v){return shallowCopy(v)}):shallowCopy(newVal)}var oldVal;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(value){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;if(mod!==(1&old$index)){var classes=arrayClasses(scope.$eval(attr[name]));mod===selector?addClasses(classes):removeClasses(classes)}})}}}]}function addSetValidityMethod(context){function setValidity(validationErrorKey,state,controller){isUndefined(state)?createAndSet("$pending",validationErrorKey,controller):unsetAndCleanup("$pending",validationErrorKey,controller),isBoolean(state)?state?(unset(ctrl.$error,validationErrorKey,controller),set(ctrl.$$success,validationErrorKey,controller)):(set(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)):(unset(ctrl.$error,validationErrorKey,controller),unset(ctrl.$$success,validationErrorKey,controller)),ctrl.$pending?(cachedToggleClass(PENDING_CLASS,!0),ctrl.$valid=ctrl.$invalid=undefined,toggleValidationCss("",null)):(cachedToggleClass(PENDING_CLASS,!1),ctrl.$valid=isObjectEmpty(ctrl.$error),ctrl.$invalid=!ctrl.$valid,toggleValidationCss("",ctrl.$valid));var combinedState;combinedState=ctrl.$pending&&ctrl.$pending[validationErrorKey]?undefined:ctrl.$error[validationErrorKey]?!1:ctrl.$$success[validationErrorKey]?!0:null,toggleValidationCss(validationErrorKey,combinedState),ctrl.$$parentForm.$setValidity(validationErrorKey,combinedState,ctrl)}function createAndSet(name,value,controller){ctrl[name]||(ctrl[name]={}),set(ctrl[name],value,controller)}function unsetAndCleanup(name,value,controller){ctrl[name]&&unset(ctrl[name],value,controller),isObjectEmpty(ctrl[name])&&(ctrl[name]=undefined)}function cachedToggleClass(className,switchValue){switchValue&&!classCache[className]?($animate.addClass($element,className),classCache[className]=!0):!switchValue&&classCache[className]&&($animate.removeClass($element,className),classCache[className]=!1)}function toggleValidationCss(validationErrorKey,isValid){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",cachedToggleClass(VALID_CLASS+validationErrorKey,isValid===!0),cachedToggleClass(INVALID_CLASS+validationErrorKey,isValid===!1)}var ctrl=context.ctrl,$element=context.$element,classCache={},set=context.set,unset=context.unset,$animate=context.$animate;classCache[INVALID_CLASS]=!(classCache[VALID_CLASS]=$element.hasClass(VALID_CLASS)),ctrl.$setValidity=setValidity}function isObjectEmpty(obj){if(obj)for(var prop in obj)if(obj.hasOwnProperty(prop))return!1;return!0}function chromeHack(optionElement){optionElement[0].hasAttribute("selected")&&(optionElement[0].selected=!0)}var REGEX_STRING_REGEXP=/^\/(.+)\/([a-z]*)$/,VALIDITY_STATE_PROPERTY="validity",lowercase=function(string){return isString(string)?string.toLowerCase():string},hasOwnProperty=Object.prototype.hasOwnProperty,uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(-33&ch.charCodeAt(0))}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var msie,jqLite,jQuery,angularModule,slice=[].slice,splice=[].splice,push=[].push,toString=Object.prototype.toString,getPrototypeOf=Object.getPrototypeOf,ngMinErr=minErr("ng"),angular=window.angular||(window.angular={}),uid=0;msie=document.documentMode,noop.$inject=[],identity.$inject=[];var skipDestroyOnNextJQueryCleanData,isArray=Array.isArray,TYPED_ARRAY_REGEXP=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array\]$/,trim=function(value){return isString(value)?value.trim():value},escapeForRegexp=function(s){return s.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},csp=function(){function noUnsafeEval(){try{return new Function(""),!1}catch(e){return!0}}if(!isDefined(csp.rules)){var ngCspElement=document.querySelector("[ng-csp]")||document.querySelector("[data-ng-csp]");if(ngCspElement){var ngCspAttribute=ngCspElement.getAttribute("ng-csp")||ngCspElement.getAttribute("data-ng-csp");csp.rules={noUnsafeEval:!ngCspAttribute||-1!==ngCspAttribute.indexOf("no-unsafe-eval"),noInlineStyle:!ngCspAttribute||-1!==ngCspAttribute.indexOf("no-inline-style")}}else csp.rules={noUnsafeEval:noUnsafeEval(),noInlineStyle:!1}}return csp.rules},jq=function(){if(isDefined(jq.name_))return jq.name_;var el,i,prefix,name,ii=ngAttrPrefixes.length;for(i=0;ii>i;++i)if(prefix=ngAttrPrefixes[i],el=document.querySelector("["+prefix.replace(":","\\:")+"jq]")){name=el.getAttribute(prefix+"jq");break}return jq.name_=name},ALL_COLONS=/:/g,ngAttrPrefixes=["ng-","data-ng-","ng:","x-ng-"],SNAKE_CASE_REGEXP=/[A-Z]/g,bindJQueryFired=!1,NODE_TYPE_ELEMENT=1,NODE_TYPE_ATTRIBUTE=2,NODE_TYPE_TEXT=3,NODE_TYPE_COMMENT=8,NODE_TYPE_DOCUMENT=9,NODE_TYPE_DOCUMENT_FRAGMENT=11,version={full:"1.4.12",major:1,minor:4,dot:12,codeName:"cultural-conservation"};JQLite.expando="ng339";var jqCache=JQLite.cache={},jqId=1,addEventListenerFn=function(element,type,fn){element.addEventListener(type,fn,!1)},removeEventListenerFn=function(element,type,fn){element.removeEventListener(type,fn,!1)};JQLite._data=function(node){return this.cache[node[this.expando]]||{}};var SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,MOUSE_EVENT_MAP={mouseleave:"mouseout",mouseenter:"mouseover"},jqLiteMinErr=minErr("jqLite"),SINGLE_TAG_REGEXP=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,HTML_REGEXP=/<|&#?\w+;/,TAG_NAME_REGEXP=/<([\w:-]+)/,XHTML_TAG_REGEXP=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,wrapMap={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var jqLiteContains=Node.prototype.contains||function(arg){return!!(16&this.compareDocumentPosition(arg))},JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===document.readyState?setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return jqLite(index>=0?this[index]:this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[value]=!0});var ALIASED_ATTR={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};forEach({data:jqLiteData,removeData:jqLiteRemoveData,hasData:jqLiteHasData},function(fn,name){JQLite[name]=fn}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite.data(element,"$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite.data(element,"$isolateScope")||jqLite.data(element,"$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){return name=camelCase(name),isDefined(value)?void(element.style[name]=value):element.style[name]},attr:function(element,name,value){var nodeType=element.nodeType;if(nodeType!==NODE_TYPE_TEXT&&nodeType!==NODE_TYPE_ATTRIBUTE&&nodeType!==NODE_TYPE_COMMENT){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:undefined;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?undefined:ret}}},prop:function(element,name,value){return isDefined(value)?void(element[name]=value):element[name]},text:function(){function getText(element,value){if(isUndefined(value)){var nodeType=element.nodeType;return nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_TEXT?element.textContent:""}element.textContent=value}return getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if(element.multiple&&"select"===nodeName_(element)){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){return isUndefined(value)?element.innerHTML:(jqLiteDealoc(element,!0),void(element.innerHTML=value))},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key,nodeCount=this.length;if(fn!==jqLiteEmpty&&isUndefined(2==fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)){if(isObject(arg1)){for(i=0;nodeCount>i;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=isUndefined(value)?Math.min(nodeCount,1):nodeCount,j=0;jj>j;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;nodeCount>i;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,on:function(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(jqLiteAcceptsData(element)){var expandoStore=jqLiteExpandoStore(element,!0),events=expandoStore.events,handle=expandoStore.handle;handle||(handle=expandoStore.handle=createEventHandler(element,events));for(var types=type.indexOf(" ")>=0?type.split(" "):[type],i=types.length,addHandler=function(type,specialHandlerWrapper,noEventListener){var eventFns=events[type];eventFns||(eventFns=events[type]=[],eventFns.specialHandlerWrapper=specialHandlerWrapper,"$destroy"===type||noEventListener||addEventListenerFn(element,type,handle)),eventFns.push(fn)};i--;)type=types[i],MOUSE_EVENT_MAP[type]?(addHandler(MOUSE_EVENT_MAP[type],specialMouseHandlerWrapper),addHandler(type,undefined,!0)):addHandler(type)}},off:jqLiteOff,one:function(element,type,fn){element=jqLite(element),element.on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){element.nodeType===NODE_TYPE_ELEMENT&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){var nodeType=element.nodeType;if(nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_DOCUMENT_FRAGMENT){node=new JQLite(node);for(var i=0,ii=node.length;ii>i;i++){var child=node[i];element.appendChild(child)}}},prepend:function(element,node){if(element.nodeType===NODE_TYPE_ELEMENT){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){jqLiteWrapNode(element,jqLite(wrapNode).eq(0).clone()[0])},remove:jqLiteRemove,detach:function(element){jqLiteRemove(element,!0)},after:function(element,newElement){var index=element,parent=element.parentNode;newElement=new JQLite(newElement);for(var i=0,ii=newElement.length;ii>i;i++){var node=newElement[i];parent.insertBefore(node,index.nextSibling),index=node}},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&parent.nodeType!==NODE_TYPE_DOCUMENT_FRAGMENT?parent:null},next:function(element){return element.nextElementSibling},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,event,extraParameters){var dummyEvent,eventFnsCopy,handlerArgs,eventName=event.type||event,expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,eventFns=events&&events[eventName];eventFns&&(dummyEvent={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return this.immediatePropagationStopped===!0},stopPropagation:noop,type:eventName,target:element},event.type&&(dummyEvent=extend(dummyEvent,event)),eventFnsCopy=shallowCopy(eventFns),handlerArgs=extraParameters?[dummyEvent].concat(extraParameters):[dummyEvent],forEach(eventFnsCopy,function(fn){dummyEvent.isImmediatePropagationStopped()||fn.apply(element,handlerArgs)}))}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0,ii=this.length;ii>i;i++)isUndefined(value)?(value=fn(this[i],arg1,arg2,arg3),isDefined(value)&&(value=jqLite(value))):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key,this.nextUid)]=value},get:function(key){return this[hashKey(key,this.nextUid)]},remove:function(key){var value=this[key=hashKey(key,this.nextUid)];return delete this[key],value}};var $$HashMapProvider=[function(){this.$get=[function(){return HashMap}]}],FN_ARGS=/^[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector");createInjector.$$annotate=annotate;var $animateMinErr=minErr("$animate"),ELEMENT_NODE=1,NG_ANIMATE_CLASSNAME="ng-animate",$$CoreAnimateJsProvider=function(){
this.$get=function(){}},$$CoreAnimateQueueProvider=function(){var postDigestQueue=new HashMap,postDigestElements=[];this.$get=["$$AnimateRunner","$rootScope",function($$AnimateRunner,$rootScope){function updateData(data,classes,value){var changed=!1;return classes&&(classes=isString(classes)?classes.split(" "):isArray(classes)?classes:[],forEach(classes,function(className){className&&(changed=!0,data[className]=value)})),changed}function handleCSSClassChanges(){forEach(postDigestElements,function(element){var data=postDigestQueue.get(element);if(data){var existing=splitClasses(element.attr("class")),toAdd="",toRemove="";forEach(data,function(status,className){var hasClass=!!existing[className];status!==hasClass&&(status?toAdd+=(toAdd.length?" ":"")+className:toRemove+=(toRemove.length?" ":"")+className)}),forEach(element,function(elm){toAdd&&jqLiteAddClass(elm,toAdd),toRemove&&jqLiteRemoveClass(elm,toRemove)}),postDigestQueue.remove(element)}}),postDigestElements.length=0}function addRemoveClassesPostDigest(element,add,remove){var data=postDigestQueue.get(element)||{},classesAdded=updateData(data,add,!0),classesRemoved=updateData(data,remove,!1);(classesAdded||classesRemoved)&&(postDigestQueue.put(element,data),postDigestElements.push(element),1===postDigestElements.length&&$rootScope.$$postDigest(handleCSSClassChanges))}return{enabled:noop,on:noop,off:noop,pin:noop,push:function(element,event,options,domOperation){domOperation&&domOperation(),options=options||{},options.from&&element.css(options.from),options.to&&element.css(options.to),(options.addClass||options.removeClass)&&addRemoveClassesPostDigest(element,options.addClass,options.removeClass);var runner=new $$AnimateRunner;return runner.complete(),runner}}}]},$AnimateProvider=["$provide",function($provide){var provider=this;this.$$registeredAnimations=Object.create(null),this.register=function(name,factory){if(name&&"."!==name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);var key=name+"-animation";provider.$$registeredAnimations[name.substr(1)]=key,$provide.factory(key,factory)},this.classNameFilter=function(expression){if(1===arguments.length&&(this.$$classNameFilter=expression instanceof RegExp?expression:null,this.$$classNameFilter)){var reservedRegex=new RegExp("(\\s+|\\/)"+NG_ANIMATE_CLASSNAME+"(\\s+|\\/)");if(reservedRegex.test(this.$$classNameFilter.toString()))throw $animateMinErr("nongcls",'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.',NG_ANIMATE_CLASSNAME)}return this.$$classNameFilter},this.$get=["$$animateQueue",function($$animateQueue){function domInsert(element,parentElement,afterElement){if(afterElement){var afterNode=extractElementNode(afterElement);!afterNode||afterNode.parentNode||afterNode.previousElementSibling||(afterElement=null)}afterElement?afterElement.after(element):parentElement.prepend(element)}return{on:$$animateQueue.on,off:$$animateQueue.off,pin:$$animateQueue.pin,enabled:$$animateQueue.enabled,cancel:function(runner){runner.end&&runner.end()},enter:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),parent=parent||after.parent(),domInsert(element,parent,after),$$animateQueue.push(element,"enter",prepareAnimateOptions(options))},move:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),parent=parent||after.parent(),domInsert(element,parent,after),$$animateQueue.push(element,"move",prepareAnimateOptions(options))},leave:function(element,options){return $$animateQueue.push(element,"leave",prepareAnimateOptions(options),function(){element.remove()})},addClass:function(element,className,options){return options=prepareAnimateOptions(options),options.addClass=mergeClasses(options.addclass,className),$$animateQueue.push(element,"addClass",options)},removeClass:function(element,className,options){return options=prepareAnimateOptions(options),options.removeClass=mergeClasses(options.removeClass,className),$$animateQueue.push(element,"removeClass",options)},setClass:function(element,add,remove,options){return options=prepareAnimateOptions(options),options.addClass=mergeClasses(options.addClass,add),options.removeClass=mergeClasses(options.removeClass,remove),$$animateQueue.push(element,"setClass",options)},animate:function(element,from,to,className,options){return options=prepareAnimateOptions(options),options.from=options.from?extend(options.from,from):from,options.to=options.to?extend(options.to,to):to,className=className||"ng-inline-animate",options.tempClasses=mergeClasses(options.tempClasses,className),$$animateQueue.push(element,"animate",options)}}}]}],$$AnimateAsyncRunFactoryProvider=function(){this.$get=["$$rAF",function($$rAF){function waitForTick(fn){waitQueue.push(fn),waitQueue.length>1||$$rAF(function(){for(var i=0;i<waitQueue.length;i++)waitQueue[i]();waitQueue=[]})}var waitQueue=[];return function(){var passed=!1;return waitForTick(function(){passed=!0}),function(callback){passed?callback():waitForTick(callback)}}}]},$$AnimateRunnerFactoryProvider=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$document","$timeout",function($q,$sniffer,$$animateAsyncRun,$document,$timeout){function AnimateRunner(host){this.setHost(host);var rafTick=$$animateAsyncRun(),timeoutTick=function(fn){$timeout(fn,0,!1)};this._doneCallbacks=[],this._tick=function(fn){var doc=$document[0];doc&&doc.hidden?timeoutTick(fn):rafTick(fn)},this._state=0}var INITIAL_STATE=0,DONE_PENDING_STATE=1,DONE_COMPLETE_STATE=2;return AnimateRunner.chain=function(chain,callback){function next(){return index===chain.length?void callback(!0):void chain[index](function(response){return response===!1?void callback(!1):(index++,void next())})}var index=0;next()},AnimateRunner.all=function(runners,callback){function onProgress(response){status=status&&response,++count===runners.length&&callback(status)}var count=0,status=!0;forEach(runners,function(runner){runner.done(onProgress)})},AnimateRunner.prototype={setHost:function(host){this.host=host||{}},done:function(fn){this._state===DONE_COMPLETE_STATE?fn():this._doneCallbacks.push(fn)},progress:noop,getPromise:function(){if(!this.promise){var self=this;this.promise=$q(function(resolve,reject){self.done(function(status){status===!1?reject():resolve()})})}return this.promise},then:function(resolveHandler,rejectHandler){return this.getPromise().then(resolveHandler,rejectHandler)},"catch":function(handler){return this.getPromise()["catch"](handler)},"finally":function(handler){return this.getPromise()["finally"](handler)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end(),this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel(),this._resolve(!1)},complete:function(response){var self=this;self._state===INITIAL_STATE&&(self._state=DONE_PENDING_STATE,self._tick(function(){self._resolve(response)}))},_resolve:function(response){this._state!==DONE_COMPLETE_STATE&&(forEach(this._doneCallbacks,function(fn){fn(response)}),this._doneCallbacks.length=0,this._state=DONE_COMPLETE_STATE)}},AnimateRunner}]},$CoreAnimateCssProvider=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function($$rAF,$q,$$AnimateRunner){return function(element,initialOptions){function run(){return $$rAF(function(){applyAnimationContents(),closed||runner.complete(),closed=!0}),runner}function applyAnimationContents(){options.addClass&&(element.addClass(options.addClass),options.addClass=null),options.removeClass&&(element.removeClass(options.removeClass),options.removeClass=null),options.to&&(element.css(options.to),options.to=null)}var options=initialOptions||{};options.$$prepared||(options=copy(options)),options.cleanupStyles&&(options.from=options.to=null),options.from&&(element.css(options.from),options.from=null);var closed,runner=new $$AnimateRunner;return{start:run,end:run}}}]},$compileMinErr=minErr("$compile");$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"];var PREFIX_REGEXP=/^((?:x|data)[\:\-_])/i,$controllerMinErr=minErr("$controller"),CNTRL_REG=/^(\S+)(\s+as\s+([\w$]+))?$/,$$ForceReflowProvider=function(){this.$get=["$document",function($document){return function(domNode){return domNode?!domNode.nodeType&&domNode instanceof jqLite&&(domNode=domNode[0]):domNode=$document[0].body,domNode.offsetWidth+1}}]},APPLICATION_JSON="application/json",CONTENT_TYPE_APPLICATION_JSON={"Content-Type":APPLICATION_JSON+";charset=utf-8"},JSON_START=/^\[|^\{(?!\{)/,JSON_ENDS={"[":/]$/,"{":/}$/},JSON_PROTECTION_PREFIX=/^\)\]\}',?\n/,$httpMinErr=minErr("$http"),$httpMinErrLegacyFn=function(method){return function(){throw $httpMinErr("legacy","The method `{0}` on the promise returned from `$http` has been disabled.",method)}},$interpolateMinErr=angular.$interpolateMinErr=minErr("$interpolate");$interpolateMinErr.throwNoconcat=function(text){throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text)},$interpolateMinErr.interr=function(text,err){return $interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString())};var PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location"),locationPrototype={$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return(match[1]||""===url)&&this.path(decodeURIComponent(match[1])),(match[2]||match[1]||""===url)&&this.search(match[3]||""),this.hash(match[5]||""),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return path=null!==path?path.toString():"","/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search)||isNumber(search))search=search.toString(),this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");search=copy(search,{}),forEach(search,function(value,key){null==value&&delete search[key]}),this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",function(hash){return null!==hash?hash.toString():""}),replace:function(){return this.$$replace=!0,this}};forEach([LocationHashbangInHtml5Url,LocationHashbangUrl,LocationHtml5Url],function(Location){Location.prototype=Object.create(locationPrototype),Location.prototype.state=function(state){if(!arguments.length)return this.$$state;if(Location!==LocationHtml5Url||!this.$$html5)throw $locationMinErr("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=isUndefined(state)?null:state,this}});var $parseMinErr=minErr("$parse"),CALL=Function.prototype.call,APPLY=Function.prototype.apply,BIND=Function.prototype.bind,OPERATORS=createMap();forEach("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(operator){OPERATORS[operator]=!0});var ESCAPE={n:"\n",f:"\f",r:"\r",t:"	",v:"\x0B","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.tokens=[];this.index<this.text.length;){var ch=this.text.charAt(this.index);if('"'===ch||"'"===ch)this.readString(ch);else if(this.isNumber(ch)||"."===ch&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(ch))this.readIdent();else if(this.is(ch,"(){}[].,;:?"))this.tokens.push({index:this.index,text:ch}),this.index++;else if(this.isWhitespace(ch))this.index++;else{var ch2=ch+this.peek(),ch3=ch2+this.peek(2),op1=OPERATORS[ch],op2=OPERATORS[ch2],op3=OPERATORS[ch3];if(op1||op2||op3){var token=op3?ch3:op2?ch2:ch;this.tokens.push({index:this.index,text:token,operator:!0}),this.index+=token.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(ch,chars){return-1!==chars.indexOf(ch)},peek:function(i){var num=i||1;return this.index+num<this.text.length?this.text.charAt(this.index+num):!1},isNumber:function(ch){return ch>="0"&&"9">=ch&&"string"==typeof ch},isWhitespace:function(ch){return" "===ch||"\r"===ch||"	"===ch||"\n"===ch||"\x0B"===ch||" "===ch},isIdent:function(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch||"_"===ch||"$"===ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."==ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"==ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:start,text:number,constant:!0,value:Number(number)})},readIdent:function(){for(var start=this.index;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(!this.isIdent(ch)&&!this.isNumber(ch))break;this.index++}this.tokens.push({index:start,text:this.text.slice(start,this.index),identifier:!0})},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep||ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,void this.tokens.push({index:start,text:rawString,constant:!0,value:string});string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var AST=function(lexer,options){this.lexer=lexer,this.options=options};AST.Program="Program",AST.ExpressionStatement="ExpressionStatement",AST.AssignmentExpression="AssignmentExpression",AST.ConditionalExpression="ConditionalExpression",AST.LogicalExpression="LogicalExpression",AST.BinaryExpression="BinaryExpression",AST.UnaryExpression="UnaryExpression",AST.CallExpression="CallExpression",AST.MemberExpression="MemberExpression",AST.Identifier="Identifier",AST.Literal="Literal",AST.ArrayExpression="ArrayExpression",AST.Property="Property",AST.ObjectExpression="ObjectExpression",AST.ThisExpression="ThisExpression",AST.NGValueParameter="NGValueParameter",AST.prototype={ast:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value},program:function(){for(var body=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&body.push(this.expressionStatement()),!this.expect(";"))return{type:AST.Program,body:body}},expressionStatement:function(){return{type:AST.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var token,left=this.expression();token=this.expect("|");)left=this.filter(left);return left},expression:function(){return this.assignment()},assignment:function(){var result=this.ternary();return this.expect("=")&&(result={type:AST.AssignmentExpression,left:result,right:this.assignment(),operator:"="}),result},ternary:function(){var alternate,consequent,test=this.logicalOR();return this.expect("?")&&(alternate=this.expression(),this.consume(":"))?(consequent=this.expression(),{type:AST.ConditionalExpression,test:test,alternate:alternate,consequent:consequent}):test},logicalOR:function(){for(var left=this.logicalAND();this.expect("||");)left={type:AST.LogicalExpression,operator:"||",left:left,right:this.logicalAND()};return left},logicalAND:function(){for(var left=this.equality();this.expect("&&");)left={type:AST.LogicalExpression,operator:"&&",left:left,right:this.equality()};return left},equality:function(){for(var token,left=this.relational();token=this.expect("==","!=","===","!==");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.relational()};return left},relational:function(){for(var token,left=this.additive();token=this.expect("<",">","<=",">=");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.additive()};return left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.multiplicative()};return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.unary()};return left},unary:function(){var token;return(token=this.expect("+","-","!"))?{type:AST.UnaryExpression,operator:token.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var primary;this.expect("(")?(primary=this.filterChain(),this.consume(")")):this.expect("[")?primary=this.arrayDeclaration():this.expect("{")?primary=this.object():this.constants.hasOwnProperty(this.peek().text)?primary=copy(this.constants[this.consume().text]):this.peek().identifier?primary=this.identifier():this.peek().constant?primary=this.constant():this.throwError("not a primary expression",this.peek());for(var next;next=this.expect("(","[",".");)"("===next.text?(primary={type:AST.CallExpression,callee:primary,arguments:this.parseArguments()},this.consume(")")):"["===next.text?(primary={type:AST.MemberExpression,object:primary,property:this.expression(),computed:!0},this.consume("]")):"."===next.text?primary={type:AST.MemberExpression,object:primary,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return primary},filter:function(baseExpression){for(var args=[baseExpression],result={type:AST.CallExpression,callee:this.identifier(),arguments:args,filter:!0};this.expect(":");)args.push(this.expression());return result},parseArguments:function(){var args=[];if(")"!==this.peekToken().text)do args.push(this.expression());while(this.expect(","));return args},identifier:function(){var token=this.consume();return token.identifier||this.throwError("is not a valid identifier",token),{type:AST.Identifier,name:token.text}},constant:function(){return{type:AST.Literal,value:this.consume().value}},arrayDeclaration:function(){var elements=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;elements.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:AST.ArrayExpression,elements:elements}},object:function(){var property,properties=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;property={type:AST.Property,kind:"init"},this.peek().constant?property.key=this.constant():this.peek().identifier?property.key=this.identifier():this.throwError("invalid key",this.peek()),this.consume(":"),property.value=this.expression(),properties.push(property)}while(this.expect(","));return this.consume("}"),{type:AST.ObjectExpression,properties:properties}},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},consume:function(e1){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);var token=this.expect(e1);return token||this.throwError("is unexpected, expecting ["+e1+"]",this.peek()),token},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){return this.peekAhead(0,e1,e2,e3,e4)},peekAhead:function(i,e1,e2,e3,e4){if(this.tokens.length>i){var token=this.tokens[i],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return token?(this.tokens.shift(),token):!1},constants:{"true":{type:AST.Literal,value:!0},"false":{type:AST.Literal,value:!1},"null":{type:AST.Literal,value:null},undefined:{type:AST.Literal,value:undefined},"this":{type:AST.ThisExpression}}},ASTCompiler.prototype={compile:function(expression,expensiveChecks){var self=this,ast=this.astBuilder.ast(expression);this.state={nextId:0,filters:{},expensiveChecks:expensiveChecks,fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},findConstantAndWatchExpressions(ast,self.$filter);var assignable,extra="";if(this.stage="assign",assignable=assignableAST(ast)){this.state.computing="assign";var result=this.nextId();this.recurse(assignable,result),this.return_(result),extra="fn.assign="+this.generateFunction("assign","s,v,l")}var toWatch=getInputs(ast.body);self.stage="inputs",forEach(toWatch,function(watch,key){var fnKey="fn"+key;self.state[fnKey]={vars:[],body:[],own:{}},self.state.computing=fnKey;var intoId=self.nextId();self.recurse(watch,intoId),self.return_(intoId),self.state.inputs.push(fnKey),watch.watchId=key}),this.state.computing="fn",this.stage="main",this.recurse(ast);var fnString='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+extra+this.watchFns()+"return fn;",fn=new Function("$filter","ensureSafeMemberName","ensureSafeObject","ensureSafeFunction","getStringValue","ensureSafeAssignContext","ifDefined","plus","text",fnString)(this.$filter,ensureSafeMemberName,ensureSafeObject,ensureSafeFunction,getStringValue,ensureSafeAssignContext,ifDefined,plusFn,expression);return this.state=this.stage=undefined,fn.literal=isLiteral(ast),fn.constant=isConstant(ast),fn},USE:"use",STRICT:"strict",watchFns:function(){var result=[],fns=this.state.inputs,self=this;return forEach(fns,function(name){result.push("var "+name+"="+self.generateFunction(name,"s"))}),fns.length&&result.push("fn.inputs=["+fns.join(",")+"];"),result.join("")},generateFunction:function(name,params){return"function("+params+"){"+this.varsPrefix(name)+this.body(name)+"};"},filterPrefix:function(){var parts=[],self=this;return forEach(this.state.filters,function(id,filter){parts.push(id+"=$filter("+self.escape(filter)+")")}),parts.length?"var "+parts.join(",")+";":""},varsPrefix:function(section){return this.state[section].vars.length?"var "+this.state[section].vars.join(",")+";":""},body:function(section){return this.state[section].body.join("")},recurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var left,right,args,expression,self=this;if(recursionFn=recursionFn||noop,!skipWatchIdCheck&&isDefined(ast.watchId))return intoId=intoId||this.nextId(),void this.if_("i",this.lazyAssign(intoId,this.computedMember("i",ast.watchId)),this.lazyRecurse(ast,intoId,nameId,recursionFn,create,!0));switch(ast.type){case AST.Program:forEach(ast.body,function(expression,pos){self.recurse(expression.expression,undefined,undefined,function(expr){right=expr}),pos!==ast.body.length-1?self.current().body.push(right,";"):self.return_(right)});break;case AST.Literal:expression=this.escape(ast.value),this.assign(intoId,expression),recursionFn(expression);break;case AST.UnaryExpression:this.recurse(ast.argument,undefined,undefined,function(expr){right=expr}),expression=ast.operator+"("+this.ifDefined(right,0)+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.BinaryExpression:this.recurse(ast.left,undefined,undefined,function(expr){left=expr}),this.recurse(ast.right,undefined,undefined,function(expr){right=expr}),expression="+"===ast.operator?this.plus(left,right):"-"===ast.operator?this.ifDefined(left,0)+ast.operator+this.ifDefined(right,0):"("+left+")"+ast.operator+"("+right+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.LogicalExpression:intoId=intoId||this.nextId(),self.recurse(ast.left,intoId),self.if_("&&"===ast.operator?intoId:self.not(intoId),self.lazyRecurse(ast.right,intoId)),recursionFn(intoId);break;case AST.ConditionalExpression:intoId=intoId||this.nextId(),self.recurse(ast.test,intoId),self.if_(intoId,self.lazyRecurse(ast.alternate,intoId),self.lazyRecurse(ast.consequent,intoId)),recursionFn(intoId);break;case AST.Identifier:intoId=intoId||this.nextId(),nameId&&(nameId.context="inputs"===self.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",ast.name)+"?l:s"),nameId.computed=!1,nameId.name=ast.name),ensureSafeMemberName(ast.name),self.if_("inputs"===self.stage||self.not(self.getHasOwnProperty("l",ast.name)),function(){self.if_("inputs"===self.stage||"s",function(){create&&1!==create&&self.if_(self.not(self.nonComputedMember("s",ast.name)),self.lazyAssign(self.nonComputedMember("s",ast.name),"{}")),self.assign(intoId,self.nonComputedMember("s",ast.name))})},intoId&&self.lazyAssign(intoId,self.nonComputedMember("l",ast.name))),(self.state.expensiveChecks||isPossiblyDangerousMemberName(ast.name))&&self.addEnsureSafeObject(intoId),recursionFn(intoId);break;case AST.MemberExpression:left=nameId&&(nameId.context=this.nextId())||this.nextId(),intoId=intoId||this.nextId(),self.recurse(ast.object,left,undefined,function(){self.if_(self.notNull(left),function(){create&&1!==create&&self.addEnsureSafeAssignContext(left),ast.computed?(right=self.nextId(),self.recurse(ast.property,right),self.getStringValue(right),self.addEnsureSafeMemberName(right),create&&1!==create&&self.if_(self.not(self.computedMember(left,right)),self.lazyAssign(self.computedMember(left,right),"{}")),expression=self.ensureSafeObject(self.computedMember(left,right)),self.assign(intoId,expression),nameId&&(nameId.computed=!0,nameId.name=right)):(ensureSafeMemberName(ast.property.name),create&&1!==create&&self.if_(self.not(self.nonComputedMember(left,ast.property.name)),self.lazyAssign(self.nonComputedMember(left,ast.property.name),"{}")),expression=self.nonComputedMember(left,ast.property.name),(self.state.expensiveChecks||isPossiblyDangerousMemberName(ast.property.name))&&(expression=self.ensureSafeObject(expression)),self.assign(intoId,expression),nameId&&(nameId.computed=!1,nameId.name=ast.property.name))},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)},!!create);break;case AST.CallExpression:intoId=intoId||this.nextId(),ast.filter?(right=self.filter(ast.callee.name),args=[],forEach(ast.arguments,function(expr){var argument=self.nextId();self.recurse(expr,argument),args.push(argument)}),expression=right+"("+args.join(",")+")",self.assign(intoId,expression),recursionFn(intoId)):(right=self.nextId(),left={},args=[],self.recurse(ast.callee,right,left,function(){self.if_(self.notNull(right),function(){self.addEnsureSafeFunction(right),forEach(ast.arguments,function(expr){self.recurse(expr,self.nextId(),undefined,function(argument){args.push(self.ensureSafeObject(argument))})}),left.name?(self.state.expensiveChecks||self.addEnsureSafeObject(left.context),expression=self.member(left.context,left.name,left.computed)+"("+args.join(",")+")"):expression=right+"("+args.join(",")+")",expression=self.ensureSafeObject(expression),self.assign(intoId,expression)},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)}));break;case AST.AssignmentExpression:if(right=this.nextId(),left={},!isAssignable(ast.left))throw $parseMinErr("lval","Trying to assign a value to a non l-value");this.recurse(ast.left,undefined,left,function(){self.if_(self.notNull(left.context),function(){self.recurse(ast.right,right),self.addEnsureSafeObject(self.member(left.context,left.name,left.computed)),self.addEnsureSafeAssignContext(left.context),expression=self.member(left.context,left.name,left.computed)+ast.operator+right,self.assign(intoId,expression),recursionFn(intoId||expression)})},1);break;case AST.ArrayExpression:args=[],forEach(ast.elements,function(expr){self.recurse(expr,self.nextId(),undefined,function(argument){args.push(argument)})}),expression="["+args.join(",")+"]",this.assign(intoId,expression),recursionFn(expression);break;case AST.ObjectExpression:args=[],forEach(ast.properties,function(property){self.recurse(property.value,self.nextId(),undefined,function(expr){args.push(self.escape(property.key.type===AST.Identifier?property.key.name:""+property.key.value)+":"+expr)})}),expression="{"+args.join(",")+"}",this.assign(intoId,expression),recursionFn(expression);break;case AST.ThisExpression:this.assign(intoId,"s"),recursionFn("s");break;case AST.NGValueParameter:this.assign(intoId,"v"),recursionFn("v")}},getHasOwnProperty:function(element,property){var key=element+"."+property,own=this.current().own;return own.hasOwnProperty(key)||(own[key]=this.nextId(!1,element+"&&("+this.escape(property)+" in "+element+")")),own[key]},assign:function(id,value){return id?(this.current().body.push(id,"=",value,";"),id):void 0},filter:function(filterName){return this.state.filters.hasOwnProperty(filterName)||(this.state.filters[filterName]=this.nextId(!0)),this.state.filters[filterName]},ifDefined:function(id,defaultValue){return"ifDefined("+id+","+this.escape(defaultValue)+")"},plus:function(left,right){return"plus("+left+","+right+")"},return_:function(id){this.current().body.push("return ",id,";")},if_:function(test,alternate,consequent){if(test===!0)alternate();else{var body=this.current().body;body.push("if(",test,"){"),alternate(),body.push("}"),consequent&&(body.push("else{"),consequent(),body.push("}"))}},not:function(expression){return"!("+expression+")"},notNull:function(expression){return expression+"!=null"},nonComputedMember:function(left,right){return left+"."+right},computedMember:function(left,right){return left+"["+right+"]"},member:function(left,right,computed){return computed?this.computedMember(left,right):this.nonComputedMember(left,right)},addEnsureSafeObject:function(item){this.current().body.push(this.ensureSafeObject(item),";")},addEnsureSafeMemberName:function(item){this.current().body.push(this.ensureSafeMemberName(item),";")},addEnsureSafeFunction:function(item){this.current().body.push(this.ensureSafeFunction(item),";")},addEnsureSafeAssignContext:function(item){this.current().body.push(this.ensureSafeAssignContext(item),";")},ensureSafeObject:function(item){return"ensureSafeObject("+item+",text)"},ensureSafeMemberName:function(item){return"ensureSafeMemberName("+item+",text)"},ensureSafeFunction:function(item){return"ensureSafeFunction("+item+",text)"},getStringValue:function(item){this.assign(item,"getStringValue("+item+",text)")},ensureSafeAssignContext:function(item){return"ensureSafeAssignContext("+item+",text)"},lazyRecurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var self=this;return function(){self.recurse(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck)}},lazyAssign:function(id,value){var self=this;return function(){self.assign(id,value)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(c){return"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)},escape:function(value){if(isString(value))return"'"+value.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(isNumber(value))return value.toString();if(value===!0)return"true";if(value===!1)return"false";if(null===value)return"null";if("undefined"==typeof value)return"undefined";throw $parseMinErr("esc","IMPOSSIBLE");
},nextId:function(skip,init){var id="v"+this.state.nextId++;return skip||this.current().vars.push(id+(init?"="+init:"")),id},current:function(){return this.state[this.state.computing]}},ASTInterpreter.prototype={compile:function(expression,expensiveChecks){var self=this,ast=this.astBuilder.ast(expression);this.expression=expression,this.expensiveChecks=expensiveChecks,findConstantAndWatchExpressions(ast,self.$filter);var assignable,assign;(assignable=assignableAST(ast))&&(assign=this.recurse(assignable));var inputs,toWatch=getInputs(ast.body);toWatch&&(inputs=[],forEach(toWatch,function(watch,key){var input=self.recurse(watch);watch.input=input,inputs.push(input),watch.watchId=key}));var expressions=[];forEach(ast.body,function(expression){expressions.push(self.recurse(expression.expression))});var fn=0===ast.body.length?function(){}:1===ast.body.length?expressions[0]:function(scope,locals){var lastValue;return forEach(expressions,function(exp){lastValue=exp(scope,locals)}),lastValue};return assign&&(fn.assign=function(scope,value,locals){return assign(scope,locals,value)}),inputs&&(fn.inputs=inputs),fn.literal=isLiteral(ast),fn.constant=isConstant(ast),fn},recurse:function(ast,context,create){var left,right,args,self=this;if(ast.input)return this.inputs(ast.input,ast.watchId);switch(ast.type){case AST.Literal:return this.value(ast.value,context);case AST.UnaryExpression:return right=this.recurse(ast.argument),this["unary"+ast.operator](right,context);case AST.BinaryExpression:return left=this.recurse(ast.left),right=this.recurse(ast.right),this["binary"+ast.operator](left,right,context);case AST.LogicalExpression:return left=this.recurse(ast.left),right=this.recurse(ast.right),this["binary"+ast.operator](left,right,context);case AST.ConditionalExpression:return this["ternary?:"](this.recurse(ast.test),this.recurse(ast.alternate),this.recurse(ast.consequent),context);case AST.Identifier:return ensureSafeMemberName(ast.name,self.expression),self.identifier(ast.name,self.expensiveChecks||isPossiblyDangerousMemberName(ast.name),context,create,self.expression);case AST.MemberExpression:return left=this.recurse(ast.object,!1,!!create),ast.computed||(ensureSafeMemberName(ast.property.name,self.expression),right=ast.property.name),ast.computed&&(right=this.recurse(ast.property)),ast.computed?this.computedMember(left,right,context,create,self.expression):this.nonComputedMember(left,right,self.expensiveChecks,context,create,self.expression);case AST.CallExpression:return args=[],forEach(ast.arguments,function(expr){args.push(self.recurse(expr))}),ast.filter&&(right=this.$filter(ast.callee.name)),ast.filter||(right=this.recurse(ast.callee,!0)),ast.filter?function(scope,locals,assign,inputs){for(var values=[],i=0;i<args.length;++i)values.push(args[i](scope,locals,assign,inputs));var value=right.apply(undefined,values,inputs);return context?{context:undefined,name:undefined,value:value}:value}:function(scope,locals,assign,inputs){var value,rhs=right(scope,locals,assign,inputs);if(null!=rhs.value){ensureSafeObject(rhs.context,self.expression),ensureSafeFunction(rhs.value,self.expression);for(var values=[],i=0;i<args.length;++i)values.push(ensureSafeObject(args[i](scope,locals,assign,inputs),self.expression));value=ensureSafeObject(rhs.value.apply(rhs.context,values),self.expression)}return context?{value:value}:value};case AST.AssignmentExpression:return left=this.recurse(ast.left,!0,1),right=this.recurse(ast.right),function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs);return ensureSafeObject(lhs.value,self.expression),ensureSafeAssignContext(lhs.context),lhs.context[lhs.name]=rhs,context?{value:rhs}:rhs};case AST.ArrayExpression:return args=[],forEach(ast.elements,function(expr){args.push(self.recurse(expr))}),function(scope,locals,assign,inputs){for(var value=[],i=0;i<args.length;++i)value.push(args[i](scope,locals,assign,inputs));return context?{value:value}:value};case AST.ObjectExpression:return args=[],forEach(ast.properties,function(property){args.push({key:property.key.type===AST.Identifier?property.key.name:""+property.key.value,value:self.recurse(property.value)})}),function(scope,locals,assign,inputs){for(var value={},i=0;i<args.length;++i)value[args[i].key]=args[i].value(scope,locals,assign,inputs);return context?{value:value}:value};case AST.ThisExpression:return function(scope){return context?{value:scope}:scope};case AST.NGValueParameter:return function(scope,locals,assign,inputs){return context?{value:assign}:assign}}},"unary+":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?+arg:0,context?{value:arg}:arg}},"unary-":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?-arg:0,context?{value:arg}:arg}},"unary!":function(argument,context){return function(scope,locals,assign,inputs){var arg=!argument(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary+":function(left,right,context){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs),arg=plusFn(lhs,rhs);return context?{value:arg}:arg}},"binary-":function(left,right,context){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs),arg=(isDefined(lhs)?lhs:0)-(isDefined(rhs)?rhs:0);return context?{value:arg}:arg}},"binary*":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)*right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary/":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)/right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary%":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)%right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary===":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)===right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary&&":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)&&right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary||":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)||right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"ternary?:":function(test,alternate,consequent,context){return function(scope,locals,assign,inputs){var arg=test(scope,locals,assign,inputs)?alternate(scope,locals,assign,inputs):consequent(scope,locals,assign,inputs);return context?{value:arg}:arg}},value:function(value,context){return function(){return context?{context:undefined,name:undefined,value:value}:value}},identifier:function(name,expensiveChecks,context,create,expression){return function(scope,locals,assign,inputs){var base=locals&&name in locals?locals:scope;create&&1!==create&&base&&!base[name]&&(base[name]={});var value=base?base[name]:undefined;return expensiveChecks&&ensureSafeObject(value,expression),context?{context:base,name:name,value:value}:value}},computedMember:function(left,right,context,create,expression){return function(scope,locals,assign,inputs){var rhs,value,lhs=left(scope,locals,assign,inputs);return null!=lhs&&(rhs=right(scope,locals,assign,inputs),rhs=getStringValue(rhs),ensureSafeMemberName(rhs,expression),create&&1!==create&&(ensureSafeAssignContext(lhs),lhs&&!lhs[rhs]&&(lhs[rhs]={})),value=lhs[rhs],ensureSafeObject(value,expression)),context?{context:lhs,name:rhs,value:value}:value}},nonComputedMember:function(left,right,expensiveChecks,context,create,expression){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs);create&&1!==create&&(ensureSafeAssignContext(lhs),lhs&&!lhs[right]&&(lhs[right]={}));var value=null!=lhs?lhs[right]:undefined;return(expensiveChecks||isPossiblyDangerousMemberName(right))&&ensureSafeObject(value,expression),context?{context:lhs,name:right,value:value}:value}},inputs:function(input,watchId){return function(scope,value,locals,inputs){return inputs?inputs[watchId]:input(scope,value,locals)}}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options,this.ast=new AST(this.lexer),this.astCompiler=options.csp?new ASTInterpreter(this.ast,$filter):new ASTCompiler(this.ast,$filter)};Parser.prototype={constructor:Parser,parse:function(text){return this.astCompiler.compile(text,this.options.expensiveChecks)}};var objectValueOf=Object.prototype.valueOf,$sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},$compileMinErr=minErr("$compile"),urlParsingNode=document.createElement("a"),originUrl=urlResolve(window.location.href);$$CookieReader.$inject=["$document"],$FilterProvider.$inject=["$provide"];var MAX_DIGITS=22,DECIMAL_SEP=".",ZERO_CHAR="0";currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DATE_FORMATS={yyyy:dateGetter("FullYear",4),yy:dateGetter("FullYear",2,0,!0),y:dateGetter("FullYear",1),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter,ww:weekGetter(2),w:weekGetter(1),G:eraGetter,GG:eraGetter,GGG:eraGetter,GGGG:longEraGetter},DATE_FORMATS_SPLIT=/((?:[^yMdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,NUMBER_STRING=/^\-?\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){return attr.href||attr.xlinkHref?void 0:function(scope,element){if("a"===element[0].nodeName.toLowerCase()){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){function defaultLinkFn(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}if("multiple"!=propName){var normalized=directiveNormalize("ng-"+attrName),linkFn=defaultLinkFn;"checked"===propName&&(linkFn=function(scope,element,attr){attr.ngModel!==attr[normalized]&&defaultLinkFn(scope,element,attr)}),ngAttributeAliasDirectives[normalized]=function(){return{restrict:"A",priority:100,link:linkFn}}}}),forEach(ALIASED_ATTR,function(htmlAttr,ngAttr){ngAttributeAliasDirectives[ngAttr]=function(){return{priority:100,link:function(scope,element,attr){if("ngPattern"===ngAttr&&"/"==attr.ngPattern.charAt(0)){var match=attr.ngPattern.match(REGEX_STRING_REGEXP);if(match)return void attr.$set("ngPattern",new RegExp(match[1],match[2]))}scope.$watch(attr[ngAttr],function(value){attr.$set(ngAttr,value)})}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$observe(normalized,function(value){return value?(attr.$set(name,value),void(msie&&propName&&element.prop(propName,attr[name]))):void("href"===attrName&&attr.$set(name,null))})}}}});var nullFormCtrl={$addControl:noop,$$renameControl:nullFormRenameControl,$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop,$setSubmitted:noop},SUBMITTED_CLASS="ng-submitted";FormController.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var formDirectiveFactory=function(isNgForm){return["$timeout","$parse",function($timeout,$parse){function getSetter(expression){return""===expression?$parse('this[""]').assign:$parse(expression).assign||noop}var formDirective={name:"form",restrict:isNgForm?"EAC":"E",require:["form","^^?form"],controller:FormController,compile:function(formElement,attr){formElement.addClass(PRISTINE_CLASS).addClass(VALID_CLASS);var nameAttr=attr.name?"name":isNgForm&&attr.ngForm?"ngForm":!1;return{pre:function(scope,formElement,attr,ctrls){var controller=ctrls[0];if(!("action"in attr)){var handleFormSubmission=function(event){scope.$apply(function(){controller.$commitViewValue(),controller.$setSubmitted()}),event.preventDefault()};addEventListenerFn(formElement[0],"submit",handleFormSubmission),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",handleFormSubmission)},0,!1)})}var parentFormCtrl=ctrls[1]||controller.$$parentForm;parentFormCtrl.$addControl(controller);var setter=nameAttr?getSetter(controller.$name):noop;nameAttr&&(setter(scope,controller),attr.$observe(nameAttr,function(newValue){controller.$name!==newValue&&(setter(scope,undefined),controller.$$parentForm.$$renameControl(controller,newValue),(setter=getSetter(controller.$name))(scope,controller))})),formElement.on("$destroy",function(){controller.$$parentForm.$removeControl(controller),setter(scope,undefined),extend(controller,nullFormCtrl)})}}}};return formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),ISO_DATE_REGEXP=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,URL_REGEXP=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:\/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,EMAIL_REGEXP=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,DATE_REGEXP=/^(\d{4})-(\d{2})-(\d{2})$/,DATETIMELOCAL_REGEXP=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,WEEK_REGEXP=/^(\d{4})-W(\d\d)$/,MONTH_REGEXP=/^(\d{4})-(\d\d)$/,TIME_REGEXP=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,PARTIAL_VALIDATION_EVENTS="keydown wheel mousedown",PARTIAL_VALIDATION_TYPES=createMap();forEach("date,datetime-local,month,time,week".split(","),function(type){PARTIAL_VALIDATION_TYPES[type]=!0});var inputType={text:textInputType,date:createDateInputType("date",DATE_REGEXP,createDateParser(DATE_REGEXP,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":createDateInputType("datetimelocal",DATETIMELOCAL_REGEXP,createDateParser(DATETIMELOCAL_REGEXP,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:createDateInputType("time",TIME_REGEXP,createDateParser(TIME_REGEXP,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:createDateInputType("week",WEEK_REGEXP,weekParser,"yyyy-Www"),month:createDateInputType("month",MONTH_REGEXP,createDateParser(MONTH_REGEXP,["yyyy","MM"]),"yyyy-MM"),number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop,file:noop},inputDirective=["$browser","$sniffer","$filter","$parse",function($browser,$sniffer,$filter,$parse){return{restrict:"E",require:["?ngModel"],link:{pre:function(scope,element,attr,ctrls){ctrls[0]&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrls[0],$sniffer,$browser,$filter,$parse)}}}}],CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{restrict:"A",priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value)})}}}},ngBindDirective=["$compile",function($compile){return{restrict:"AC",compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBind),element=element[0],scope.$watch(attr.ngBind,function(value){element.textContent=isUndefined(value)?"":value})}}}}],ngBindTemplateDirective=["$interpolate","$compile",function($interpolate,$compile){return{compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));$compile.$$addBindingInfo(element,interpolateFn.expressions),element=element[0],attr.$observe("ngBindTemplate",function(value){element.textContent=isUndefined(value)?"":value})}}}}],ngBindHtmlDirective=["$sce","$parse","$compile",function($sce,$parse,$compile){return{restrict:"A",compile:function(tElement,tAttrs){var ngBindHtmlGetter=$parse(tAttrs.ngBindHtml),ngBindHtmlWatch=$parse(tAttrs.ngBindHtml,function(val){return $sce.valueOf(val)});return $compile.$$addBindingClass(tElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBindHtml),scope.$watch(ngBindHtmlWatch,function(){var value=ngBindHtmlGetter(scope);element.html($sce.getTrustedHtml(value)||"")})}}}}],ngChangeDirective=valueFn({restrict:"A",require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",undefined),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],ngEventDirectives={},forceAsyncEvents={blur:!0,focus:!0};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(eventName){var directiveName=directiveNormalize("ng-"+eventName);ngEventDirectives[directiveName]=["$parse","$rootScope",function($parse,$rootScope){return{restrict:"A",compile:function($element,attr){var fn=$parse(attr[directiveName],null,!0);return function(scope,element){element.on(eventName,function(event){var callback=function(){fn(scope,{$event:event})};forceAsyncEvents[eventName]&&$rootScope.$$phase?scope.$evalAsync(callback):scope.$apply(callback)})}}}}]});var ngIfDirective=["$animate",function($animate){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function(value){value?childScope||$transclude(function(clone,newScope){childScope=newScope,clone[clone.length++]=document.createComment(" end ngIf: "+$attr.ngIf+" "),block={clone:clone},$animate.enter(clone,$element.parent(),$element)}):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockNodes(block.clone),$animate.leave(previousElements).then(function(){previousElements=null}),block=null))})}}}],ngIncludeDirective=["$templateRequest","$anchorScroll","$animate",function($templateRequest,$anchorScroll,$animate){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var currentScope,previousElement,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement).then(function(){previousElement=null}),previousElement=currentElement,currentElement=null)};scope.$watch(srcExp,function(src){var afterAnimation=function(){!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($templateRequest(src,!0).then(function(response){if(!scope.$$destroyed&&thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element).then(afterAnimation)});currentScope=newScope,currentElement=clone,currentScope.$emit("$includeContentLoaded",src),scope.$eval(onloadExp)}},function(){scope.$$destroyed||thisChangeId===changeCounter&&(cleanupLastIncludeContent(),scope.$emit("$includeContentError",src))}),scope.$emit("$includeContentRequested",src)):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){return/SVG/.test($element[0].toString())?($element.empty(),void $compile(jqLiteBuildFragment(ctrl.template,document).childNodes)(scope,function(clone){$element.append(clone)},{futureParentElement:$element})):($element.html(ctrl.template),void $compile($element.contents())(scope))}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngListDirective=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(scope,element,attr,ctrl){var ngList=element.attr(attr.$attr.ngList)||", ",trimValues="false"!==attr.ngTrim,separator=trimValues?trim(ngList):ngList,parse=function(viewValue){if(!isUndefined(viewValue)){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trimValues?trim(value):value)}),list}};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){return isArray(value)?value.join(ngList):undefined}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",UNTOUCHED_CLASS="ng-untouched",TOUCHED_CLASS="ng-touched",PENDING_CLASS="ng-pending",ngModelMinErr=minErr("ngModel"),NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function($scope,$exceptionHandler,$attr,$element,$parse,$animate,$timeout,$rootScope,$q,$interpolate){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=undefined,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=undefined,this.$name=$interpolate($attr.name||"",!1)($scope),this.$$parentForm=nullFormCtrl;var parserValid,parsedNgModel=$parse($attr.ngModel),parsedNgModelAssign=parsedNgModel.assign,ngModelGet=parsedNgModel,ngModelSet=parsedNgModelAssign,pendingDebounce=null,ctrl=this;this.$$setOptions=function(options){if(ctrl.$options=options,options&&options.getterSetter){var invokeModelGetter=$parse($attr.ngModel+"()"),invokeModelSetter=$parse($attr.ngModel+"($$$p)");ngModelGet=function($scope){var modelValue=parsedNgModel($scope);return isFunction(modelValue)&&(modelValue=invokeModelGetter($scope)),modelValue},ngModelSet=function($scope,newValue){isFunction(parsedNgModel($scope))?invokeModelSetter($scope,{$$$p:ctrl.$modelValue}):parsedNgModelAssign($scope,ctrl.$modelValue)}}else if(!parsedNgModel.assign)throw ngModelMinErr("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element))},this.$render=noop,this.$isEmpty=function(value){return isUndefined(value)||""===value||null===value||value!==value};var currentValidationRunId=0;addSetValidityMethod({ctrl:this,$element:$element,set:function(object,property){object[property]=!0},unset:function(object,property){delete object[property]},$animate:$animate}),this.$setPristine=function(){ctrl.$dirty=!1,ctrl.$pristine=!0,$animate.removeClass($element,DIRTY_CLASS),$animate.addClass($element,PRISTINE_CLASS)},this.$setDirty=function(){ctrl.$dirty=!0,ctrl.$pristine=!1,$animate.removeClass($element,PRISTINE_CLASS),$animate.addClass($element,DIRTY_CLASS),ctrl.$$parentForm.$setDirty()},this.$setUntouched=function(){ctrl.$touched=!1,ctrl.$untouched=!0,$animate.setClass($element,UNTOUCHED_CLASS,TOUCHED_CLASS)},this.$setTouched=function(){ctrl.$touched=!0,ctrl.$untouched=!1,$animate.setClass($element,TOUCHED_CLASS,UNTOUCHED_CLASS)},this.$rollbackViewValue=function(){$timeout.cancel(pendingDebounce),ctrl.$viewValue=ctrl.$$lastCommittedViewValue,ctrl.$render()},this.$validate=function(){if(!isNumber(ctrl.$modelValue)||!isNaN(ctrl.$modelValue)){var viewValue=ctrl.$$lastCommittedViewValue,modelValue=ctrl.$$rawModelValue,prevValid=ctrl.$valid,prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$runValidators(modelValue,viewValue,function(allValid){allowInvalid||prevValid===allValid||(ctrl.$modelValue=allValid?modelValue:undefined,ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope())})}},this.$$runValidators=function(modelValue,viewValue,doneCallback){function processParseErrors(){var errorKey=ctrl.$$parserName||"parse";return isUndefined(parserValid)?(setValidity(errorKey,null),!0):(parserValid||(forEach(ctrl.$validators,function(v,name){setValidity(name,null)}),forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)})),setValidity(errorKey,parserValid),parserValid)}function processSyncValidators(){var syncValidatorsValid=!0;return forEach(ctrl.$validators,function(validator,name){var result=validator(modelValue,viewValue);syncValidatorsValid=syncValidatorsValid&&result,setValidity(name,result)}),syncValidatorsValid?!0:(forEach(ctrl.$asyncValidators,function(v,name){setValidity(name,null)}),!1)}function processAsyncValidators(){var validatorPromises=[],allValid=!0;forEach(ctrl.$asyncValidators,function(validator,name){var promise=validator(modelValue,viewValue);if(!isPromiseLike(promise))throw ngModelMinErr("nopromise","Expected asynchronous validator to return a promise but got '{0}' instead.",promise);setValidity(name,undefined),validatorPromises.push(promise.then(function(){setValidity(name,!0)},function(error){allValid=!1,setValidity(name,!1)}))}),validatorPromises.length?$q.all(validatorPromises).then(function(){validationDone(allValid)},noop):validationDone(!0)}function setValidity(name,isValid){localValidationRunId===currentValidationRunId&&ctrl.$setValidity(name,isValid)}function validationDone(allValid){localValidationRunId===currentValidationRunId&&doneCallback(allValid)}currentValidationRunId++;var localValidationRunId=currentValidationRunId;return processParseErrors()&&processSyncValidators()?void processAsyncValidators():void validationDone(!1)},this.$commitViewValue=function(){var viewValue=ctrl.$viewValue;$timeout.cancel(pendingDebounce),(ctrl.$$lastCommittedViewValue!==viewValue||""===viewValue&&ctrl.$$hasNativeValidators)&&(ctrl.$$lastCommittedViewValue=viewValue,ctrl.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){function writeToModelIfNeeded(){ctrl.$modelValue!==prevModelValue&&ctrl.$$writeModelToScope()}var viewValue=ctrl.$$lastCommittedViewValue,modelValue=viewValue;if(parserValid=isUndefined(modelValue)?undefined:!0)for(var i=0;i<ctrl.$parsers.length;i++)if(modelValue=ctrl.$parsers[i](modelValue),isUndefined(modelValue)){parserValid=!1;break}isNumber(ctrl.$modelValue)&&isNaN(ctrl.$modelValue)&&(ctrl.$modelValue=ngModelGet($scope));var prevModelValue=ctrl.$modelValue,allowInvalid=ctrl.$options&&ctrl.$options.allowInvalid;ctrl.$$rawModelValue=modelValue,allowInvalid&&(ctrl.$modelValue=modelValue,writeToModelIfNeeded()),ctrl.$$runValidators(modelValue,ctrl.$$lastCommittedViewValue,function(allValid){allowInvalid||(ctrl.$modelValue=allValid?modelValue:undefined,writeToModelIfNeeded())})},this.$$writeModelToScope=function(){ngModelSet($scope,ctrl.$modelValue),forEach(ctrl.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}})},this.$setViewValue=function(value,trigger){ctrl.$viewValue=value,(!ctrl.$options||ctrl.$options.updateOnDefault)&&ctrl.$$debounceViewValueCommit(trigger)},this.$$debounceViewValueCommit=function(trigger){var debounce,debounceDelay=0,options=ctrl.$options;options&&isDefined(options.debounce)&&(debounce=options.debounce,isNumber(debounce)?debounceDelay=debounce:isNumber(debounce[trigger])?debounceDelay=debounce[trigger]:isNumber(debounce["default"])&&(debounceDelay=debounce["default"])),$timeout.cancel(pendingDebounce),debounceDelay?pendingDebounce=$timeout(function(){ctrl.$commitViewValue()},debounceDelay):$rootScope.$$phase?ctrl.$commitViewValue():$scope.$apply(function(){ctrl.$commitViewValue()})},$scope.$watch(function(){var modelValue=ngModelGet($scope);if(modelValue!==ctrl.$modelValue&&(ctrl.$modelValue===ctrl.$modelValue||modelValue===modelValue)){ctrl.$modelValue=ctrl.$$rawModelValue=modelValue,parserValid=undefined;for(var formatters=ctrl.$formatters,idx=formatters.length,viewValue=modelValue;idx--;)viewValue=formatters[idx](viewValue);ctrl.$viewValue!==viewValue&&(ctrl.$viewValue=ctrl.$$lastCommittedViewValue=viewValue,ctrl.$render(),ctrl.$$runValidators(modelValue,viewValue,noop))}return modelValue})}],ngModelDirective=["$rootScope",function($rootScope){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:NgModelController,priority:1,compile:function(element){return element.addClass(PRISTINE_CLASS).addClass(UNTOUCHED_CLASS).addClass(VALID_CLASS),{pre:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||modelCtrl.$$parentForm;modelCtrl.$$setOptions(ctrls[2]&&ctrls[2].$options),formCtrl.$addControl(modelCtrl),attr.$observe("name",function(newValue){modelCtrl.$name!==newValue&&modelCtrl.$$parentForm.$$renameControl(modelCtrl,newValue)}),scope.$on("$destroy",function(){modelCtrl.$$parentForm.$removeControl(modelCtrl)})},post:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0];modelCtrl.$options&&modelCtrl.$options.updateOn&&element.on(modelCtrl.$options.updateOn,function(ev){modelCtrl.$$debounceViewValueCommit(ev&&ev.type)}),element.on("blur",function(ev){
modelCtrl.$touched||($rootScope.$$phase?scope.$evalAsync(modelCtrl.$setTouched):scope.$apply(modelCtrl.$setTouched))})}}}}}],DEFAULT_REGEXP=/(\s+|^)default(\s+|$)/,ngModelOptionsDirective=function(){return{restrict:"A",controller:["$scope","$attrs",function($scope,$attrs){var that=this;this.$options=copy($scope.$eval($attrs.ngModelOptions)),isDefined(this.$options.updateOn)?(this.$options.updateOnDefault=!1,this.$options.updateOn=trim(this.$options.updateOn.replace(DEFAULT_REGEXP,function(){return that.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngOptionsMinErr=minErr("ngOptions"),NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,ngOptionsDirective=["$compile","$parse",function($compile,$parse){function parseOptionsExpression(optionsExp,selectElement,scope){function Option(selectValue,viewValue,label,group,disabled){this.selectValue=selectValue,this.viewValue=viewValue,this.label=label,this.group=group,this.disabled=disabled}function getOptionValuesKeys(optionValues){var optionValuesKeys;if(!keyName&&isArrayLike(optionValues))optionValuesKeys=optionValues;else{optionValuesKeys=[];for(var itemKey in optionValues)optionValues.hasOwnProperty(itemKey)&&"$"!==itemKey.charAt(0)&&optionValuesKeys.push(itemKey)}return optionValuesKeys}var match=optionsExp.match(NG_OPTIONS_REGEXP);if(!match)throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var valueName=match[5]||match[7],keyName=match[6],selectAs=/ as /.test(match[0])&&match[1],trackBy=match[9],valueFn=$parse(match[2]?match[1]:valueName),selectAsFn=selectAs&&$parse(selectAs),viewValueFn=selectAsFn||valueFn,trackByFn=trackBy&&$parse(trackBy),getTrackByValueFn=trackBy?function(value,locals){return trackByFn(scope,locals)}:function(value){return hashKey(value)},getTrackByValue=function(value,key){return getTrackByValueFn(value,getLocals(value,key))},displayFn=$parse(match[2]||match[1]),groupByFn=$parse(match[3]||""),disableWhenFn=$parse(match[4]||""),valuesFn=$parse(match[8]),locals={},getLocals=keyName?function(value,key){return locals[keyName]=key,locals[valueName]=value,locals}:function(value){return locals[valueName]=value,locals};return{trackBy:trackBy,getTrackByValue:getTrackByValue,getWatchables:$parse(valuesFn,function(optionValues){var watchedArray=[];optionValues=optionValues||[];for(var optionValuesKeys=getOptionValuesKeys(optionValues),optionValuesLength=optionValuesKeys.length,index=0;optionValuesLength>index;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],locals=(optionValues[key],getLocals(optionValues[key],key)),selectValue=getTrackByValueFn(optionValues[key],locals);if(watchedArray.push(selectValue),match[2]||match[1]){var label=displayFn(scope,locals);watchedArray.push(label)}if(match[4]){var disableWhen=disableWhenFn(scope,locals);watchedArray.push(disableWhen)}}return watchedArray}),getOptions:function(){for(var optionItems=[],selectValueMap={},optionValues=valuesFn(scope)||[],optionValuesKeys=getOptionValuesKeys(optionValues),optionValuesLength=optionValuesKeys.length,index=0;optionValuesLength>index;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],value=optionValues[key],locals=getLocals(value,key),viewValue=viewValueFn(scope,locals),selectValue=getTrackByValueFn(viewValue,locals),label=displayFn(scope,locals),group=groupByFn(scope,locals),disabled=disableWhenFn(scope,locals),optionItem=new Option(selectValue,viewValue,label,group,disabled);optionItems.push(optionItem),selectValueMap[selectValue]=optionItem}return{items:optionItems,selectValueMap:selectValueMap,getOptionFromViewValue:function(value){return selectValueMap[getTrackByValue(value)]},getViewValueFromOption:function(option){return trackBy?angular.copy(option.viewValue):option.viewValue}}}}}function ngOptionsPostLink(scope,selectElement,attr,ctrls){function updateOptionElement(option,element){option.element=element,element.disabled=option.disabled,option.label!==element.label&&(element.label=option.label,element.textContent=option.label),option.value!==element.value&&(element.value=option.selectValue)}function addOrReuseElement(parent,current,type,templateElement){var element;return current&&lowercase(current.nodeName)===type?element=current:(element=templateElement.cloneNode(!1),current?parent.insertBefore(element,current):parent.appendChild(element)),element}function removeExcessElements(current){for(var next;current;)next=current.nextSibling,jqLiteRemove(current),current=next}function skipEmptyAndUnknownOptions(current){var emptyOption_=emptyOption&&emptyOption[0],unknownOption_=unknownOption&&unknownOption[0];if(emptyOption_||unknownOption_)for(;current&&(current===emptyOption_||current===unknownOption_||current.nodeType===NODE_TYPE_COMMENT||"option"===nodeName_(current)&&""===current.value);)current=current.nextSibling;return current}function updateOptions(){var previousValue=options&&selectCtrl.readValue();options=ngOptions.getOptions();var groupMap={},currentElement=selectElement[0].firstChild;if(providedEmptyOption&&selectElement.prepend(emptyOption),currentElement=skipEmptyAndUnknownOptions(currentElement),options.items.forEach(function(option){var group,groupElement,optionElement;option.group?(group=groupMap[option.group],group||(groupElement=addOrReuseElement(selectElement[0],currentElement,"optgroup",optGroupTemplate),currentElement=groupElement.nextSibling,groupElement.label=option.group,group=groupMap[option.group]={groupElement:groupElement,currentOptionElement:groupElement.firstChild}),optionElement=addOrReuseElement(group.groupElement,group.currentOptionElement,"option",optionTemplate),updateOptionElement(option,optionElement),group.currentOptionElement=optionElement.nextSibling):(optionElement=addOrReuseElement(selectElement[0],currentElement,"option",optionTemplate),updateOptionElement(option,optionElement),currentElement=optionElement.nextSibling)}),Object.keys(groupMap).forEach(function(key){removeExcessElements(groupMap[key].currentOptionElement)}),removeExcessElements(currentElement),ngModelCtrl.$render(),!ngModelCtrl.$isEmpty(previousValue)){var nextValue=selectCtrl.readValue(),isNotPrimitive=ngOptions.trackBy||multiple;(isNotPrimitive?equals(previousValue,nextValue):previousValue===nextValue)||(ngModelCtrl.$setViewValue(nextValue),ngModelCtrl.$render())}}var ngModelCtrl=ctrls[1];if(ngModelCtrl){for(var emptyOption,selectCtrl=ctrls[0],multiple=attr.multiple,i=0,children=selectElement.children(),ii=children.length;ii>i;i++)if(""===children[i].value){emptyOption=children.eq(i);break}var providedEmptyOption=!!emptyOption,unknownOption=jqLite(optionTemplate.cloneNode(!1));unknownOption.val("?");var options,ngOptions=parseOptionsExpression(attr.ngOptions,selectElement,scope),renderEmptyOption=function(){providedEmptyOption||selectElement.prepend(emptyOption),selectElement.val(""),emptyOption.prop("selected",!0),emptyOption.attr("selected",!0)},removeEmptyOption=function(){providedEmptyOption||emptyOption.remove()},renderUnknownOption=function(){selectElement.prepend(unknownOption),selectElement.val("?"),unknownOption.prop("selected",!0),unknownOption.attr("selected",!0)},removeUnknownOption=function(){unknownOption.remove()};multiple?(ngModelCtrl.$isEmpty=function(value){return!value||0===value.length},selectCtrl.writeValue=function(value){options.items.forEach(function(option){option.element.selected=!1}),value&&value.forEach(function(item){var option=options.getOptionFromViewValue(item);option&&!option.disabled&&(option.element.selected=!0)})},selectCtrl.readValue=function(){var selectedValues=selectElement.val()||[],selections=[];return forEach(selectedValues,function(value){var option=options.selectValueMap[value];option&&!option.disabled&&selections.push(options.getViewValueFromOption(option))}),selections},ngOptions.trackBy&&scope.$watchCollection(function(){return isArray(ngModelCtrl.$viewValue)?ngModelCtrl.$viewValue.map(function(value){return ngOptions.getTrackByValue(value)}):void 0},function(){ngModelCtrl.$render()})):(selectCtrl.writeValue=function(value){var option=options.getOptionFromViewValue(value);option&&!option.disabled?(selectElement[0].value!==option.selectValue&&(removeUnknownOption(),removeEmptyOption(),selectElement[0].value=option.selectValue,option.element.selected=!0),option.element.setAttribute("selected","selected")):null===value||providedEmptyOption?(removeUnknownOption(),renderEmptyOption()):(removeEmptyOption(),renderUnknownOption())},selectCtrl.readValue=function(){var selectedOption=options.selectValueMap[selectElement.val()];return selectedOption&&!selectedOption.disabled?(removeEmptyOption(),removeUnknownOption(),options.getViewValueFromOption(selectedOption)):null},ngOptions.trackBy&&scope.$watch(function(){return ngOptions.getTrackByValue(ngModelCtrl.$viewValue)},function(){ngModelCtrl.$render()})),providedEmptyOption?(emptyOption.remove(),$compile(emptyOption)(scope),emptyOption.removeClass("ng-scope")):emptyOption=jqLite(optionTemplate.cloneNode(!1)),updateOptions(),scope.$watchCollection(ngOptions.getWatchables,updateOptions)}}var optionTemplate=document.createElement("option"),optGroupTemplate=document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","?ngModel"],link:{pre:function(scope,selectElement,attr,ctrls){ctrls[0].registerOption=noop},post:ngOptionsPostLink}}}],ngPluralizeDirective=["$locale","$interpolate","$log",function($locale,$interpolate,$log){var BRACE=/{}/g,IS_WHEN=/^when(Minus)?(.+)$/;return{link:function(scope,element,attr){function updateElementText(newText){element.text(newText||"")}var lastCount,numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),braceReplacement=startSymbol+numberExp+"-"+offset+endSymbol,watchRemover=angular.noop;forEach(attr,function(expression,attributeName){var tmpMatch=IS_WHEN.exec(attributeName);if(tmpMatch){var whenKey=(tmpMatch[1]?"-":"")+lowercase(tmpMatch[2]);whens[whenKey]=element.attr(attr.$attr[attributeName])}}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,braceReplacement))}),scope.$watch(numberExp,function(newVal){var count=parseFloat(newVal),countIsNaN=isNaN(count);if(countIsNaN||count in whens||(count=$locale.pluralCat(count-offset)),count!==lastCount&&!(countIsNaN&&isNumber(lastCount)&&isNaN(lastCount))){watchRemover();var whenExpFn=whensExpFns[count];isUndefined(whenExpFn)?(null!=newVal&&$log.debug("ngPluralize: no rule defined for '"+count+"' in "+whenExp),watchRemover=noop,updateElementText()):watchRemover=scope.$watch(whenExpFn,updateElementText),lastCount=count}})}}}],ngRepeatDirective=["$parse","$animate",function($parse,$animate){var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat"),updateScope=function(scope,index,valueIdentifier,value,keyIdentifier,key,arrayLength){scope[valueIdentifier]=value,keyIdentifier&&(scope[keyIdentifier]=key),scope.$index=index,scope.$first=0===index,scope.$last=index===arrayLength-1,scope.$middle=!(scope.$first||scope.$last),scope.$odd=!(scope.$even=0===(1&index))},getBlockStart=function(block){return block.clone[0]},getBlockEnd=function(block){return block.clone[block.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function($element,$attr){var expression=$attr.ngRepeat,ngRepeatEndComment=document.createComment(" end ngRepeat: "+expression+" "),match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);var lhs=match[1],rhs=match[2],aliasAs=match[3],trackByExp=match[4];if(match=lhs.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);var valueIdentifier=match[3]||match[1],keyIdentifier=match[2];if(aliasAs&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(aliasAs)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(aliasAs)))throw ngRepeatMinErr("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",aliasAs);var trackByExpGetter,trackByIdExpFn,trackByIdArrayFn,trackByIdObjFn,hashFnLocals={$id:hashKey};return trackByExp?trackByExpGetter=$parse(trackByExp):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),function($scope,$element,$attr,ctrl,$transclude){trackByExpGetter&&(trackByIdExpFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)});var lastBlockMap=createMap();$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,collectionLength,key,value,trackById,trackByIdFn,collectionKeys,block,nextBlockOrder,elementsToRemove,previousNode=$element[0],nextBlockMap=createMap();if(aliasAs&&($scope[aliasAs]=collection),isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else{trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[];for(var itemKey in collection)hasOwnProperty.call(collection,itemKey)&&"$"!==itemKey.charAt(0)&&collectionKeys.push(itemKey)}for(collectionLength=collectionKeys.length,nextBlockOrder=new Array(collectionLength),index=0;collectionLength>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),lastBlockMap[trackById])block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap[trackById])throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",expression,trackById,value);nextBlockOrder[index]={id:trackById,scope:undefined,clone:undefined},nextBlockMap[trackById]=!0}for(var blockKey in lastBlockMap){if(block=lastBlockMap[blockKey],elementsToRemove=getBlockNodes(block.clone),$animate.leave(elementsToRemove),elementsToRemove[0].parentNode)for(index=0,length=elementsToRemove.length;length>index;index++)elementsToRemove[index][NG_REMOVED]=!0;block.scope.$destroy()}for(index=0;collectionLength>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],block.scope){nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);getBlockStart(block)!=nextNode&&$animate.move(getBlockNodes(block.clone),null,previousNode),previousNode=getBlockEnd(block),updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)}else $transclude(function(clone,scope){block.scope=scope;var endNode=ngRepeatEndComment.cloneNode(!1);clone[clone.length++]=endNode,$animate.enter(clone,null,previousNode),previousNode=endNode,block.clone=clone,nextBlockMap[block.id]=block,updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)});lastBlockMap=nextBlockMap})}}}}],NG_HIDE_CLASS="ng-hide",NG_HIDE_IN_PROGRESS_CLASS="ng-hide-animate",ngShowDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[value?"removeClass":"addClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngHideDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[value?"addClass":"removeClass"](element,NG_HIDE_CLASS,{tempClasses:NG_HIDE_IN_PROGRESS_CLASS})})}}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=["$animate",function($animate){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var watchExpr=attr.ngSwitch||attr.on,selectedTranscludes=[],selectedElements=[],previousLeaveAnimations=[],selectedScopes=[],spliceFactory=function(array,index){return function(){array.splice(index,1)}};scope.$watch(watchExpr,function(value){var i,ii;for(i=0,ii=previousLeaveAnimations.length;ii>i;++i)$animate.cancel(previousLeaveAnimations[i]);for(previousLeaveAnimations.length=0,i=0,ii=selectedScopes.length;ii>i;++i){var selected=getBlockNodes(selectedElements[i].clone);selectedScopes[i].$destroy();var promise=previousLeaveAnimations[i]=$animate.leave(selected);promise.then(spliceFactory(previousLeaveAnimations,i))}selectedElements.length=0,selectedScopes.length=0,(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&forEach(selectedTranscludes,function(selectedTransclude){selectedTransclude.transclude(function(caseElement,selectedScope){selectedScopes.push(selectedScope);var anchor=selectedTransclude.element;caseElement[caseElement.length++]=document.createComment(" end ngSwitchWhen: ");var block={clone:caseElement};selectedElements.push(block),$animate.enter(caseElement,anchor.parent(),anchor)})})})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attrs,ctrl,$transclude){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:$transclude,element:element})}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeDirective=ngDirective({restrict:"EAC",link:function($scope,$element,$attrs,controller,$transclude){if(!$transclude)throw minErr("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$transclude(function(clone){$element.empty(),$element.append(clone)})}}),scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],noopNgModelController={$setViewValue:noop,$render:noop},SelectController=["$element","$scope","$attrs",function($element,$scope,$attrs){var self=this,optionsMap=new HashMap;self.ngModelCtrl=noopNgModelController,self.unknownOption=jqLite(document.createElement("option")),self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";self.unknownOption.val(unknownVal),$element.prepend(self.unknownOption),$element.val(unknownVal)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop}),self.removeUnknownOption=function(){self.unknownOption.parent()&&self.unknownOption.remove()},self.readValue=function(){return self.removeUnknownOption(),$element.val()},self.writeValue=function(value){self.hasOption(value)?(self.removeUnknownOption(),$element.val(value),""===value&&self.emptyOption.prop("selected",!0)):null==value&&self.emptyOption?(self.removeUnknownOption(),$element.val("")):self.renderUnknownOption(value)},self.addOption=function(value,element){if(element[0].nodeType!==NODE_TYPE_COMMENT){assertNotHasOwnProperty(value,'"option value"'),""===value&&(self.emptyOption=element);var count=optionsMap.get(value)||0;optionsMap.put(value,count+1),self.ngModelCtrl.$render(),chromeHack(element)}},self.removeOption=function(value){var count=optionsMap.get(value);count&&(1===count?(optionsMap.remove(value),""===value&&(self.emptyOption=undefined)):optionsMap.put(value,count-1))},self.hasOption=function(value){return!!optionsMap.get(value)},self.registerOption=function(optionScope,optionElement,optionAttrs,interpolateValueFn,interpolateTextFn){if(interpolateValueFn){var oldVal;optionAttrs.$observe("value",function(newVal){isDefined(oldVal)&&self.removeOption(oldVal),oldVal=newVal,self.addOption(newVal,optionElement)})}else interpolateTextFn?optionScope.$watch(interpolateTextFn,function(newVal,oldVal){optionAttrs.$set("value",newVal),oldVal!==newVal&&self.removeOption(oldVal),self.addOption(newVal,optionElement)}):self.addOption(optionAttrs.value,optionElement);optionElement.on("$destroy",function(){self.removeOption(optionAttrs.value),self.ngModelCtrl.$render()})}}],selectDirective=function(){function selectPreLink(scope,element,attr,ctrls){var ngModelCtrl=ctrls[1];if(ngModelCtrl){var selectCtrl=ctrls[0];if(selectCtrl.ngModelCtrl=ngModelCtrl,element.on("change",function(){scope.$apply(function(){ngModelCtrl.$setViewValue(selectCtrl.readValue())})}),attr.multiple){selectCtrl.readValue=function(){var array=[];return forEach(element.find("option"),function(option){option.selected&&array.push(option.value)}),array},selectCtrl.writeValue=function(value){var items=new HashMap(value);forEach(element.find("option"),function(option){option.selected=isDefined(items.get(option.value))})};var lastView,lastViewRef=NaN;scope.$watch(function(){lastViewRef!==ngModelCtrl.$viewValue||equals(lastView,ngModelCtrl.$viewValue)||(lastView=shallowCopy(ngModelCtrl.$viewValue),ngModelCtrl.$render()),lastViewRef=ngModelCtrl.$viewValue}),ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}}}}function selectPostLink(scope,element,attrs,ctrls){var ngModelCtrl=ctrls[1];if(ngModelCtrl){var selectCtrl=ctrls[0];ngModelCtrl.$render=function(){selectCtrl.writeValue(ngModelCtrl.$viewValue)}}}return{restrict:"E",require:["select","?ngModel"],controller:SelectController,priority:1,link:{pre:selectPreLink,post:selectPostLink}}},optionDirective=["$interpolate",function($interpolate){return{restrict:"E",priority:100,compile:function(element,attr){if(isDefined(attr.value))var interpolateValueFn=$interpolate(attr.value,!0);else{var interpolateTextFn=$interpolate(element.text(),!0);interpolateTextFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.registerOption(scope,element,attr,interpolateValueFn,interpolateTextFn)}}}}],styleDirective=valueFn({restrict:"E",terminal:!1}),requiredDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){ctrl&&(attr.required=!0,ctrl.$validators.required=function(modelValue,viewValue){return!attr.required||!ctrl.$isEmpty(viewValue)},attr.$observe("required",function(){ctrl.$validate()}))}}},patternDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var regexp,patternExp=attr.ngPattern||attr.pattern;attr.$observe("pattern",function(regex){if(isString(regex)&&regex.length>0&&(regex=new RegExp("^"+regex+"$")),regex&&!regex.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",patternExp,regex,startingTag(elm));regexp=regex||undefined,ctrl.$validate()}),ctrl.$validators.pattern=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(regexp)||regexp.test(viewValue)}}}}},maxlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var maxlength=-1;attr.$observe("maxlength",function(value){var intVal=toInt(value);maxlength=isNaN(intVal)?-1:intVal,ctrl.$validate()}),ctrl.$validators.maxlength=function(modelValue,viewValue){return 0>maxlength||ctrl.$isEmpty(viewValue)||viewValue.length<=maxlength}}}}},minlengthDirective=function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var minlength=0;attr.$observe("minlength",function(value){minlength=toInt(value)||0,ctrl.$validate()}),ctrl.$validators.minlength=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||viewValue.length>=minlength}}}}};return window.angular.bootstrap?void(window.console&&console.log("WARNING: Tried to load angular more than once.")):(bindJQuery(),publishExternalAPI(angular),angular.module("ngLocale",[],["$provide",function($provide){function getDecimals(n){n+="";var i=n.indexOf(".");return-1==i?0:n.length-i-1}function getVF(n,opt_precision){var v=opt_precision;undefined===v&&(v=Math.min(getDecimals(n),3));var base=Math.pow(10,v),f=(n*base|0)%base;return{v:v,f:f}}var PLURAL_CATEGORY={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};$provide.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(n,opt_precision){var i=0|n,vf=getVF(n,opt_precision);return 1==i&&0==vf.v?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}})}]),void jqLite(document).ready(function(){angularInit(document,bootstrap)}))}(window,document),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>'),define("angular",["jquery"],function(global){return function(){var ret;return ret||global.angular}}(this)),function(window,angular,undefined){"use strict";function nodeName_(element){return angular.lowercase(element.nodeName||element[0]&&element[0].nodeName)}function makeSwipeDirective(directiveName,direction,eventName){ngTouch.directive(directiveName,["$parse","$swipe",function($parse,$swipe){var MAX_VERTICAL_DISTANCE=75,MAX_VERTICAL_RATIO=.3,MIN_HORIZONTAL_DISTANCE=30;return function(scope,element,attr){function validSwipe(coords){if(!startCoords)return!1;var deltaY=Math.abs(coords.y-startCoords.y),deltaX=(coords.x-startCoords.x)*direction;return valid&&MAX_VERTICAL_DISTANCE>deltaY&&deltaX>0&&deltaX>MIN_HORIZONTAL_DISTANCE&&MAX_VERTICAL_RATIO>deltaY/deltaX}var startCoords,valid,swipeHandler=$parse(attr[directiveName]),pointerTypes=["touch"];angular.isDefined(attr.ngSwipeDisableMouse)||pointerTypes.push("mouse"),$swipe.bind(element,{start:function(coords,event){startCoords=coords,valid=!0},cancel:function(event){valid=!1},end:function(coords,event){validSwipe(coords)&&scope.$apply(function(){element.triggerHandler(eventName),swipeHandler(scope,{$event:event})})}},pointerTypes)}}])}var ngTouch=angular.module("ngTouch",[]);ngTouch.factory("$swipe",[function(){function getCoordinates(event){var originalEvent=event.originalEvent||event,touches=originalEvent.touches&&originalEvent.touches.length?originalEvent.touches:[originalEvent],e=originalEvent.changedTouches&&originalEvent.changedTouches[0]||touches[0];return{x:e.clientX,y:e.clientY}}function getEvents(pointerTypes,eventType){var res=[];return angular.forEach(pointerTypes,function(pointerType){var eventName=POINTER_EVENTS[pointerType][eventType];eventName&&res.push(eventName)}),res.join(" ")}var MOVE_BUFFER_RADIUS=10,POINTER_EVENTS={mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},touch:{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"}};return{bind:function(element,eventHandlers,pointerTypes){var totalX,totalY,startCoords,lastPos,active=!1;pointerTypes=pointerTypes||["mouse","touch"],element.on(getEvents(pointerTypes,"start"),function(event){startCoords=getCoordinates(event),active=!0,totalX=0,totalY=0,lastPos=startCoords,eventHandlers.start&&eventHandlers.start(startCoords,event)});var events=getEvents(pointerTypes,"cancel");events&&element.on(events,function(event){active=!1,eventHandlers.cancel&&eventHandlers.cancel(event)}),element.on(getEvents(pointerTypes,"move"),function(event){if(active&&startCoords){var coords=getCoordinates(event);if(totalX+=Math.abs(coords.x-lastPos.x),totalY+=Math.abs(coords.y-lastPos.y),lastPos=coords,!(MOVE_BUFFER_RADIUS>totalX&&MOVE_BUFFER_RADIUS>totalY))return totalY>totalX?(active=!1,void(eventHandlers.cancel&&eventHandlers.cancel(event))):(event.preventDefault(),void(eventHandlers.move&&eventHandlers.move(coords,event)))}}),element.on(getEvents(pointerTypes,"end"),function(event){active&&(active=!1,eventHandlers.end&&eventHandlers.end(getCoordinates(event),event))})}}}]),ngTouch.config(["$provide",function($provide){$provide.decorator("ngClickDirective",["$delegate",function($delegate){return $delegate.shift(),$delegate}])}]),ngTouch.directive("ngClick",["$parse","$timeout","$rootElement",function($parse,$timeout,$rootElement){function hit(x1,y1,x2,y2){return Math.abs(x1-x2)<CLICKBUSTER_THRESHOLD&&Math.abs(y1-y2)<CLICKBUSTER_THRESHOLD}function checkAllowableRegions(touchCoordinates,x,y){for(var i=0;i<touchCoordinates.length;i+=2)if(hit(touchCoordinates[i],touchCoordinates[i+1],x,y))return touchCoordinates.splice(i,i+2),!0;return!1}function onClick(event){if(!(Date.now()-lastPreventedTime>PREVENT_DURATION)){var touches=event.touches&&event.touches.length?event.touches:[event],x=touches[0].clientX,y=touches[0].clientY;1>x&&1>y||lastLabelClickCoordinates&&lastLabelClickCoordinates[0]===x&&lastLabelClickCoordinates[1]===y||(lastLabelClickCoordinates&&(lastLabelClickCoordinates=null),"label"===nodeName_(event.target)&&(lastLabelClickCoordinates=[x,y]),checkAllowableRegions(touchCoordinates,x,y)||(event.stopPropagation(),event.preventDefault(),event.target&&event.target.blur&&event.target.blur()))}}function onTouchStart(event){var touches=event.touches&&event.touches.length?event.touches:[event],x=touches[0].clientX,y=touches[0].clientY;touchCoordinates.push(x,y),$timeout(function(){for(var i=0;i<touchCoordinates.length;i+=2)if(touchCoordinates[i]==x&&touchCoordinates[i+1]==y)return void touchCoordinates.splice(i,i+2)},PREVENT_DURATION,!1)}function preventGhostClick(x,y){touchCoordinates||($rootElement[0].addEventListener("click",onClick,!0),$rootElement[0].addEventListener("touchstart",onTouchStart,!0),touchCoordinates=[]),lastPreventedTime=Date.now(),checkAllowableRegions(touchCoordinates,x,y)}var lastPreventedTime,touchCoordinates,lastLabelClickCoordinates,TAP_DURATION=750,MOVE_TOLERANCE=12,PREVENT_DURATION=2500,CLICKBUSTER_THRESHOLD=25,ACTIVE_CLASS_NAME="ng-click-active";
return function(scope,element,attr){function resetState(){tapping=!1,element.removeClass(ACTIVE_CLASS_NAME)}var tapElement,startTime,touchStartX,touchStartY,clickHandler=$parse(attr.ngClick),tapping=!1;element.on("touchstart",function(event){tapping=!0,tapElement=event.target?event.target:event.srcElement,3==tapElement.nodeType&&(tapElement=tapElement.parentNode),element.addClass(ACTIVE_CLASS_NAME),startTime=Date.now();var originalEvent=event.originalEvent||event,touches=originalEvent.touches&&originalEvent.touches.length?originalEvent.touches:[originalEvent],e=touches[0];touchStartX=e.clientX,touchStartY=e.clientY}),element.on("touchcancel",function(event){resetState()}),element.on("touchend",function(event){var diff=Date.now()-startTime,originalEvent=event.originalEvent||event,touches=originalEvent.changedTouches&&originalEvent.changedTouches.length?originalEvent.changedTouches:originalEvent.touches&&originalEvent.touches.length?originalEvent.touches:[originalEvent],e=touches[0],x=e.clientX,y=e.clientY,dist=Math.sqrt(Math.pow(x-touchStartX,2)+Math.pow(y-touchStartY,2));tapping&&TAP_DURATION>diff&&MOVE_TOLERANCE>dist&&(preventGhostClick(x,y),tapElement&&tapElement.blur(),angular.isDefined(attr.disabled)&&attr.disabled!==!1||element.triggerHandler("click",[event])),resetState()}),element.onclick=function(event){},element.on("click",function(event,touchend){scope.$apply(function(){clickHandler(scope,{$event:touchend||event})})}),element.on("mousedown",function(event){element.addClass(ACTIVE_CLASS_NAME)}),element.on("mousemove mouseup",function(event){element.removeClass(ACTIVE_CLASS_NAME)})}}]),makeSwipeDirective("ngSwipeLeft",-1,"swipeleft"),makeSwipeDirective("ngSwipeRight",1,"swiperight")}(window,window.angular),define("ngTouch",["angular"],function(){}),function(window,document,exportName,undefined){"use strict";function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout)}function invokeArrayArg(arg,fn,context){return Array.isArray(arg)?(each(arg,context[fn],context),!0):!1}function each(obj,iterator,context){var i;if(obj)if(obj.forEach)obj.forEach(iterator,context);else if(obj.length!==undefined)for(i=0;i<obj.length;)iterator.call(context,obj[i],i,obj),i++;else for(i in obj)obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}function deprecate(method,name,message){var deprecationMessage="DEPRECATED METHOD: "+name+"\n"+message+" AT \n";return function(){var e=new Error("get-stack-trace"),stack=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",log=window.console&&(window.console.warn||window.console.log);return log&&log.call(window.console,deprecationMessage,stack),method.apply(this,arguments)}}function inherit(child,base,properties){var childP,baseP=base.prototype;childP=child.prototype=Object.create(baseP),childP.constructor=child,childP._super=baseP,properties&&assign(childP,properties)}function bindFn(fn,context){return function(){return fn.apply(context,arguments)}}function boolOrFn(val,args){return typeof val==TYPE_FUNCTION?val.apply(args?args[0]||undefined:undefined,args):val}function ifUndefined(val1,val2){return val1===undefined?val2:val1}function addEventListeners(target,types,handler){each(splitStr(types),function(type){target.addEventListener(type,handler,!1)})}function removeEventListeners(target,types,handler){each(splitStr(types),function(type){target.removeEventListener(type,handler,!1)})}function hasParent(node,parent){for(;node;){if(node==parent)return!0;node=node.parentNode}return!1}function inStr(str,find){return str.indexOf(find)>-1}function splitStr(str){return str.trim().split(/\s+/g)}function inArray(src,find,findByKey){if(src.indexOf&&!findByKey)return src.indexOf(find);for(var i=0;i<src.length;){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find)return i;i++}return-1}function toArray(obj){return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){for(var results=[],values=[],i=0;i<src.length;){var val=key?src[i][key]:src[i];inArray(values,val)<0&&results.push(src[i]),values[i]=val,i++}return sort&&(results=key?results.sort(function(a,b){return a[key]>b[key]}):results.sort()),results}function prefixed(obj,property){for(var prefix,prop,camelProp=property[0].toUpperCase()+property.slice(1),i=0;i<VENDOR_PREFIXES.length;){if(prefix=VENDOR_PREFIXES[i],prop=prefix?prefix+camelProp:property,prop in obj)return prop;i++}return undefined}function uniqueId(){return _uniqueId++}function getWindowForElement(element){var doc=element.ownerDocument||element;return doc.defaultView||doc.parentWindow||window}function Input(manager,callback){var self=this;this.manager=manager,this.callback=callback,this.element=manager.element,this.target=manager.options.inputTarget,this.domHandler=function(ev){boolOrFn(manager.options.enable,[manager])&&self.handler(ev)},this.init()}function createInputInstance(manager){var Type,inputClass=manager.options.inputClass;return new(Type=inputClass?inputClass:SUPPORT_POINTER_EVENTS?PointerEventInput:SUPPORT_ONLY_TOUCH?TouchInput:SUPPORT_TOUCH?TouchMouseInput:MouseInput)(manager,inputHandler)}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length,changedPointersLen=input.changedPointers.length,isFirst=eventType&INPUT_START&&pointersLen-changedPointersLen===0,isFinal=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen===0;input.isFirst=!!isFirst,input.isFinal=!!isFinal,isFirst&&(manager.session={}),input.eventType=eventType,computeInputData(manager,input),manager.emit("hammer.input",input),manager.recognize(input),manager.session.prevInput=input}function computeInputData(manager,input){var session=manager.session,pointers=input.pointers,pointersLength=pointers.length;session.firstInput||(session.firstInput=simpleCloneInputData(input)),pointersLength>1&&!session.firstMultiple?session.firstMultiple=simpleCloneInputData(input):1===pointersLength&&(session.firstMultiple=!1);var firstInput=session.firstInput,firstMultiple=session.firstMultiple,offsetCenter=firstMultiple?firstMultiple.center:firstInput.center,center=input.center=getCenter(pointers);input.timeStamp=now(),input.deltaTime=input.timeStamp-firstInput.timeStamp,input.angle=getAngle(offsetCenter,center),input.distance=getDistance(offsetCenter,center),computeDeltaXY(session,input),input.offsetDirection=getDirection(input.deltaX,input.deltaY);var overallVelocity=getVelocity(input.deltaTime,input.deltaX,input.deltaY);input.overallVelocityX=overallVelocity.x,input.overallVelocityY=overallVelocity.y,input.overallVelocity=abs(overallVelocity.x)>abs(overallVelocity.y)?overallVelocity.x:overallVelocity.y,input.scale=firstMultiple?getScale(firstMultiple.pointers,pointers):1,input.rotation=firstMultiple?getRotation(firstMultiple.pointers,pointers):0,input.maxPointers=session.prevInput?input.pointers.length>session.prevInput.maxPointers?input.pointers.length:session.prevInput.maxPointers:input.pointers.length,computeIntervalInputData(session,input);var target=manager.element;hasParent(input.srcEvent.target,target)&&(target=input.srcEvent.target),input.target=target}function computeDeltaXY(session,input){var center=input.center,offset=session.offsetDelta||{},prevDelta=session.prevDelta||{},prevInput=session.prevInput||{};(input.eventType===INPUT_START||prevInput.eventType===INPUT_END)&&(prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0},offset=session.offsetDelta={x:center.x,y:center.y}),input.deltaX=prevDelta.x+(center.x-offset.x),input.deltaY=prevDelta.y+(center.y-offset.y)}function computeIntervalInputData(session,input){var velocity,velocityX,velocityY,direction,last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp;if(input.eventType!=INPUT_CANCEL&&(deltaTime>COMPUTE_INTERVAL||last.velocity===undefined)){var deltaX=input.deltaX-last.deltaX,deltaY=input.deltaY-last.deltaY,v=getVelocity(deltaTime,deltaX,deltaY);velocityX=v.x,velocityY=v.y,velocity=abs(v.x)>abs(v.y)?v.x:v.y,direction=getDirection(deltaX,deltaY),session.lastInterval=input}else velocity=last.velocity,velocityX=last.velocityX,velocityY=last.velocityY,direction=last.direction;input.velocity=velocity,input.velocityX=velocityX,input.velocityY=velocityY,input.direction=direction}function simpleCloneInputData(input){for(var pointers=[],i=0;i<input.pointers.length;)pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)},i++;return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getCenter(pointers){var pointersLength=pointers.length;if(1===pointersLength)return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)};for(var x=0,y=0,i=0;pointersLength>i;)x+=pointers[i].clientX,y+=pointers[i].clientY,i++;return{x:round(x/pointersLength),y:round(y/pointersLength)}}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function getDirection(x,y){return x===y?DIRECTION_NONE:abs(x)>=abs(y)?0>x?DIRECTION_LEFT:DIRECTION_RIGHT:0>y?DIRECTION_UP:DIRECTION_DOWN}function getDistance(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y)}function getAngle(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return 180*Math.atan2(y,x)/Math.PI}function getRotation(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)+getAngle(start[1],start[0],PROPS_CLIENT_XY)}function getScale(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY)}function MouseInput(){this.evEl=MOUSE_ELEMENT_EVENTS,this.evWin=MOUSE_WINDOW_EVENTS,this.pressed=!1,Input.apply(this,arguments)}function PointerEventInput(){this.evEl=POINTER_ELEMENT_EVENTS,this.evWin=POINTER_WINDOW_EVENTS,Input.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function SingleTouchInput(){this.evTarget=SINGLE_TOUCH_TARGET_EVENTS,this.evWin=SINGLE_TOUCH_WINDOW_EVENTS,this.started=!1,Input.apply(this,arguments)}function normalizeSingleTouches(ev,type){var all=toArray(ev.touches),changed=toArray(ev.changedTouches);return type&(INPUT_END|INPUT_CANCEL)&&(all=uniqueArray(all.concat(changed),"identifier",!0)),[all,changed]}function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS,this.targetIds={},Input.apply(this,arguments)}function getTouches(ev,type){var allTouches=toArray(ev.touches),targetIds=this.targetIds;if(type&(INPUT_START|INPUT_MOVE)&&1===allTouches.length)return targetIds[allTouches[0].identifier]=!0,[allTouches,allTouches];var i,targetTouches,changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;if(targetTouches=allTouches.filter(function(touch){return hasParent(touch.target,target)}),type===INPUT_START)for(i=0;i<targetTouches.length;)targetIds[targetTouches[i].identifier]=!0,i++;for(i=0;i<changedTouches.length;)targetIds[changedTouches[i].identifier]&&changedTargetTouches.push(changedTouches[i]),type&(INPUT_END|INPUT_CANCEL)&&delete targetIds[changedTouches[i].identifier],i++;return changedTargetTouches.length?[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",!0),changedTargetTouches]:void 0}function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler),this.mouse=new MouseInput(this.manager,handler),this.primaryTouch=null,this.lastTouches=[]}function recordTouches(eventType,eventData){eventType&INPUT_START?(this.primaryTouch=eventData.changedPointers[0].identifier,setLastTouch.call(this,eventData)):eventType&(INPUT_END|INPUT_CANCEL)&&setLastTouch.call(this,eventData)}function setLastTouch(eventData){var touch=eventData.changedPointers[0];if(touch.identifier===this.primaryTouch){var lastTouch={x:touch.clientX,y:touch.clientY};this.lastTouches.push(lastTouch);var lts=this.lastTouches,removeLastTouch=function(){var i=lts.indexOf(lastTouch);i>-1&&lts.splice(i,1)};setTimeout(removeLastTouch,DEDUP_TIMEOUT)}}function isSyntheticEvent(eventData){for(var x=eventData.srcEvent.clientX,y=eventData.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var t=this.lastTouches[i],dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(DEDUP_DISTANCE>=dx&&DEDUP_DISTANCE>=dy)return!0}return!1}function TouchAction(manager,value){this.manager=manager,this.set(value)}function cleanTouchActions(actions){if(inStr(actions,TOUCH_ACTION_NONE))return TOUCH_ACTION_NONE;var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X),hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);return hasPanX&&hasPanY?TOUCH_ACTION_NONE:hasPanX||hasPanY?hasPanX?TOUCH_ACTION_PAN_X:TOUCH_ACTION_PAN_Y:inStr(actions,TOUCH_ACTION_MANIPULATION)?TOUCH_ACTION_MANIPULATION:TOUCH_ACTION_AUTO}function getTouchActionProps(){if(!NATIVE_TOUCH_ACTION)return!1;var touchMap={},cssSupports=window.CSS&&window.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(val){touchMap[val]=cssSupports?window.CSS.supports("touch-action",val):!0}),touchMap}function Recognizer(options){this.options=assign({},this.defaults,options||{}),this.id=uniqueId(),this.manager=null,this.options.enable=ifUndefined(this.options.enable,!0),this.state=STATE_POSSIBLE,this.simultaneous={},this.requireFail=[]}function stateStr(state){return state&STATE_CANCELLED?"cancel":state&STATE_ENDED?"end":state&STATE_CHANGED?"move":state&STATE_BEGAN?"start":""}function directionStr(direction){return direction==DIRECTION_DOWN?"down":direction==DIRECTION_UP?"up":direction==DIRECTION_LEFT?"left":direction==DIRECTION_RIGHT?"right":""}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;return manager?manager.get(otherRecognizer):otherRecognizer}function AttrRecognizer(){Recognizer.apply(this,arguments)}function PanRecognizer(){AttrRecognizer.apply(this,arguments),this.pX=null,this.pY=null}function PinchRecognizer(){AttrRecognizer.apply(this,arguments)}function PressRecognizer(){Recognizer.apply(this,arguments),this._timer=null,this._input=null}function RotateRecognizer(){AttrRecognizer.apply(this,arguments)}function SwipeRecognizer(){AttrRecognizer.apply(this,arguments)}function TapRecognizer(){Recognizer.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Hammer(element,options){return options=options||{},options.recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset),new Manager(element,options)}function Manager(element,options){this.options=assign({},Hammer.defaults,options||{}),this.options.inputTarget=this.options.inputTarget||element,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=element,this.input=createInputInstance(this),this.touchAction=new TouchAction(this,this.options.touchAction),toggleCssProps(this,!0),each(this.options.recognizers,function(item){var recognizer=this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]),item[3]&&recognizer.requireFailure(item[3])},this)}function toggleCssProps(manager,add){var element=manager.element;if(element.style){var prop;each(manager.options.cssProps,function(value,name){prop=prefixed(element.style,name),add?(manager.oldCssProps[prop]=element.style[prop],element.style[prop]=value):element.style[prop]=manager.oldCssProps[prop]||""}),add||(manager.oldCssProps={})}}function triggerDomEvent(event,data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,!0,!0),gestureEvent.gesture=data,data.target.dispatchEvent(gestureEvent)}var assign,VENDOR_PREFIXES=["","webkit","Moz","MS","ms","o"],TEST_ELEMENT=document.createElement("div"),TYPE_FUNCTION="function",round=Math.round,abs=Math.abs,now=Date.now;assign="function"!=typeof Object.assign?function(target){if(target===undefined||null===target)throw new TypeError("Cannot convert undefined or null to object");for(var output=Object(target),index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&null!==source)for(var nextKey in source)source.hasOwnProperty(nextKey)&&(output[nextKey]=source[nextKey])}return output}:Object.assign;var extend=deprecate(function(dest,src,merge){for(var keys=Object.keys(src),i=0;i<keys.length;)(!merge||merge&&dest[keys[i]]===undefined)&&(dest[keys[i]]=src[keys[i]]),i++;return dest},"extend","Use `assign`."),merge=deprecate(function(dest,src){return extend(dest,src,!0)},"merge","Use `assign`."),_uniqueId=1,MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i,SUPPORT_TOUCH="ontouchstart"in window,SUPPORT_POINTER_EVENTS=prefixed(window,"PointerEvent")!==undefined,SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&MOBILE_REGEX.test(navigator.userAgent),INPUT_TYPE_TOUCH="touch",INPUT_TYPE_PEN="pen",INPUT_TYPE_MOUSE="mouse",INPUT_TYPE_KINECT="kinect",COMPUTE_INTERVAL=25,INPUT_START=1,INPUT_MOVE=2,INPUT_END=4,INPUT_CANCEL=8,DIRECTION_NONE=1,DIRECTION_LEFT=2,DIRECTION_RIGHT=4,DIRECTION_UP=8,DIRECTION_DOWN=16,DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT,DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN,DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,PROPS_XY=["x","y"],PROPS_CLIENT_XY=["clientX","clientY"];Input.prototype={handler:function(){},init:function(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)}};var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:INPUT_MOVE,mouseup:INPUT_END},MOUSE_ELEMENT_EVENTS="mousedown",MOUSE_WINDOW_EVENTS="mousemove mouseup";inherit(MouseInput,Input,{handler:function(ev){var eventType=MOUSE_INPUT_MAP[ev.type];eventType&INPUT_START&&0===ev.button&&(this.pressed=!0),eventType&INPUT_MOVE&&1!==ev.which&&(eventType=INPUT_END),this.pressed&&(eventType&INPUT_END&&(this.pressed=!1),this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:INPUT_TYPE_MOUSE,srcEvent:ev}))}});var POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:INPUT_MOVE,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL},IE10_POINTER_TYPE_ENUM={2:INPUT_TYPE_TOUCH,3:INPUT_TYPE_PEN,4:INPUT_TYPE_MOUSE,5:INPUT_TYPE_KINECT},POINTER_ELEMENT_EVENTS="pointerdown",POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";window.MSPointerEvent&&!window.PointerEvent&&(POINTER_ELEMENT_EVENTS="MSPointerDown",POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel"),inherit(PointerEventInput,Input,{handler:function(ev){var store=this.store,removePointer=!1,eventTypeNormalized=ev.type.toLowerCase().replace("ms",""),eventType=POINTER_INPUT_MAP[eventTypeNormalized],pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType,isTouch=pointerType==INPUT_TYPE_TOUCH,storeIndex=inArray(store,ev.pointerId,"pointerId");eventType&INPUT_START&&(0===ev.button||isTouch)?0>storeIndex&&(store.push(ev),storeIndex=store.length-1):eventType&(INPUT_END|INPUT_CANCEL)&&(removePointer=!0),0>storeIndex||(store[storeIndex]=ev,this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev}),removePointer&&store.splice(storeIndex,1))}});var SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL},SINGLE_TOUCH_TARGET_EVENTS="touchstart",SINGLE_TOUCH_WINDOW_EVENTS="touchstart touchmove touchend touchcancel";inherit(SingleTouchInput,Input,{handler:function(ev){var type=SINGLE_TOUCH_INPUT_MAP[ev.type];if(type===INPUT_START&&(this.started=!0),this.started){var touches=normalizeSingleTouches.call(this,ev,type);type&(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length===0&&(this.started=!1),this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}}});var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL},TOUCH_TARGET_EVENTS="touchstart touchmove touchend touchcancel";inherit(TouchInput,Input,{handler:function(ev){var type=TOUCH_INPUT_MAP[ev.type],touches=getTouches.call(this,ev,type);touches&&this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}});var DEDUP_TIMEOUT=2500,DEDUP_DISTANCE=25;inherit(TouchMouseInput,Input,{handler:function(manager,inputEvent,inputData){var isTouch=inputData.pointerType==INPUT_TYPE_TOUCH,isMouse=inputData.pointerType==INPUT_TYPE_MOUSE;if(!(isMouse&&inputData.sourceCapabilities&&inputData.sourceCapabilities.firesTouchEvents)){if(isTouch)recordTouches.call(this,inputEvent,inputData);else if(isMouse&&isSyntheticEvent.call(this,inputData))return;this.callback(manager,inputEvent,inputData)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction"),NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined,TOUCH_ACTION_COMPUTE="compute",TOUCH_ACTION_AUTO="auto",TOUCH_ACTION_MANIPULATION="manipulation",TOUCH_ACTION_NONE="none",TOUCH_ACTION_PAN_X="pan-x",TOUCH_ACTION_PAN_Y="pan-y",TOUCH_ACTION_MAP=getTouchActionProps();TouchAction.prototype={set:function(value){value==TOUCH_ACTION_COMPUTE&&(value=this.compute()),NATIVE_TOUCH_ACTION&&this.manager.element.style&&TOUCH_ACTION_MAP[value]&&(this.manager.element.style[PREFIXED_TOUCH_ACTION]=value),this.actions=value.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var actions=[];return each(this.manager.recognizers,function(recognizer){boolOrFn(recognizer.options.enable,[recognizer])&&(actions=actions.concat(recognizer.getTouchAction()))}),cleanTouchActions(actions.join(" "))},preventDefaults:function(input){var srcEvent=input.srcEvent,direction=input.offsetDirection;if(this.manager.session.prevented)return void srcEvent.preventDefault();var actions=this.actions,hasNone=inStr(actions,TOUCH_ACTION_NONE)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_NONE],hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y],hasPanX=inStr(actions,TOUCH_ACTION_PAN_X)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];if(hasNone){var isTapPointer=1===input.pointers.length,isTapMovement=input.distance<2,isTapTouchTime=input.deltaTime<250;if(isTapPointer&&isTapMovement&&isTapTouchTime)return}return hasPanX&&hasPanY?void 0:hasNone||hasPanY&&direction&DIRECTION_HORIZONTAL||hasPanX&&direction&DIRECTION_VERTICAL?this.preventSrc(srcEvent):void 0},preventSrc:function(srcEvent){this.manager.session.prevented=!0,srcEvent.preventDefault()}};var STATE_POSSIBLE=1,STATE_BEGAN=2,STATE_CHANGED=4,STATE_ENDED=8,STATE_RECOGNIZED=STATE_ENDED,STATE_CANCELLED=16,STATE_FAILED=32;Recognizer.prototype={defaults:{},set:function(options){return assign(this.options,options),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"recognizeWith",this))return this;var simultaneous=this.simultaneous;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),simultaneous[otherRecognizer.id]||(simultaneous[otherRecognizer.id]=otherRecognizer,otherRecognizer.recognizeWith(this)),this},dropRecognizeWith:function(otherRecognizer){return invokeArrayArg(otherRecognizer,"dropRecognizeWith",this)?this:(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),delete this.simultaneous[otherRecognizer.id],this)},requireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this))return this;var requireFail=this.requireFail;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),-1===inArray(requireFail,otherRecognizer)&&(requireFail.push(otherRecognizer),otherRecognizer.requireFailure(this)),this},dropRequireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this))return this;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);return index>-1&&this.requireFail.splice(index,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]},emit:function(input){function emit(event){self.manager.emit(event,input)}var self=this,state=this.state;STATE_ENDED>state&&emit(self.options.event+stateStr(state)),emit(self.options.event),input.additionalEvent&&emit(input.additionalEvent),state>=STATE_ENDED&&emit(self.options.event+stateStr(state))},tryEmit:function(input){return this.canEmit()?this.emit(input):void(this.state=STATE_FAILED)},canEmit:function(){for(var i=0;i<this.requireFail.length;){if(!(this.requireFail[i].state&(STATE_FAILED|STATE_POSSIBLE)))return!1;i++}return!0},recognize:function(inputData){var inputDataClone=assign({},inputData);return boolOrFn(this.options.enable,[this,inputDataClone])?(this.state&(STATE_RECOGNIZED|STATE_CANCELLED|STATE_FAILED)&&(this.state=STATE_POSSIBLE),this.state=this.process(inputDataClone),void(this.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED|STATE_CANCELLED)&&this.tryEmit(inputDataClone))):(this.reset(),void(this.state=STATE_FAILED))},process:function(inputData){},getTouchAction:function(){},reset:function(){}},inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function(input){var optionPointers=this.options.pointers;return 0===optionPointers||input.pointers.length===optionPointers},process:function(input){var state=this.state,eventType=input.eventType,isRecognized=state&(STATE_BEGAN|STATE_CHANGED),isValid=this.attrTest(input);return isRecognized&&(eventType&INPUT_CANCEL||!isValid)?state|STATE_CANCELLED:isRecognized||isValid?eventType&INPUT_END?state|STATE_ENDED:state&STATE_BEGAN?state|STATE_CHANGED:STATE_BEGAN:STATE_FAILED}}),inherit(PanRecognizer,AttrRecognizer,{defaults:{event:"pan",threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function(){var direction=this.options.direction,actions=[];return direction&DIRECTION_HORIZONTAL&&actions.push(TOUCH_ACTION_PAN_Y),direction&DIRECTION_VERTICAL&&actions.push(TOUCH_ACTION_PAN_X),actions},directionTest:function(input){var options=this.options,hasMoved=!0,distance=input.distance,direction=input.direction,x=input.deltaX,y=input.deltaY;return direction&options.direction||(options.direction&DIRECTION_HORIZONTAL?(direction=0===x?DIRECTION_NONE:0>x?DIRECTION_LEFT:DIRECTION_RIGHT,hasMoved=x!=this.pX,distance=Math.abs(input.deltaX)):(direction=0===y?DIRECTION_NONE:0>y?DIRECTION_UP:DIRECTION_DOWN,hasMoved=y!=this.pY,distance=Math.abs(input.deltaY))),input.direction=direction,hasMoved&&distance>options.threshold&&direction&options.direction},attrTest:function(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(this.state&STATE_BEGAN||!(this.state&STATE_BEGAN)&&this.directionTest(input))},emit:function(input){this.pX=input.deltaX,this.pY=input.deltaY;var direction=directionStr(input.direction);direction&&(input.additionalEvent=this.options.event+direction),this._super.emit.call(this,input)}}),inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||this.state&STATE_BEGAN)},emit:function(input){if(1!==input.scale){var inOut=input.scale<1?"in":"out";input.additionalEvent=this.options.event+inOut}this._super.emit.call(this,input)}}),inherit(PressRecognizer,Recognizer,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[TOUCH_ACTION_AUTO]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTime=input.deltaTime>options.time;if(this._input=input,!validMovement||!validPointers||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime)this.reset();else if(input.eventType&INPUT_START)this.reset(),this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit()},options.time,this);else if(input.eventType&INPUT_END)return STATE_RECOGNIZED;return STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(input){this.state===STATE_RECOGNIZED&&(input&&input.eventType&INPUT_END?this.manager.emit(this.options.event+"up",input):(this._input.timeStamp=now(),this.manager.emit(this.options.event,this._input)))}}),inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||this.state&STATE_BEGAN)}}),inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function(){return PanRecognizer.prototype.getTouchAction.call(this)},attrTest:function(input){var velocity,direction=this.options.direction;return direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL)?velocity=input.overallVelocity:direction&DIRECTION_HORIZONTAL?velocity=input.overallVelocityX:direction&DIRECTION_VERTICAL&&(velocity=input.overallVelocityY),this._super.attrTest.call(this,input)&&direction&input.offsetDirection&&input.distance>this.options.threshold&&input.maxPointers==this.options.pointers&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END},emit:function(input){var direction=directionStr(input.offsetDirection);direction&&this.manager.emit(this.options.event+direction,input),this.manager.emit(this.options.event,input)}}),inherit(TapRecognizer,Recognizer,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[TOUCH_ACTION_MANIPULATION]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTouchTime=input.deltaTime<options.time;if(this.reset(),input.eventType&INPUT_START&&0===this.count)return this.failTimeout();if(validMovement&&validTouchTime&&validPointers){if(input.eventType!=INPUT_END)return this.failTimeout();var validInterval=this.pTime?input.timeStamp-this.pTime<options.interval:!0,validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;this.pTime=input.timeStamp,this.pCenter=input.center,validMultiTap&&validInterval?this.count+=1:this.count=1,this._input=input;var tapCount=this.count%options.taps;if(0===tapCount)return this.hasRequireFailures()?(this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit()},options.interval,this),STATE_BEGAN):STATE_RECOGNIZED}return STATE_FAILED},failTimeout:function(){return this._timer=setTimeoutContext(function(){this.state=STATE_FAILED},this.options.interval,this),STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==STATE_RECOGNIZED&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Hammer.VERSION="2.0.7",Hammer.defaults={domEvents:!1,touchAction:TOUCH_ACTION_COMPUTE,enable:!0,inputTarget:null,inputClass:null,preset:[[RotateRecognizer,{enable:!1}],[PinchRecognizer,{enable:!1},["rotate"]],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var STOP=1,FORCED_STOP=2;Manager.prototype={set:function(options){return assign(this.options,options),
options.touchAction&&this.touchAction.update(),options.inputTarget&&(this.input.destroy(),this.input.target=options.inputTarget,this.input.init()),this},stop:function(force){this.session.stopped=force?FORCED_STOP:STOP},recognize:function(inputData){var session=this.session;if(!session.stopped){this.touchAction.preventDefaults(inputData);var recognizer,recognizers=this.recognizers,curRecognizer=session.curRecognizer;(!curRecognizer||curRecognizer&&curRecognizer.state&STATE_RECOGNIZED)&&(curRecognizer=session.curRecognizer=null);for(var i=0;i<recognizers.length;)recognizer=recognizers[i],session.stopped===FORCED_STOP||curRecognizer&&recognizer!=curRecognizer&&!recognizer.canRecognizeWith(curRecognizer)?recognizer.reset():recognizer.recognize(inputData),!curRecognizer&&recognizer.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED)&&(curRecognizer=session.curRecognizer=recognizer),i++}},get:function(recognizer){if(recognizer instanceof Recognizer)return recognizer;for(var recognizers=this.recognizers,i=0;i<recognizers.length;i++)if(recognizers[i].options.event==recognizer)return recognizers[i];return null},add:function(recognizer){if(invokeArrayArg(recognizer,"add",this))return this;var existing=this.get(recognizer.options.event);return existing&&this.remove(existing),this.recognizers.push(recognizer),recognizer.manager=this,this.touchAction.update(),recognizer},remove:function(recognizer){if(invokeArrayArg(recognizer,"remove",this))return this;if(recognizer=this.get(recognizer)){var recognizers=this.recognizers,index=inArray(recognizers,recognizer);-1!==index&&(recognizers.splice(index,1),this.touchAction.update())}return this},on:function(events,handler){if(events!==undefined&&handler!==undefined){var handlers=this.handlers;return each(splitStr(events),function(event){handlers[event]=handlers[event]||[],handlers[event].push(handler)}),this}},off:function(events,handler){if(events!==undefined){var handlers=this.handlers;return each(splitStr(events),function(event){handler?handlers[event]&&handlers[event].splice(inArray(handlers[event],handler),1):delete handlers[event]}),this}},emit:function(event,data){this.options.domEvents&&triggerDomEvent(event,data);var handlers=this.handlers[event]&&this.handlers[event].slice();if(handlers&&handlers.length){data.type=event,data.preventDefault=function(){data.srcEvent.preventDefault()};for(var i=0;i<handlers.length;)handlers[i](data),i++}},destroy:function(){this.element&&toggleCssProps(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},assign(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:INPUT_MOVE,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:STATE_BEGAN,STATE_CHANGED:STATE_CHANGED,STATE_ENDED:STATE_ENDED,STATE_RECOGNIZED:STATE_RECOGNIZED,STATE_CANCELLED:STATE_CANCELLED,STATE_FAILED:STATE_FAILED,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,assign:assign,inherit:inherit,bindFn:bindFn,prefixed:prefixed});var freeGlobal="undefined"!=typeof window?window:"undefined"!=typeof self?self:{};freeGlobal.Hammer=Hammer,"function"==typeof define&&define.amd?define("hammerjs",[],function(){return Hammer}):"undefined"!=typeof module&&module.exports?module.exports=Hammer:window[exportName]=Hammer}(window,document,"Hammer"),function(window,angular,undefined){"use strict";function $$CookieWriter($document,$log,$browser){function buildCookieString(name,value,options){var path,expires;options=options||{},expires=options.expires,path=angular.isDefined(options.path)?options.path:cookiePath,angular.isUndefined(value)&&(expires="Thu, 01 Jan 1970 00:00:00 GMT",value=""),angular.isString(expires)&&(expires=new Date(expires));var str=encodeURIComponent(name)+"="+encodeURIComponent(value);str+=path?";path="+path:"",str+=options.domain?";domain="+options.domain:"",str+=expires?";expires="+expires.toUTCString():"",str+=options.secure?";secure":"";var cookieLength=str.length+1;return cookieLength>4096&&$log.warn("Cookie '"+name+"' possibly not set or overflowed because it was too large ("+cookieLength+" > 4096 bytes)!"),str}var cookiePath=$browser.baseHref(),rawDocument=$document[0];return function(name,value,options){rawDocument.cookie=buildCookieString(name,value,options)}}angular.module("ngCookies",["ng"]).provider("$cookies",[function(){function calcOptions(options){return options?angular.extend({},defaults,options):defaults}var defaults=this.defaults={};this.$get=["$$cookieReader","$$cookieWriter",function($$cookieReader,$$cookieWriter){return{get:function(key){return $$cookieReader()[key]},getObject:function(key){var value=this.get(key);return value?angular.fromJson(value):value},getAll:function(){return $$cookieReader()},put:function(key,value,options){$$cookieWriter(key,value,calcOptions(options))},putObject:function(key,value,options){this.put(key,angular.toJson(value),options)},remove:function(key,options){$$cookieWriter(key,undefined,calcOptions(options))}}}]}]),angular.module("ngCookies").factory("$cookieStore",["$cookies",function($cookies){return{get:function(key){return $cookies.getObject(key)},put:function(key,value){$cookies.putObject(key,value)},remove:function(key){$cookies.remove(key)}}}]),$$CookieWriter.$inject=["$document","$log","$browser"],angular.module("ngCookies").provider("$$cookieWriter",function(){this.$get=$$CookieWriter})}(window,window.angular),define("angular-cookies",["angular"],function(){}),function(root,factory){"function"==typeof define&&define.amd?define("svgjs",[],function(){return factory(root,root.document)}):"object"==typeof exports?module.exports=root.document?factory(root,root.document):function(w){return factory(w,w.document)}:root.SVG=factory(root,root.document)}("undefined"!=typeof window?window:this,function(window,document){function pathRegReplace(a,b,c,d){return c+d.replace(SVG.regex.dots," .")}function array_clone(arr){for(var clone=arr.slice(0),i=clone.length;i--;)Array.isArray(clone[i])&&(clone[i]=array_clone(clone[i]));return clone}function is(el,obj){return el instanceof obj}function matches(el,selector){return(el.matches||el.matchesSelector||el.msMatchesSelector||el.mozMatchesSelector||el.webkitMatchesSelector||el.oMatchesSelector).call(el,selector)}function camelCase(s){return s.toLowerCase().replace(/-(.)/g,function(m,g){return g.toUpperCase()})}function capitalize(s){return s.charAt(0).toUpperCase()+s.slice(1)}function fullHex(hex){return 4==hex.length?["#",hex.substring(1,2),hex.substring(1,2),hex.substring(2,3),hex.substring(2,3),hex.substring(3,4),hex.substring(3,4)].join(""):hex}function compToHex(comp){var hex=comp.toString(16);return 1==hex.length?"0"+hex:hex}function proportionalSize(element,width,height){if(null==width||null==height){var box=element.bbox();null==width?width=box.width/box.height*height:null==height&&(height=box.height/box.width*width)}return{width:width,height:height}}function deltaTransformPoint(matrix,x,y){return{x:x*matrix.a+y*matrix.c+0,y:x*matrix.b+y*matrix.d+0}}function arrayToMatrix(a){return{a:a[0],b:a[1],c:a[2],d:a[3],e:a[4],f:a[5]}}function parseMatrix(matrix){return matrix instanceof SVG.Matrix||(matrix=new SVG.Matrix(matrix)),matrix}function ensureCentre(o,target){o.cx=null==o.cx?target.bbox().cx:o.cx,o.cy=null==o.cy?target.bbox().cy:o.cy}function arrayToString(a){for(var i=0,il=a.length,s="";il>i;i++)s+=a[i][0],null!=a[i][1]&&(s+=a[i][1],null!=a[i][2]&&(s+=" ",s+=a[i][2],null!=a[i][3]&&(s+=" ",s+=a[i][3],s+=" ",s+=a[i][4],null!=a[i][5]&&(s+=" ",s+=a[i][5],s+=" ",s+=a[i][6],null!=a[i][7]&&(s+=" ",s+=a[i][7])))));return s+" "}function assignNewId(node){for(var i=node.childNodes.length-1;i>=0;i--)node.childNodes[i]instanceof window.SVGElement&&assignNewId(node.childNodes[i]);return SVG.adopt(node).id(SVG.eid(node.nodeName))}function fullBox(b){return null==b.x&&(b.x=0,b.y=0,b.width=0,b.height=0),b.w=b.width,b.h=b.height,b.x2=b.x+b.width,b.y2=b.y+b.height,b.cx=b.x+b.width/2,b.cy=b.y+b.height/2,b}function idFromReference(url){var m=url.toString().match(SVG.regex.reference);return m?m[1]:void 0}var SVG=this.SVG=function(element){return SVG.supported?(element=new SVG.Doc(element),SVG.parser.draw||SVG.prepare(),element):void 0};if(SVG.ns="http://www.w3.org/2000/svg",SVG.xmlns="http://www.w3.org/2000/xmlns/",SVG.xlink="http://www.w3.org/1999/xlink",SVG.svgjs="http://svgjs.com/svgjs",SVG.supported=function(){return!!document.createElementNS&&!!document.createElementNS(SVG.ns,"svg").createSVGRect}(),!SVG.supported)return!1;SVG.did=1e3,SVG.eid=function(name){return"Svgjs"+capitalize(name)+SVG.did++},SVG.create=function(name){var element=document.createElementNS(this.ns,name);return element.setAttribute("id",this.eid(name)),element},SVG.extend=function(){var modules,methods,key,i;for(modules=[].slice.call(arguments),methods=modules.pop(),i=modules.length-1;i>=0;i--)if(modules[i])for(key in methods)modules[i].prototype[key]=methods[key];SVG.Set&&SVG.Set.inherit&&SVG.Set.inherit()},SVG.invent=function(config){var initializer="function"==typeof config.create?config.create:function(){this.constructor.call(this,SVG.create(config.create))};return config.inherit&&(initializer.prototype=new config.inherit),config.extend&&SVG.extend(initializer,config.extend),config.construct&&SVG.extend(config.parent||SVG.Container,config.construct),initializer},SVG.adopt=function(node){if(!node)return null;if(node.instance)return node.instance;var element;return element="svg"==node.nodeName?node.parentNode instanceof window.SVGElement?new SVG.Nested:new SVG.Doc:"linearGradient"==node.nodeName?new SVG.Gradient("linear"):"radialGradient"==node.nodeName?new SVG.Gradient("radial"):SVG[capitalize(node.nodeName)]?new(SVG[capitalize(node.nodeName)]):new SVG.Element(node),element.type=node.nodeName,element.node=node,node.instance=element,element instanceof SVG.Doc&&element.namespace().defs(),element.setData(JSON.parse(node.getAttribute("svgjs:data"))||{}),element},SVG.prepare=function(){var body=document.getElementsByTagName("body")[0],draw=(body?new SVG.Doc(body):SVG.adopt(document.documentElement).nested()).size(2,0);SVG.parser={body:body||document.documentElement,draw:draw.style("opacity:0;position:absolute;left:-100%;top:-100%;overflow:hidden"),poly:draw.polyline().node,path:draw.path().node,"native":SVG.create("svg")}},SVG.parser={"native":SVG.create("svg")},document.addEventListener("DOMContentLoaded",function(){SVG.parser.draw||SVG.prepare()},!1),SVG.regex={numberAndUnit:/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,hex:/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,rgb:/rgb\((\d+),(\d+),(\d+)\)/,reference:/#([a-z0-9\-_]+)/i,transforms:/\)\s*,?\s*/,whitespace:/\s/g,isHex:/^#[a-f0-9]{3,6}$/i,isRgb:/^rgb\(/,isCss:/[^:]+:[^;]+;?/,isBlank:/^(\s+)?$/,isNumber:/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,isPercent:/^-?[\d\.]+%$/,isImage:/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,delimiter:/[\s,]+/,hyphen:/([^e])\-/gi,pathLetters:/[MLHVCSQTAZ]/gi,isPathLetter:/[MLHVCSQTAZ]/i,numbersWithDots:/((\d?\.\d+(?:e[+-]?\d+)?)((?:\.\d+(?:e[+-]?\d+)?)+))+/gi,dots:/\./g},SVG.utils={map:function(array,block){var i,il=array.length,result=[];for(i=0;il>i;i++)result.push(block(array[i]));return result},filter:function(array,block){var i,il=array.length,result=[];for(i=0;il>i;i++)block(array[i])&&result.push(array[i]);return result},radians:function(d){return d%360*Math.PI/180},degrees:function(r){return 180*r/Math.PI%360},filterSVGElements:function(nodes){return this.filter(nodes,function(el){return el instanceof window.SVGElement})}},SVG.defaults={attrs:{"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","font-size":16,"font-family":"Helvetica, Arial, sans-serif","text-anchor":"start"}},SVG.Color=function(color){var match;this.r=0,this.g=0,this.b=0,color&&("string"==typeof color?SVG.regex.isRgb.test(color)?(match=SVG.regex.rgb.exec(color.replace(SVG.regex.whitespace,"")),this.r=parseInt(match[1]),this.g=parseInt(match[2]),this.b=parseInt(match[3])):SVG.regex.isHex.test(color)&&(match=SVG.regex.hex.exec(fullHex(color)),this.r=parseInt(match[1],16),this.g=parseInt(match[2],16),this.b=parseInt(match[3],16)):"object"==typeof color&&(this.r=color.r,this.g=color.g,this.b=color.b))},SVG.extend(SVG.Color,{toString:function(){return this.toHex()},toHex:function(){return"#"+compToHex(this.r)+compToHex(this.g)+compToHex(this.b)},toRgb:function(){return"rgb("+[this.r,this.g,this.b].join()+")"},brightness:function(){return this.r/255*.3+this.g/255*.59+this.b/255*.11},morph:function(color){return this.destination=new SVG.Color(color),this},at:function(pos){return this.destination?(pos=0>pos?0:pos>1?1:pos,new SVG.Color({r:~~(this.r+(this.destination.r-this.r)*pos),g:~~(this.g+(this.destination.g-this.g)*pos),b:~~(this.b+(this.destination.b-this.b)*pos)})):this}}),SVG.Color.test=function(color){return color+="",SVG.regex.isHex.test(color)||SVG.regex.isRgb.test(color)},SVG.Color.isRgb=function(color){return color&&"number"==typeof color.r&&"number"==typeof color.g&&"number"==typeof color.b},SVG.Color.isColor=function(color){return SVG.Color.isRgb(color)||SVG.Color.test(color)},SVG.Array=function(array,fallback){array=(array||[]).valueOf(),0==array.length&&fallback&&(array=fallback.valueOf()),this.value=this.parse(array)},SVG.extend(SVG.Array,{morph:function(array){if(this.destination=this.parse(array),this.value.length!=this.destination.length){for(var lastValue=this.value[this.value.length-1],lastDestination=this.destination[this.destination.length-1];this.value.length>this.destination.length;)this.destination.push(lastDestination);for(;this.value.length<this.destination.length;)this.value.push(lastValue)}return this},settle:function(){for(var i=0,il=this.value.length,seen=[];il>i;i++)-1==seen.indexOf(this.value[i])&&seen.push(this.value[i]);return this.value=seen},at:function(pos){if(!this.destination)return this;for(var i=0,il=this.value.length,array=[];il>i;i++)array.push(this.value[i]+(this.destination[i]-this.value[i])*pos);return new SVG.Array(array)},toString:function(){return this.value.join(" ")},valueOf:function(){return this.value},parse:function(array){return array=array.valueOf(),Array.isArray(array)?array:this.split(array)},split:function(string){return string.trim().split(SVG.regex.delimiter).map(parseFloat)},reverse:function(){return this.value.reverse(),this},clone:function(){var clone=new this.constructor;return clone.value=array_clone(this.value),clone}}),SVG.PointArray=function(array,fallback){SVG.Array.call(this,array,fallback||[[0,0]])},SVG.PointArray.prototype=new SVG.Array,SVG.PointArray.prototype.constructor=SVG.PointArray,SVG.extend(SVG.PointArray,{toString:function(){for(var i=0,il=this.value.length,array=[];il>i;i++)array.push(this.value[i].join(","));return array.join(" ")},toLine:function(){return{x1:this.value[0][0],y1:this.value[0][1],x2:this.value[1][0],y2:this.value[1][1]}},at:function(pos){if(!this.destination)return this;for(var i=0,il=this.value.length,array=[];il>i;i++)array.push([this.value[i][0]+(this.destination[i][0]-this.value[i][0])*pos,this.value[i][1]+(this.destination[i][1]-this.value[i][1])*pos]);return new SVG.PointArray(array)},parse:function(array){var points=[];if(array=array.valueOf(),Array.isArray(array)){if(Array.isArray(array[0]))return array}else array=array.trim().split(SVG.regex.delimiter).map(parseFloat);array.length%2!==0&&array.pop();for(var i=0,len=array.length;len>i;i+=2)points.push([array[i],array[i+1]]);return points},move:function(x,y){var box=this.bbox();if(x-=box.x,y-=box.y,!isNaN(x)&&!isNaN(y))for(var i=this.value.length-1;i>=0;i--)this.value[i]=[this.value[i][0]+x,this.value[i][1]+y];return this},size:function(width,height){var i,box=this.bbox();for(i=this.value.length-1;i>=0;i--)box.width&&(this.value[i][0]=(this.value[i][0]-box.x)*width/box.width+box.x),box.height&&(this.value[i][1]=(this.value[i][1]-box.y)*height/box.height+box.y);return this},bbox:function(){return SVG.parser.poly.setAttribute("points",this.toString()),SVG.parser.poly.getBBox()}}),SVG.PathArray=function(array,fallback){SVG.Array.call(this,array,fallback||[["M",0,0]])},SVG.PathArray.prototype=new SVG.Array,SVG.PathArray.prototype.constructor=SVG.PathArray,SVG.extend(SVG.PathArray,{toString:function(){return arrayToString(this.value)},move:function(x,y){var box=this.bbox();if(x-=box.x,y-=box.y,!isNaN(x)&&!isNaN(y))for(var l,i=this.value.length-1;i>=0;i--)l=this.value[i][0],"M"==l||"L"==l||"T"==l?(this.value[i][1]+=x,this.value[i][2]+=y):"H"==l?this.value[i][1]+=x:"V"==l?this.value[i][1]+=y:"C"==l||"S"==l||"Q"==l?(this.value[i][1]+=x,this.value[i][2]+=y,this.value[i][3]+=x,this.value[i][4]+=y,"C"==l&&(this.value[i][5]+=x,this.value[i][6]+=y)):"A"==l&&(this.value[i][6]+=x,this.value[i][7]+=y);return this},size:function(width,height){var i,l,box=this.bbox();for(i=this.value.length-1;i>=0;i--)l=this.value[i][0],"M"==l||"L"==l||"T"==l?(this.value[i][1]=(this.value[i][1]-box.x)*width/box.width+box.x,this.value[i][2]=(this.value[i][2]-box.y)*height/box.height+box.y):"H"==l?this.value[i][1]=(this.value[i][1]-box.x)*width/box.width+box.x:"V"==l?this.value[i][1]=(this.value[i][1]-box.y)*height/box.height+box.y:"C"==l||"S"==l||"Q"==l?(this.value[i][1]=(this.value[i][1]-box.x)*width/box.width+box.x,this.value[i][2]=(this.value[i][2]-box.y)*height/box.height+box.y,this.value[i][3]=(this.value[i][3]-box.x)*width/box.width+box.x,this.value[i][4]=(this.value[i][4]-box.y)*height/box.height+box.y,"C"==l&&(this.value[i][5]=(this.value[i][5]-box.x)*width/box.width+box.x,this.value[i][6]=(this.value[i][6]-box.y)*height/box.height+box.y)):"A"==l&&(this.value[i][1]=this.value[i][1]*width/box.width,this.value[i][2]=this.value[i][2]*height/box.height,this.value[i][6]=(this.value[i][6]-box.x)*width/box.width+box.x,this.value[i][7]=(this.value[i][7]-box.y)*height/box.height+box.y);return this},equalCommands:function(pathArray){var i,il,equalCommands;for(pathArray=new SVG.PathArray(pathArray),equalCommands=this.value.length===pathArray.value.length,i=0,il=this.value.length;equalCommands&&il>i;i++)equalCommands=this.value[i][0]===pathArray.value[i][0];return equalCommands},morph:function(pathArray){return pathArray=new SVG.PathArray(pathArray),this.equalCommands(pathArray)?this.destination=pathArray:this.destination=null,this},at:function(pos){if(!this.destination)return this;var i,il,j,jl,sourceArray=this.value,destinationArray=this.destination.value,array=[],pathArray=new SVG.PathArray;for(i=0,il=sourceArray.length;il>i;i++){for(array[i]=[sourceArray[i][0]],j=1,jl=sourceArray[i].length;jl>j;j++)array[i][j]=sourceArray[i][j]+(destinationArray[i][j]-sourceArray[i][j])*pos;"A"===array[i][0]&&(array[i][4]=+(0!=array[i][4]),array[i][5]=+(0!=array[i][5]))}return pathArray.value=array,pathArray},parse:function(array){if(array instanceof SVG.PathArray)return array.valueOf();var i,x0,y0,s,seg,arr,x=0,y=0,paramCnt={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7};array="string"==typeof array?array.replace(SVG.regex.numbersWithDots,pathRegReplace).replace(SVG.regex.pathLetters," $& ").replace(SVG.regex.hyphen,"$1 -").trim().split(SVG.regex.delimiter):array.reduce(function(prev,curr){return[].concat.call(prev,curr)},[]);var arr=[];do{for(SVG.regex.isPathLetter.test(array[0])?(s=array[0],array.shift()):"M"==s?s="L":"m"==s&&(s="l"),seg=[s.toUpperCase()],i=0;i<paramCnt[seg[0]];++i)seg.push(parseFloat(array.shift()));s==seg[0]?"M"==s||"L"==s||"C"==s||"Q"==s||"S"==s||"T"==s?(x=seg[paramCnt[seg[0]]-1],y=seg[paramCnt[seg[0]]]):"V"==s?y=seg[1]:"H"==s?x=seg[1]:"A"==s&&(x=seg[6],y=seg[7]):"m"==s||"l"==s||"c"==s||"s"==s||"q"==s||"t"==s?(seg[1]+=x,seg[2]+=y,null!=seg[3]&&(seg[3]+=x,seg[4]+=y),null!=seg[5]&&(seg[5]+=x,seg[6]+=y),x=seg[paramCnt[seg[0]]-1],y=seg[paramCnt[seg[0]]]):"v"==s?(seg[1]+=y,y=seg[1]):"h"==s?(seg[1]+=x,x=seg[1]):"a"==s&&(seg[6]+=x,seg[7]+=y,x=seg[6],y=seg[7]),"M"==seg[0]&&(x0=x,y0=y),"Z"==seg[0]&&(x=x0,y=y0),arr.push(seg)}while(array.length);return arr},bbox:function(){return SVG.parser.path.setAttribute("d",this.toString()),SVG.parser.path.getBBox()}}),SVG.Number=SVG.invent({create:function(value,unit){this.value=0,this.unit=unit||"","number"==typeof value?this.value=isNaN(value)?0:isFinite(value)?value:0>value?-3.4e38:3.4e38:"string"==typeof value?(unit=value.match(SVG.regex.numberAndUnit),unit&&(this.value=parseFloat(unit[1]),"%"==unit[5]?this.value/=100:"s"==unit[5]&&(this.value*=1e3),this.unit=unit[5])):value instanceof SVG.Number&&(this.value=value.valueOf(),this.unit=value.unit)},extend:{toString:function(){return("%"==this.unit?~~(1e8*this.value)/1e6:"s"==this.unit?this.value/1e3:this.value)+this.unit},toJSON:function(){return this.toString()},valueOf:function(){return this.value},plus:function(number){return number=new SVG.Number(number),new SVG.Number(this+number,this.unit||number.unit)},minus:function(number){return number=new SVG.Number(number),new SVG.Number(this-number,this.unit||number.unit)},times:function(number){return number=new SVG.Number(number),new SVG.Number(this*number,this.unit||number.unit)},divide:function(number){return number=new SVG.Number(number),new SVG.Number(this/number,this.unit||number.unit)},to:function(unit){var number=new SVG.Number(this);return"string"==typeof unit&&(number.unit=unit),number},morph:function(number){return this.destination=new SVG.Number(number),number.relative&&(this.destination.value+=this.value),this},at:function(pos){return this.destination?new SVG.Number(this.destination).minus(this).times(pos).plus(this):this}}}),SVG.Element=SVG.invent({create:function(node){this._stroke=SVG.defaults.attrs.stroke,this._event=null,this.dom={},(this.node=node)&&(this.type=node.nodeName,this.node.instance=this,this._stroke=node.getAttribute("stroke")||this._stroke)},extend:{x:function(x){return this.attr("x",x)},y:function(y){return this.attr("y",y)},cx:function(x){return null==x?this.x()+this.width()/2:this.x(x-this.width()/2)},cy:function(y){return null==y?this.y()+this.height()/2:this.y(y-this.height()/2)},move:function(x,y){return this.x(x).y(y)},center:function(x,y){return this.cx(x).cy(y)},width:function(width){return this.attr("width",width)},height:function(height){return this.attr("height",height)},size:function(width,height){var p=proportionalSize(this,width,height);return this.width(new SVG.Number(p.width)).height(new SVG.Number(p.height))},clone:function(parent,withData){this.writeDataToDom();var clone=assignNewId(this.node.cloneNode(!0));return parent?parent.add(clone):this.after(clone),clone},remove:function(){return this.parent()&&this.parent().removeElement(this),this},replace:function(element){return this.after(element).remove(),element},addTo:function(parent){return parent.put(this)},putIn:function(parent){return parent.add(this)},id:function(id){return this.attr("id",id)},inside:function(x,y){var box=this.bbox();return x>box.x&&y>box.y&&x<box.x+box.width&&y<box.y+box.height},show:function(){return this.style("display","")},hide:function(){return this.style("display","none")},visible:function(){return"none"!=this.style("display")},toString:function(){return this.attr("id")},classes:function(){var attr=this.attr("class");return null==attr?[]:attr.trim().split(SVG.regex.delimiter)},hasClass:function(name){return-1!=this.classes().indexOf(name)},addClass:function(name){if(!this.hasClass(name)){var array=this.classes();array.push(name),this.attr("class",array.join(" "))}return this},removeClass:function(name){return this.hasClass(name)&&this.attr("class",this.classes().filter(function(c){return c!=name}).join(" ")),this},toggleClass:function(name){return this.hasClass(name)?this.removeClass(name):this.addClass(name)},reference:function(attr){return SVG.get(this.attr(attr))},parent:function(type){var parent=this;if(!parent.node.parentNode)return null;if(parent=SVG.adopt(parent.node.parentNode),!type)return parent;for(;parent&&parent.node instanceof window.SVGElement;){if("string"==typeof type?parent.matches(type):parent instanceof type)return parent;parent=SVG.adopt(parent.node.parentNode)}},doc:function(){return this instanceof SVG.Doc?this:this.parent(SVG.Doc)},parents:function(type){var parents=[],parent=this;do{if(parent=parent.parent(type),!parent||!parent.node)break;parents.push(parent)}while(parent.parent);return parents},matches:function(selector){return matches(this.node,selector)},"native":function(){return this.node},svg:function(svg){var well=document.createElement("svg");if(!(svg&&this instanceof SVG.Parent))return well.appendChild(svg=document.createElement("svg")),this.writeDataToDom(),svg.appendChild(this.node.cloneNode(!0)),well.innerHTML.replace(/^<svg>/,"").replace(/<\/svg>$/,"");well.innerHTML="<svg>"+svg.replace(/\n/,"").replace(/<(\w+)([^<]+?)\/>/g,"<$1$2></$1>")+"</svg>";for(var i=0,il=well.firstChild.childNodes.length;il>i;i++)this.node.appendChild(well.firstChild.firstChild);return this},writeDataToDom:function(){if(this.each||this.lines){var fn=this.each?this:this.lines();fn.each(function(){this.writeDataToDom()})}return this.node.removeAttribute("svgjs:data"),Object.keys(this.dom).length&&this.node.setAttribute("svgjs:data",JSON.stringify(this.dom)),this},setData:function(o){return this.dom=o,this},is:function(obj){return is(this,obj)}}}),SVG.easing={"-":function(pos){return pos},"<>":function(pos){return-Math.cos(pos*Math.PI)/2+.5},">":function(pos){return Math.sin(pos*Math.PI/2)},"<":function(pos){return-Math.cos(pos*Math.PI/2)+1}},SVG.morph=function(pos){return function(from,to){return new SVG.MorphObj(from,to).at(pos)}},SVG.Situation=SVG.invent({create:function(o){this.init=!1,this.reversed=!1,this.reversing=!1,this.duration=new SVG.Number(o.duration).valueOf(),this.delay=new SVG.Number(o.delay).valueOf(),this.start=+new Date+this.delay,this.finish=this.start+this.duration,this.ease=o.ease,this.loop=0,this.loops=!1,this.animations={},this.attrs={},this.styles={},this.transforms=[],this.once={}}}),SVG.FX=SVG.invent({create:function(element){this._target=element,this.situations=[],this.active=!1,this.situation=null,this.paused=!1,this.lastPos=0,this.pos=0,this.absPos=0,this._speed=1},extend:{animate:function(o,ease,delay){"object"==typeof o&&(ease=o.ease,delay=o.delay,o=o.duration);var situation=new SVG.Situation({duration:o||1e3,delay:delay||0,ease:SVG.easing[ease||"-"]||ease});return this.queue(situation),this},delay:function(delay){var situation=new SVG.Situation({duration:delay,delay:0,ease:SVG.easing["-"]});return this.queue(situation)},target:function(target){return target&&target instanceof SVG.Element?(this._target=target,this):this._target},timeToAbsPos:function(timestamp){return(timestamp-this.situation.start)/(this.situation.duration/this._speed)},absPosToTime:function(absPos){return this.situation.duration/this._speed*absPos+this.situation.start},startAnimFrame:function(){this.stopAnimFrame(),this.animationFrame=window.requestAnimationFrame(function(){this.step()}.bind(this))},stopAnimFrame:function(){window.cancelAnimationFrame(this.animationFrame)},start:function(){return!this.active&&this.situation&&(this.active=!0,this.startCurrent()),this},startCurrent:function(){return this.situation.start=+new Date+this.situation.delay/this._speed,this.situation.finish=this.situation.start+this.situation.duration/this._speed,this.initAnimations().step()},queue:function(fn){return("function"==typeof fn||fn instanceof SVG.Situation)&&this.situations.push(fn),this.situation||(this.situation=this.situations.shift()),this},dequeue:function(){return this.stop(),this.situation=this.situations.shift(),this.situation&&(this.situation instanceof SVG.Situation?this.start():this.situation.call(this)),this},initAnimations:function(){var i,source,s=this.situation;if(s.init)return this;for(i in s.animations)source=this.target()[i](),s.animations[i]instanceof SVG.Number&&(source=new SVG.Number(source)),s.animations[i]=source.morph(s.animations[i]);for(i in s.attrs)s.attrs[i]=new SVG.MorphObj(this.target().attr(i),s.attrs[i]);for(i in s.styles)s.styles[i]=new SVG.MorphObj(this.target().style(i),s.styles[i]);return s.initialTransformation=this.target().matrixify(),s.init=!0,this},clearQueue:function(){return this.situations=[],this},clearCurrent:function(){return this.situation=null,this},stop:function(jumpToEnd,clearQueue){var active=this.active;return this.active=!1,clearQueue&&this.clearQueue(),jumpToEnd&&this.situation&&(!active&&this.startCurrent(),this.atEnd()),this.stopAnimFrame(),this.clearCurrent()},reset:function(){if(this.situation){var temp=this.situation;this.stop(),this.situation=temp,this.atStart()}return this},finish:function(){for(this.stop(!0,!1);this.dequeue().situation&&this.stop(!0,!1););return this.clearQueue().clearCurrent(),this},atStart:function(){return this.at(0,!0)},atEnd:function(){return this.situation.loops===!0&&(this.situation.loops=this.situation.loop+1),"number"==typeof this.situation.loops?this.at(this.situation.loops,!0):this.at(1,!0)},at:function(pos,isAbsPos){var durDivSpd=this.situation.duration/this._speed;return this.absPos=pos,isAbsPos||(this.situation.reversed&&(this.absPos=1-this.absPos),this.absPos+=this.situation.loop),this.situation.start=+new Date-this.absPos*durDivSpd,this.situation.finish=this.situation.start+durDivSpd,this.step(!0)},speed:function(speed){return 0===speed?this.pause():speed?(this._speed=speed,this.at(this.absPos,!0)):this._speed},loop:function(times,reverse){var c=this.last();return c.loops=null!=times?times:!0,c.loop=0,reverse&&(c.reversing=!0),this},pause:function(){return this.paused=!0,this.stopAnimFrame(),this},play:function(){return this.paused?(this.paused=!1,this.at(this.absPos,!0)):this},reverse:function(reversed){var c=this.last();return"undefined"==typeof reversed?c.reversed=!c.reversed:c.reversed=reversed,this},progress:function(easeIt){return easeIt?this.situation.ease(this.pos):this.pos},after:function(fn){var c=this.last(),wrapper=function wrapper(e){e.detail.situation==c&&(fn.call(this,c),this.off("finished.fx",wrapper))};return this.target().on("finished.fx",wrapper),this._callStart()},during:function(fn){var c=this.last(),wrapper=function(e){e.detail.situation==c&&fn.call(this,e.detail.pos,SVG.morph(e.detail.pos),e.detail.eased,c)};return this.target().off("during.fx",wrapper).on("during.fx",wrapper),this.after(function(){this.off("during.fx",wrapper)}),this._callStart()},afterAll:function(fn){var wrapper=function wrapper(e){fn.call(this),this.off("allfinished.fx",wrapper)};return this.target().off("allfinished.fx",wrapper).on("allfinished.fx",wrapper),this._callStart()},duringAll:function(fn){var wrapper=function(e){fn.call(this,e.detail.pos,SVG.morph(e.detail.pos),e.detail.eased,e.detail.situation)};return this.target().off("during.fx",wrapper).on("during.fx",wrapper),this.afterAll(function(){this.off("during.fx",wrapper)}),this._callStart()},last:function(){return this.situations.length?this.situations[this.situations.length-1]:this.situation},add:function(method,args,type){return this.last()[type||"animations"][method]=args,this._callStart()},step:function(ignoreTime){if(ignoreTime||(this.absPos=this.timeToAbsPos(+new Date)),this.situation.loops!==!1){var absPos,absPosInt,lastLoop;absPos=Math.max(this.absPos,0),absPosInt=Math.floor(absPos),this.situation.loops===!0||absPosInt<this.situation.loops?(this.pos=absPos-absPosInt,
lastLoop=this.situation.loop,this.situation.loop=absPosInt):(this.absPos=this.situation.loops,this.pos=1,lastLoop=this.situation.loop-1,this.situation.loop=this.situation.loops),this.situation.reversing&&(this.situation.reversed=this.situation.reversed!=Boolean((this.situation.loop-lastLoop)%2))}else this.absPos=Math.min(this.absPos,1),this.pos=this.absPos;this.pos<0&&(this.pos=0),this.situation.reversed&&(this.pos=1-this.pos);var eased=this.situation.ease(this.pos);for(var i in this.situation.once)i>this.lastPos&&eased>=i&&(this.situation.once[i].call(this.target(),this.pos,eased),delete this.situation.once[i]);return this.active&&this.target().fire("during",{pos:this.pos,eased:eased,fx:this,situation:this.situation}),this.situation?(this.eachAt(),1==this.pos&&!this.situation.reversed||this.situation.reversed&&0==this.pos?(this.stopAnimFrame(),this.target().fire("finished",{fx:this,situation:this.situation}),this.situations.length||(this.target().fire("allfinished"),this.target().off(".fx"),this.active=!1),this.active?this.dequeue():this.clearCurrent()):!this.paused&&this.active&&this.startAnimFrame(),this.lastPos=eased,this):this},eachAt:function(){var i,at,self=this,target=this.target(),s=this.situation;for(i in s.animations)at=[].concat(s.animations[i]).map(function(el){return"string"!=typeof el&&el.at?el.at(s.ease(self.pos),self.pos):el}),target[i].apply(target,at);for(i in s.attrs)at=[i].concat(s.attrs[i]).map(function(el){return"string"!=typeof el&&el.at?el.at(s.ease(self.pos),self.pos):el}),target.attr.apply(target,at);for(i in s.styles)at=[i].concat(s.styles[i]).map(function(el){return"string"!=typeof el&&el.at?el.at(s.ease(self.pos),self.pos):el}),target.style.apply(target,at);if(s.transforms.length){for(at=s.initialTransformation,i=0,len=s.transforms.length;i<len;i++){var a=s.transforms[i];a instanceof SVG.Matrix?at=a.relative?at.multiply((new SVG.Matrix).morph(a).at(s.ease(this.pos))):at.morph(a).at(s.ease(this.pos)):(a.relative||a.undo(at.extract()),at=at.multiply(a.at(s.ease(this.pos))))}target.matrix(at)}return this},once:function(pos,fn,isEased){return isEased||(pos=this.situation.ease(pos)),this.situation.once[pos]=fn,this},_callStart:function(){return setTimeout(function(){this.start()}.bind(this),0),this}},parent:SVG.Element,construct:{animate:function(o,ease,delay){return(this.fx||(this.fx=new SVG.FX(this))).animate(o,ease,delay)},delay:function(delay){return(this.fx||(this.fx=new SVG.FX(this))).delay(delay)},stop:function(jumpToEnd,clearQueue){return this.fx&&this.fx.stop(jumpToEnd,clearQueue),this},finish:function(){return this.fx&&this.fx.finish(),this},pause:function(){return this.fx&&this.fx.pause(),this},play:function(){return this.fx&&this.fx.play(),this},speed:function(speed){if(this.fx){if(null==speed)return this.fx.speed();this.fx.speed(speed)}return this}}}),SVG.MorphObj=SVG.invent({create:function(from,to){return SVG.Color.isColor(to)?new SVG.Color(from).morph(to):SVG.regex.numberAndUnit.test(to)?new SVG.Number(from).morph(to):(this.value=from,void(this.destination=to))},extend:{at:function(pos,real){return 1>real?this.value:this.destination},valueOf:function(){return this.value}}}),SVG.extend(SVG.FX,{attr:function(a,v,relative){if("object"==typeof a)for(var key in a)this.attr(key,a[key]);else this.add(a,v,"attrs");return this},style:function(s,v){if("object"==typeof s)for(var key in s)this.style(key,s[key]);else this.add(s,v,"styles");return this},x:function(x,relative){if(this.target()instanceof SVG.G)return this.transform({x:x},relative),this;var num=new SVG.Number(x);return num.relative=relative,this.add("x",num)},y:function(y,relative){if(this.target()instanceof SVG.G)return this.transform({y:y},relative),this;var num=new SVG.Number(y);return num.relative=relative,this.add("y",num)},cx:function(x){return this.add("cx",new SVG.Number(x))},cy:function(y){return this.add("cy",new SVG.Number(y))},move:function(x,y){return this.x(x).y(y)},center:function(x,y){return this.cx(x).cy(y)},size:function(width,height){if(this.target()instanceof SVG.Text)this.attr("font-size",width);else{var box;width&&height||(box=this.target().bbox()),width||(width=box.width/box.height*height),height||(height=box.height/box.width*width),this.add("width",new SVG.Number(width)).add("height",new SVG.Number(height))}return this},plot:function(){return this.add("plot",arguments.length>1?[].slice.call(arguments):arguments[0])},leading:function(value){return this.target().leading?this.add("leading",new SVG.Number(value)):this},viewbox:function(x,y,width,height){return this.target()instanceof SVG.Container&&this.add("viewbox",new SVG.ViewBox(x,y,width,height)),this},update:function(o){if(this.target()instanceof SVG.Stop){if("number"==typeof o||o instanceof SVG.Number)return this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]});null!=o.opacity&&this.attr("stop-opacity",o.opacity),null!=o.color&&this.attr("stop-color",o.color),null!=o.offset&&this.attr("offset",o.offset)}return this}}),SVG.Box=SVG.invent({create:function(x,y,width,height){return"object"!=typeof x||x instanceof SVG.Element?(4==arguments.length&&(this.x=x,this.y=y,this.width=width,this.height=height),void fullBox(this)):SVG.Box.call(this,null!=x.left?x.left:x.x,null!=x.top?x.top:x.y,x.width,x.height)},extend:{merge:function(box){var b=new this.constructor;return b.x=Math.min(this.x,box.x),b.y=Math.min(this.y,box.y),b.width=Math.max(this.x+this.width,box.x+box.width)-b.x,b.height=Math.max(this.y+this.height,box.y+box.height)-b.y,fullBox(b)},transform:function(m){var xMin=1/0,xMax=-(1/0),yMin=1/0,yMax=-(1/0),pts=[new SVG.Point(this.x,this.y),new SVG.Point(this.x2,this.y),new SVG.Point(this.x,this.y2),new SVG.Point(this.x2,this.y2)];return pts.forEach(function(p){p=p.transform(m),xMin=Math.min(xMin,p.x),xMax=Math.max(xMax,p.x),yMin=Math.min(yMin,p.y),yMax=Math.max(yMax,p.y)}),bbox=new this.constructor,bbox.x=xMin,bbox.width=xMax-xMin,bbox.y=yMin,bbox.height=yMax-yMin,fullBox(bbox),bbox}}}),SVG.BBox=SVG.invent({create:function(element){if(SVG.Box.apply(this,[].slice.call(arguments)),element instanceof SVG.Element){var box;try{if(document.documentElement.contains){if(!document.documentElement.contains(element.node))throw new Exception("Element not in the dom")}else{for(var topParent=element.node;topParent.parentNode;)topParent=topParent.parentNode;if(topParent!=document)throw new Exception("Element not in the dom")}box=element.node.getBBox()}catch(e){if(element instanceof SVG.Shape){var clone=element.clone(SVG.parser.draw).show();box=clone.node.getBBox(),clone.remove()}else box={x:element.node.clientLeft,y:element.node.clientTop,width:element.node.clientWidth,height:element.node.clientHeight}}SVG.Box.call(this,box)}},inherit:SVG.Box,parent:SVG.Element,construct:{bbox:function(){return new SVG.BBox(this)}}}),SVG.BBox.prototype.constructor=SVG.BBox,SVG.extend(SVG.Element,{tbox:function(){return console.warn("Use of TBox is deprecated and mapped to RBox. Use .rbox() instead."),this.rbox(this.doc())}}),SVG.RBox=SVG.invent({create:function(element){SVG.Box.apply(this,[].slice.call(arguments)),element instanceof SVG.Element&&SVG.Box.call(this,element.node.getBoundingClientRect())},inherit:SVG.Box,parent:SVG.Element,extend:{addOffset:function(){return this.x+=window.pageXOffset,this.y+=window.pageYOffset,this}},construct:{rbox:function(el){return el?new SVG.RBox(this).transform(el.screenCTM().inverse()):new SVG.RBox(this).addOffset()}}}),SVG.RBox.prototype.constructor=SVG.RBox,SVG.Matrix=SVG.invent({create:function(source){var i,base=arrayToMatrix([1,0,0,1,0,0]);for(source=source instanceof SVG.Element?source.matrixify():"string"==typeof source?arrayToMatrix(source.split(SVG.regex.delimiter).map(parseFloat)):6==arguments.length?arrayToMatrix([].slice.call(arguments)):Array.isArray(source)?arrayToMatrix(source):"object"==typeof source?source:base,i=abcdef.length-1;i>=0;--i)this[abcdef[i]]=source&&"number"==typeof source[abcdef[i]]?source[abcdef[i]]:base[abcdef[i]]},extend:{extract:function(){var px=deltaTransformPoint(this,0,1),py=deltaTransformPoint(this,1,0),skewX=180/Math.PI*Math.atan2(px.y,px.x)-90;return{x:this.e,y:this.f,transformedX:(this.e*Math.cos(skewX*Math.PI/180)+this.f*Math.sin(skewX*Math.PI/180))/Math.sqrt(this.a*this.a+this.b*this.b),transformedY:(this.f*Math.cos(skewX*Math.PI/180)+this.e*Math.sin(-skewX*Math.PI/180))/Math.sqrt(this.c*this.c+this.d*this.d),skewX:-skewX,skewY:180/Math.PI*Math.atan2(py.y,py.x),scaleX:Math.sqrt(this.a*this.a+this.b*this.b),scaleY:Math.sqrt(this.c*this.c+this.d*this.d),rotation:skewX,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f,matrix:new SVG.Matrix(this)}},clone:function(){return new SVG.Matrix(this)},morph:function(matrix){return this.destination=new SVG.Matrix(matrix),this},at:function(pos){if(!this.destination)return this;var matrix=new SVG.Matrix({a:this.a+(this.destination.a-this.a)*pos,b:this.b+(this.destination.b-this.b)*pos,c:this.c+(this.destination.c-this.c)*pos,d:this.d+(this.destination.d-this.d)*pos,e:this.e+(this.destination.e-this.e)*pos,f:this.f+(this.destination.f-this.f)*pos});return matrix},multiply:function(matrix){return new SVG.Matrix(this["native"]().multiply(parseMatrix(matrix)["native"]()))},inverse:function(){return new SVG.Matrix(this["native"]().inverse())},translate:function(x,y){return new SVG.Matrix(this["native"]().translate(x||0,y||0))},scale:function(x,y,cx,cy){return 1==arguments.length?y=x:3==arguments.length&&(cy=cx,cx=y,y=x),this.around(cx,cy,new SVG.Matrix(x,0,0,y,0,0))},rotate:function(r,cx,cy){return r=SVG.utils.radians(r),this.around(cx,cy,new SVG.Matrix(Math.cos(r),Math.sin(r),-Math.sin(r),Math.cos(r),0,0))},flip:function(a,o){return o="number"==typeof a?a:o,"x"==a?this.scale(-1,1,o,0):"y"==a?this.scale(1,-1,0,o):this.scale(-1,-1,o,o)},skew:function(x,y,cx,cy){return 1==arguments.length?y=x:3==arguments.length&&(cy=cx,cx=y,y=x),x=SVG.utils.radians(x),y=SVG.utils.radians(y),this.around(cx,cy,new SVG.Matrix(1,Math.tan(y),Math.tan(x),1,0,0))},skewX:function(x,cx,cy){return this.skew(x,0,cx,cy)},skewY:function(y,cx,cy){return this.skew(0,y,cx,cy)},around:function(cx,cy,matrix){return this.multiply(new SVG.Matrix(1,0,0,1,cx||0,cy||0)).multiply(matrix).multiply(new SVG.Matrix(1,0,0,1,-cx||0,-cy||0))},"native":function(){for(var matrix=SVG.parser["native"].createSVGMatrix(),i=abcdef.length-1;i>=0;i--)matrix[abcdef[i]]=this[abcdef[i]];return matrix},toString:function(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"}},parent:SVG.Element,construct:{ctm:function(){return new SVG.Matrix(this.node.getCTM())},screenCTM:function(){if(this instanceof SVG.Nested){var rect=this.rect(1,1),m=rect.node.getScreenCTM();return rect.remove(),new SVG.Matrix(m)}return new SVG.Matrix(this.node.getScreenCTM())}}}),SVG.Point=SVG.invent({create:function(x,y){var source,base={x:0,y:0};source=Array.isArray(x)?{x:x[0],y:x[1]}:"object"==typeof x?{x:x.x,y:x.y}:null!=x?{x:x,y:null!=y?y:x}:base,this.x=source.x,this.y=source.y},extend:{clone:function(){return new SVG.Point(this)},morph:function(x,y){return this.destination=new SVG.Point(x,y),this},at:function(pos){if(!this.destination)return this;var point=new SVG.Point({x:this.x+(this.destination.x-this.x)*pos,y:this.y+(this.destination.y-this.y)*pos});return point},"native":function(){var point=SVG.parser["native"].createSVGPoint();return point.x=this.x,point.y=this.y,point},transform:function(matrix){return new SVG.Point(this["native"]().matrixTransform(matrix["native"]()))}}}),SVG.extend(SVG.Element,{point:function(x,y){return new SVG.Point(x,y).transform(this.screenCTM().inverse())}}),SVG.extend(SVG.Element,{attr:function(a,v,n){if(null==a){for(a={},v=this.node.attributes,n=v.length-1;n>=0;n--)a[v[n].nodeName]=SVG.regex.isNumber.test(v[n].nodeValue)?parseFloat(v[n].nodeValue):v[n].nodeValue;return a}if("object"==typeof a)for(v in a)this.attr(v,a[v]);else if(null===v)this.node.removeAttribute(a);else{if(null==v)return v=this.node.getAttribute(a),null==v?SVG.defaults.attrs[a]:SVG.regex.isNumber.test(v)?parseFloat(v):v;"stroke-width"==a?this.attr("stroke",parseFloat(v)>0?this._stroke:null):"stroke"==a&&(this._stroke=v),("fill"==a||"stroke"==a)&&(SVG.regex.isImage.test(v)&&(v=this.doc().defs().image(v,0,0)),v instanceof SVG.Image&&(v=this.doc().defs().pattern(0,0,function(){this.add(v)}))),"number"==typeof v?v=new SVG.Number(v):SVG.Color.isColor(v)?v=new SVG.Color(v):Array.isArray(v)&&(v=new SVG.Array(v)),"leading"==a?this.leading&&this.leading(v):"string"==typeof n?this.node.setAttributeNS(n,a,v.toString()):this.node.setAttribute(a,v.toString()),!this.rebuild||"font-size"!=a&&"x"!=a||this.rebuild(a,v)}return this}}),SVG.extend(SVG.Element,{transform:function(o,relative){var matrix,target=this;if("object"!=typeof o)return matrix=new SVG.Matrix(target).extract(),"string"==typeof o?matrix[o]:matrix;if(matrix=new SVG.Matrix(target),relative=!!relative||!!o.relative,null!=o.a)matrix=relative?matrix.multiply(new SVG.Matrix(o)):new SVG.Matrix(o);else if(null!=o.rotation)ensureCentre(o,target),matrix=relative?matrix.rotate(o.rotation,o.cx,o.cy):matrix.rotate(o.rotation-matrix.extract().rotation,o.cx,o.cy);else if(null!=o.scale||null!=o.scaleX||null!=o.scaleY){if(ensureCentre(o,target),o.scaleX=null!=o.scale?o.scale:null!=o.scaleX?o.scaleX:1,o.scaleY=null!=o.scale?o.scale:null!=o.scaleY?o.scaleY:1,!relative){var e=matrix.extract();o.scaleX=1*o.scaleX/e.scaleX,o.scaleY=1*o.scaleY/e.scaleY}matrix=matrix.scale(o.scaleX,o.scaleY,o.cx,o.cy)}else if(null!=o.skew||null!=o.skewX||null!=o.skewY){if(ensureCentre(o,target),o.skewX=null!=o.skew?o.skew:null!=o.skewX?o.skewX:0,o.skewY=null!=o.skew?o.skew:null!=o.skewY?o.skewY:0,!relative){var e=matrix.extract();matrix=matrix.multiply((new SVG.Matrix).skew(e.skewX,e.skewY,o.cx,o.cy).inverse())}matrix=matrix.skew(o.skewX,o.skewY,o.cx,o.cy)}else o.flip?matrix=matrix.flip(o.flip,null==o.offset?target.bbox()["c"+o.flip]:o.offset):(null!=o.x||null!=o.y)&&(relative?matrix=matrix.translate(o.x,o.y):(null!=o.x&&(matrix.e=o.x),null!=o.y&&(matrix.f=o.y)));return this.attr("transform",matrix)}}),SVG.extend(SVG.FX,{transform:function(o,relative){var matrix,target=this.target();return"object"!=typeof o?(matrix=new SVG.Matrix(target).extract(),"string"==typeof o?matrix[o]:matrix):(relative=!!relative||!!o.relative,null!=o.a?matrix=new SVG.Matrix(o):null!=o.rotation?(ensureCentre(o,target),matrix=new SVG.Rotate(o.rotation,o.cx,o.cy)):null!=o.scale||null!=o.scaleX||null!=o.scaleY?(ensureCentre(o,target),o.scaleX=null!=o.scale?o.scale:null!=o.scaleX?o.scaleX:1,o.scaleY=null!=o.scale?o.scale:null!=o.scaleY?o.scaleY:1,matrix=new SVG.Scale(o.scaleX,o.scaleY,o.cx,o.cy)):null!=o.skewX||null!=o.skewY?(ensureCentre(o,target),o.skewX=null!=o.skewX?o.skewX:0,o.skewY=null!=o.skewY?o.skewY:0,matrix=new SVG.Skew(o.skewX,o.skewY,o.cx,o.cy)):o.flip?matrix=(new SVG.Matrix).flip(o.flip,null==o.offset?target.bbox()["c"+o.flip]:o.offset):(null!=o.x||null!=o.y)&&(matrix=new SVG.Translate(o.x,o.y)),matrix?(matrix.relative=relative,this.last().transforms.push(matrix),this._callStart()):this)}}),SVG.extend(SVG.Element,{untransform:function(){return this.attr("transform",null)},matrixify:function(){var matrix=(this.attr("transform")||"").split(SVG.regex.transforms).slice(0,-1).map(function(str){var kv=str.trim().split("(");return[kv[0],kv[1].split(SVG.regex.delimiter).map(function(str){return parseFloat(str)})]}).reduce(function(matrix,transform){return"matrix"==transform[0]?matrix.multiply(arrayToMatrix(transform[1])):matrix[transform[0]].apply(matrix,transform[1])},new SVG.Matrix);return matrix},toParent:function(parent){if(this==parent)return this;var ctm=this.screenCTM(),pCtm=parent.screenCTM().inverse();return this.addTo(parent).untransform().transform(pCtm.multiply(ctm)),this},toDoc:function(){return this.toParent(this.doc())}}),SVG.Transformation=SVG.invent({create:function(source,inversed){if(arguments.length>1&&"boolean"!=typeof inversed)return this.constructor.call(this,[].slice.call(arguments));if(Array.isArray(source))for(var i=0,len=this.arguments.length;len>i;++i)this[this.arguments[i]]=source[i];else if("object"==typeof source)for(var i=0,len=this.arguments.length;len>i;++i)this[this.arguments[i]]=source[this.arguments[i]];this.inversed=!1,inversed===!0&&(this.inversed=!0)},extend:{arguments:[],method:"",at:function(pos){for(var params=[],i=0,len=this.arguments.length;len>i;++i)params.push(this[this.arguments[i]]);var m=this._undo||new SVG.Matrix;return m=(new SVG.Matrix).morph(SVG.Matrix.prototype[this.method].apply(m,params)).at(pos),this.inversed?m.inverse():m},undo:function(o){for(var i=0,len=this.arguments.length;len>i;++i)o[this.arguments[i]]="undefined"==typeof this[this.arguments[i]]?0:o[this.arguments[i]];return o.cx=this.cx,o.cy=this.cy,this._undo=new(SVG[capitalize(this.method)])(o,!0).at(1),this}}}),SVG.Translate=SVG.invent({parent:SVG.Matrix,inherit:SVG.Transformation,create:function(source,inversed){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["transformedX","transformedY"],method:"translate"}}),SVG.Rotate=SVG.invent({parent:SVG.Matrix,inherit:SVG.Transformation,create:function(source,inversed){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["rotation","cx","cy"],method:"rotate",at:function(pos){var m=(new SVG.Matrix).rotate((new SVG.Number).morph(this.rotation-(this._undo?this._undo.rotation:0)).at(pos),this.cx,this.cy);return this.inversed?m.inverse():m},undo:function(o){return this._undo=o,this}}}),SVG.Scale=SVG.invent({parent:SVG.Matrix,inherit:SVG.Transformation,create:function(source,inversed){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["scaleX","scaleY","cx","cy"],method:"scale"}}),SVG.Skew=SVG.invent({parent:SVG.Matrix,inherit:SVG.Transformation,create:function(source,inversed){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["skewX","skewY","cx","cy"],method:"skew"}}),SVG.extend(SVG.Element,{style:function(s,v){if(0==arguments.length)return this.node.style.cssText||"";if(arguments.length<2)if("object"==typeof s)for(v in s)this.style(v,s[v]);else{if(!SVG.regex.isCss.test(s))return this.node.style[camelCase(s)];for(s=s.split(/\s*;\s*/).filter(function(e){return!!e}).map(function(e){return e.split(/\s*:\s*/)});v=s.pop();)this.style(v[0],v[1])}else this.node.style[camelCase(s)]=null===v||SVG.regex.isBlank.test(v)?"":v;return this}}),SVG.Parent=SVG.invent({create:function(element){this.constructor.call(this,element)},inherit:SVG.Element,extend:{children:function(){return SVG.utils.map(SVG.utils.filterSVGElements(this.node.childNodes),function(node){return SVG.adopt(node)})},add:function(element,i){return null==i?this.node.appendChild(element.node):element.node!=this.node.childNodes[i]&&this.node.insertBefore(element.node,this.node.childNodes[i]),this},put:function(element,i){return this.add(element,i),element},has:function(element){return this.index(element)>=0},index:function(element){return[].slice.call(this.node.childNodes).indexOf(element.node)},get:function(i){return SVG.adopt(this.node.childNodes[i])},first:function(){return this.get(0)},last:function(){return this.get(this.node.childNodes.length-1)},each:function(block,deep){var i,il,children=this.children();for(i=0,il=children.length;il>i;i++)children[i]instanceof SVG.Element&&block.apply(children[i],[i,children]),deep&&children[i]instanceof SVG.Container&&children[i].each(block,deep);return this},removeElement:function(element){return this.node.removeChild(element.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,this},defs:function(){return this.doc().defs()}}}),SVG.extend(SVG.Parent,{ungroup:function(parent,depth){return 0===depth||this instanceof SVG.Defs?this:(parent=parent||(this instanceof SVG.Doc?this:this.parent(SVG.Parent)),depth=depth||1/0,this.each(function(){return this instanceof SVG.Defs?this:this instanceof SVG.Parent?this.ungroup(parent,depth-1):this.toParent(parent)}),this.node.firstChild||this.remove(),this)},flatten:function(parent,depth){return this.ungroup(parent,depth)}}),SVG.Container=SVG.invent({create:function(element){this.constructor.call(this,element)},inherit:SVG.Parent}),SVG.ViewBox=SVG.invent({create:function(source){var x,y,width,height,box,view,we,he,base=[0,0,0,0],wm=1,hm=1,reg=/[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?/gi;if(source instanceof SVG.Element){for(we=source,he=source,view=(source.attr("viewBox")||"").match(reg),box=source.bbox,width=new SVG.Number(source.width()),height=new SVG.Number(source.height());"%"==width.unit;)wm*=width.value,width=new SVG.Number(we instanceof SVG.Doc?we.parent().offsetWidth:we.parent().width()),we=we.parent();for(;"%"==height.unit;)hm*=height.value,height=new SVG.Number(he instanceof SVG.Doc?he.parent().offsetHeight:he.parent().height()),he=he.parent();this.x=0,this.y=0,this.width=width*wm,this.height=height*hm,this.zoom=1,view&&(x=parseFloat(view[0]),y=parseFloat(view[1]),width=parseFloat(view[2]),height=parseFloat(view[3]),this.zoom=this.width/this.height>width/height?this.height/height:this.width/width,this.x=x,this.y=y,this.width=width,this.height=height)}else source="string"==typeof source?source.match(reg).map(function(el){return parseFloat(el)}):Array.isArray(source)?source:"object"==typeof source?[source.x,source.y,source.width,source.height]:4==arguments.length?[].slice.call(arguments):base,this.x=source[0],this.y=source[1],this.width=source[2],this.height=source[3]},extend:{toString:function(){return this.x+" "+this.y+" "+this.width+" "+this.height},morph:function(x,y,width,height){return this.destination=new SVG.ViewBox(x,y,width,height),this},at:function(pos){return this.destination?new SVG.ViewBox([this.x+(this.destination.x-this.x)*pos,this.y+(this.destination.y-this.y)*pos,this.width+(this.destination.width-this.width)*pos,this.height+(this.destination.height-this.height)*pos]):this}},parent:SVG.Container,construct:{viewbox:function(x,y,width,height){return 0==arguments.length?new SVG.ViewBox(this):this.attr("viewBox",new SVG.ViewBox(x,y,width,height))}}}),["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","touchstart","touchmove","touchleave","touchend","touchcancel"].forEach(function(event){SVG.Element.prototype[event]=function(f){return SVG.on(this.node,event,f),this}}),SVG.listeners=[],SVG.handlerMap=[],SVG.listenerId=0,SVG.on=function(node,event,listener,binding){var l=listener.bind(binding||node.instance||node),index=(SVG.handlerMap.indexOf(node)+1||SVG.handlerMap.push(node))-1,ev=event.split(".")[0],ns=event.split(".")[1]||"*";SVG.listeners[index]=SVG.listeners[index]||{},SVG.listeners[index][ev]=SVG.listeners[index][ev]||{},SVG.listeners[index][ev][ns]=SVG.listeners[index][ev][ns]||{},listener._svgjsListenerId||(listener._svgjsListenerId=++SVG.listenerId),SVG.listeners[index][ev][ns][listener._svgjsListenerId]=l,node.addEventListener(ev,l,!1)},SVG.off=function(node,event,listener){var index=SVG.handlerMap.indexOf(node),ev=event&&event.split(".")[0],ns=event&&event.split(".")[1];if(-1!=index)if(listener){if("function"==typeof listener&&(listener=listener._svgjsListenerId),!listener)return;SVG.listeners[index][ev]&&SVG.listeners[index][ev][ns||"*"]&&(node.removeEventListener(ev,SVG.listeners[index][ev][ns||"*"][listener],!1),delete SVG.listeners[index][ev][ns||"*"][listener])}else if(ns&&ev){if(SVG.listeners[index][ev]&&SVG.listeners[index][ev][ns]){for(listener in SVG.listeners[index][ev][ns])SVG.off(node,[ev,ns].join("."),listener);delete SVG.listeners[index][ev][ns]}}else if(ns)for(event in SVG.listeners[index])for(namespace in SVG.listeners[index][event])ns===namespace&&SVG.off(node,[event,ns].join("."));else if(ev){if(SVG.listeners[index][ev]){for(namespace in SVG.listeners[index][ev])SVG.off(node,[ev,namespace].join("."));delete SVG.listeners[index][ev]}}else{for(event in SVG.listeners[index])SVG.off(node,event);delete SVG.listeners[index],delete SVG.handlerMap[index]}},SVG.extend(SVG.Element,{on:function(event,listener,binding){return SVG.on(this.node,event,listener,binding),this},off:function(event,listener){return SVG.off(this.node,event,listener),this},fire:function(event,data){return event instanceof window.Event?this.node.dispatchEvent(event):this.node.dispatchEvent(event=new window.CustomEvent(event,{detail:data,cancelable:!0})),this._event=event,this},event:function(){return this._event}}),SVG.Defs=SVG.invent({create:"defs",inherit:SVG.Container}),SVG.G=SVG.invent({create:"g",inherit:SVG.Container,extend:{x:function(x){return null==x?this.transform("x"):this.transform({x:x-this.x()},!0)},y:function(y){return null==y?this.transform("y"):this.transform({y:y-this.y()},!0)},cx:function(x){return null==x?this.gbox().cx:this.x(x-this.gbox().width/2)},cy:function(y){return null==y?this.gbox().cy:this.y(y-this.gbox().height/2)},gbox:function(){var bbox=this.bbox(),trans=this.transform();return bbox.x+=trans.x,bbox.x2+=trans.x,bbox.cx+=trans.x,bbox.y+=trans.y,bbox.y2+=trans.y,bbox.cy+=trans.y,bbox}},construct:{group:function(){return this.put(new SVG.G)}}}),SVG.extend(SVG.Element,{siblings:function(){return this.parent().children()},position:function(){return this.parent().index(this)},next:function(){return this.siblings()[this.position()+1]},previous:function(){return this.siblings()[this.position()-1]},forward:function(){var i=this.position()+1,p=this.parent();return p.removeElement(this).add(this,i),p instanceof SVG.Doc&&p.node.appendChild(p.defs().node),this},backward:function(){var i=this.position();return i>0&&this.parent().removeElement(this).add(this,i-1),this},front:function(){var p=this.parent();return p.node.appendChild(this.node),p instanceof SVG.Doc&&p.node.appendChild(p.defs().node),this},back:function(){return this.position()>0&&this.parent().removeElement(this).add(this,0),this},before:function(element){element.remove();var i=this.position();return this.parent().add(element,i),this},after:function(element){element.remove();var i=this.position();return this.parent().add(element,i+1),this}}),SVG.Mask=SVG.invent({create:function(){this.constructor.call(this,SVG.create("mask")),this.targets=[]},inherit:SVG.Container,extend:{remove:function(){for(var i=this.targets.length-1;i>=0;i--)this.targets[i]&&this.targets[i].unmask();return this.targets=[],this.parent().removeElement(this),this}},construct:{mask:function(){return this.defs().put(new SVG.Mask)}}}),SVG.extend(SVG.Element,{maskWith:function(element){return this.masker=element instanceof SVG.Mask?element:this.parent().mask().add(element),this.masker.targets.push(this),this.attr("mask",'url("#'+this.masker.attr("id")+'")')},unmask:function(){return delete this.masker,this.attr("mask",null)}}),SVG.ClipPath=SVG.invent({create:function(){this.constructor.call(this,SVG.create("clipPath")),this.targets=[]},inherit:SVG.Container,extend:{remove:function(){for(var i=this.targets.length-1;i>=0;i--)this.targets[i]&&this.targets[i].unclip();return this.targets=[],this.parent().removeElement(this),this}},construct:{clip:function(){return this.defs().put(new SVG.ClipPath)}}}),SVG.extend(SVG.Element,{clipWith:function(element){return this.clipper=element instanceof SVG.ClipPath?element:this.parent().clip().add(element),this.clipper.targets.push(this),this.attr("clip-path",'url("#'+this.clipper.attr("id")+'")')},unclip:function(){return delete this.clipper,this.attr("clip-path",null)}}),SVG.Gradient=SVG.invent({create:function(type){this.constructor.call(this,SVG.create(type+"Gradient")),this.type=type},inherit:SVG.Container,extend:{at:function(offset,color,opacity){return this.put(new SVG.Stop).update(offset,color,opacity)},update:function(block){return this.clear(),"function"==typeof block&&block.call(this,this),this},fill:function(){return"url(#"+this.id()+")"},toString:function(){return this.fill()},attr:function(a,b,c){return"transform"==a&&(a="gradientTransform"),SVG.Container.prototype.attr.call(this,a,b,c)}},construct:{gradient:function(type,block){return this.defs().gradient(type,block)}}}),SVG.extend(SVG.Gradient,SVG.FX,{from:function(x,y){return"radial"==(this._target||this).type?this.attr({fx:new SVG.Number(x),fy:new SVG.Number(y)}):this.attr({x1:new SVG.Number(x),y1:new SVG.Number(y)})},to:function(x,y){return"radial"==(this._target||this).type?this.attr({cx:new SVG.Number(x),cy:new SVG.Number(y)}):this.attr({x2:new SVG.Number(x),y2:new SVG.Number(y)})}}),SVG.extend(SVG.Defs,{gradient:function(type,block){return this.put(new SVG.Gradient(type)).update(block)}}),SVG.Stop=SVG.invent({create:"stop",inherit:SVG.Element,extend:{update:function(o){return("number"==typeof o||o instanceof SVG.Number)&&(o={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=o.opacity&&this.attr("stop-opacity",o.opacity),null!=o.color&&this.attr("stop-color",o.color),null!=o.offset&&this.attr("offset",new SVG.Number(o.offset)),this}}}),SVG.Pattern=SVG.invent({create:"pattern",inherit:SVG.Container,extend:{fill:function(){return"url(#"+this.id()+")"},update:function(block){return this.clear(),"function"==typeof block&&block.call(this,this),this},toString:function(){return this.fill()},attr:function(a,b,c){return"transform"==a&&(a="patternTransform"),SVG.Container.prototype.attr.call(this,a,b,c)}},construct:{pattern:function(width,height,block){return this.defs().pattern(width,height,block)}}}),SVG.extend(SVG.Defs,{pattern:function(width,height,block){return this.put(new SVG.Pattern).update(block).attr({x:0,y:0,width:width,height:height,patternUnits:"userSpaceOnUse"})}}),SVG.Doc=SVG.invent({create:function(element){element&&(element="string"==typeof element?document.getElementById(element):element,"svg"==element.nodeName?this.constructor.call(this,element):(this.constructor.call(this,SVG.create("svg")),element.appendChild(this.node),this.size("100%","100%")),this.namespace().defs())},inherit:SVG.Container,extend:{namespace:function(){return this.attr({xmlns:SVG.ns,version:"1.1"}).attr("xmlns:xlink",SVG.xlink,SVG.xmlns).attr("xmlns:svgjs",SVG.svgjs,SVG.xmlns)},defs:function(){if(!this._defs){var defs;(defs=this.node.getElementsByTagName("defs")[0])?this._defs=SVG.adopt(defs):this._defs=new SVG.Defs,this.node.appendChild(this._defs.node)}return this._defs},parent:function(){return"#document"==this.node.parentNode.nodeName?null:this.node.parentNode},spof:function(spof){var pos=this.node.getScreenCTM();return pos&&this.style("left",-pos.e%1+"px").style("top",-pos.f%1+"px"),this},remove:function(){return this.parent()&&this.parent().removeChild(this.node),this}}}),SVG.Shape=SVG.invent({create:function(element){this.constructor.call(this,element)},inherit:SVG.Element}),SVG.Bare=SVG.invent({create:function(element,inherit){if(this.constructor.call(this,SVG.create(element)),inherit)for(var method in inherit.prototype)"function"==typeof inherit.prototype[method]&&(this[method]=inherit.prototype[method])},inherit:SVG.Element,extend:{words:function(text){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this.node.appendChild(document.createTextNode(text)),this}}}),SVG.extend(SVG.Parent,{element:function(element,inherit){return this.put(new SVG.Bare(element,inherit))}}),SVG.Symbol=SVG.invent({create:"symbol",inherit:SVG.Container,construct:{symbol:function(){return this.put(new SVG.Symbol)}}}),SVG.Use=SVG.invent({create:"use",inherit:SVG.Shape,extend:{element:function(element,file){return this.attr("href",(file||"")+"#"+element,SVG.xlink)}},construct:{use:function(element,file){return this.put(new SVG.Use).element(element,file)}}}),SVG.Rect=SVG.invent({create:"rect",inherit:SVG.Shape,construct:{rect:function(width,height){return this.put(new SVG.Rect).size(width,height)}}}),SVG.Circle=SVG.invent({create:"circle",inherit:SVG.Shape,construct:{circle:function(size){return this.put(new SVG.Circle).rx(new SVG.Number(size).divide(2)).move(0,0)}}}),SVG.extend(SVG.Circle,SVG.FX,{rx:function(rx){return this.attr("r",rx);
},ry:function(ry){return this.rx(ry)}}),SVG.Ellipse=SVG.invent({create:"ellipse",inherit:SVG.Shape,construct:{ellipse:function(width,height){return this.put(new SVG.Ellipse).size(width,height).move(0,0)}}}),SVG.extend(SVG.Ellipse,SVG.Rect,SVG.FX,{rx:function(rx){return this.attr("rx",rx)},ry:function(ry){return this.attr("ry",ry)}}),SVG.extend(SVG.Circle,SVG.Ellipse,{x:function(x){return null==x?this.cx()-this.rx():this.cx(x+this.rx())},y:function(y){return null==y?this.cy()-this.ry():this.cy(y+this.ry())},cx:function(x){return null==x?this.attr("cx"):this.attr("cx",x)},cy:function(y){return null==y?this.attr("cy"):this.attr("cy",y)},width:function(width){return null==width?2*this.rx():this.rx(new SVG.Number(width).divide(2))},height:function(height){return null==height?2*this.ry():this.ry(new SVG.Number(height).divide(2))},size:function(width,height){var p=proportionalSize(this,width,height);return this.rx(new SVG.Number(p.width).divide(2)).ry(new SVG.Number(p.height).divide(2))}}),SVG.Line=SVG.invent({create:"line",inherit:SVG.Shape,extend:{array:function(){return new SVG.PointArray([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])},plot:function(x1,y1,x2,y2){return null==x1?this.array():(x1="undefined"!=typeof y1?{x1:x1,y1:y1,x2:x2,y2:y2}:new SVG.PointArray(x1).toLine(),this.attr(x1))},move:function(x,y){return this.attr(this.array().move(x,y).toLine())},size:function(width,height){var p=proportionalSize(this,width,height);return this.attr(this.array().size(p.width,p.height).toLine())}},construct:{line:function(x1,y1,x2,y2){return SVG.Line.prototype.plot.apply(this.put(new SVG.Line),null!=x1?[x1,y1,x2,y2]:[0,0,0,0])}}}),SVG.Polyline=SVG.invent({create:"polyline",inherit:SVG.Shape,construct:{polyline:function(p){return this.put(new SVG.Polyline).plot(p||new SVG.PointArray)}}}),SVG.Polygon=SVG.invent({create:"polygon",inherit:SVG.Shape,construct:{polygon:function(p){return this.put(new SVG.Polygon).plot(p||new SVG.PointArray)}}}),SVG.extend(SVG.Polyline,SVG.Polygon,{array:function(){return this._array||(this._array=new SVG.PointArray(this.attr("points")))},plot:function(p){return null==p?this.array():this.clear().attr("points","string"==typeof p?p:this._array=new SVG.PointArray(p))},clear:function(){return delete this._array,this},move:function(x,y){return this.attr("points",this.array().move(x,y))},size:function(width,height){var p=proportionalSize(this,width,height);return this.attr("points",this.array().size(p.width,p.height))}}),SVG.extend(SVG.Line,SVG.Polyline,SVG.Polygon,{morphArray:SVG.PointArray,x:function(x){return null==x?this.bbox().x:this.move(x,this.bbox().y)},y:function(y){return null==y?this.bbox().y:this.move(this.bbox().x,y)},width:function(width){var b=this.bbox();return null==width?b.width:this.size(width,b.height)},height:function(height){var b=this.bbox();return null==height?b.height:this.size(b.width,height)}}),SVG.Path=SVG.invent({create:"path",inherit:SVG.Shape,extend:{morphArray:SVG.PathArray,array:function(){return this._array||(this._array=new SVG.PathArray(this.attr("d")))},plot:function(d){return null==d?this.array():this.clear().attr("d","string"==typeof d?d:this._array=new SVG.PathArray(d))},clear:function(){return delete this._array,this},move:function(x,y){return this.attr("d",this.array().move(x,y))},x:function(x){return null==x?this.bbox().x:this.move(x,this.bbox().y)},y:function(y){return null==y?this.bbox().y:this.move(this.bbox().x,y)},size:function(width,height){var p=proportionalSize(this,width,height);return this.attr("d",this.array().size(p.width,p.height))},width:function(width){return null==width?this.bbox().width:this.size(width,this.bbox().height)},height:function(height){return null==height?this.bbox().height:this.size(this.bbox().width,height)}},construct:{path:function(d){return this.put(new SVG.Path).plot(d||new SVG.PathArray)}}}),SVG.Image=SVG.invent({create:"image",inherit:SVG.Shape,extend:{load:function(url){if(!url)return this;var self=this,img=new window.Image;return SVG.on(img,"load",function(){var p=self.parent(SVG.Pattern);null!==p&&(0==self.width()&&0==self.height()&&self.size(img.width,img.height),p&&0==p.width()&&0==p.height()&&p.size(self.width(),self.height()),"function"==typeof self._loaded&&self._loaded.call(self,{width:img.width,height:img.height,ratio:img.width/img.height,url:url}))}),SVG.on(img,"error",function(e){"function"==typeof self._error&&self._error.call(self,e)}),this.attr("href",img.src=this.src=url,SVG.xlink)},loaded:function(loaded){return this._loaded=loaded,this},error:function(error){return this._error=error,this}},construct:{image:function(source,width,height){return this.put(new SVG.Image).load(source).size(width||0,height||width||0)}}}),SVG.Text=SVG.invent({create:function(){this.constructor.call(this,SVG.create("text")),this.dom.leading=new SVG.Number(1.3),this._rebuild=!0,this._build=!1,this.attr("font-family",SVG.defaults.attrs["font-family"])},inherit:SVG.Shape,extend:{x:function(x){return null==x?this.attr("x"):this.attr("x",x)},y:function(y){var oy=this.attr("y"),o="number"==typeof oy?oy-this.bbox().y:0;return null==y?"number"==typeof oy?oy-o:oy:this.attr("y","number"==typeof y?y+o:y)},cx:function(x){return null==x?this.bbox().cx:this.x(x-this.bbox().width/2)},cy:function(y){return null==y?this.bbox().cy:this.y(y-this.bbox().height/2)},text:function(text){if("undefined"==typeof text){for(var text="",children=this.node.childNodes,i=0,len=children.length;len>i;++i)0!=i&&3!=children[i].nodeType&&1==SVG.adopt(children[i]).dom.newLined&&(text+="\n"),text+=children[i].textContent;return text}if(this.clear().build(!0),"function"==typeof text)text.call(this,this);else{text=text.split("\n");for(var i=0,il=text.length;il>i;i++)this.tspan(text[i]).newLine()}return this.build(!1).rebuild()},size:function(size){return this.attr("font-size",size).rebuild()},leading:function(value){return null==value?this.dom.leading:(this.dom.leading=new SVG.Number(value),this.rebuild())},lines:function(){var node=(this.textPath&&this.textPath()||this).node,lines=SVG.utils.map(SVG.utils.filterSVGElements(node.childNodes),function(el){return SVG.adopt(el)});return new SVG.Set(lines)},rebuild:function(rebuild){if("boolean"==typeof rebuild&&(this._rebuild=rebuild),this._rebuild){var self=this,blankLineOffset=0,dy=this.dom.leading*new SVG.Number(this.attr("font-size"));this.lines().each(function(){this.dom.newLined&&(self.textPath()||this.attr("x",self.attr("x")),"\n"==this.text()?blankLineOffset+=dy:(this.attr("dy",dy+blankLineOffset),blankLineOffset=0))}),this.fire("rebuild")}return this},build:function(build){return this._build=!!build,this},setData:function(o){return this.dom=o,this.dom.leading=new SVG.Number(o.leading||1.3),this}},construct:{text:function(text){return this.put(new SVG.Text).text(text)},plain:function(text){return this.put(new SVG.Text).plain(text)}}}),SVG.Tspan=SVG.invent({create:"tspan",inherit:SVG.Shape,extend:{text:function(text){return null==text?this.node.textContent+(this.dom.newLined?"\n":""):("function"==typeof text?text.call(this,this):this.plain(text),this)},dx:function(dx){return this.attr("dx",dx)},dy:function(dy){return this.attr("dy",dy)},newLine:function(){var t=this.parent(SVG.Text);return this.dom.newLined=!0,this.dy(t.dom.leading*t.attr("font-size")).attr("x",t.x())}}}),SVG.extend(SVG.Text,SVG.Tspan,{plain:function(text){return this._build===!1&&this.clear(),this.node.appendChild(document.createTextNode(text)),this},tspan:function(text){var node=(this.textPath&&this.textPath()||this).node,tspan=new SVG.Tspan;return this._build===!1&&this.clear(),node.appendChild(tspan.node),tspan.text(text)},clear:function(){for(var node=(this.textPath&&this.textPath()||this).node;node.hasChildNodes();)node.removeChild(node.lastChild);return this},length:function(){return this.node.getComputedTextLength()}}),SVG.TextPath=SVG.invent({create:"textPath",inherit:SVG.Parent,parent:SVG.Text,construct:{path:function(d){for(var path=new SVG.TextPath,track=this.doc().defs().path(d);this.node.hasChildNodes();)path.node.appendChild(this.node.firstChild);return this.node.appendChild(path.node),path.attr("href","#"+track,SVG.xlink),this},array:function(){var track=this.track();return track?track.array():null},plot:function(d){var track=this.track(),pathArray=null;return track&&(pathArray=track.plot(d)),null==d?pathArray:this},track:function(){var path=this.textPath();return path?path.reference("href"):void 0},textPath:function(){return this.node.firstChild&&"textPath"==this.node.firstChild.nodeName?SVG.adopt(this.node.firstChild):void 0}}}),SVG.Nested=SVG.invent({create:function(){this.constructor.call(this,SVG.create("svg")),this.style("overflow","visible")},inherit:SVG.Container,construct:{nested:function(){return this.put(new SVG.Nested)}}}),SVG.A=SVG.invent({create:"a",inherit:SVG.Container,extend:{to:function(url){return this.attr("href",url,SVG.xlink)},show:function(target){return this.attr("show",target,SVG.xlink)},target:function(target){return this.attr("target",target)}},construct:{link:function(url){return this.put(new SVG.A).to(url)}}}),SVG.extend(SVG.Element,{linkTo:function(url){var link=new SVG.A;return"function"==typeof url?url.call(link,link):link.to(url),this.parent().put(link).put(this)}}),SVG.Marker=SVG.invent({create:"marker",inherit:SVG.Container,extend:{width:function(width){return this.attr("markerWidth",width)},height:function(height){return this.attr("markerHeight",height)},ref:function(x,y){return this.attr("refX",x).attr("refY",y)},update:function(block){return this.clear(),"function"==typeof block&&block.call(this,this),this},toString:function(){return"url(#"+this.id()+")"}},construct:{marker:function(width,height,block){return this.defs().marker(width,height,block)}}}),SVG.extend(SVG.Defs,{marker:function(width,height,block){return this.put(new SVG.Marker).size(width,height).ref(width/2,height/2).viewbox(0,0,width,height).attr("orient","auto").update(block)}}),SVG.extend(SVG.Line,SVG.Polyline,SVG.Polygon,SVG.Path,{marker:function(marker,width,height,block){var attr=["marker"];return"all"!=marker&&attr.push(marker),attr=attr.join("-"),marker=arguments[1]instanceof SVG.Marker?arguments[1]:this.doc().marker(width,height,block),this.attr(attr,marker)}});var sugar={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(t,a){return"color"==a?t:t+"-"+a}};["fill","stroke"].forEach(function(m){var i,extension={};extension[m]=function(o){if("undefined"==typeof o)return this;if("string"==typeof o||SVG.Color.isRgb(o)||o&&"function"==typeof o.fill)this.attr(m,o);else for(i=sugar[m].length-1;i>=0;i--)null!=o[sugar[m][i]]&&this.attr(sugar.prefix(m,sugar[m][i]),o[sugar[m][i]]);return this},SVG.extend(SVG.Element,SVG.FX,extension)}),SVG.extend(SVG.Element,SVG.FX,{rotate:function(d,cx,cy){return this.transform({rotation:d,cx:cx,cy:cy})},skew:function(x,y,cx,cy){return 1==arguments.length||3==arguments.length?this.transform({skew:x,cx:y,cy:cx}):this.transform({skewX:x,skewY:y,cx:cx,cy:cy})},scale:function(x,y,cx,cy){return 1==arguments.length||3==arguments.length?this.transform({scale:x,cx:y,cy:cx}):this.transform({scaleX:x,scaleY:y,cx:cx,cy:cy})},translate:function(x,y){return this.transform({x:x,y:y})},flip:function(a,o){return o="number"==typeof a?a:o,this.transform({flip:a||"both",offset:o})},matrix:function(m){return this.attr("transform",new SVG.Matrix(6==arguments.length?[].slice.call(arguments):m))},opacity:function(value){return this.attr("opacity",value)},dx:function(x){return this.x(new SVG.Number(x).plus(this instanceof SVG.FX?0:this.x()),!0)},dy:function(y){return this.y(new SVG.Number(y).plus(this instanceof SVG.FX?0:this.y()),!0)},dmove:function(x,y){return this.dx(x).dy(y)}}),SVG.extend(SVG.Rect,SVG.Ellipse,SVG.Circle,SVG.Gradient,SVG.FX,{radius:function(x,y){var type=(this._target||this).type;return"radial"==type||"circle"==type?this.attr("r",new SVG.Number(x)):this.rx(x).ry(null==y?x:y)}}),SVG.extend(SVG.Path,{length:function(){return this.node.getTotalLength()},pointAt:function(length){return this.node.getPointAtLength(length)}}),SVG.extend(SVG.Parent,SVG.Text,SVG.Tspan,SVG.FX,{font:function(a,v){if("object"==typeof a)for(v in a)this.font(v,a[v]);return"leading"==a?this.leading(v):"anchor"==a?this.attr("text-anchor",v):"size"==a||"family"==a||"weight"==a||"stretch"==a||"variant"==a||"style"==a?this.attr("font-"+a,v):this.attr(a,v)}}),SVG.Set=SVG.invent({create:function(members){Array.isArray(members)?this.members=members:this.clear()},extend:{add:function(){var i,il,elements=[].slice.call(arguments);for(i=0,il=elements.length;il>i;i++)this.members.push(elements[i]);return this},remove:function(element){var i=this.index(element);return i>-1&&this.members.splice(i,1),this},each:function(block){for(var i=0,il=this.members.length;il>i;i++)block.apply(this.members[i],[i,this.members]);return this},clear:function(){return this.members=[],this},length:function(){return this.members.length},has:function(element){return this.index(element)>=0},index:function(element){return this.members.indexOf(element)},get:function(i){return this.members[i]},first:function(){return this.get(0)},last:function(){return this.get(this.members.length-1)},valueOf:function(){return this.members},bbox:function(){if(0==this.members.length)return new SVG.RBox;var rbox=this.members[0].rbox(this.members[0].doc());return this.each(function(){rbox=rbox.merge(this.rbox(this.doc()))}),rbox}},construct:{set:function(members){return new SVG.Set(members)}}}),SVG.FX.Set=SVG.invent({create:function(set){this.set=set}}),SVG.Set.inherit=function(){var m,methods=[];for(var m in SVG.Shape.prototype)"function"==typeof SVG.Shape.prototype[m]&&"function"!=typeof SVG.Set.prototype[m]&&methods.push(m);methods.forEach(function(method){SVG.Set.prototype[method]=function(){for(var i=0,il=this.members.length;il>i;i++)this.members[i]&&"function"==typeof this.members[i][method]&&this.members[i][method].apply(this.members[i],arguments);return"animate"==method?this.fx||(this.fx=new SVG.FX.Set(this)):this}}),methods=[];for(var m in SVG.FX.prototype)"function"==typeof SVG.FX.prototype[m]&&"function"!=typeof SVG.FX.Set.prototype[m]&&methods.push(m);methods.forEach(function(method){SVG.FX.Set.prototype[method]=function(){for(var i=0,il=this.set.members.length;il>i;i++)this.set.members[i].fx[method].apply(this.set.members[i].fx,arguments);return this}})},SVG.extend(SVG.Element,{data:function(a,v,r){if("object"==typeof a)for(v in a)this.data(v,a[v]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+a))}catch(e){return this.attr("data-"+a)}else this.attr("data-"+a,null===v?null:r===!0||"string"==typeof v||"number"==typeof v?v:JSON.stringify(v));return this}}),SVG.extend(SVG.Element,{remember:function(k,v){if("object"==typeof arguments[0])for(var v in k)this.remember(v,k[v]);else{if(1==arguments.length)return this.memory()[k];this.memory()[k]=v}return this},forget:function(){if(0==arguments.length)this._memory={};else for(var i=arguments.length-1;i>=0;i--)delete this.memory()[arguments[i]];return this},memory:function(){return this._memory||(this._memory={})}}),SVG.get=function(id){var node=document.getElementById(idFromReference(id)||id);return SVG.adopt(node)},SVG.select=function(query,parent){return new SVG.Set(SVG.utils.map((parent||document).querySelectorAll(query),function(node){return SVG.adopt(node)}))},SVG.extend(SVG.Parent,{select:function(query){return SVG.select(query,this.node)}});var abcdef="abcdef".split("");if("function"!=typeof window.CustomEvent){var CustomEvent=function(event,options){options=options||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");return e.initCustomEvent(event,options.bubbles,options.cancelable,options.detail),e};CustomEvent.prototype=window.Event.prototype,window.CustomEvent=CustomEvent}return function(w){for(var lastTime=0,vendors=["moz","webkit"],x=0;x<vendors.length&&!window.requestAnimationFrame;++x)w.requestAnimationFrame=w[vendors[x]+"RequestAnimationFrame"],w.cancelAnimationFrame=w[vendors[x]+"CancelAnimationFrame"]||w[vendors[x]+"CancelRequestAnimationFrame"];w.requestAnimationFrame=w.requestAnimationFrame||function(callback){var currTime=(new Date).getTime(),timeToCall=Math.max(0,16-(currTime-lastTime)),id=w.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);return lastTime=currTime+timeToCall,id},w.cancelAnimationFrame=w.cancelAnimationFrame||w.clearTimeout}(window),SVG});var Mouse={};Mouse.x=0,Mouse.y=0,Mouse.isTouchSupported="ontouchstart"in window,Mouse.START=Mouse.isTouchSupported?"touchstart":"mousedown",Mouse.MOVE=Mouse.isTouchSupported?"touchmove":"mousemove",Mouse.END=Mouse.isTouchSupported?"touchend":"mouseup",Mouse.get=function(event,elem){elem||(elem=event.currentTarget),event.touches?event.touches.length&&(Mouse.x=parseInt(event.touches[0].pageX),Mouse.y=parseInt(event.touches[0].pageY)):(Mouse.x=parseInt(event.clientX),Mouse.y=parseInt(event.clientY));var rect=elem.getBoundingClientRect();return Mouse.x+=elem.scrollLeft-elem.clientLeft-rect.left,Mouse.y+=elem.scrollTop-elem.clientTop-rect.top,Mouse},ImagesLoader.prototype.load=function(imgList){var i;for(this.imageCount=imgList.length,i=0;i<this.imageCount;i++)this.loadImage(imgList[i])},ImagesLoader.prototype.loadImage=function(url){var img=new Image;this.images.push(img),this.images[url]=img,img.onload=this.handleOnLoad.bind(this),img.onerror=this.handleOnError.bind(this),img.src=url},ImagesLoader.prototype.handleOnLoad=function(){this.checkComplete()},ImagesLoader.prototype.handleOnError=function(){console.log("Failed to load img "+this),this.checkComplete()},ImagesLoader.prototype.checkComplete=function(){if(--this.imageCount<=0&&null!==this.completeCallback){var temp=this.completeCallback;this.completeCallback=null,temp()}},console||(console={log:function(){}}),function(){Function.prototype.bind||(Function.prototype.bind=function(oThis){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var aArgs=Array.prototype.slice.call(arguments,1),fToBind=this,fNOP=function(){},fBound=function(){return fToBind.apply(this instanceof fNOP&&oThis?this:oThis,aArgs.concat(Array.prototype.slice.call(arguments)))};return fNOP.prototype=this.prototype,fBound.prototype=new fNOP,fBound})}(),function(){function CustomEvent(event,params){params=params||{bubbles:!1,cancelable:!1,detail:void 0};var evt=document.createEvent("CustomEvent");return evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail),evt}CustomEvent.prototype=window.Event.prototype,window.CustomEvent=CustomEvent}(),define("transform-utils",function(){}),TransformTool.prototype.setTarget=function(target){this.target!==target&&(this.target=target,this.updateFromTarget())},TransformTool.prototype.updateFromTarget=function(){this.target&&this.target.matrix&&(this.endMatrix.copyFrom(this.target.matrix),this.commit(),this.updateRegistration(),this.updateControls())},TransformTool.prototype.setControls=function(controls){if(this.controls.length=0,controls&&controls.length){var i=0,n=controls.length;for(i=0;n>i;i++)controls[i].tool=this,this.controls[i]=controls[i],this.controls[i].updatePosition()}},TransformTool.prototype.updateControls=function(){var i=0,n=this.controls.length;for(i=0;n>i;i++)this.controls[i].updatePosition()},TransformTool.prototype.getControlAt=function(x,y){for(var i=this.controls.length;i--;)if(this.controls[i].contains(x,y))return this.controls[i];return null},TransformTool.prototype.draw=function(){if(this.shouldDraw()){var i=0,n=this.controls.length;for(i=0;n>i;i++)this.controls[i].draw(this.container)}},TransformTool.prototype.shouldDraw=function(){return null!==this.target},TransformTool.prototype.start=function(x,y,control){if(!this.target)return!1;if(this.end(),this.control=control||this.getControlAt(x,y),this.control){if(13===this.control.type)return this.remove(this.control),!0;if(this.startX=x,this.startY=y,this.dU=0,this.dV=0,this.control.dynamicUV){var cx=x-this.startMatrix.x,cy=y-this.startMatrix.y;this.control.u=(this.inv.a*cx+this.inv.c*cy)/this.target.width,this.control.v=(this.inv.d*cy+this.inv.b*cx)/this.target.height}return this.updateRegistration(),!0}return!1},TransformTool.prototype.remove=function(ctrl){console.log("Remove this element.")},TransformTool.prototype.move=function(x,y){this.updateMoveValues(x,y),this.control&&(this.applyControl(),this.updateTransform(),this.updateTarget(),this.updateRegistration(),this.updateControls())},TransformTool.prototype.end=function(){this.commit(),this.control=null},TransformTool.prototype.updateMoveValues=function(x,y){this.endX=x,this.endY=y;var cx=this.endX-this.startX,cy=this.endY-this.startY;this.dU=(this.inv.a*cx+this.inv.c*cy)/this.target.width,this.dV=(this.inv.d*cy+this.inv.b*cx)/this.target.height},TransformTool.prototype.applyControl=function(){if(this.control){if(null!==this.control.transformCallback&&!this.control.transformCallback(this.control))return;var x=0,y=0,w=this.target.width,h=this.target.height,cu=this.control.u-this.regStartU,cv=this.control.v-this.regStartV;switch(cu>0?1>cu*w&&(cu=1/w):cu*w>-1&&(cu=-1/w),cv>0?1>cv*h&&(cv=1/h):cv*h>-1&&(cv=-1/h),this.control.type){case Control.SCALE:x=(cu+this.dU)/cu,y=(cv+this.dV)/cv,this.preMatrix.scale(x,y);break;case Control.SCALE_X:x=(cu+this.dU)/cu,this.preMatrix.scale(x,1);break;case Control.SCALE_Y:y=(cv+this.dV)/cv,this.preMatrix.scale(1,y);break;case Control.SCALE_UNIFORM:x=(cu+this.dU)/cu,y=(cv+this.dV)/cv,w=y?Math.abs(x/y):0,h=x?Math.abs(y/x):0,0===w||0===h?(x=0,y=0):w>h?x*=h:y*=w,this.preMatrix.scale(x,y);break;case Control.SKEW_X:this.preMatrix.c=w/h*(this.dU/cv);break;case Control.SKEW_Y:this.preMatrix.b=h/w*(this.dV/cu);break;case Control.ROTATE_SCALE:x=this.startX-this.regX,y=this.startY-this.regY;var ex=this.endX-this.regX,ey=this.endY-this.regY,angle=Math.atan2(ey,ex)-Math.atan2(y,x);this.postMatrix.rotate(angle);var s=Math.sqrt(x*x+y*y);0===s?this.preMatrix.scale(0,0):(s=Math.sqrt(ex*ex+ey*ey)/s,this.preMatrix.scale(s,s));break;case Control.ROTATE:x=Math.atan2(this.startY-this.regY,this.startX-this.regX),y=Math.atan2(this.endY-this.regY,this.endX-this.regX),this.postMatrix.rotate(y-x);break;case Control.TRANSLATE:this.postMatrix.translate(this.endX-this.startX,this.endY-this.startY);break;case Control.REGISTRATION:this.regEndU=this.regStartU+this.dU,this.regEndV=this.regStartV+this.dV}}},TransformTool.prototype.updateRegistration=function(){var x=this.regEndU*this.target.width,y=this.regEndV*this.target.height,m=this.endMatrix;this.regX=m.x+m.a*x+m.c*y,this.regY=m.y+m.d*y+m.b*x},TransformTool.prototype.setTranslation=function(transformMatrix,x,y){transformMatrix.x=x,transformMatrix.y=y},TransformTool.prototype.updateTransform=function(){this.endMatrix.identity(),this.endMatrix.concat(this.preMatrix),this.endMatrix.concat(this.startMatrix);var x=this.endMatrix.x+this.postMatrix.x,y=this.endMatrix.y+this.postMatrix.y;this.endMatrix.concat(this.postMatrix),this.setTranslation(this.endMatrix,x,y),this.applyRegistrationOffset(),this.preMatrix.identity(),this.postMatrix.identity()},TransformTool.prototype.applyRegistrationOffset=function(){if(0!==this.regEndU||0!==this.regEndV){var x=this.regEndU*this.target.width,y=this.regEndV*this.target.height,rx=this.startMatrix.a*x+this.startMatrix.c*y,ry=this.startMatrix.d*y+this.startMatrix.b*x;rx-=this.endMatrix.a*x+this.endMatrix.c*y,ry-=this.endMatrix.d*y+this.endMatrix.b*x,this.endMatrix.translate(rx,ry)}},TransformTool.prototype.updateTarget=function(){this.target&&this.target.matrix&&!this.target.matrix.equals(this.endMatrix)&&(this.target.matrix.copyFrom(this.endMatrix),null!==this.target.changed&&this.target.changed())},TransformTool.prototype.commit=function(){this.regStartU=this.regEndU,this.regStartV=this.regEndV,this.startMatrix.copyFrom(this.endMatrix),this.sanitizeStartMatrix(),this.inv.copyFrom(this.startMatrix),this.inv.invert()},TransformTool.prototype.sanitizeStartMatrix=function(){this.target&&(0===this.startMatrix.a&&0===this.startMatrix.b&&(this.startMatrix.a=1/this.target.width),0===this.startMatrix.d&&0===this.startMatrix.c&&(this.startMatrix.d=1/this.target.height))},Control.SCALE=1,Control.SCALE_X=2,Control.SCALE_Y=3,Control.SCALE_UNIFORM=4,Control.ROTATE=5,Control.TRANSLATE=6,Control.REGISTRATION=7,Control.SKEW_X=8,Control.SKEW_Y=9,Control.BORDER=10,Control.TARGET=11,Control.ROTATE_SCALE=12,Control.CLOSE=13,Control.SHAPE_CIRCLE=1,Control.SHAPE_SQUARE=2,Control.SHAPE_CLOSE=3,Control.prototype.setDefaultShape=function(){switch(this.type){case Control.ROTATE:case Control.ROTATE_SCALE:case Control.REGISTRATION:this.shape=Control.SHAPE_CIRCLE;break;case Control.SCALE:case Control.SCALE_UNIFORM:case Control.SCALE_X:case Control.SCALE_Y:case Control.SKEW_X:case Control.SKEW_Y:this.shape=Control.SHAPE_SQUARE;break;case Control.CLOSE:this.shape=Control.SHAPE_CLOSE;break;case Control.BORDER:this.shape=Control.SHAPE_BORDER}},Control.prototype.updatePosition=function(){if(this.tool&&this.tool.target){if(this.type===Control.REGISTRATION)return this.x=this.tool.regX,void(this.y=this.tool.regY);var m=this.tool.endMatrix,w=this.tool.target.width*this.u,h=this.tool.target.height*this.v;this.x=m.x+m.a*w+m.c*h,this.y=m.y+m.d*h+m.b*w;var angle=0;this.offsetX&&(angle=m.getRotationX(),this.x+=this.offsetX*Math.cos(angle),this.y+=this.offsetX*Math.sin(angle)),this.offsetY&&(angle=m.getRotationY(),this.x+=this.offsetY*Math.sin(angle),this.y+=this.offsetY*Math.cos(angle))}},Control.prototype.draw=function(ctx){if((null===this.drawCallback||this.drawCallback(this,ctx))&&!(this.size<=0)){var x=0,y=0;switch(ctx.save(),ctx.beginPath(),ctx.fillStyle=this.tool.fillStyle,ctx.strokeStyle=this.tool.strokeStyle,ctx.lineWidth=this.tool.lineWidth,this.shape){case Control.SHAPE_CIRCLE:ctx.arc(this.x,this.y,this.size/2,0,2*Math.PI),ctx.fill(),ctx.stroke();break;case Control.SHAPE_SQUARE:x=this.x-this.size/2|0,y=this.y-this.size/2|0,ctx.fillRect(x,y,this.size,this.size),ctx.strokeRect(x,y,this.size,this.size);break;case Control.SHAPE_CLOSE:x=this.x-this.size/2|0,y=this.y-this.size/2|0,ctx.fillRect(x,y,this.size,this.size),ctx.strokeRect(x,y,this.size,this.size);break;case Control.SHAPE_BORDER:ctx.fillStyle="";var t=this.tool.target,m=this.tool.endMatrix;ctx.moveTo(m.x,m.y),x=m.x+m.a*t.width,y=m.y+m.b*t.width,ctx.lineTo(x,y),x=m.x+m.a*t.width+m.c*t.height,y=m.y+m.d*t.height+m.b*t.width,ctx.lineTo(x,y),x=m.x+m.c*t.height,y=m.y+m.d*t.height,ctx.lineTo(x,y),ctx.lineTo(m.x,m.y),ctx.stroke()}ctx.restore()}},Control.prototype.contains=function(x,y){if(this.hitTestTarget){var t=this.tool.target;return t.matrix.containsPoint(x,y,t.width,t.height)}var cx=Math.abs(this.x-x),cy=Math.abs(this.y-y),sr=this.size/2;return sr>cx&&sr>cy?!0:!1};var ControlSet={};ControlSet.controlClass=Control,ControlSet.getStandard=function(){var translater=new this.controlClass(Control.TRANSLATE);return translater.hitTestTarget=!0,[new this.controlClass(Control.BORDER),translater,new this.controlClass(Control.ROTATE,0,0,0,0,10),new this.controlClass(Control.ROTATE,0,1,0,0,10),new this.controlClass(Control.ROTATE,1,0,0,0,10),new this.controlClass(Control.ROTATE,1,1,0,0,10),new this.controlClass(Control.SCALE_X,0,.5,0,0,10),new this.controlClass(Control.SCALE_X,1,.5,0,0,10),new this.controlClass(Control.SCALE_Y,.5,0,0,0,10),new this.controlClass(Control.SCALE_Y,.5,1,0,0,10)]},ControlSet.getScaler=function(){var translater=new this.controlClass(Control.TRANSLATE);return translater.hitTestTarget=!0,[new this.controlClass(Control.BORDER),translater,new this.controlClass(Control.SCALE,0,0,0,0,10),new this.controlClass(Control.SCALE,0,1,0,0,10),new this.controlClass(Control.SCALE,1,0,0,0,10),new this.controlClass(Control.SCALE,1,1,0,0,10),new this.controlClass(Control.SCALE_X,0,.5,0,0,10),new this.controlClass(Control.SCALE_X,1,.5,0,0,10),new this.controlClass(Control.SCALE_Y,.5,0,0,0,10),new this.controlClass(Control.SCALE_Y,.5,1,0,0,10)]},ControlSet.getUniformScaler=function(){var translater=new this.controlClass(Control.TRANSLATE);return translater.hitTestTarget=!0,[new this.controlClass(Control.BORDER),translater,new this.controlClass(Control.SCALE_UNIFORM,0,0,0,0,10),new this.controlClass(Control.SCALE_UNIFORM,0,1,0,0,10),new this.controlClass(Control.SCALE_UNIFORM,1,0,0,0,10),new this.controlClass(Control.SCALE_UNIFORM,1,1,0,0,10)]},ControlSet.getScalerWithRotate=function(){var translater=new this.controlClass(Control.TRANSLATE,0,0,0,0,-1);return translater.hitTestTarget=!0,[new this.controlClass(Control.BORDER),translater,new this.controlClass(Control.ROTATE,.5,0,0,-20,10),new this.controlClass(Control.SCALE,0,0,0,0,10),new this.controlClass(Control.SCALE,0,1,0,0,10),new this.controlClass(Control.SCALE,1,0,0,0,10),new this.controlClass(Control.SCALE,1,1,0,0,10),new this.controlClass(Control.SCALE_X,0,.5,0,0,10),new this.controlClass(Control.SCALE_X,1,.5,0,0,10),new this.controlClass(Control.SCALE_Y,.5,0,0,0,10),new this.controlClass(Control.SCALE_Y,.5,1,0,0,10)]},ControlSet.getDynamic=function(){var dyn=new this.controlClass(Control.TRANSLATE);return dyn.dynamicUV=!0,dyn.hitTestTarget=!0,[new this.controlClass(Control.BORDER),dyn]},Matrix.temp=new Matrix,Matrix.prototype.toString=function(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.x+","+this.y+")"},Matrix.prototype.equals=function(m){return this.a===m.a&&this.b===m.b&&this.c===m.c&&this.d===m.d&&this.x===m.x&&this.y===m.y?!0:!1},Matrix.prototype.identity=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.x=0,this.y=0},Matrix.prototype.clone=function(){return new Matrix(this.a,this.b,this.c,this.d,this.x,this.y)},Matrix.prototype.copyFrom=function(m){this.a=m.a,this.b=m.b,this.c=m.c,this.d=m.d,this.x=m.x,this.y=m.y},Matrix.prototype.rotate=function(angle){var u=Math.cos(angle),v=Math.sin(angle),temp=this.a;this.a=u*this.a-v*this.b,this.b=v*temp+u*this.b,temp=this.c,this.c=u*this.c-v*this.d,this.d=v*temp+u*this.d,temp=this.x,this.x=u*this.x-v*this.y,this.y=v*temp+u*this.y},Matrix.prototype.translate=function(x,y){this.x+=x,this.y+=y},Matrix.prototype.concat=function(m){var a=this.a*m.a,b=0,c=0,d=this.d*m.d,x=this.x*m.a+m.x,y=this.y*m.d+m.y;(0!==this.b||0!==this.c||0!==m.b||0!==m.c)&&(a+=this.b*m.c,d+=this.c*m.b,b+=this.a*m.b+this.b*m.d,c+=this.c*m.a+this.d*m.c,x+=this.y*m.c,y+=this.x*m.b),this.a=a,this.b=b,this.c=c,this.d=d,this.x=x,this.y=y},Matrix.prototype.invert=function(){if(0===this.b&&0===this.c&&0!==this.a&&0!==this.d)this.a=1/this.a,this.d=1/this.d,this.b=0,this.c=0,this.x=-this.a*this.x,this.y=-this.d*this.y;else{var det=this.a*this.d-this.b*this.c;if(0===det)return void this.identity();det=1/det;var temp=this.a;this.a=this.d*det,this.b=-this.b*det,this.c=-this.c*det,this.d=temp*det,temp=this.y,this.y=-(this.b*this.x+this.d*this.y),this.x=-(this.a*this.x+this.c*temp)}},Matrix.prototype.getRotationX=function(){return Math.atan2(this.b,this.a)},Matrix.prototype.getRotationY=function(){return Math.atan2(this.c,this.d)},Matrix.prototype.getTransformedX=function(x,y){return this.x+this.a*x+this.c*y},Matrix.prototype.getTransformedY=function(x,y){return this.y+this.d*y+this.b*x},Matrix.prototype.scale=function(x,y){this.a*=x,this.b*=y,this.c*=x,this.d*=y,this.x*=x,this.y*=y},Matrix.prototype.containsPoint=function(x,y,w,h){var inv=Matrix.temp;inv.copyFrom(this),inv.invert();var tx=inv.x+inv.a*x+inv.c*y,ty=inv.y+inv.d*y+inv.b*x;return tx>=0&&w>=tx&&ty>=0&&h>=ty?!0:!1},define("transform",function(){}),DOMTransformTool.prototype=new TransformTool,DOMTransformTool.prototype._super=TransformTool,DOMTransformTool.prototype.constructor=DOMTransformTool,DOMTransformTool.DEFAULT_ALIGN_THRESHOLD=10,DOMTransformTool.prototype.getBBoxByTransformMatrix=function(transformMatrix){var bbox=[1e4,1e4,-1e4,-1e4];[[0,0],[this.target.width,0],[this.target.width,this.target.height],[0,this.target.height]].map(function(point){var coords=[transformMatrix.getTransformedX(point[0],point[1]),transformMatrix.getTransformedY(point[0],point[1])];
return bbox[0]=Math.min(coords[0],bbox[0]),bbox[1]=Math.min(coords[1],bbox[1]),bbox[2]=Math.max(coords[0],bbox[2]),bbox[3]=Math.max(coords[1],bbox[3]),coords});return bbox},DOMTransformTool.prototype._getTransformByAlignObject=function(sourceValue,alignLines,localAligns,trnValue,indexValue){var ALIGN_INDEX_IS_DYNAMIC=4,ALIGN_INDEX_THR=5,ALIGN_INDEX_ALLOW_UV=6,ALIGN_INDEX_ACTIVE=7,indexRect=indexValue?0:1;return resultTransformValue=sourceValue,touchedAlignLines=[],bbox=this.getBBoxByTransformMatrix(this.endMatrix),bboxSize=[bbox[2]-bbox[0],bbox[3]-bbox[1]],alignLines.length&&alignLines.forEach(function(alignLine,alignLineIndex){alignLine[ALIGN_INDEX_ACTIVE]=0,localAligns.length&&localAligns.forEach(function(localAlignValue){if(!(alignLine[ALIGN_INDEX_ALLOW_UV]&&alignLine[ALIGN_INDEX_ALLOW_UV].indexOf(localAlignValue)<0)){var currentValue=bbox[indexValue]+bboxSize[indexValue]*localAlignValue;if(Math.abs(alignLine[indexValue]-currentValue)<(alignLine[ALIGN_INDEX_THR]||DOMTransformTool.DEFAULT_ALIGN_THRESHOLD)){var relateValue=bboxSize[indexValue]*localAlignValue;resultTransformValue=alignLine[indexValue]-trnValue-relateValue+.5*bboxSize[indexValue],touchedAlignLines.push([alignLineIndex,alignLine[indexValue],resultTransformValue,relateValue]),alignLine[ALIGN_INDEX_IS_DYNAMIC]&&(alignLine[indexRect]=Math.min(bbox[indexRect],alignLine[ALIGN_INDEX_IS_DYNAMIC][0]),alignLine[indexRect+2]=Math.max(bbox[indexRect+2],alignLine[ALIGN_INDEX_IS_DYNAMIC][1]))}}})}),touchedAlignLines.length&&touchedAlignLines.forEach(function(al){Math.abs(resultTransformValue-al[2])<1&&(alignLines[al[0]][ALIGN_INDEX_ACTIVE]=1)}),resultTransformValue},DOMTransformTool.prototype.setTranslation=function(transformMatrix,x,y){if(this.control.type!==Control.TRANSLATE)return TransformTool.prototype.setTranslation.call(this,transformMatrix,x,y);var rx=.5*this.target.width,ry=.5*this.target.height,trnRx=this.startMatrix.a*rx+this.startMatrix.c*ry,trnRy=this.startMatrix.b*rx+this.startMatrix.d*ry;transformMatrix.x=this._getTransformByAlignObject(x,this.vertAligns,this.uAlignments,trnRx,0),transformMatrix.y=this._getTransformByAlignObject(y,this.horizAligns,this.vAlignments,trnRy,1)},DOMTransformTool.prototype.setControls=function(controls){if(this.controls){var i=0,n=this.controls.length;for(i=0;n>i;i++)this.controls[i].undraw(this.container)}DOMTransformTool.prototype._super.prototype.setControls.call(this,controls)},DOMTransformTool.prototype._super.prototype.remove=function(ctrl){var ctrlElem=document.getElementById(ctrl.id),removeEvent=new CustomEvent("removeElement",{bubbles:!0,cancelable:!1});ctrlElem.dispatchEvent(removeEvent)},DOMTransformTool.prototype.shouldDraw=function(){return!0},DOMControl.idCounter=0,DOMControl.idPrefix="-dom-control-",DOMControl.prototype=new Control,DOMControl.prototype._super=Control,DOMControl.prototype.constructor=DOMControl,DOMControl.prototype.undraw=function(){var elem=document.getElementById(this.id);elem&&elem.parentNode&&elem.parentNode.removeChild(elem)},DOMControl.prototype.setStyle=function(elem,fill){fill!==!1?elem.setAttribute("fill",this.tool.fillStyle):(elem.setAttribute("fill","#ffffff"),elem.setAttribute("fill-opacity","0")),elem.setAttribute("stroke",this.tool.strokeStyle),elem.setAttribute("stroke-width",this.tool.lineWidth)},DOMControl.prototype.setCloseStyle=function(elem,fill){fill!==!1?elem.setAttribute("fill",this.tool.fillStyle):elem.setAttribute("fill","none"),elem.setAttribute("stroke",this.tool.strokeStyle),elem.setAttribute("stroke-width",this.tool.lineWidth)},DOMControl.prototype.draw=function(container){if((null===this.drawCallback||this.drawCallback(this,container))&&!(this.size<=0)){var elem=document.getElementById(this.id),i=0;switch(this.shape){case Control.SHAPE_CIRCLE:elem||(elem=document.createElementNS("http://www.w3.org/2000/svg","use"),elem.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#tool-rotate"),elem.id=this.id,elem.setAttribute("class","rotate"),elem.width.baseVal.value=this.size,elem.height.baseVal.value=this.size,container.appendChild(elem)),elem.x.baseVal.value=this.x-this.size/2,elem.y.baseVal.value=this.y-this.size/2;break;case Control.SHAPE_SQUARE:elem||(elem=document.createElementNS(container.namespaceURI,"rect"),elem.id=this.id,elem.setAttribute("cursor",this.ctype),elem.width.baseVal.value=this.size,elem.height.baseVal.value=this.size,this.setStyle(elem),container.appendChild(elem)),elem.x.baseVal.value=this.x-this.size/2,elem.y.baseVal.value=this.y-this.size/2;break;case Control.SHAPE_CLOSE:elem||(elem=document.createElementNS("http://www.w3.org/2000/svg","use"),elem.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#tool-close-button"),elem.id=this.id,elem.setAttribute("cursor","pointer"),elem.width.baseVal.value=this.size,elem.height.baseVal.value=this.size,container.appendChild(elem)),elem.x.baseVal.value=this.x-this.size/2,elem.y.baseVal.value=this.y-this.size/2;break;case Control.SHAPE_BORDER:if(!elem){for(elem=document.createElementNS(container.namespaceURI,"polygon"),elem.id=this.id,elem.setAttribute("class","grab"),i=0;4>i;i++)elem.points.appendItem(container.createSVGPoint());this.setStyle(elem,!1),container.appendChild(elem)}var pt;if(this.tool&&this.tool.target){var t=this.tool.target,m=this.tool.endMatrix;pt=elem.points.getItem(0),pt.x=m.x,pt.y=m.y,pt=elem.points.getItem(1),pt.x=m.x+m.a*t.width,pt.y=m.y+m.b*t.width,pt=elem.points.getItem(2),pt.x=m.x+m.a*t.width+m.c*t.height,pt.y=m.y+m.d*t.height+m.b*t.width,pt=elem.points.getItem(3),pt.x=m.x+m.c*t.height,pt.y=m.y+m.d*t.height}}elem&&this.tool&&(this.tool.target?elem.style.display="":elem.style.display="none")}},define("transform-dom",["transform-utils","transform"],function(){}),define("services/AlignmentObjectsService",["angular","svgjs","transform-dom"],function(angular,svgjs){"use strict";var ALIGNMENT_TO_OBJECTS_THRESHOLD=DOMTransformTool.DEFAULT_ALIGN_THRESHOLD,ALIGNMENT_TO_STAGE_THRESHOLD=8;angular.module("logoBuilderApp.services.AlignmentObjectsService",[]).factory("AlignmentObjectsService",function(){function getSvgStageElement(){return $("#tool").get(0)}var AlignmentLinesDisplay=function(){function AlignmentLinesDisplay(){}var alignLines={};return AlignmentLinesDisplay.showActiveAlignmentLines=function(){if(this.tool.horizAligns.length||this.tool.vertAligns.length){var container=getSvgStageElement();this.tool.horizAligns.forEach(function(alignLine){AlignmentLinesDisplay.setAlignLine(container,alignLine[1],alignLine[0],alignLine[2],!1,alignLine[7])}),this.tool.vertAligns.forEach(function(alignLine){AlignmentLinesDisplay.setAlignLine(container,alignLine[0],alignLine[1],alignLine[3],!0,alignLine[7])})}},AlignmentLinesDisplay.setSvgElemnts=function(container,id,x1,y1,x2,y2,color){var elem;return alignLines[id]?elem=document.getElementById(id):(elem=document.createElementNS(container.namespaceURI,"line"),elem.id=id,elem.setAttribute("stroke",color||"#2AF")),elem.setAttribute("x1",Math.min(x1,x2)),elem.setAttribute("y1",Math.min(y1,y2)),elem.setAttribute("x2",Math.max(x1,x2)),elem.setAttribute("y2",Math.max(y1,y2)),elem.style.display="none",alignLines[id]||(container.appendChild(elem),alignLines[id]=!0),elem},AlignmentLinesDisplay.removeAllElements=function(){for(var svgElementId in alignLines)if(alignLines.hasOwnProperty(svgElementId)){var elem=document.getElementById(svgElementId);elem.parentNode.removeChild(elem),delete alignLines[svgElementId]}},AlignmentLinesDisplay.setAlignLine=function(container,position,minVal,maxVal,isVertical,isShow,color){var svgElement=AlignmentLinesDisplay.setSvgElemnts(container,"align-"+(isVertical?"v-":"h-")+position,isVertical?position:minVal,isVertical?minVal:position,isVertical?position:maxVal,isVertical?maxVal:position);isShow&&1.1>=isShow&&(svgElement.style.display="inline")},AlignmentLinesDisplay}(),TransformToolAlignmentDecorator=function(AlignmentLinesDisplay){function _createAlignmentLineParams(isVertical,position,threshold,allowedUV){var stageRect=getSvgStageElement().getBoundingClientRect();return[isVertical?position:0,isVertical?0:position,isVertical?position:stageRect.width,isVertical?stageRect.height:position,!1,threshold||DOMTransformTool.DEFAULT_ALIGN_THRESHOLD,allowedUV||[0,1,.5],!1]}function _setAlignmentLineDynamic(alignmentLineArray,bboxMinSideValue,bboxMaxSideValue){return alignmentLineArray[4]=[bboxMinSideValue,bboxMaxSideValue],alignmentLineArray}function _addAlignToStage(){var stageRect=getSvgStageElement().getBoundingClientRect();this.tool.horizAligns.push(_createAlignmentLineParams(!1,stageRect.height/2,ALIGNMENT_TO_STAGE_THRESHOLD,[.5])),this.tool.vertAligns.push(_createAlignmentLineParams(!0,stageRect.width/2,ALIGNMENT_TO_STAGE_THRESHOLD,[.5]))}function _addAlignToObjects(uValues,vValues){var _this=this,stageRect=getSvgStageElement().getBoundingClientRect();this.displayList.forEach(function(e){if(e.image!==_this.tool.target.owner.image){var objectRect=e.image.getBoundingClientRect();uValues.forEach(function(u){_this.tool.horizAligns.push(_setAlignmentLineDynamic(_createAlignmentLineParams(!1,objectRect.top-stageRect.top+objectRect.height*u[0],u[1]||ALIGNMENT_TO_OBJECTS_THRESHOLD),objectRect.left-stageRect.left,objectRect.right-stageRect.left))}),vValues.forEach(function(v){_this.tool.vertAligns.push(_setAlignmentLineDynamic(_createAlignmentLineParams(!0,objectRect.left-stageRect.left+objectRect.width*v[0],v[1]||ALIGNMENT_TO_OBJECTS_THRESHOLD),objectRect.top-stageRect.top,objectRect.bottom-stageRect.top))})}})}function _setAlignmentBehavior(isAlignToStage,isAlignToObjects){return this.tool.horizAligns=[],this.tool.vertAligns=[],isAlignToStage||isAlignToObjects?void(this.tool.target&&(isAlignToStage&&_addAlignToStage.call(this),isAlignToObjects&&this.displayList&&_addAlignToObjects.call(this,[[.5],[0],[1]],[[.5],[0],[1]]))):void AlignmentLinesDisplay.removeAllElements()}function TransformToolAlignmentDecorator(TransformTool,transformToolObject){return transformToolObject._alignmentOptions={toStage:!1,toObjects:!1},transformToolObject.setAlignmentBehaviorOptions=function(toStage,toObjects){return transformToolObject._alignmentOptions.toStage=toStage||!1,transformToolObject._alignmentOptions.toObjects=toObjects||!1,this},transformToolObject.up=function(event){TransformTool.prototype.up.call(transformToolObject,event),_setAlignmentBehavior.call(this)},transformToolObject.down=function(event){TransformTool.prototype.down.call(transformToolObject,event),_setAlignmentBehavior.call(this,transformToolObject._alignmentOptions.toStage,transformToolObject._alignmentOptions.toObjects)},transformToolObject.move=function(event){TransformTool.prototype.move.call(transformToolObject,event),AlignmentLinesDisplay.showActiveAlignmentLines.call(this)},transformToolObject.bindHandlers(),transformToolObject}return TransformToolAlignmentDecorator}(AlignmentLinesDisplay);return{TransformToolAlignmentDecorator:TransformToolAlignmentDecorator}})}),define("services/ApiService",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.services.LgApi",[]).provider("lgApi",function(){function getLocationUrl(baseUrl){return(locationUrlPrefix+baseUrl).replace(/\/+/,"/")}var apiUrl="api.logogarden.com",partnerRedirectionUrl=window.apiVars&&window.apiVars.partner_redirect_url||"",locationUrlPrefix="/";this.setLocationPrefix=function(prefixUrl){locationUrlPrefix=prefixUrl},this.getLocationUrl=getLocationUrl,this.setApiUrl=function(url){apiUrl=url||apiUrl,apiUrl+="/"!==apiUrl.slice(-1)?"/":""},this.setPartnerRedirectionUrl=function(url){partnerRedirectionUrl=url},this.$get=["$http","$q",function($http,$q){var logogardenApiService={getLocationUrl:getLocationUrl,getApiUrl:function(baseUrl){return baseUrl=(baseUrl||"").replace(/\/+/,"/").replace(/^\//,""),apiUrl+baseUrl},getKeywordsHints:function(q){return $.ajax({url:apiUrl+"diy/objectshint?maxcount=5&q="+q,type:"GET",dataType:"json"})},loadLogo:function(logoId){return $http.post(apiUrl+"diy_scripts/action.php",{action:"get_logo",logo_id:logoId})},saveLogo:function(postData){return $http.post(apiUrl+"diy_scripts/action.php",postData)},saveLogoSession:function(logoId){return $http.post(partnerRedirectionUrl+"&noredirect=true&logo_id="+logoId,{})},getAllIndustriesSymbols:function(){return $http({cache:!0,method:"GET",url:apiUrl+"diy/industries"}).then(function(res){var industries=res.data&&res.data.data||null;return industries&&(Array.prototype.push.apply(industries,[{id:999998,is_alphabet:!0,name:"Alphabet"},{id:999999,is_shapes:!0,name:"Shapes"}]),industries.sort(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0})),industries})},getSpecifiedSymbolsByIds:function(symbolsIds){return $http({method:"GET",url:apiUrl+"diy/objects?symbols_ids="+symbolsIds.slice(0,48).join(",")}).then(function(res){return res.data&&res.data.data||null})},getIndustrySymbols:function(industryId){return $http({cache:!0,method:"GET",url:apiUrl+"diy/objects?industry_ID="+industryId}).then(function(res){return res.data&&res.data.data||null})},getSymbolsByAlphabetLetter:function(letter){return $http({cache:!0,method:"GET",url:apiUrl+"diy_scripts/action.php?action=get_symbols&alphabet="+letter}).then(function(res){return res.data||null})},getAllAbstractedSymbols:function(){return $http({cache:!0,method:"GET",url:apiUrl+"diy_scripts/action.php?action=get_symbols&abstract=yes"}).then(function(res){return res.data||null})},getObjectsByKeywords:function(source,keywords,page,limit){return $http({method:"GET",url:apiUrl+"diy/objects?source="+("objects"==source?"objects":"symbols")+"&keyword="+encodeURIComponent(keywords)+"&page="+(page||1)+"&limit="+(limit||48)}).then(function(response){return response.data&&response.data.data||[]})},findObjectsByKeywords:function(industryKeyword,keywords,page,limit){return $http({method:"GET",url:apiUrl+"diy/objects?partial=1&source=symbols&alt_industry_id="+encodeURIComponent(industryKeyword)+"&keyword="+encodeURIComponent(keywords)+"&page="+(page||1)+"&limit="+(limit||48)}).then(function(response){return response.data&&response.data.data||[]})},getSymbolsByIds:function(ids){return $http({method:"GET",url:apiUrl+"diy/symbols?ids="+ids.join()}).then(function(res){return res.data&&res.data.data||null})},getSymbolById:function(id){return this.getSymbolsByIds([id]).then(function(res){return res&&res.length?window.atob(res[0]).split("|||")[1]:null})},getForeignSymbol:function(symbolUrl){return $http({url:symbolUrl,dataType:"text",method:"get"}).then(function(data){return data.data||null})}};return logogardenApiService}]})}),define("services/EditorCommonService",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.services.EditorCommonService",[]).factory("EditorCommonService",["$log","svgService",function($log,svgService){function getSVGElementId(){return"#svg"}var IE=-1;window.ie9||document.all&&!window.atob?IE=9:document.all&&window.atob?IE=10:navigator.userAgent.match(/Trident.*rv[ :]*11\./)?IE=11:navigator.userAgent.match(new RegExp("Edge/"))&&(IE=13);var EditorCommonService={addIERect:function(){var ieRect=document.createElementNS("http://www.w3.org/2000/svg","rect");ieRect.setAttribute("id","ie-rect"),ieRect.setAttribute("width","1"),ieRect.setAttribute("height","1"),ieRect.setAttribute("fill","#ffffff"),ieRect.setAttribute("fill-opacity","0.1"),document.querySelector(getSVGElementId()).appendChild(ieRect);var defs=document.querySelector("#svg defs"),defsParent=defs.parentNode;defsParent.lastChild===defs?defsParent.appendChild(ieRect):defsParent.insertBefore(ieRect,defs.nextSibling)},removeIERect:function(){var ieRect=document.getElementById("ie-rect");ieRect&&ieRect.parentNode.removeChild(ieRect)},updateSymbolTransformToolBoundaries:function(scope,adj){var thisSymbolWrapper=document.querySelector("#symbol-bg-wrapper-1"),thisMatrix=thisSymbolWrapper.getCTM(),dm=svgService.decomposeMatrix(thisMatrix),bgBox=document.querySelector("#symbol-bg-wrapper-1").getBBox();scope.$root.send("updateDisplayListItem","symbol-wrapper-1",{adjust:adj,w:bgBox.width*dm.scaleX,h:bgBox.height*dm.scaleY,m:thisMatrix,tool:scope.transformTool})},getIEVersion:function(){return IE}};return EditorCommonService}])}),define("services/EditorEffectsService",["angular","svgjs"],function(angular,svgjs){"use strict";angular.module("logoBuilderApp.services.EditorEffectsService",[]).factory("EditorEffectsService",["$log","$timeout","EditorCommonService","SharedCode","svgService","logoData",function($log,$timeout,EditorCommonService,shared,svgService,logoData){function EffectElementObject(objectType,elementId){this.type=objectType,this.id=elementId,this.container=null,this.wrapperContainer=null}function EffectBaseProvider(baseContainer){this.container=baseContainer||EffectBaseProvider.getDefaultBaseContainer(),this.name="unknown"}function getAllEffectProviders(object){var effects=[new EffectShineProvider,new EffectDistressProvider,new EffectReflectionProvider];return"text"==object.type?effects.push(new EffectProjectShadowProvider):effects.push(new EffectSpotShadowProvider),effects}function getSVGElementId(){return"#svg"}angular.extend(EffectElementObject.prototype,{initContainers:function(baseContainer){this.container=this.container||baseContainer.select("#"+this.type+"-"+this.id).first(),this.bbox=this.container.bbox(),this.tbox=this.container.tbox(),this.wrapperContainer=this.wrapperContainer||baseContainer.select("#"+this.type+"-wrapper-"+this.id).first(),this.wrapperBBox=this.wrapperContainer.bbox(),this.wrapperTBox=this.wrapperContainer.tbox();var baseViewBox=baseContainer.node.getBoundingClientRect(),absViewBox=this.wrapperContainer.node.getBoundingClientRect();this.viewBox={x:absViewBox.left-baseViewBox.left,y:absViewBox.top-baseViewBox.top,w:absViewBox.width,h:absViewBox.height,x2:absViewBox.right-baseViewBox.left,y2:absViewBox.bottom-baseViewBox.top,cx:absViewBox.left+absViewBox.width/2-baseViewBox.left,cy:absViewBox.top+absViewBox.height/2-baseViewBox.top}},formatId:function(name){return this.type+"-"+(name?name+"-":"")+this.id},_cloneElementAsMask:function(element,fillAttr,strokeAttr){var clonedElement=element.clone().each(function(i,child){this.attr("stroke")&&this.attr("stroke",strokeAttr||"#ffffff"),this.attr("fill")&&this.attr("fill",fillAttr||"#ffffff"),this.attr("filter",null)},!0);return clonedElement},cloneAsMask:function(fillAttr){return this._cloneElementAsMask(this.container,fillAttr)},cloneWrapperAsMask:function(fillAttr){return this._cloneElementAsMask(this.wrapperContainer,fillAttr)}}),EffectBaseProvider.getDefaultBaseContainer=function(){return svgjs(getSVGElementId().slice(1))},angular.extend(EffectBaseProvider.prototype,{formatId:function(object,name){return object.formatId(this.name+(name?"-"+name:""))},createMaskFromFxTemplate:function(templateId,newContainerId){return svgjs.adopt($("#"+templateId,this.container.node).clone(!0,!0).get(0)).attr("id",newContainerId).addTo(this.getDefsStorage())},getDefsStorage:function(){return this.container.select("#created-defs").first()},buildEffect:function(object){},applyEffect:function(object){object.initContainers(this.container),this.buildEffect(object),EditorCommonService.getIEVersion()>9&&$("#svg use").each(function(){var hrefAttribute=(this.getAttributeNS(svgjs.xlink,"href")||"").split("/");this.setAttributeNS(svgjs.xlink,"xlink:href",1==hrefAttribute.length?"./"+hrefAttribute[0]:hrefAttribute[1])})},removeEffect:function(object){object.initContainers(this.container)},refreshEffect:function(object){object.initContainers(this.container)}});var EffectReflectionProvider=(shared.inherit(function self(baseContainer){self["super"].constructor.apply(this,arguments),this.name="background"},EffectBaseProvider,{}),shared.inherit(function self(baseContainer){self["super"].constructor.apply(this,arguments),this.name="reflection",this.reflectionScale=.5},EffectBaseProvider,{buildEffect:function(object){EffectReflectionProvider["super"].buildEffect.apply(this,arguments);var maskElement=this.createMaskFromFxTemplate("reflectionMask",this.formatId(object,"mask")),maskRectElement=maskElement.children()[0];maskRectElement.scale(object.viewBox.w/180,-object.viewBox.h/30*this.reflectionScale).translate(object.viewBox.x,object.viewBox.y+.5*object.viewBox.h*this.reflectionScale),this.container.add(object.container.group().attr("id",this.formatId(object,"wrapper")).translate(0,.5*object.viewBox.h*(1+this.reflectionScale)).maskWith(maskElement).add(this.container.use(object.wrapperContainer).attr("id",this.formatId(object,"use")).scale(1,-this.reflectionScale)),Math.max(this.container.index(object.wrapperContainer)-2,0))},removeEffect:function(object){EffectReflectionProvider["super"].removeEffect.apply(this,arguments),$("#"+this.formatId(object,"wrapper")).remove(),$("#"+this.formatId(object,"mask")).remove()},refreshEffect:function(object){EffectReflectionProvider["super"].refreshEffect.apply(this,arguments)}})),EffectShineProvider=shared.inherit(function self(baseContainer){self["super"].constructor.apply(this,arguments),this.name="shine"},EffectBaseProvider,{buildEffect:function(object){EffectShineProvider["super"].buildEffect.apply(this,arguments);var maskScaleX=object.wrapperBBox.w/(logoData.SHINE_WIDTH-4),maskScaleY=object.wrapperBBox.h/(logoData.SHINE_HEIGHT-1),shineMaskElement=this.container.mask().attr({id:this.formatId(object,"mask-def"),maskUnits:"userSpaceOnUse"}).addTo(this.getDefsStorage()).add(object.cloneWrapperAsMask("#ffffff").attr("id",this.formatId(object,"mask-body")).transform(new svgjs.Matrix));this.container.group().attr({id:this.formatId(object,"wrapper"),"pointer-events":"none"}).addTo(object.wrapperContainer).add(this.container.use(this.container.select("#shine").first()).attr("id",this.formatId(object,"use")).scale(maskScaleX,maskScaleY).translate(-2*maskScaleX,-2*maskScaleY)).maskWith(shineMaskElement)},removeEffect:function(object){EffectShineProvider["super"].removeEffect.apply(this,arguments),$("#"+this.formatId(object,"wrapper")).remove(),$("#"+this.formatId(object,"mask-def")).remove()},refreshEffect:function(object){EffectShineProvider["super"].refreshEffect.apply(this,arguments)}}),EffectDistressProvider=shared.inherit(function self(baseContainer){self["super"].constructor.apply(this,arguments),this.name="distress"},EffectBaseProvider,{buildEffect:function(object){EffectDistressProvider["super"].buildEffect.apply(this,arguments);var maskElement=this.container.mask().attr("id",this.formatId(object,"mask")).addTo(this.getDefsStorage()).add(this.container.use(this.container.select("#distressPattern").first()).attr("id",this.formatId(object,"use")).transform(object.wrapperContainer.transform()).scale(object.wrapperTBox.w/logoData.SYMBOL_DISTRESS_WIDTH,object.wrapperTBox.h/logoData.SYMBOL_DISTRESS_HEIGHT).translate(object.wrapperTBox.x,object.wrapperTBox.y));this.container.group().attr("id",this.formatId(object,"wrapper")).maskWith(maskElement).add(object.wrapperContainer),EditorCommonService.getIEVersion()>9&&EditorCommonService.addIERect()},removeEffect:function(object){EffectDistressProvider["super"].removeEffect.apply(this,arguments),this.container.add(object.wrapperContainer),$("#"+this.formatId(object,"wrapper")).remove(),$("#"+this.formatId(object,"mask")).remove()},refreshEffect:function(object){EffectDistressProvider["super"].refreshEffect.apply(this,arguments)}}),EffectProjectShadowProvider=shared.inherit(function self(baseContainer){self["super"].constructor.apply(this,arguments),this.name="shadow"},EffectBaseProvider,{buildEffect:function(object){EffectProjectShadowProvider["super"].buildEffect.apply(this,arguments),shared.svgBuildNode("filter",{id:this.formatId(object,"filter")},[shared.svgBuildNode("feGaussianBlur",{"in":"SourceAlpha",stdDeviation:1}),shared.svgBuildNode("feOffset",{dx:3,dy:3}),shared.svgBuildNode("feMerge",{},[shared.svgBuildNode("feMergeNode",{}),shared.svgBuildNode("feMergeNode",{"in":"SourceGraphic"})])],this.getDefsStorage().node),this.container.add(object.wrapperContainer.group().attr({id:this.formatId(object,"group"),fill:"#000000",stroke:"#000000","fill-opacity":.3,"stroke-opacity":.3,filter:"url(#"+this.formatId(object,"filter")+")"}).add(this._transformProjection(object,this.container.use(object.container).attr("id",this.formatId(object,"use")))),0)},_transformProjection:function(object,svgElement){return svgElement.transform(object.wrapperContainer.transform())},removeEffect:function(object){EffectProjectShadowProvider["super"].removeEffect.apply(this,arguments),$("#"+this.formatId(object,"group")).remove(),$("#"+this.formatId(object,"filter")).remove()},refreshEffect:function(object){EffectProjectShadowProvider["super"].refreshEffect.apply(this,arguments),this._transformProjection(object,this.container.select("#"+this.formatId(object,"use")).first())}}),EffectSpotShadowProvider=shared.inherit(function self(baseContainer){self["super"].constructor.apply(this,arguments),this.name="shadow"},EffectBaseProvider,{buildEffect:function(object){EffectSpotShadowProvider["super"].buildEffect.apply(this,arguments),this.container.add(this._transformSpot(object,object.container.use(svgjs.select("#symbol-shadow").first()).attr("id",this.formatId(object,"use"))),Math.max(this.container.index(object.wrapperContainer)-1,0))},_transformSpot:function(object,svgElement){var scaleFactor=object.viewBox.w/logoData.SYMBOL_SHADOW_WIDTH,shadowHeightOffset=scaleFactor*logoData.SYMBOL_SHADOW_HEIGHT/2;return svgElement.scale(scaleFactor).translate(object.viewBox.cx-scaleFactor*logoData.SYMBOL_SHADOW_WIDTH/2,object.viewBox.y2-shadowHeightOffset)},removeEffect:function(object){EffectSpotShadowProvider["super"].removeEffect.apply(this,arguments),$("#"+this.formatId(object,"use")).remove()},refreshEffect:function(object){EffectSpotShadowProvider["super"].refreshEffect.apply(this,arguments),this._transformSpot(this.container.select("#"+this.formatId(object,"use")).first())}}),EditorEffectsService={updateSymbolBG:function(scope,newID,addHistory){var elementIndex=1,history={id:"symbol-wrapper-"+elementIndex,type:"symbolBGChange",oldBG:logoData.symbol.bgid,newBG:newID,data:{}};0===logoData.symbol.bgid&&0!==newID?EditorEffectsService.addSymbolBG(scope,newID):(EditorEffectsService.removeSymbolBG(scope,logoData.symbol.bgid),0!==newID&&EditorEffectsService.addSymbolBG(scope,newID),logoData.symbol.bg[logoData.symbol.bgid-1]=!1),logoData.symbol.bgid=Number(newID),"true"===document.querySelector("#symbol-"+elementIndex).getAttribute("data-shine")&&(EditorEffectsService.removeSymbolShine(elementIndex,scope),EditorEffectsService.addSymbolShine(elementIndex,scope));var addHist=!0;void 0!==addHistory&&null!==addHistory&&(addHist=addHistory),addHist&&scope.$root.send("addHistory",history)},getSelectedSymbolBG:function(scope){for(var elementIndex=1,i=0;6>i;i++)if("true"===document.querySelector("#symbol-bg-button-"+(i+1)).getAttribute("data-active"))return EditorEffectsService.updateSymbolBG(scope,i+1,!0),void(logoData.symbol.bgid=i+1);EditorEffectsService.removeSymbolBG(scope,logoData.symbol.bgid),logoData.symbol.bgid=0,"true"===document.querySelector("#symbol-"+elementIndex).getAttribute("data-shine")&&(EditorEffectsService.removeSymbolShine(elementIndex,scope),EditorEffectsService.addSymbolShine(elementIndex,scope))},addSymbolBG:function(scope,thisBG){scope.model.states.isBackgroundActive=!0;var stage=document.querySelector(getSVGElementId()),symbolWrapper=document.querySelector("#symbol-wrapper-1"),center=svgService.getReferenceCenter(stage,symbolWrapper),thisSymbolBG=document.querySelector("#symbol-bg-"+thisBG).cloneNode(!0);thisSymbolBG.setAttribute("id","symbol-bg-active-"+thisBG),document.querySelector(getSVGElementId()).appendChild(thisSymbolBG);var obgbox=document.querySelector("#symbol-bg-active-"+thisBG).querySelector(".symbol-bg-trim").getBoundingClientRect(),xOffset=Number(thisSymbolBG.getAttribute("data-x-offset")),yOffset=Number(thisSymbolBG.getAttribute("data-y-offset")),thisSymbol=document.querySelector("#symbol-1"),thisSymbolWrapper=document.querySelector("#symbol-bg-wrapper-1");thisSymbolWrapper.insertBefore(thisSymbolBG,thisSymbol);var symbolBgScale=logoData.symbol.defaultWidth*logoData.symbol.initScale/obgbox.width;(logoData.symbol.defaultWidth*logoData.symbol.initScale-obgbox.width*symbolBgScale)/2+xOffset,(logoData.symbol.defaultHeight*logoData.symbol.initScale-obgbox.height*symbolBgScale)/2+yOffset;thisSymbolBG.setAttribute("transform","scale("+symbolBgScale+")");var symbolScale=(document.querySelector("#symbol-bg-3").querySelector(".symbol-bg-trim").getBoundingClientRect(),svgService.getMaxScale(logoData.symbol.defaultWidth,logoData.symbol.defaultHeight,logoData.SYMBOL_BG_STD_WIDTH*symbolBgScale*logoData.SYMBOL_BG_INSET,logoData.SYMBOL_BG_STD_HEIGHT*symbolBgScale*logoData.SYMBOL_BG_INSET)),xTransSymbol=(logoData.symbol.defaultWidth*logoData.symbol.initScale-logoData.symbol.defaultWidth*symbolScale)/2-(logoData.symbol.defaultWidth*logoData.symbol.initScale-obgbox.width*symbolBgScale)/2,yTransSymbol=(logoData.symbol.defaultHeight*logoData.symbol.initScale-logoData.symbol.defaultHeight*symbolScale)/2-(logoData.symbol.defaultHeight*logoData.symbol.initScale-obgbox.height*symbolBgScale)/2;thisSymbol.setAttribute("transform","translate("+xTransSymbol+","+yTransSymbol+") scale("+symbolScale+")");var offCenter=svgService.getReferenceCenter(stage,symbolWrapper),adjust={x:center.x-offCenter.x,y:center.y-offCenter.y,cx:center.x,cy:center.y},symbolBgBase=thisSymbolBG.querySelector(".symbol-bg-base");symbolBgBase.setAttribute("id","symbol-bg-base"),symbolBgBase.setAttribute("fill",logoData.symbol.color),svgService.setSymbolColorStyles("url(#symbolGradient)"),EditorCommonService.updateSymbolTransformToolBoundaries(scope,adjust),this.hideEffects("symbol","1"),this.showEffects("symbol","1")},removeSymbolBG:function(scope,thisBG){scope.model.states.isBackgroundActive=!1;var stage=document.querySelector(getSVGElementId()),symbolWrapper=document.querySelector("#symbol-wrapper-1"),center=svgService.getReferenceCenter(stage,symbolWrapper),thisSymbolBG=document.querySelector("#symbol-bg-active-"+thisBG),thisSymbol=document.querySelector("#symbol-1");thisSymbolBG.parentNode.removeChild(thisSymbolBG),thisSymbol.setAttribute("transform","scale("+logoData.symbol.initScale+")"),svgService.setSymbolColorStyles(logoData.symbol.color);var offCenter=svgService.getReferenceCenter(stage,symbolWrapper),adjust={x:center.x-offCenter.x,y:center.y-offCenter.y,cx:center.x,cy:center.y};EditorCommonService.updateSymbolTransformToolBoundaries(scope,adjust),this.hideEffects("symbol","1"),this.showEffects("symbol","1")},updateFXButtons:function(scope){var isItemSelected=!!scope.selectedItem.item;scope.selectedItem.distress=isItemSelected&&"true"===scope.selectedItem.item.getAttribute("data-distress"),scope.selectedItem.reflection=isItemSelected&&"true"===scope.selectedItem.item.getAttribute("data-reflection"),scope.selectedItem.shadow=isItemSelected&&"true"===scope.selectedItem.item.getAttribute("data-shadow"),scope.selectedItem.shine=isItemSelected&&"true"===scope.selectedItem.item.getAttribute("data-shine")},toggleFXAttribute:function(scope,fx){var useEffect;return"true"===scope.selectedItem.item.getAttribute("data-"+fx)?useEffect=!1:"false"===scope.selectedItem.item.getAttribute("data-"+fx)&&(useEffect=!0),scope.selectedItem.item.setAttribute("data-"+fx,useEffect),scope.transformTool.tool.target.owner[fx]=useEffect,useEffect},_processEffectHistory:function(scope,effectType,state){scope.$root.send("addHistory",{id:scope.selectedItem.item.id,type:"effect",effectType:effectType,state:!!state})},_capitalizeWord:function(word){return word[0].toUpperCase()+word.slice(1)},toggleEffectById:function(elementId,effectType,forceSwitch){var elementIdParts=elementId.split("-"),element=document.getElementById(elementId),isSwitchOn="true"==element.getAttribute("data-"+effectType);void 0!==forceSwitch&&(isSwitchOn=forceSwitch),this[(isSwitchOn?"remove":"add")+this._capitalizeWord(elementIdParts[0])+this._capitalizeWord(effectType)](elementIdParts.pop()),
element.setAttribute("data-"+effectType,isSwitchOn?"false":"true")},toggleDistress:function(scope){var elementId=scope.selectedItem.item.id.split("-").pop(),useEffect=EditorEffectsService.toggleFXAttribute(scope,"distress");this._processEffectHistory(scope,"distress",useEffect),"regular-text"===scope.selectedItem.item.getAttribute("data-element-type")?useEffect?EditorEffectsService.addTextDistress(elementId):EditorEffectsService.removeTextDistress(elementId):"symbol"===scope.selectedItem.item.getAttribute("data-element-type")&&(useEffect?EditorEffectsService.addSymbolDistress(elementId):EditorEffectsService.removeSymbolDistress(elementId))},addTextDistress:function(elementId){(new EffectDistressProvider).applyEffect(new EffectElementObject("text",elementId))},removeTextDistress:function(elementId){(new EffectDistressProvider).removeEffect(new EffectElementObject("text",elementId))},addSymbolDistress:function(elementId){(new EffectDistressProvider).applyEffect(new EffectElementObject("symbol",elementId))},removeSymbolDistress:function(elementId){(new EffectDistressProvider).removeEffect(new EffectElementObject("symbol",elementId))},toggleReflection:function(scope){var elementId=scope.selectedItem.item.id.split("-").pop(),useEffect=EditorEffectsService.toggleFXAttribute(scope,"reflection");this._processEffectHistory(scope,"reflection",useEffect),"regular-text"===scope.selectedItem.item.getAttribute("data-element-type")?useEffect?EditorEffectsService.addTextReflection(elementId):EditorEffectsService.removeTextReflection(elementId):"symbol"===scope.selectedItem.item.getAttribute("data-element-type")&&(useEffect?EditorEffectsService.addSymbolReflection(elementId):EditorEffectsService.removeSymbolReflection(elementId))},addTextReflection:function(elementId){(new EffectReflectionProvider).applyEffect(new EffectElementObject("text",elementId))},removeTextReflection:function(elementId){(new EffectReflectionProvider).removeEffect(new EffectElementObject("text",elementId))},addSymbolReflection:function(elementId){(new EffectReflectionProvider).applyEffect(new EffectElementObject("symbol",elementId))},removeSymbolReflection:function(elementId){(new EffectReflectionProvider).removeEffect(new EffectElementObject("symbol",elementId))},toggleShadow:function(scope){var elementId=scope.selectedItem.item.id.split("-").pop(),useEffect=EditorEffectsService.toggleFXAttribute(scope,"shadow");this._processEffectHistory(scope,"shadow",useEffect),"regular-text"===scope.selectedItem.item.getAttribute("data-element-type")?useEffect?EditorEffectsService.addTextShadow(elementId):EditorEffectsService.removeTextShadow(elementId):"symbol"===scope.selectedItem.item.getAttribute("data-element-type")&&(useEffect?EditorEffectsService.addSymbolShadow(elementId):EditorEffectsService.removeSymbolShadow(elementId))},addTextShadow:function(elementId){(new EffectProjectShadowProvider).applyEffect(new EffectElementObject("text",elementId))},removeTextShadow:function(elementId){(new EffectProjectShadowProvider).removeEffect(new EffectElementObject("text",elementId))},addSymbolShadow:function(elementId){(new EffectSpotShadowProvider).applyEffect(new EffectElementObject("symbol",elementId))},removeSymbolShadow:function(elementId){(new EffectSpotShadowProvider).removeEffect(new EffectElementObject("symbol",elementId))},toggleShine:function(scope){var elementId=scope.selectedItem.item.id.split("-").pop(),useEffect=EditorEffectsService.toggleFXAttribute(scope,"shine");this._processEffectHistory(scope,"shine",useEffect),"regular-text"===scope.selectedItem.item.getAttribute("data-element-type")?useEffect?EditorEffectsService.addTextShine(elementId):EditorEffectsService.removeTextShine(elementId):"symbol"===scope.selectedItem.item.getAttribute("data-element-type")&&(useEffect?EditorEffectsService.addSymbolShine(elementId):EditorEffectsService.removeSymbolShine(elementId))},addTextShine:function(elementId){(new EffectShineProvider).applyEffect(new EffectElementObject("text",elementId))},removeTextShine:function(elementId){(new EffectShineProvider).removeEffect(new EffectElementObject("text",elementId))},addSymbolShine:function(elementId){(new EffectShineProvider).applyEffect(new EffectElementObject("symbol",elementId))},removeSymbolShine:function(elementId){(new EffectShineProvider).removeEffect(new EffectElementObject("symbol",elementId))},loadFXDefs:function(scope,stage,rootElement,doc){var importedNode=svgService.importNode(doc.documentElement,document);return stage.appendChild(importedNode.querySelector("defs")),rootElement[0].insertBefore(stage,rootElement[0].lastChild),logoData.editing&&!logoData.swappingSymbol?(scope.$parent.prepareStage(),!1):logoData.swappingSymbol?($log.debug("typeof loader"),$log.debug(scope.$parent),void 0!==typeof scope.$parent.showLoader&&scope.$parent.showLoader(),logoData.symbol.content=svgService.transformToCompatibleSvg(scope.$root.data.selectedSymbol),scope.$parent.prepareStage(),!1):(shared.svgBuildNode("g",{id:"created-defs"},null,document.querySelector("#stock-defs").parentNode),!0)},stashTextEffects:function(scope){if(scope.selectedItem.item){scope.selectedItem.item.id.split("-").pop();"true"===scope.selectedItem.item.getAttribute("data-shine")&&(EditorEffectsService.toggleShine(scope),scope.stash.shine=!0),"true"===scope.selectedItem.item.getAttribute("data-distress")&&(EditorEffectsService.toggleDistress(scope),scope.stash.distress=!0),"true"===scope.selectedItem.item.getAttribute("data-reflection")&&(EditorEffectsService.toggleReflection(scope),scope.stash.reflection=!0),"true"===scope.selectedItem.item.getAttribute("data-shadow")&&(EditorEffectsService.toggleShadow(scope),scope.stash.shadow=!0)}},hideEffects:function(objectType,elementId){var object=new EffectElementObject(objectType,elementId);getAllEffectProviders(object).forEach(function(provider){provider.removeEffect(object)})},showEffects:function(objectType,elementId){var object=new EffectElementObject(objectType,elementId);getAllEffectProviders(object).forEach(function(provider){object.initContainers(provider.container),"true"===object.container.node.getAttribute("data-"+provider.name)&&provider.applyEffect(object)})},reinstateTextEffects:function(scope){if(scope.selectedItem.item){scope.selectedItem.item.id.split("-").pop();scope.stash.shine===!0&&(EditorEffectsService.toggleShine(scope),scope.stash.shine=!1),scope.stash.distress===!0&&(EditorEffectsService.toggleDistress(scope),scope.stash.distress=!1),scope.stash.reflection===!0&&(EditorEffectsService.toggleReflection(scope),scope.stash.reflection=!1),scope.stash.shadow===!0&&(EditorEffectsService.toggleShadow(scope),scope.stash.shadow=!1),scope.$root.send("updateDisplayListTextField")}},refreshObjectEffect:function(objectType,elementId){this.hideEffects(objectType,elementId),this.showEffects(objectType,elementId)},refreshSelectedObjectEffects:function(scope){if(EditorCommonService.getIEVersion()>9)this.refreshAllObjectsEffects(scope);else{if(!scope.selectedItem||!scope.selectedItem.item)return;var objectNameParts=scope.selectedItem.item.id.split("-");this.refreshObjectEffect(objectNameParts[0],objectNameParts.pop())}},refreshAllObjectsEffects:function(scope){var _this=this;(scope.targets||[]).map(function(t){return[t.split("-")[0],t.split("-").pop()]}).forEach(function(obj){_this.refreshObjectEffect(obj[0],obj[1])})},recalculateTextEffects:function(scope){if(scope.selectedItem.item){if(EditorCommonService.getIEVersion()>9){var poly=scope.transformTool.tool.container.querySelector("polygon");poly.style.display="none",$timeout(function(){var poly=scope.transformTool.tool.container.querySelector("polygon");poly.style.display="block"},8)}this.refreshSelectedObjectEffects(scope),scope.$root.send("updateDisplayListTextField")}}};return EditorEffectsService}])}),define("services/HistoryService",["angular","transform-dom","transform"],function(angular,senocular,senoc){"use strict";angular.module("logoBuilderApp.services.HistoryService",[]).service("historyService",function($log,$rootScope,$timeout,svgService,logoData){var LogoHistory=function(){this.curIndex=-1,this.history=[],this.lastUndoHistoryItem=null,this.getCurrentHistoryItem=function(){return-1===this.curIndex?null:this.history[this.curIndex]},this.removeCurrentHistoryItem=function(){this.history.splice(this.curIndex,1),this.getCurrentHistory()},this.removeLastHistoryItem=function(){$log.debug("removing current item"),this.history.splice(this.history.length-1,1);var len=this.history.length;len<=this.curIndex&&(this.curIndex=this.history.length-1),this.getCurrentHistory()},this.addHistoryItem=function(item){return"shape"===item.type&&item.oldShapeState===item.direction?void $log.debug("Skipping adding history because oldshape and direction are the same"):(this.curIndex<=this.history.length&&($log.debug("Deleting some history because its no longer accurate"),this.curIndex<0?this.history=[]:($log.debug("Delete items > "+this.curIndex),this.history=this.history.slice(0,this.curIndex+1))),$log.debug("adding history item of type:"+item.type),this.history.push(item),void(this.curIndex+=1))},this.getLastUndoHistoryItem=function(){return this.lastUndoHistoryItem},this.undoHistory=function(){$log.debug("undo");var index=this.curIndex;if(this.lastUndoHistoryItem=null,index>-1){$log.debug("grabbing history item "+index);var item=this.history[index],elemExists=null!==document.getElementById(item.id);if("removeText"!==item.type)for(;!elemExists&&index>-1;)index--,index>-1&&(item=this.history[index]),elemExists=null!==document.getElementById(item.id);switch($log.debug(item),$log.debug("history type: "+item.type),this.lastUndoHistoryItem=item,item.type){case"textChange":var childElem=document.getElementById(item.id.replace(/-wrapper/,""));if(""===item.data){var dataText=childElem.getAttribute("data-content");$log.debug("setting item.data to:"+dataText),item.data=dataText}if(childElem){for(childElem.setAttribute("data-content",item.oldText);childElem.firstChild;)childElem.removeChild(childElem.firstChild);svgService.renderFont(childElem)}break;case"addTextField":var elem=document.getElementById(item.id);item.data=elem.cloneNode(!0),$rootScope.send("logo-editor_removeStageElem",item.id),$rootScope.send("transform-tool_spliceIDHashWithID",item.id);var toolSvg=document.getElementById("tool"),i=0,length=toolSvg.childNodes.length;for(i=0;length>i;i++)toolSvg.childNodes[i].style.display="none";break;case"removeText":var oldItem=item.oldNode,oldChild=item.oldNode.firstChild,oldId=oldItem.getAttribute("id").replace(/text-wrapper-/,""),matrix=oldItem.getAttribute("transform"),outFill=oldItem.getAttribute("fill"),outStroke=oldItem.getAttribute("stroke"),outStyle=oldItem.getAttribute("style"),inData_style=oldChild.getAttribute("data-style"),inData_letter_spacing=oldChild.getAttribute("data-letter-spacing"),inData_fill=oldChild.getAttribute("data-fill"),inData_font=oldChild.getAttribute("data-font"),inData_content=oldChild.getAttribute("data-content"),inTransform=oldChild.getAttribute("transform"),inDistress=oldChild.getAttribute("data-distress"),inReflection=oldChild.getAttribute("data-reflection"),inShadow=oldChild.getAttribute("data-shadow"),inShine=oldChild.getAttribute("data-shine"),inData_element_type=oldChild.getAttribute("data-element-type"),inData_path=oldChild.getAttribute("data-path"),data={id:oldId,matrix:matrix};$rootScope.send("logo-editor_addRegularTextWithData",data);var newItem=document.getElementById(item.id);newItem.setAttribute("transform",matrix),newItem.setAttribute("fill",outFill),newItem.setAttribute("stroke",outStroke),newItem.setAttribute("style",outStyle);var newChild=document.getElementById(item.id.replace(/wrapper-/,""));newChild.setAttribute("data-style",inData_style),newChild.setAttribute("data-letter-spacing",inData_letter_spacing),newChild.setAttribute("data-fill",inData_fill),newChild.setAttribute("data-font",inData_font),newChild.setAttribute("data-content",inData_content),newChild.setAttribute("transform",inTransform),newChild.setAttribute("data-distress",inDistress),newChild.setAttribute("data-reflection",inReflection),newChild.setAttribute("data-shadow",inShadow),newChild.setAttribute("data-shine",inShine),newChild.setAttribute("data-element-type",inData_element_type),newChild.setAttribute("data-path",inData_path),svgService.renderFont(newChild);break;case"transform":var elem=document.getElementById(item.id);item.data=elem.getAttribute("transform"),$rootScope.send("transform-tool_UpdateMatrixWithString",item.id,item.oldMatrix);break;case"shape":var direction=item.oldShapeState,id=item.id.replace(/-wrapper/,"");childElem=document.getElementById(id),childElem.setAttribute("data-path",direction),svgService.renderFont(childElem);break;case"fontChange":var childId=item.id.replace(/-wrapper/,"");$rootScope.send("font-panel_changeFontWithId",childId,item.oldFont);break;case"fontSizeChange":var id=item.id;$rootScope.send("font-panel_changeFontSizeWithId",id,item.newSize,item.oldSize);break;case"styleChange":var childId=item.id.replace(/-wrapper/,"");$rootScope.send("font-panel_changeStyleWithId",childId,item.oldStyle);break;case"letterSpacing":var childId=item.id.replace(/-wrapper/,"");$rootScope.send("font-panel_changeLetterSpacingWithId",childId,item.oldSpacing);break;case"colorChange":var id=item.id.replace(/symbol-wrapper-/,"symbol-");$rootScope.send("logo-editor_changeColorWithId",id,item.oldColor),$rootScope.send("changeBgColor",item.oldColor);break;case"symbolBGChange":var dontSendHistory=!1;$rootScope.send("logo-editor_updateSymbolBG",item.oldBG,dontSendHistory);break;case"changeSymbol":$rootScope.send("editor_changeSymbol",item.symbol_prev,!0);break;case"effect":$rootScope.send("editor_changeEffects",item.id,item.effectType)}return this.curIndex=index-1,$log.debug("curHistory:"+this.curIndex),1}return null},this.redoHistory=function(){$log.debug("redo");var index=this.curIndex,len=this.history.length-1;if(this.lastUndoHistoryItem=null,len>index){index++,$log.debug("grabbing history item "+index);var item=this.history[index];document.getElementById(item.id);switch(item.type){case"addTextField":var oldItem=item.data,theMatrix=oldItem.getAttribute("transform"),oldId=oldItem.getAttribute("id").replace(/text-wrapper-/,""),data={matrix:theMatrix,id:oldId};$rootScope.send("logo-editor_addRegularTextWithData",data);break;case"removeText":$rootScope.send("logo-editor_removeTextElementById",item.id);break;case"textChange":var childElem=document.getElementById(item.id.replace(/-wrapper/,""));for(childElem.setAttribute("data-content",item.data);childElem.firstChild;)childElem.removeChild(childElem.firstChild);svgService.renderFont(childElem);break;case"transform":$rootScope.send("transform-tool_UpdateMatrixWithString",item.id,item.data);break;case"shape":var direction=item.direction,id=item.id.replace(/-wrapper/,"");childElem=document.getElementById(id),childElem.setAttribute("data-path",direction),svgService.renderFont(childElem);break;case"fontChange":var childId=item.id.replace(/-wrapper/,"");$rootScope.send("font-panel_changeFontWithId",childId,item.newFont);break;case"fontSizeChange":var id=item.id;$rootScope.send("font-panel_changeFontSizeWithId",id,item.oldSize,item.newSize);break;case"styleChange":var childId=item.id.replace(/-wrapper/,"");$rootScope.send("font-panel_changeStyleWithId",childId,item.newStyle);break;case"letterSpacing":var childId=item.id.replace(/-wrapper/,"");$rootScope.send("font-panel_changeLetterSpacingWithId",childId,item.newSpacing);break;case"colorChange":var id=item.id.replace(/symbol-wrapper-/,"symbol-");$rootScope.send("logo-editor_changeColorWithId",id,item.newColor),$rootScope.send("changeBgColor",item.newColor);break;case"symbolBGChange":var dontSendHistory=!1;$rootScope.send("logo-editor_updateSymbolBG",item.newBG,dontSendHistory);break;case"changeSymbol":$rootScope.send("editor_changeSymbol",item.symbol_next,!0);break;case"effect":$rootScope.send("editor_changeEffects",item.id,item.effectType)}return $log.debug(item),this.curIndex=index,1}return null},this.getCurrentHistory=function(){var index=this.curIndex;this.history[index]},this.undoAllHistory=function(){var result=1;do result=this.undoHistory();while(null!==result)}},history=new LogoHistory;return{getCurrentHistory:function(){return history.getCurrentHistory()},redoHistory:function(){return history.redoHistory()},getLastUndoHistoryItem:function(){return history.getLastUndoHistoryItem()},undoHistory:function(){return history.undoHistory()},addHistoryItem:function(item){return history.addHistoryItem(item)},getCurrentHistoryItem:function(){return history.getCurrentHistoryItem()},removeCurrentHistoryItem:function(){return history.removeCurrentHistoryItem()},removeLastHistoryItem:function(){return history.removeLastHistoryItem()},undoAllHistory:function(){return history.undoAllHistory()}}})}),define("config",["angular"],function(angular){"use strict";var appConfig={debugging:!1,isTrafficTrackDisabled:!1,firstTimeIndustryId:1,firstTimeSymbolId:6048,firstTimeCategorySymbols:[6048,6678,4999,3179,2588,4877,4259,3747,1881,5501,6019,6674,3325,4087,5593,4071,3974,690,2112,3736,903,1574,5544,465],s3PreviewUrl:"//s3.amazonaws.com/lg-vectors",lgApiUrl:"//api.logogarden.com",legacySiteUrl:"//my.logogarden.com"};try{angular.module("logoBuilderApp.config",[]).constant("appConfig",appConfig)}catch(err){}return appConfig}),define("services/LgSiteApiService",["angular","config"],function(angular,config){"use strict";angular.module("logoBuilderApp.services.LgSiteApi",[]).constant("trackTargetIds",{LOADED:4,SELECTED_CATEGORY:5,SELECTED_SYMBOL:6,SAVE_DOWNLOAD:27,DESIGN_ASSIST:58,DESIGN_ASSIST_MODAL:59}).provider("lgSiteApi",function(){var apiUrl=config.lgApiUrl,trafficTrackOnceDict={},isTrafficTrackDisabled=!1,overrideOptions={headers:{"Content-Type":"application/x-www-form-urlencoded"}};this.setTrafficTrackEnabled=function(flag){isTrafficTrackDisabled=!flag},this.setApiUrl=function(url){apiUrl=url||(window.top&&window).location.origin,apiUrl.indexOf((window.top||window).location.hostname)<0&&(overrideOptions.withCredentials=!0),apiUrl+="/"!==apiUrl.slice(-1)?"/":""},this.setApiUrl(),this.$get=["$http","$q","$log",function($http,$q,$log){function mapUserDataSvgLogoToSite(userData){return{api_logo_ID:userData.logoId,letter:"","abstract":0,industry_ID:+userData.industryId||config.firstTimeIndustryId,object_ID:0,symbol_ID:0,logo_width:100,logo_height:100,logo_svg:userData.svgContent,symbol_color_UI:userData.symbolColor}}function mapUserRegistrationDataToSite(userData){return{action:"create_user",signup_type:"logo",fname:userData.name||"Anonymous",lname:"User",phone:userData.phone,email:userData.email,password:userData.password}}function processXmlResponse(response){var responseXml=$($.parseXML(response.data));return 200==response.status&&responseXml.find("errors").length?$q.reject(responseXml.find("error").map(function(error){return $(this).text()})):responseXml}var logogardenApiService={generateRandomString:function(stringLength,probabilityNums,probabilitySyms){for(var charSet,randomString="",stringLength=stringLength||16;--stringLength;)charSet=~~(10*Math.random()),randomString+=(probabilityNums||0)>charSet?"0123456789".slice(~~(10*Math.random()))[0]:charSet>=10-(probabilitySyms||0)?"!@#$%^&*".slice(~~(8*Math.random()))[0]:String.fromCharCode((charSet>=5?"A":"a").charCodeAt(0)+~~(26*Math.random()));return randomString},trafficTrackOnce:function(targetId){return trafficTrackOnceDict[targetId]?$q.resolve(targetId):(trafficTrackOnceDict[targetId]=1,this.trafficTrack(targetId))},trafficTrack:function(targetId){return console.log(targetId),isTrafficTrackDisabled?$q.resolve(targetId):$http(angular.extend({url:apiUrl+"diy_scripts/action.php",method:"POST",data:$.param({action:"save_site_traffic_target_hit",site_traffic_target_ID:targetId})},overrideOptions))},registerUserAndSaveLogo:function(userData){return $http(angular.extend({url:apiUrl+"diy_scripts/action.php",method:"POST",data:$.param(angular.extend(mapUserRegistrationDataToSite(userData),mapUserDataSvgLogoToSite(userData)))},overrideOptions)).then(processXmlResponse)},storeLogoData:function(logoData){return $http(angular.extend({url:apiUrl+"diy_scripts/action.php",method:"POST",data:$.param({action:"store_logo_info",logoref:logoData.logoref,industryId:logoData.industryId,symbolColor:logoData.symbolColor})},overrideOptions))},storeAffiliateData:function(data){return $http(angular.extend({url:apiUrl+"diy_scripts/action.php",method:"POST",data:$.param({action:"store_affiliate",aff_code:data.code})},overrideOptions))},updateUserLogo:function(userData){return $http(angular.extend({url:apiUrl+"diy_scripts/action.php",method:"POST",data:$.param({action:"update_logo",api_logo_ID:userData.logoId,symbol_color_UI:userData.symbolColor})},overrideOptions))},updateUserLogoDetails:function(userData){return $http(angular.extend({url:apiUrl+"diy_scripts/action.php",method:"POST",data:$.param({action:"update_user_details",api_logo_ID:userData.logoId,symbol_color_UI:userData.symbolColor})},overrideOptions))},getApiUrl:function(baseUrl){return baseUrl=(baseUrl||"").replace(/\/+/,"/").replace(/^\//,""),apiUrl+baseUrl}};return logogardenApiService}]})}),define("services/LogoData",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.services.LogoData",[]).factory("logoData",function($log,$rootScope,$location,$http,lgApi){var _session={api_url:lgApi.getApiUrl(),assets_url:lgApi.getApiUrl(),industries:[],tree:"main",branch:{},pages:{},fontLibrary:{},fontList:{},fontCount:0,symbol:{},textFields:{},glyphUsePool:[],saveState:!1,logoStashed:!1,SYMBOL_MAX_DEFAULT_WIDTH:100,SYMBOL_MAX_DEFAULT_HEIGHT:100,SYMBOL_DEFAULT_X:410,SYMBOL_DEFAULT_Y:160,SYMBOL_BG_INSET:.56,SYMBOL_BG_STD_WIDTH:100,SYMBOL_BG_STD_HEIGHT:100,SHINE_WIDTH:145.7,SHINE_HEIGHT:146.4,SYMBOL_SHADOW_WIDTH:102.1,SYMBOL_SHADOW_HEIGHT:35.55,SYMBOL_DISTRESS_WIDTH:200,SYMBOL_DISTRESS_HEIGHT:200};return _session})}),define("services/PictureService",["angular","transform-dom","transform"],function(angular,senocular,senoc){"use strict";angular.module("logoBuilderApp.services.PictureService",[]).factory("pictureService",function($rootScope,$timeout,svgService,SvgTransformService,logoData){function Picture(elemID){if(this.image=document.getElementById(elemID),null!==this.image){var idArray=this.image.id.split("-");this.index=idArray[idArray.length-1];var innerID=idArray[0]+"-"+this.index,innerItem=document.getElementById(innerID);this.distress="true"===innerItem.getAttribute("data-distress")?!0:!1,this.reflection="true"===innerItem.getAttribute("data-reflection")?!0:!1,this.shadow="true"===innerItem.getAttribute("data-shadow")?!0:!1,this.shine="true"===innerItem.getAttribute("data-shine")?!0:!1;var m=this.image.getCTM(),mtx=new Matrix(parseFloat(m.a),parseFloat(m.b),parseFloat(m.c),parseFloat(m.d),parseFloat(m.e),parseFloat(m.f)),rect=this.image.getBBox(),w=rect.width,h=rect.height;this.transform=new Transformable(w,h,mtx,this);var origin="0 0",style=this.image&&this.image.style||{};"undefined"!=typeof style.transformOrigin?style.transformOrigin=origin:"undefined"!=typeof style.webkitTransformOrigin?style.webkitTransformOrigin=origin:"undefined"!=typeof style.msTransformOrigin?style.msTransformOrigin=origin:"undefined"!=typeof style.MozTransformOrigin?style.MozTransformOrigin=origin:"undefined"!=typeof style.OTransformOrigin&&(style.OTransformOrigin=origin)}}return Picture.prototype.draw=function(){if(this.transform){var trans=this.transform.matrix.toString(),tool=(this.image.style,document.getElementById("symbol-1"),document.getElementById("svg"),SvgTransformService.TransformTool.getInstance()),t=(tool.container,this.transform),m=t.matrix,isSymbol=(svgService.getBoundingBox(m,t.width,t.height),this.image.id.indexOf("symbol")>-1?!0:!1);this.image.setAttribute("transform",trans),isSymbol||$rootScope.send("updateFontSize"),logoData.saveState&&(logoData.svg_content=$rootScope.send("transform-tool_serializeLogo"),logoData.saveState=!1)}},{create:function(elem){return new Picture(elem)}}})}),function(root,factory){"object"==typeof exports?module.exports=factory():"function"==typeof define&&define.amd?define("spin",factory):root.Spinner=factory()}(this,function(){"use strict";function createEl(tag,prop){var n,el=document.createElement(tag||"div");for(n in prop)el[n]=prop[n];return el}function ins(parent){for(var i=1,n=arguments.length;n>i;i++)parent.appendChild(arguments[i]);return parent}function addAnimation(alpha,trail,i,lines){var name=["opacity",trail,~~(100*alpha),i,lines].join("-"),start=.01+i/lines*100,z=Math.max(1-(1-alpha)/trail*(100-start),alpha),prefix=useCssAnimations.substring(0,useCssAnimations.indexOf("Animation")).toLowerCase(),pre=prefix&&"-"+prefix+"-"||"";return animations[name]||(sheet.insertRule("@"+pre+"keyframes "+name+"{0%{opacity:"+z+"}"+start+"%{opacity:"+alpha+"}"+(start+.01)+"%{opacity:1}"+(start+trail)%100+"%{opacity:"+alpha+"}100%{opacity:"+z+"}}",sheet.cssRules.length),animations[name]=1),name}function vendor(el,prop){var pp,i,s=el.style;for(prop=prop.charAt(0).toUpperCase()+prop.slice(1),i=0;i<prefixes.length;i++)if(pp=prefixes[i]+prop,void 0!==s[pp])return pp;return void 0!==s[prop]?prop:void 0}function css(el,prop){for(var n in prop)el.style[vendor(el,n)||n]=prop[n];return el}function merge(obj){for(var i=1;i<arguments.length;i++){var def=arguments[i];for(var n in def)void 0===obj[n]&&(obj[n]=def[n])}return obj}function getColor(color,idx){return"string"==typeof color?color:color[idx%color.length]}function Spinner(o){this.opts=merge(o||{},Spinner.defaults,defaults)}function initVML(){function vml(tag,attr){return createEl("<"+tag+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',attr)}sheet.addRule(".spin-vml","behavior:url(#default#VML)"),Spinner.prototype.lines=function(el,o){function grp(){return css(vml("group",{coordsize:s+" "+s,coordorigin:-r+" "+-r}),{width:s,height:s})}function seg(i,dx,filter){ins(g,ins(css(grp(),{rotation:360/o.lines*i+"deg",left:~~dx}),ins(css(vml("roundrect",{arcsize:o.corners}),{width:r,height:o.width,left:o.radius,top:-o.width>>1,filter:filter}),vml("fill",{color:getColor(o.color,i),opacity:o.opacity}),vml("stroke",{opacity:0}))))}var i,r=o.length+o.width,s=2*r,margin=2*-(o.width+o.length)+"px",g=css(grp(),{position:"absolute",top:margin,left:margin});if(o.shadow)for(i=1;i<=o.lines;i++)seg(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=o.lines;i++)seg(i);return ins(el,g)},Spinner.prototype.opacity=function(el,i,val,o){var c=el.firstChild;o=o.shadow&&o.lines||0,c&&i+o<c.childNodes.length&&(c=c.childNodes[i+o],c=c&&c.firstChild,c=c&&c.firstChild,c&&(c.opacity=val))}}var useCssAnimations,prefixes=["webkit","Moz","ms","O"],animations={},sheet=function(){var el=createEl("style",{type:"text/css"});return ins(document.getElementsByTagName("head")[0],el),el.sheet||el.styleSheet}(),defaults={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};Spinner.defaults={},merge(Spinner.prototype,{spin:function(target){this.stop();var self=this,o=self.opts,el=self.el=css(createEl(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex});o.radius+o.length+o.width;if(css(el,{left:o.left,top:o.top}),target&&target.insertBefore(el,target.firstChild||null),el.setAttribute("role","progressbar"),self.lines(el,self.opts),!useCssAnimations){var alpha,i=0,start=(o.lines-1)*(1-o.direction)/2,fps=o.fps,f=fps/o.speed,ostep=(1-o.opacity)/(f*o.trail/100),astep=f/o.lines;!function anim(){i++;for(var j=0;j<o.lines;j++)alpha=Math.max(1-(i+(o.lines-j)*astep)%f*ostep,o.opacity),self.opacity(el,j*o.direction+start,alpha,o);self.timeout=self.el&&setTimeout(anim,~~(1e3/fps))}()}return self},stop:function(){var el=this.el;return el&&(clearTimeout(this.timeout),el.parentNode&&el.parentNode.removeChild(el),this.el=void 0),this},lines:function(el,o){function fill(color,shadow){return css(createEl(),{position:"absolute",width:o.length+o.width+"px",height:o.width+"px",background:color,boxShadow:shadow,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*i+o.rotate)+"deg) translate("+o.radius+"px,0)",borderRadius:(o.corners*o.width>>1)+"px"})}for(var seg,i=0,start=(o.lines-1)*(1-o.direction)/2;i<o.lines;i++)seg=css(createEl(),{position:"absolute",top:1+~(o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:useCssAnimations&&addAnimation(o.opacity,o.trail,start+i*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&ins(seg,css(fill("#000","0 0 4px #000"),{top:"2px"})),ins(el,ins(seg,fill(getColor(o.color,i),"0 0 1px rgba(0,0,0,.1)")));return el},opacity:function(el,i,val){i<el.childNodes.length&&(el.childNodes[i].style.opacity=val)}});var probe=css(createEl("group"),{behavior:"url(#default#VML)"});return!vendor(probe,"transform")&&probe.adj?initVML():useCssAnimations=vendor(probe,"animation"),Spinner}),function(){for(var lastTime=0,vendors=["webkit","moz"],x=0;x<vendors.length&&!window.requestAnimationFrame;++x)window.requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(callback){var currTime=(new Date).getTime(),timeToCall=Math.max(0,16-(currTime-lastTime)),id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);return lastTime=currTime+timeToCall,id}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(id){clearTimeout(id)})}(),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/gm,"")});var parseAttributeOptions=function(str){for(var tmp=str.split(","),ops={},i=0,max=tmp.length;max>i;i++)tmp[i]=tmp[i].split(":"),void 0!==tmp[i][1]&&(ops[tmp[i][0].trim()]=tmp[i][1].trim());return ops},parseAttributeObjects=function(str){str=str.substr(1,str.length-2),str=str.split(/\}\s*,\s*\{/);for(var i=0,max=str.length;max>i;i++)0===i&&(str[i]=str[i].substr(1)),i===str.length-1&&(str[i]=str[i].substr(0,str[i].length-1));for(var i=0,max=str.length;max>i;i++){str[i]=str[i].trim();for(var objs=[],out=[],rec=!1,c=0;c<str[i].length;c++)"{"===str[i].charAt(c)&&(rec=!0),"}"===str[i].charAt(c)&&(rec=!1,out.push(str[i].charAt(c)),objs.push(out.join("")),out=[]),rec&&out.push(str[i].charAt(c));for(var j=0;j<objs.length;j++)str[i]=str[i].replace(objs[j],"_"+j+"_"),objs[j]=parseAttributeOptions(objs[j].substr(1,objs[j].length-2));str[i]=parseAttributeOptions(str[i]),str[i].to=objs[0],str[i].hasOwnProperty("from")&&(str[i].from=objs[1])}return str},clone=function(obj){if(null===obj||"object"!=typeof obj)return obj;if(obj instanceof Date){var copy=new Date;return copy.setTime(obj.getTime()),copy}if(obj instanceof Array){for(var copy=[],i=0,len=obj.length;len>i;i++)copy[i]=clone(obj[i]);return copy}if(obj instanceof Object){var copy={};for(var attr in obj)obj.hasOwnProperty(attr)&&(copy[attr]=clone(obj[attr]));return copy}throw new Error("Unable to copy obj! Its type isn't supported.")};window.requestTimeout=function(fn,delay){function loop(){var current=(new Date).getTime(),delta=current-start;delta>=delay?fn.call():handle.value=requestAnimationFrame(loop)}if(!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame&&window.mozCancelRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame))return window.setTimeout(fn,delay);var start=(new Date).getTime(),handle=new Object;return handle.value=requestAnimationFrame(loop),handle},window.clearRequestTimeout=function(handle){window.cancelAnimationFrame?window.cancelAnimationFrame(handle.value):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(handle.value):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(handle.value):window.mozCancelRequestAnimationFrame?window.mozCancelRequestAnimationFrame(handle.value):window.oCancelRequestAnimationFrame?window.oCancelRequestAnimationFrame(handle.value):window.msCancelRequestAnimationFrame?window.msCancelRequestAnimationFrame(handle.value):clearTimeout(handle);
},window.requestInterval=function(fn,delay){function loop(){var current=(new Date).getTime(),delta=current-start;delta>=delay&&(fn.call(),start=(new Date).getTime()),handle.value=requestAnimFrame(loop)}if(!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame&&window.mozCancelRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame))return window.setInterval(fn,delay);var start=(new Date).getTime(),handle=new Object;return handle.value=requestAnimFrame(loop),handle},window.clearRequestInterval=function(handle){window.cancelAnimationFrame?window.cancelAnimationFrame(handle.value):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(handle.value):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(handle.value):window.mozCancelRequestAnimationFrame?window.mozCancelRequestAnimationFrame(handle.value):window.oCancelRequestAnimationFrame?window.oCancelRequestAnimationFrame(handle.value):window.msCancelRequestAnimationFrame?window.msCancelRequestAnimationFrame(handle.value):clearInterval(handle)},define("Utilities",function(){}),define("services/ProcessHelper",["angular","spin","Utilities"],function(angular,Spinner,Utilities){"use strict";angular.module("logoBuilderApp.services.ProcessHelper",[]).factory("ProcessHelper",function($log,$rootScope,$timeout){var ProgressViewer=function(){function ProgressViewer(containerElement,overlaySelector){this._containerElement=containerElement,this._overlaySelector=overlaySelector,this._spinner=null,this._callTimes=0,this._stopDebounceTimeoutId=0}return ProgressViewer.prototype.start=function(opts){this._stopDebounceTimeout=(opts||{}).debounceTimeout||600,this._callTimes+=1,this._stopDebounceTimeoutId&&(clearTimeout(this._stopDebounceTimeoutId),this._stopDebounceTimeoutId=0),this._callTimes>1||(this._spinner&&this._spinner.stop(),this._spinner=new Spinner(angular.extend({lines:15,length:35,width:6,radius:28,corners:1,rotate:0,direction:1,color:"#8F0887",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:100,top:"50%",left:"50%"},{})).spin(),$(this._containerElement).addClass("in-process").prepend('<div class="in-process-overlay"></div>').append($(this._spinner.el).css("display","none").fadeIn("normal")))},ProgressViewer.prototype.stop=function(){if(this._callTimes-=1,!(this._callTimes>0)){var _this=this;this._callTimes=0,this._stopDebounceTimeoutId&&clearTimeout(this._stopDebounceTimeoutId),this._stopDebounceTimeoutId=setTimeout(function(){function hideOverlay(){var overlayElement=$(_this._containerElement).removeClass("in-process").children("div.in-process-overlay");overlayElement.fadeOut("fast",function(){overlayElement.remove()})}_this._stopDebounceTimeoutId=0,_this._spinner?$(_this._spinner.el).fadeOut("fast",function(){_this._spinner.stop(),hideOverlay()}):hideOverlay()},this._stopDebounceTimeout)}},ProgressViewer}();return{ProgressViewer:ProgressViewer}}).directive("progressViewer",function(ProcessHelper){function processEvent(method,regexpCheckId,attrs,progress,opts){attrs.progressViewer.match(new RegExp(regexpCheckId))&&progress[method](opts)}return{restrict:"EA",scope:!1,link:function(scope,element,attrs){var progress=new ProcessHelper.ProgressViewer(element);scope.$on("progress-viewer:start",function(event,regexpCheckId,opts){processEvent("start",regexpCheckId,attrs,progress,opts)}),scope.$on("progress-viewer:stop",function(event,regexpCheckId){processEvent("stop",regexpCheckId,attrs,progress)})}}})}),define("services/SharedCode",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.services.SharedCode",[]).factory("SharedCode",["$log",function($log){function svgNSParse(nodeName,namespace){return nodeName=nodeName.split(":"),2==nodeName.length?nodeName:[void 0===namespace?"http://www.w3.org/2000/svg":"",nodeName[0]]}return{bindConfirmOnUnload:function(message){return message?void(window.onbeforeunload=window.onbeforeunload||function(event){var ev=event||window.event;return ev&&(ev.returnValue=message),message}):void(window.onbeforeunload=null)},svgBuildNode:function(nodeName,attributes,appendNodes,setParentNode){nodeName=svgNSParse(nodeName);var node=document.createElementNS(nodeName[0],nodeName[1]);return Object.keys(attributes||{}).forEach(function(name){var attrName=svgNSParse(name,"");attrName[0]?node.setAttributeNS(attrName[0],attrName[1],""+attributes[name]):node.setAttribute(attrName[1],""+attributes[name])}),appendNodes&&Array.prototype.forEach.call(appendNodes,function(n){node.appendChild(n)}),setParentNode&&setParentNode.appendChild(node),node},inherit:function(child,parent,methods,classFields){return child.prototype=Object.create(parent.prototype),angular.extend(child.prototype,methods),classFields&&angular.extend(child,classFields),child.prototype.constructor=child,child["super"]=parent.prototype,child},getIEVersion:function(){var IE=-1;return window.ie9||document.all&&!window.atob?IE=9:document.all&&window.atob?IE=10:navigator.userAgent.match(/Trident.*rv[ :]*11\./)?IE=11:navigator.userAgent.match(new RegExp("Edge/"))&&(IE=13),IE}}}])}),define("services/SvgSerializer",["angular","svgjs"],function(angular,svgjs){"use strict";function mapLogoObjectNodes(svgElementsIds,srcContainer,methodFn){var objects=[];return $(srcContainer).children().each(function(){if(this.id&&(this.id.indexOf("text-")>-1||this.id.indexOf("symbol-")>-1)){var objectType=this.id.split("-")[0],id=this.id.split("-").pop();svgElementsIds.indexOf(objectType+"-wrapper-"+id)>-1&&objects.push(methodFn&&methodFn(this,objectType,id)||this)}}),objects}var SERIALIZE_LOGO_VIEWPORT_PADDING=10;angular.module("logoBuilderApp.services.SvgSerializer",[]).factory("SvgSerializer",["$log","svgService",function($log,SvgService){var SvgSerializer={Stringify:function(svgElementsIds){if(!svgElementsIds&&svgElementsIds.constructor!==Array.prototype.constructor)throw new Error("Wrong SVG ids elements");var svg=document.getElementById("svg"),gridElement=$("#editorGrid"),svgBound=SvgService.getSVGBoundaries(mapLogoObjectNodes(svgElementsIds,svg)),w=svgBound.right-svgBound.left,h=svgBound.bottom-svgBound.top,vW=w+2*SERIALIZE_LOGO_VIEWPORT_PADDING,vH=h+2*SERIALIZE_LOGO_VIEWPORT_PADDING,vL=svgBound.left-SERIALIZE_LOGO_VIEWPORT_PADDING,vT=svgBound.top-SERIALIZE_LOGO_VIEWPORT_PADDING,wt=Math.ceil(w)+2*SERIALIZE_LOGO_VIEWPORT_PADDING,ht=Math.ceil(h)+2*SERIALIZE_LOGO_VIEWPORT_PADDING;$log.debug("vL: "+vL+"  vT: "+vT);var tmpSvgContainer=svg.cloneNode(!0),offsetFix=document.createElementNS("http://www.w3.org/2000/svg","g");offsetFix.setAttribute("id","offset-fix-group"),offsetFix.setAttribute("transform","matrix(1,0,0,1,"+-vL+","+-vT+")"),tmpSvgContainer.appendChild(offsetFix),mapLogoObjectNodes(svgElementsIds,tmpSvgContainer,function(obj,objType,id){offsetFix.appendChild(obj)});var gridW=gridElement.width()/8,gridH=gridElement.height()/8;$log.debug("SVG Editor Grid:"+gridW+" "+gridH),tmpSvgContainer.setAttribute("width",wt+gridW+"px"),tmpSvgContainer.setAttribute("height",ht+gridH+"px"),tmpSvgContainer.setAttribute("viewBox","0 0 "+vW+" "+vH),tmpSvgContainer=angular.element(tmpSvgContainer);var ieRect=tmpSvgContainer[0].getElementById("ie-rect");ieRect&&ieRect.parentNode.removeChild(ieRect);var defs,stockDefs,symbolBackgroundTrimGradient=tmpSvgContainer[0].getElementById("symbolBackgroundTrimGradient"),symbolGradient=tmpSvgContainer[0].getElementById("symbolGradient");if(defs=tmpSvgContainer&&tmpSvgContainer[0].getElementById("symbol-assets"),defs&&(stockDefs=defs.querySelector("#stock-defs")),stockDefs){for(;stockDefs.lastChild;)stockDefs.removeChild(stockDefs.lastChild);symbolGradient&&stockDefs.appendChild(symbolGradient),symbolBackgroundTrimGradient&&stockDefs.appendChild(symbolBackgroundTrimGradient)}Array.prototype.forEach.call(document.querySelectorAll("g[data-font] use"),function(item){var letterID=item.getAttributeNS("xlink","href").substring(1);if(defs){var def=document.getElementById(letterID).cloneNode(!0);defs.appendChild(def)}});var logo=(new XMLSerializer).serializeToString(tmpSvgContainer[0]);return logo=logo.replace(/xmlns=\"http\:\/\/www\.w3\.org\/2000\/svg\"\sxmlns\:ns\d+=\"\"\sns\d+:xmlns\S*/i,""),logo=logo.replace(/xmlns:ns\d*=\"\"/gi,""),logo=logo.replace(/ns\d+:xlink:href=\"\S*\"/gi,""),logo=logo.replace(/ns\d+:xmlns:xlink=\"\S*\"/gi,""),logo=logo.replace(/&quot;/g,""),logo=logo.replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/gi,""),logo=logo.replace(/<svg/,'<svg xmlns="http://www.w3.org/2000/svg"'),logo=logo.replace(/ viewbox=/," viewBox="),logo=logo.replace(' xmlns="xmlns" '," "),logo=logo.replace(/xmlns\:ns\d+=".*?"\s+ns\d+\:xlink=".*?"/gi,"")}};return SvgSerializer}])}),define("services/SvgService",["angular","svgjs"],function(angular,svgjs){"use strict";angular.module("logoBuilderApp.services.SvgService",[]).service("svgService",function($q,$log,$http,logoData,$timeout){var cachedResources={},charUniqId=1,IE=-1;return window.ie9||document.all&&!window.atob?IE=9:document.all&&window.atob?IE=10:navigator.userAgent.match(/Trident.*rv[ :]*11\./)?IE=11:navigator.userAgent.match(new RegExp("Edge/"))&&(IE=13),{rad2deg:function(angle){return 180*angle/Math.PI},deg2rad:function(angle){return angle*Math.PI/180},positiveAngle:function(angle){return 0>angle?360+angle%360:angle%360},getMaxScale:function(thisWidth,thisHeight,maxWidth,maxHeight){var widthScale=maxWidth/thisWidth,heightScale=maxHeight/thisHeight;return heightScale>widthScale?widthScale:heightScale},getMatrixFromStyle:function(style){var match=/matrix\(([-]?[0-9]*\.?[0-9]+)(,|\s)([-]?[0-9]*\.?[0-9]+)(,|\s)([-]?[0-9]*\.?[0-9]+)(,|\s)([-]?[0-9]*\.?[0-9]+)(,|\s)([-]?[0-9]*\.?[0-9]+)(,|\s)([-]?[0-9]*\.?[0-9]+)\)/g.exec(style);return{a:match&&match[1]||1,b:match&&match[3]||0,c:match&&match[5]||0,d:match&&match[7]||1,x:match&&match[9]||0,y:match&&match[11]||0}},deltaTransformPoint:function(matrix,point){return{x:point.x*matrix.a+point.y*matrix.c+0,y:point.x*matrix.b+point.y*matrix.d+0}},decomposeMatrix:function(matrix){var px=this.deltaTransformPoint(matrix,{x:0,y:1}),py=this.deltaTransformPoint(matrix,{x:1,y:0}),skewX=180/Math.PI*Math.atan2(px.y,px.x)-90,skewY=180/Math.PI*Math.atan2(py.y,py.x);return{translateX:matrix.x,translateY:matrix.y,scaleX:Math.sqrt(matrix.a*matrix.a+matrix.b*matrix.b),scaleY:Math.sqrt(matrix.c*matrix.c+matrix.d*matrix.d),skewX:skewX,skewY:skewY,rotation:Math.atan2(matrix.b,matrix.a)}},composeMatrix:function(matrix,scaleX,skewY,skewX,scaleY,translateX,translateY){matrix.a=null!=scaleX?scaleX:1,matrix.b=skewY||0,matrix.c=skewX||0,matrix.d=null!=scaleY?scaleY:1,matrix.x=translateX||0,matrix.y=translateY||0},getBoundingBox:function(m,w,h){var bbox={},angle=this.deg2rad(this.positiveAngle(this.rad2deg(Math.atan2(m.b,m.a))));return angle=angle>.5*Math.PI&&angle<1*Math.PI||angle>1.5*Math.PI&&angle<2*Math.PI?Math.PI-angle:angle,bbox.width=Math.abs(Math.sin(angle)*h+Math.cos(angle)*w),bbox.height=Math.abs(Math.sin(angle)*w+Math.cos(angle)*h),bbox.scaleX=Math.sqrt(m.a*m.a+m.c*m.c),bbox.scaleY=Math.sqrt(m.b*m.b+m.d*m.d),bbox.scaleW=bbox.width*bbox.scaleX,bbox.scaleH=bbox.height*bbox.scaleY,bbox},getSVGBoundaries:function(svgElements){var svg=document.getElementById("svg"),svgRect=svg.getBoundingClientRect(),left=1e4,top=1e4,right=-1e3,bottom=-1e3;return svgElements.forEach(function(element){var elementRect=element.getBoundingClientRect();elementRect.right-svgRect.left>=0&&elementRect.bottom-svgRect.top>=0&&elementRect.left-svgRect.left<svgRect.width&&elementRect.top-svgRect.top<svgRect.height&&(left=Math.min(left,elementRect.left-svgRect.left),top=Math.min(top,elementRect.top-svgRect.top),right=Math.max(right,elementRect.right-svgRect.left),bottom=Math.max(bottom,elementRect.bottom-svgRect.top))}),$log.debug("Computed svg boundary: left:"+left+" right:"+right+" top:"+top+" bottom:"+bottom),{left:left,right:right,top:top,bottom:bottom}},getReferenceCenter:function(p,c){var pp=p.createSVGPoint(),rect=document.createElementNS("http://www.w3.org/2000/svg","rect"),cbox=c.getBBox(),rTrans="translate("+cbox.width/2+", "+cbox.height/2+")";rect.setAttribute("transform",rTrans),rect.setAttribute("width",1),rect.setAttribute("height",1),c.appendChild(rect);var ctm=rect.getCTM(),pmt=pp.matrixTransform(ctm);return c.removeChild(rect),rect=pp=cbox=rTrans=ctm=void 0,pmt},importNode:function(node,allChildren){var importedNode,instance=this;try{importedNode=document.importNode(node,!0)}catch(e){var i,il;switch(node.nodeType){case document.ELEMENT_NODE:var newNode=document.createElementNS(node.namespaceURI,node.nodeName);if(node.attributes&&node.attributes.length>0)for(i=0,il=node.attributes.length;il>i;i++)newNode.setAttribute(node.attributes[i].nodeName,node.getAttribute(node.attributes[i].nodeName));if(allChildren&&node.childNodes&&node.childNodes.length>0)for(i=0,il=node.childNodes.length;il>i;i++)newNode.appendChild(instance.importNode(node.childNodes[i],allChildren));importedNode=newNode;break;case document.TEXT_NODE:case document.CDATA_SECTION_NODE:case document.COMMENT_NODE:importedNode=document.createTextNode(node.nodeValue)}}return importedNode},loadResource:function(url){return cachedResources[url]?$q(function(resolve,reject){setTimeout(function(){$log.debug("RESOURCE LOAD [CACHE]:",url),resolve(cachedResources[url])},50)}):$http.get(url).then(function(response){return cachedResources[url]=response.data},function(response){$log.error("RESOURCE LOAD [ERROR]:",url,response)})},stockGlyphUsePool:function(len){var length=len||100;if(!(1>length))for(var i=0;length>i;i++)logoData.glyphUsePool.push(document.createElementNS("http://www.w3.org/2000/svg","use"))},checkFont:function(fam){var fl=logoData.fontList[fam];return!(!logoData.fontLibrary[fl.folderName]&&!logoData.fontLibrary[fl.n])},loadFont:function(folderName,elem,isPreCache){var _this=this,_scope=isPreCache||angular.element(elem).scope();return isPreCache||_scope.send("startLoadingFont"),this.loadResource(logoData.assets_url+"/proxy/fonts/"+folderName+".fntz").then(function(data){return isPreCache||(_this.parseFontStyles(data,folderName),_scope.send("stopLoadingFont"),_scope.send("renderAfterLoadingFont")),data})},getFamilyFromFolder:function(folderName){for(var i in logoData.fontList)if(logoData.fontList.hasOwnProperty(i)&&logoData.fontList[i].folderName===folderName)return i;return""},IsObjectNodeType:function(o){return"object"==typeof HTMLElement?o instanceof HTMLElement:o&&"object"==typeof o&&null!==o&&1===o.nodeType&&"string"==typeof o.nodeName},parseXML:function(string){var doc=null;if("string"!=typeof string){if(!this.IsObjectNodeType(string))throw new Error("Passed wrong object/string ["+string+"]");return string}if(window.DOMParser){var domParser=new window.DOMParser;if(doc=domParser.parseFromString(string,"text/xml"),doc&&"html"==doc.documentElement.nodeName)throw new Error("ParseXML [ERROR]: "+$(doc).text())}else if("undefined"!=typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")){var xmlDoc=new window.ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false",xmlDoc.loadXML(string.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")),doc=xmlDoc}return doc.firstChild&&10==doc.firstChild.nodeType&&doc.removeChild(doc.firstChild),$("#offset-fix-group",doc).length&&($("#offset-fix-group",doc).children().unwrap(),$("#offset-fix-group",doc).remove()),doc},parseFontStyles:function(data,folderName){var ff="Open Sans";void 0===folderName?folderName="OpenSans":ff=this.getFamilyFromFolder(folderName);for(var fonts=data.split('<?xml version="1.0" standalone="no"?>').slice(1),len=fonts.length,i=0;len>i;i++){var rgx=/<font id="(.+?)"/g,match=rgx.exec(fonts[i]),fontID=match[1];rgx=/font\-weight="(.+?)"/g,match=rgx.exec(fonts[i]);var weight=parseInt(match[1]);rgx=/font\-style="(.+?)"/g,match=rgx.exec(fonts[i]);var style=match&&match[1]||"normal",fs="";400>=weight&&"normal"===style&&(fs="n"),weight>400&&"normal"===style&&(fs="b"),400>=weight&&"italic"===style&&(fs="i"),weight>400&&"italic"===style&&(fs="z");var fn=logoData.fontList[ff][fs]||fontID;void 0===logoData.fontLibrary[fn]&&(logoData.fontLibrary[fn]=this.parseFont(this.parseXML(fonts[i])))}},loadSVG:function(url,isPreCache){var _this=this;return this.loadResource(url).then(function(data){return isPreCache?data:_this.parseXML(data)})},parseFont:function(xml){var fontDefs=document.getElementById("fontDefs");if(!fontDefs){var p,fd=document.createElementNS("http://www.w3.org/2000/svg","svg");fd.setAttribute("id","fontDefs"),fd.setAttribute("width","0"),fd.setAttribute("height","0"),fd.setAttribute("style","position:absolute; top: -1000"),p=document.createElementNS("http://www.w3.org/2000/svg","defs"),p.setAttribute("id","font-assets"),fd.appendChild(p),document.body.appendChild(fd)}var doc=xml.documentElement,defs=doc.getElementsByTagName("defs")[0],font=defs.getElementsByTagName("font")[0],def={};def.id=font.id,def.horizAdvX=parseFloat(font.getAttribute("horiz-adv-x"));var face={},ff=font.getElementsByTagName("font-face")[0];face.fontFamily=ff.getAttribute("font-family"),face.fontWeight=ff.getAttribute("font-weight"),face.fontStretch=ff.getAttribute("font-stretch"),face.unitsPerEm=parseFloat(ff.getAttribute("units-per-em")),face.panose1=ff.getAttribute("panose-1"),face.ascent=parseFloat(ff.getAttribute("ascent")),face.descent=parseFloat(ff.getAttribute("descent")),face.alphabetic=ff.getAttribute("alphabetic"),face.xHeight=parseFloat(ff.getAttribute("x-height"))||null,face.capHeight=parseFloat(ff.getAttribute("cap-height"))||null,face.underlineThickness=parseFloat(ff.getAttribute("underline-thickness"))||null,face.underlinePosition=parseFloat(ff.getAttribute("underline-position"))||null,face.lineHeight=Math.abs(face.ascent)+Math.abs(face.descent);var str=ff.getAttribute("bbox");if(str&&str.length>0){var spl=str.split(" ");face.bbox={x:spl[0],y:spl[1],width:spl[2],height:spl[3]}}def.fontFace=face;for(var glyphs={},glyphList=font.getElementsByTagName("glyph"),glenn=glyphList.length,i=0;glenn>i;i++){var glyphXML=glyphList[i],g={};g.unicode=glyphXML.getAttribute("unicode"),g.glyphName=glyphXML.getAttribute("glyph-name"),g.descent=parseFloat(glyphXML.getAttribute("descent")),g.ascent=parseFloat(glyphXML.getAttribute("ascent"))+g.descent,g.horizAdvX=parseFloat(glyphXML.getAttribute("horiz-adv-x")),g.horizAdvX=isNaN(g.horizAdvX)?def.horizAdvX:g.horizAdvX,glyphXML.getAttribute("d")?g.data=glyphXML.getAttribute("d").split("\n").join(" ").split("\r").join(" "):g.data=null,g.unicode&&(glyphs[g.unicode]=g)}def.glyphs=glyphs;var missingGlyphXML=font.getElementsByTagName("missing-glyph")[0];if(missingGlyphXML&&missingGlyphXML.getAttribute("d")){var mg={};mg.data=missingGlyphXML.getAttribute("d").split("\n").join(" ").split("\r").join(" "),mg.horizAdvX=missingGlyphXML.getAttribute("horiz-adv-x"),def.missingGlyph=mg}for(var hkerns={},hkernList=font.getElementsByTagName("hkern"),hlen=hkernList.length,i=0;hlen>i;i++){var kernXML=hkernList[i],g1=kernXML.getAttribute("g1"),g2=kernXML.getAttribute("g2"),u1=kernXML.getAttribute("u1"),u2=kernXML.getAttribute("u2"),k=kernXML.getAttribute("k");g1&&g2&&(hkerns[g1]||(hkerns[g1]={}),hkerns[g1][g2]=parseFloat(k)),u1&&u2&&(u1="&#X"==u1.substr(0,3).toUpperCase()?u1.toUpperCase():u1,u2="&#X"==u2.substr(0,3).toUpperCase()?u2.toUpperCase():u2,hkerns[u1]||(hkerns[u1]={}),hkerns[u1][u2]=parseFloat(k))}return def.hkerns=hkerns,def.fontNum=Math.random().toString(36).replace(/[^a-z]+/g,""),++logoData.fontCount,def.useDefs={},def},getKerning:function(font,g,ng){var hkern=0;if(ng){var g1=g.glyphName,g2=ng.glyphName;if(g1&&g2&&font.hkerns[g1]&&font.hkerns[g1][g2])return parseFloat(font.hkerns[g1][g2]);var u1=g.unicode,u2=ng.unicode;if(font.hkerns[u1]&&font.hkerns[u1][u2])return parseFloat(font.hkerns[u1][u2]);if(u1&&"&#x"!=u1.substr(0,3))var ux1=u1.charCodeAt(0).toString(16),c1="&#X"+ux1.toUpperCase()+";";else c1=u1;if(u2&&"&#x"!=u2.substr(0,3))var ux2=u2.charCodeAt(0).toString(16),c2="&#X"+ux2.toUpperCase()+";";else c2=u2;if(font.hkerns[c1]&&font.hkerns[c1][c2])return parseFloat(font.hkerns[c1][c2]);if(font.hkerns[u1]&&font.hkerns[u1][c2])return parseFloat(font.hkerns[u1][c2])}return hkern},getFontFromStyle:function(fam,style){var ff=logoData.fontList[fam],fnt="";return ff.hasOwnProperty(style)?fnt=ff[style]:(("b"===style||"i"===style)&&(fnt=ff.n),"z"===style&&(fnt=ff.b?ff.b:ff.i?ff.i:ff.n)),fnt},removeTextFromLogoData:function(id){return id in logoData.textFields&&delete logoData.textFields[id],logoData.textFields},isNodeAttachedTo:function(rootElement,checkingElement){return checkingElement?checkingElement===rootElement?!0:(checkingElement=checkingElement.parentNode)?this.isNodeAttachedTo(rootElement,checkingElement):!1:!1},getSvgWholeChildBound:function(parentNode,getBBoxFn){var wholeBoundBox=[1e4,1e4,-1e4,-1e4];return Array.prototype.forEach.call(parentNode&&parentNode.childNodes||[],function(childNode){var boundBox=getBBoxFn?getBBoxFn(childNode):childNode.getBBox();wholeBoundBox[0]=Math.min(wholeBoundBox[0],boundBox.left),wholeBoundBox[1]=Math.min(wholeBoundBox[1],boundBox.top),wholeBoundBox[2]=Math.max(wholeBoundBox[2],boundBox.right),wholeBoundBox[3]=Math.max(wholeBoundBox[3],boundBox.bottom)}),wholeBoundBox},renderFont:function(elem,isForce){function getElementOffsetBox(){var ebox=elem.getBBox();elem.setAttribute("transform","translate("+-ebox.x+", "+-ebox.y+")");var computedWidth=textRight-textLeft,currentBboxWidth=currentLength-letterSpacing;("z"===style||"i"===style)&&(currentBboxWidth+=400);var elemWidth=computedWidth>0?computedWidth:currentBboxWidth;textData.top=textTop*scale,textData.bottom=textBottom*scale,textData.width=elemWidth*scale,textData.height=(textTop-textBottom)*scale,textData.content=content,textData.font=sFont,logoData.textFields[elem.id]=textData,_this.updateTextFieldProperties(elem)}var textData,len,sym,scale,_this=(document.querySelector("#fontDefs defs"),document.getElementById("svg"),this),_scope=angular.element(elem).scope(),pNode=elem,letterSpacing=parseFloat(elem.getAttribute("data-letter-spacing"))||0,content=elem.getAttribute("data-content"),style=(elem.getAttribute("data-fill")||"#000000",elem.getAttribute("data-style")||"n"),shape=elem.getAttribute("data-path")||"straight",radius=elem.getAttribute("data-radius")||3,fam=elem.getAttribute("data-font"),sFont=this.getFontFromStyle(fam,style),currentLength=0,textTop=-1e4,textBottom=1e4,textLeft=0,textRight=0,glyphIndex=0,font=null;if(!this.checkFont(fam))return this.loadFont(logoData.fontList[fam].folderName,elem);if(textData=textData||{},textData.renderFX=!!isForce,logoData.textFields[elem.id]){textData=logoData.textFields[elem.id];var existingGlyphs,contentDifferent=textData.content!==content,fontDifferent=textData.font!==sFont,textDifferent=contentDifferent||fontDifferent;textDifferent&&(textData.content=content,textData.font=sFont,textData.renderFX=!0)}else textData={},textData.renderFX=!0;existingGlyphs=elem.childNodes,textData.renderFX&&jQuery(elem).empty(),logoData.fontList[fam].disable&&logoData.fontList[fam].disable.indexOf("I")>-1&&(_scope.selectedItalic=!1,style="z"===style?"b":style,style="i"===style?"n":style,elem.setAttribute("data-style",style));var sFont=this.getFontFromStyle(fam,style);font=logoData.fontLibrary[sFont]||logoData.fontLibrary[logoData.fontList[fam].folderName],sym=logoData.fontLibrary.OpenSans,scale=16/parseFloat(font.fontFace.unitsPerEm),letterSpacing=letterSpacing*font.fontFace.unitsPerEm/16,len=content.length;var xRadius=2e3*radius;if("straight"!==shape){var totalLength=this.getTextLength(elem);currentLength-=totalLength/2}for(var i=0;len>i;i++){var glyph=font.glyphs[content.charAt(i)]||sym.glyphs[content.charAt(i)]||font.glyphs[" "];if(i>0){var pGlyph=font.glyphs[content.charAt(i-1)]||sym.glyphs[content.charAt(i-1)]||font.glyphs[" "],hkern=this.getKerning(font,pGlyph,glyph);currentLength-=hkern}if(glyph.data){var id="f"+font.fontNum+"-"+glyph.glyphName;font.useDefs[id]||(font.useDefs[id]=!0);var svgFontNode;if(textData.renderFX?(svgFontNode=document.createElementNS(svgjs.ns,"path"),pNode.appendChild(svgFontNode),svgFontNode.setAttribute("d",glyph.data),svgFontNode.setAttribute("id","char-"+id+"-"+charUniqId++)):(svgFontNode=existingGlyphs[glyphIndex],glyphIndex++),svgFontNode){var trans;if("straight"===shape)trans="scale("+scale+", -"+scale+") translate("+currentLength+", 0)",glyph.ascent>textTop&&(textTop=glyph.ascent),glyph.descent<textBottom&&(textBottom=glyph.descent);else{var xCurrentLength=currentLength+glyph.horizAdvX/2,pd=this.getShapeTextPlacementData(glyph.horizAdvX,xRadius,xCurrentLength,shape,font.fontFace.ascent);trans="scale("+scale+", -"+scale+") ",trans+="translate("+pd.left+", "+pd.top+") ",trans+="rotate("+pd.deg+", "+pd.cx+", "+pd.cy+")",pd.xList=[pd.left,pd.left+glyph.horizAdvX],pd.yList=[pd.top,pd.top+glyph.ascent+glyph.descent];var rotCoords=this.getRotatedCoords(pd);rotCoords.forEach(function(element,index,array){textLeft=Math.min(textLeft,element.x),textTop=Math.min(textTop,element.y),textRight=Math.max(textRight,element.x),textBottom=Math.max(textBottom,element.y)})}"z"!==style||logoData.fontLibrary[logoData.fontList[fam].z]||(logoData.fontLibrary[logoData.fontList[fam].b]?svgFontNode.removeAttribute("stroke-width"):svgFontNode.setAttribute("stroke-width","20"),(!logoData.fontLibrary[logoData.fontList[fam].i]||sFont.indexOf("Bold")>-1)&&(trans+=" skewX(20)")),"b"!==style||logoData.fontLibrary[logoData.fontList[fam].b]?svgFontNode.removeAttribute("stroke-width"):svgFontNode.setAttribute("stroke-width","20"),"i"!==style||logoData.fontLibrary[logoData.fontList[fam].i]||(trans+=" skewX(20)"),svgFontNode.setAttribute("transform",trans),currentLength+=glyph.horizAdvX||font.fontFace.horizAdvX||0}}else currentLength+=glyph.horizAdvX||font.fontFace.horizAdvX||0;currentLength+=letterSpacing}return getElementOffsetBox(),$q.resolve()},getTextLength:function(elem){var currentLength=0,content=elem.getAttribute("data-content"),len=content.length,letterSpacing=parseFloat(elem.getAttribute("data-letter-spacing"))||0,fam=elem.getAttribute("data-font"),style=elem.getAttribute("data-style")||"n",sFont=this.getFontFromStyle(fam,style),font=logoData.fontLibrary[sFont]||logoData.fontLibrary[logoData.fontList[fam].folderName],sym=logoData.fontLibrary.OpenSans;letterSpacing*=font.fontFace.unitsPerEm/16;for(var i=0;len>i;i++){var glyph=font.glyphs[content.charAt(i)]||sym.glyphs[content.charAt(i)]||font.glyphs[" "];if(i>0){var pGlyph=font.glyphs[content.charAt(i-1)]||sym.glyphs[content.charAt(i-1)]||font.glyphs[" "],hkern=this.getKerning(font,pGlyph,glyph);currentLength-=hkern}currentLength+=glyph.data?glyph.horizAdvX||font.fontFace.horizAdvX||0:glyph.horizAdvX||font.fontFace.horizAdvX||0,currentLength+=letterSpacing}return currentLength},updateTextFieldProperties:function(elem){var elemID=elem.getAttribute("id"),idArray=elemID.split("-"),_scope=("text-wrapper-"+idArray[idArray.length-1],angular.element(elem).scope());logoData.textFields[elem.id].renderFX?(logoData.textFields[elem.id].renderFX=!1,_scope.send("reinstateTextEffects")):_scope.send("recalculateTextEffects")},removeChildSafe:function(el){for(;el&&el.childNodes.length>0;)removeChildSafe(el.childNodes[el.childNodes.length-1])},discardElement:function(el){var bin=document.getElementById("IELeakGarbageBin");bin||(bin=document.createElement("div"),bin.id="IELeakGarbageBin",document.body.appendChild(bin)),bin.appendChild(el),bin.innerHTML=""},loadSymbol:function(loadedSymbol){for(var xmlDoc=this.parseXML(loadedSymbol),paths=[],symbolPaths=xmlDoc.getElementsByTagName("path"),i=0;i<symbolPaths.length;i++)paths.push(symbolPaths[i].getAttribute("d"));return paths},setSymbolColorStyles:function(style,symbol){symbol=symbol||svgjs.select("#symbol-1").first(),symbol.each(function(i,child){this.attr("stroke")&&this.stroke(style),this.attr("fill")&&this.fill(style)},!0)},_filterSvgContent:function(previousRoot,nodeRoot){if(nodeRoot)for(var attr,i=nodeRoot.childNodes.length,nodes=nodeRoot.childNodes;i--;){if(["text"].indexOf(nodes[i].nodeName)>-1&&previousRoot)return void previousRoot.removeChild(nodeRoot);["svg","g"].indexOf(nodes[i].nodeName)>-1?this._filterSvgContent(nodeRoot,nodes[i]):["path","polyline","polygon","ellipse","line","circle","rect","switch"].indexOf(nodes[i].nodeName)<0||[Node.DOCUMENT_NODE,Node.ELEMENT_NODE].indexOf(nodes[i].nodeType)<0?nodeRoot.removeChild(nodes[i]):(attr=nodes[i].getAttribute("style"))&&nodes[i].setAttribute("style",attr.replace(/(fill) *: *[^;]+;?/g,";"))}},transformToCompatibleSvg:function(loadedSymbol,counter){var symbol,xmlDoc=this.parseXML(loadedSymbol);if(this._filterSvgContent(null,xmlDoc),symbol=xmlDoc,xmlDoc&&xmlDoc.firstChild){var svgElement=xmlDoc.firstChild,inx=svgElement.childNodes.length;for(symbol=document.createElementNS("http://www.w3.org/2000/svg","g"),symbol.setAttribute("id","gsymbol-"+(counter||1));inx--;)symbol.appendChild(svgElement.firstChild)}return symbol},addTextfield:function(textField,textfieldID,isTextOnPath,addHistory){var stage=document.querySelector("#svg"),twg=document.createElementNS("http://www.w3.org/2000/svg","g"),_id="text-wrapper-"+textfieldID,_scope=angular.element(stage).scope(),color=textField.color||"#000000",font=textField.font||"Open Sans";twg.setAttribute("id",_id),twg.setAttribute("fill",color),twg.setAttribute("stroke",color),twg.setAttribute("cursor","pointer"),twg.setAttribute("transform",textField.mtx),stage.appendChild(twg);var tg=document.createElementNS("http://www.w3.org/2000/svg","g");tg.setAttribute("id","text-"+textfieldID),tg.setAttribute("data-style","n"),tg.setAttribute("data-letter-spacing","0"),tg.setAttribute("data-fill",color),tg.setAttribute("data-font",font),tg.setAttribute("data-content",textField.text),tg.setAttribute("transform","matrix(1,0,0,1,0,12)"),tg.setAttribute("data-distress",!1),tg.setAttribute("data-reflection",!1),tg.setAttribute("data-shadow",!1),tg.setAttribute("data-shine",!1),tg.setAttribute("data-element-type","regular-text"),twg.appendChild(tg);var addHist=!0;if(void 0!==addHistory&&null!==addHistory&&""!==addHistory&&(addHist=addHistory),addHist===!0){var history={id:_id,type:"addTextField",data:{}};_scope.send("addHistory",history)}},getShapeTextPlacementData:function(width,radius,arcLength,thisType,ascent){var coords,angle,shapeType=thisType||"up",shape={},angleIncr=0,arcDir=1;return shape.radius=radius,shape.cx=shape.radius/2,shape.cy=shape.radius/2,"down"===shapeType?shape.angle=0-Math.PI/2:(angleIncr+=Math.PI,arcDir=-1,shape.angle=Math.PI/2),arcLength*=arcDir,coords=this.getPolarCoords(arcLength,shape),angle=coords[2]+Math.PI/2+angleIncr,this.getCharTransform(width,ascent,coords,angle)},getPolarCoords:function(arc,shape){var angle=arc/shape.radius+shape.angle,cos=Math.cos(angle),sin=Math.sin(angle),x=shape.radius*cos+shape.cx,y=shape.radius*sin+shape.cy;return[x,y,angle]},getCharTransform:function(width,ascent,coords,angle){var obj={};return obj.top=coords[1]-ascent,obj.left=coords[0]-width/2,obj.rad=angle,obj.deg=angle*(180/Math.PI),obj.cx=width/2,obj.cy=0,obj},getRotatedCoords:function(pd){for(var coords=[],i=0;i<pd.xList.length;i++)for(var j=0;j<pd.yList.length;j++){var point={},rcx=pd.cx+pd.left,rcy=pd.cy+pd.top;point.x=rcx+(pd.xList[i]-rcx)*Math.cos(pd.rad)-(pd.yList[j]-rcy)*Math.sin(pd.rad),point.y=rcy-(pd.xList[i]-rcx)*Math.sin(pd.rad)+(pd.yList[j]-rcy)*Math.cos(pd.rad),coords.push(point)}return coords}}})}),define("services/SvgTransformService",["angular","svgjs","transform-dom"],function(angular,svgjs){"use strict";angular.module("logoBuilderApp.services.SvgTransformService",[]).factory("SvgTransformService",["$log","$timeout","svgService","historyService","logoData","EditorEffectsService",function($log,$timeout,svgService,historyService,logoData,EditorEffectsService){var transformToolInstance=null,TransformTool=(function(){function DomTransformTool(){}var tool;DomTransformTool.create=function(element){return tool=new DOMTransformTool(element)},DomTransformTool.getLastCreated=function(){return tool}}(),function(){function TransformTool(scope,element,attrs){
var toolElem=element[0];this.scope=scope,this.dom=document.getElementById(attrs.dom),this.dom.addEventListener("removeElement",this.remove.bind(this)),this.tool=transformToolInstance=element?new DOMTransformTool(element.get(0)):null,this.setSelectedItem=function(){},this.moving=!1,this.displayIDHash=[],this.displayList=[];for(var i=0;i<scope.targets.length;i++)this.displayIDHash.push(scope.targets[i]),this.displayList.push(pictureService.create(scope.targets[i]));toolElem.style.zIndex=this.displayList.length,this.setupTool(),this.bindHandlers(),$(this.dom).hammer().bind("doubletap",TransformTool.prototype.doubleclick.bind(this));var hammer=$(this.dom).hammer({domEvents:!0}).bind("pressup",TransformTool.prototype.doubleclick.bind(this)).data("hammer");hammer.get("tap").set({event:"tap",time:19}),hammer.get("press").set({event:"press",time:20,threshold:2}),this.render()}function createTransformControls(targetContent,translater,isClose){var transformControl=[new DOMControl(Control.BORDER),targetContent,translater,new DOMControl(Control.SCALE_X,0,.5,0,0,10,"ew-resize"),new DOMControl(Control.SCALE_X,1,.5,0,0,10,"ew-resize"),new DOMControl(Control.SCALE_Y,.5,0,0,0,10,"ns-resize"),new DOMControl(Control.SCALE_Y,.5,1,0,0,10,"ns-resize"),new DOMControl(Control.SCALE_UNIFORM,0,0,0,0,10,"nwse-resize"),new DOMControl(Control.SCALE_UNIFORM,0,1,0,0,10,"nesw-resize"),new DOMControl(Control.SCALE_UNIFORM,1,0,0,0,10,"nesw-resize"),new DOMControl(Control.SCALE_UNIFORM,1,1,0,0,10,"nwse-resize"),new DOMControl(Control.ROTATE,.5,0,1,-25,19)];return isClose&&transformControl.push(new DOMControl(Control.CLOSE,.5,0,30,-20,13)),transformControl}return TransformTool.getInstance=function(element){return transformToolInstance},TransformTool.prototype.bindHandlers=function(){this.up=this.up.bind(this),this.down=this.down.bind(this),this.move=this.move.bind(this),this.render=this.render.bind(this),this.renderSelected=this.renderSelected.bind(this),this.dom.removeEventListener(Mouse.START,this.down),this.dom.addEventListener(Mouse.START,this.down)},TransformTool.prototype.doubleclick=function(){var _this=this;$timeout(function(){_this.scope.$root.send("toolDoubleclick")},1)},TransformTool.prototype.setupTool=function(){ControlSet.controlClass=DOMControl,this.symbolControls=this.getCustomControls(),this.textControls=this.getTextControls(),this.tool.setControls(this.symbolControls)},TransformTool.prototype.remove=function(e){this.scope.$root.send("removeElem")},TransformTool.prototype.getCustomControls=function(){var translater=new DOMControl(Control.TRANSLATE);return translater.hitTestTarget=!0,createTransformControls(new DOMControl(Control.TARGET),translater)},TransformTool.prototype.getTextControls=function(){var translater=new DOMControl(Control.TRANSLATE);return translater.hitTestTarget=!0,createTransformControls(new DOMControl(Control.TARGET),translater,!0)},TransformTool.prototype.down=function(event){logoData.symbol.moving=!0,this.dX=event.x,this.dY=event.y,Mouse.get(event,this.dom);var controlled=this.tool.start(Mouse.x,Mouse.y);if(!controlled&&this.selectImage(Mouse.x,Mouse.y)&&(controlled=this.tool.start(Mouse.x,Mouse.y,this.findControlByType(Control.TRANSLATE))),controlled&&(this.dom.addEventListener(Mouse.MOVE,this.move),document.addEventListener(Mouse.END,this.up)),this.tool.target){var targetID=angular.element(document.getElementById("svg")).scope().selectedItem.item.id.replace(/(text-)/g,"text-wrapper-");targetID=targetID.replace(/(symbol-)/g,"symbol-wrapper-");var history={id:targetID,type:"transform",oldMatrix:document.getElementById(targetID).getAttribute("transform"),data:{}};this.scope.$root.send("addHistory",history),this.scope.selected.deg=Math.floor(svgService.positiveAngle(svgService.rad2deg(this.tool.target.matrix.getRotationX()))),this.scope.$apply();var objectNameParts=targetID.split("-");EditorEffectsService.hideEffects(objectNameParts[0],objectNameParts.pop())}requestAnimationFrame(this.renderSelected),event.preventDefault()},TransformTool.prototype.move=function(event){logoData.symbol.moving=!0,Mouse.get(event,this.dom),this.applyDynamicControls(event),this.tool.move(Mouse.x,Mouse.y),this.scope.selected.deg=Math.floor(svgService.positiveAngle(svgService.rad2deg(this.tool.target.matrix.getRotationX()))),this.scope.$apply(),requestAnimationFrame(this.renderSelected),event.preventDefault()},TransformTool.prototype.up=function(event){logoData.symbol.moving=!1,this.tool.end(),this.dom.removeEventListener(Mouse.MOVE,this.move),document.removeEventListener(Mouse.END,this.up),logoData.saveState=!0,requestAnimationFrame(this.renderSelected),event.preventDefault();var history=historyService.getCurrentHistoryItem();if(null!==history&&"transform"===history.type){var oldMatrix=history.oldMatrix,newMatrix=document.getElementById(history.id).getAttribute("transform");oldMatrix===newMatrix&&($log.debug("TransformTool.up: removing transform history because we didnt move"),historyService.removeLastHistoryItem());var targetID=angular.element(document.getElementById("svg")).scope().selectedItem.item.id.replace(/(text-)/g,"text-wrapper-");targetID.split("-")}var _this=this;$timeout(function(){_this.scope.$root.send("refreshSelectedObjectEffects")},0)},TransformTool.prototype.applyDynamicControls=function(event){var dyn=this.getDynamicControl();dyn&&(event.ctrlKey?event.shiftKey?dyn.type=Control.ROTATE_SCALE:dyn.type=Control.ROTATE:event.shiftKey?dyn.type=Control.SCALE:dyn.type=Control.TRANSLATE)},TransformTool.prototype.getDynamicControl=function(){var i=0,n=this.tool.controls.length;for(i=0;n>i;i++)if(this.tool.controls[i].dynamicUV)return this.tool.controls[i];return null},TransformTool.prototype.findControlByType=function(type){var i=0,n=this.tool.controls.length;for(i=0;n>i;i++)if(this.tool.controls[i].type===type)return this.tool.controls[i];return null},TransformTool.prototype.selectImage=function(x,y){for(var pic=null,t=null,i=this.displayList.length;i--;)if(pic=this.displayList[i],t=pic.transform,t.matrix.containsPoint(x,y,t.width,t.height)){if(this.tool.target!==t&&(this.displayList.splice(i,1),this.displayList.push(pic),pic.image)){var newControls,elemType=pic.image.id.split("-")[0];newControls="symbol"===elemType?this.symbolControls:this.textControls,this.tool.setControls(newControls);var innerID="#"+pic.image.id.split("-")[0]+"-"+pic.image.id.split("-")[2];return this.tool.setTarget(t),this.setSelectedItem(innerID),!0}return!1}return this.tool.setTarget(null),this.setSelectedItem(null),!1},TransformTool.prototype.render=function(){this.drawDisplayList(),this.tool.draw()},TransformTool.prototype.renderSelected=function(){this.tool.target&&this.tool.target.owner.draw(),this.tool.draw()},TransformTool.prototype.drawDisplayList=function(){var i=0,n=this.displayList.length;for(i=0;n>i;i++)this.displayList[i].image&&(this.displayList[i].image.style.zIndex=i,this.displayList[i].draw())},TransformTool.prototype.removeTool=function(){var ctrlElem=document.getElementById("-dom-control-22"),removeEvent=new CustomEvent("removeElement",{bubbles:!0,cancelable:!1});ctrlElem.dispatchEvent(removeEvent)},TransformTool}());return{TransformTool:TransformTool}}])}),define("services/SymbolFacade",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.services.SymbolFacade",[]).factory("SymbolFacade",["$log","$q","appConfig","lgApi","logoData",function($log,$q,appConfig,lgApi,logoData){function randomInt(maxValue,minValue){return(minValue||0)+~~(Math.random()*(maxValue-(minValue||0)))}function getRandomIndustry(preIndustryId){return lgApi.getAllIndustriesSymbols().then(function(industries){if(!industries)return $q.reject("No industries was received");var industry=null;if(preIndustryId)industry=industries.filter(function(i){return i.id==preIndustryId}).pop();else do industry=industries[randomInt(industries.length)];while(industry.is_shapes||industry.is_alphabet);return industry})}return{findFirstSymbolBySequenceKeywordScanning:function(industryId,keywords){return getRandomIndustry(industryId||appConfig.firstTimeIndustryId).then(function(industry){return lgApi.findObjectsByKeywords(industryId||appConfig.firstTimeIndustryId,keywords).then(function(response){var symbolId=response.objects&&response.objects.length&&response.objects[0].symbols[0].id;return $q.all({data:response,industry:industry,symbolId:symbolId,symbolSvgContent:lgApi.getSymbolById(symbolId)})})}).then(function(response){return{industry:response.industry,symbol:{id:response.symbolId,svgContent:response.symbolSvgContent},data:response.data}})},loadDefaultFirstTimeSymbol:function(preIndustryId){return getRandomIndustry(preIndustryId).then(function(industry){return industry?$q.all({industry:industry,svgContent:lgApi.getSymbolById(appConfig.firstTimeSymbolId)}):$q.reject("No industry was received")}).then(function(data){return data.svgContent?{industry:data.industry,symbol:{id:appConfig.firstTimeSymbolId,svgContent:data.svgContent}}:$q.reject("No content was received for symbol")})},loadRandomSymbol:function(preIndustryId){return getRandomIndustry(preIndustryId).then(function(industry){return $q.all({industry:industry,symbols:industry.main_keyword?lgApi.getObjectsByKeywords(industry.main_keyword,1):lgApi.getIndustrySymbols(industry.id)})}).then(function(data){if(!data.symbols)return $q.reject("No symbols was received");var symbol,symbolsGroup=data.symbols[randomInt(data.symbols.length)];return symbolsGroup.symbols?(symbolsGroup=symbolsGroup.symbols,symbol=symbolsGroup[randomInt(symbolsGroup.length)]):symbol=symbolsGroup,symbol.is_foreign?data.symbol=lgApi.getForeignSymbol(symbol.data_url).then(function(data){return logoData.symbol_ID=2147483647,data}):data.symbol=lgApi.getSymbolById(symbol.id),data.symbolId=symbol.id,$q.all(data)}).then(function(data){return data.symbol?{industry:data.industry,symbol:{id:data.symbolId,svgContent:data.symbol}}:$q.reject("No symbol was received")})}}}])}),define("services/PopupModal",["angular","transform-dom","transform"],function(angular,senocular,senoc){"use strict";angular.module("logoBuilderApp.services.PopupModal",[]).directive("popupModal",function(){return{restrict:"E",scope:!0,link:function(scope,element,attrs){}}}).factory("PopupModalService",["$q","$http","$templateCache","$injector","$compile","$window","$rootScope","$rootElement",function($q,$http,$templateCache,$injector,$compile,$window,$rootScope,$rootElement){function PopupModal(config){this.templateUrl=config.templateUrl,this.controller=config.controller,this.backdrop=config.backdrop,this.scope=config.scope,this.$element=null,this.defer=$q.defer()}return PopupModal.prototype.getTemplateContent=function(templateUrl){return $q(function(resolve,reject){var template;(template=$templateCache.get(templateUrl))?resolve(template):$http.get(templateUrl).then(function(response){resolve(response.data)})})},PopupModal.prototype.show=function(){var _this=this;this.getTemplateContent(this.templateUrl).then(function(template){if(_this.scope||(_this.scope=$rootScope.$new(!0,null)),_this.controller){var thisController=_this.controller instanceof Function?_this.controller:_this.controller.slice(-1)[0];$injector.invoke(_this.controller,thisController,{$scope:_this.scope,$modal:{$$thisModal:_this,hide:function(value){var thisModal=this.$$thisModal;thisModal.close().then(function(){thisModal.defer.resolve(value)})},close:function(value){var thisModal=this.$$thisModal;thisModal.close().then(function(){thisModal.defer.reject(value)})}}})}_this.showBackdrop(),_this.$element=$compile(template)(_this.scope),angular.element(document.body).append(_this.$element)})},PopupModal.prototype.close=function(){var _this=this;return $q(function(resolve){_this.showBackdrop(!0),angular.element(_this.$element).remove(),resolve()})},PopupModal.prototype.showBackdrop=function(isRemove){if(isRemove)angular.element(document.body).removeClass("popup-modal-showing").find("div.popup-backdrop").remove();else if(this.backdrop){var doc=document.documentElement,left=(window.pageXOffset||doc.scrollLeft)-(doc.clientLeft||0),top=(window.pageYOffset||doc.scrollTop)-(doc.clientTop||0),backdropElement=angular.element('<div class="popup-backdrop"> </div>').css({top:top,left:left,opacity:void 0!==this.backdrop.opacity?this.backdrop.opacity:.6});angular.element(document.body).addClass("popup-modal-showing").append(backdropElement)}},{show:function(options){var modal=new PopupModal(options);return modal.show(),modal.defer.promise}}}])}),define("services/WizardService",["angular","spin","Utilities"],function(angular,Spinner,Utilities){"use strict";angular.module("logoBuilderApp.services.WizardService",[]).directive("bindHtmlUnsafe",function($compile){return function($scope,$element,$attrs){var compile=function(newHTML){newHTML?(newHTML.match(/^\<p\>/)||(newHTML="<span>"+newHTML+"</span>"),newHTML=$compile(newHTML)($scope),$element.html("").append(newHTML)):$element.html("").append("<span></span>")};if($attrs&&$attrs.bindHtmlUnsafe){var htmlName=$attrs.bindHtmlUnsafe;$scope.$watch(htmlName,function(newHTML){compile(newHTML)})}}}).factory("wizardService",function($log,$rootScope,$timeout,logoData){var loader,currentStep=0,highestStep=0,_this=this;$rootScope.$on("alert",function(event,alert){_this.stopLoader(),$rootScope.data.alert=alert});var currentContainerId;_this.addLoader=function(containerID,opts){if(currentContainerId=containerID,!$("#"+containerID+" > .spinner").length){var options={lines:15,length:35,width:8,radius:35,corners:1,rotate:0,direction:1,color:"#8F0887",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:3,top:"50%",left:"50%"};for(var i in opts)options[i]=opts[i];$rootScope.wizard.loader=new Spinner(options).spin(document.getElementById(containerID));var spinner=document.querySelector(".spinner");spinner&&(spinner.style.display="none")}},_this.getLoader=function(){return loader},_this.ignoreOptions=[],_this.showTransitions=function(step,type,loader){$log.debug("step: "+step+", type: "+type),step>highestStep&&(highestStep=step);var _that=this;$timeout(function(){var elements=document.querySelectorAll("[data-animate], [data-wipe-effect]");"leave"!==type||loader||0===currentStep||_that.startLoader(),Array.prototype.forEach.call(elements,function(el,i){var $el=angular.element(el),scope=$el.scope();scope.dataLoaded=!0,$el.addClass("start-animation")})},0)};var timeoutStopLoader,isStoping=!1;return _this.stopLoader=function(){isStoping||(timeoutStopLoader=setTimeout(function(){$("#"+currentContainerId+" > .spinner, #spinnerOverlay").css({display:"none"})},700))},_this.startLoader=function(){clearTimeout(timeoutStopLoader),$("#"+currentContainerId+" > .spinner, #spinnerOverlay").css({display:"block"})},_this.emit=function(event,a,b,c){$rootScope.$broadcast(event,a,b,c)},_this})}),define("directives/common/ColorPicker",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.directives.ColorPicker",[]).directive("colorPicker",function(lgApi){return{templateUrl:lgApi.getLocationUrl("views/color-picker.html"),restrict:"E",replace:!0,require:"ngModel",scope:{ngModel:"="},link:function(scope,element,attrs){function onColorEnter(e){var key=e.keyCode?e.keyCode:e.which;13===key&&(e.preventDefault(),scope.$root.send("changeColor",scope.hex))}function drawPicker(cursorPosition,blockColor){canvas.width=colorPickerSize.width+2*borderOffset,canvas.height=colorPickerSize.height+2*borderOffset,context.fillStyle="#949494",context.fillRect(0,0,canvas.width,canvas.height),drawColorBox(context,borderOffset,borderOffset)}function drawColorBox(ctx,x,y){ctx.save(),ctx.beginPath(),ctx.moveTo(x+0,y+0),ctx.lineTo(x+245,y+0),ctx.lineTo(x+245,y+83),ctx.lineTo(x+0,y+83),ctx.closePath(),ctx.clip(),ctx.strokeStyle="rgba(0,0,0,0)",ctx.lineCap="butt",ctx.lineJoin="miter",ctx.miterLimit=4,ctx.transform(1,0,0,1,1.45,0),g=ctx.createLinearGradient(x+26.549782399999984,y+-16.8,x+253.3502176,y+-16.8),g.addColorStop(.0313725,"rgba(255, 0, 0, 1)"),g.addColorStop(.184314,"rgba(255, 255, 0, 1)"),g.addColorStop(.203922,"rgba(255, 255, 0, 1)"),g.addColorStop(.352941,"rgba(0, 255, 0, 1)"),g.addColorStop(.498039,"rgba(0, 255, 255, 1)"),g.addColorStop(.513725,"rgba(0, 255, 255, 1)"),g.addColorStop(.686275,"rgba(0, 0, 255, 1)"),g.addColorStop(.831373,"rgba(255, 0, 255, 1)"),g.addColorStop(.980392,"rgba(255, 0, 0, 1)"),ctx.fillStyle=g,ctx.beginPath(),ctx.moveTo(x+252.05,y+83),ctx.lineTo(x+26.1,y+83),ctx.lineTo(x+26.1,y+0),ctx.lineTo(x+252.05,y+0),ctx.lineTo(x+252.05,y+83),ctx.fill(),ctx.stroke(),g=ctx.createLinearGradient(x+10.95,y+18.025018879999994,x+10.95,y+69.57498112),g.addColorStop(0,"rgba(255, 255, 255, 1)"),g.addColorStop(1,"rgba(0, 0, 0, 1)"),ctx.fillStyle=g,ctx.beginPath(),ctx.moveTo(x+26.1,y+83),ctx.lineTo(x+-1.45,y+83),ctx.lineTo(x+-1.45,y+0),ctx.lineTo(x+26.1,y+0),ctx.lineTo(x+26.1,y+83),ctx.fill(),ctx.stroke();var g=ctx.createLinearGradient(x+136.83750013440002,y+-1.1124902399999996,x+136.4624998656,y+84.11249024);g.addColorStop(.0901961,"rgba(0, 0, 0, 0)"),g.addColorStop(.960784,"rgba(0, 0, 0, 0.898039)"),ctx.fillStyle=g,ctx.beginPath(),ctx.moveTo(x+247.1,y+83),ctx.lineTo(x+26.1,y+83),ctx.lineTo(x+26.1,y+0),ctx.lineTo(x+247.1,y+0),ctx.lineTo(x+247.1,y+83),ctx.fill(),ctx.stroke(),ctx.restore()}function userClickToCanvas(e){var x=0,y=0,o=canvas;do x+=o.offsetLeft,y+=o.offsetTop;while(o=o.offsetParent);if(x=e.pageX-x,y=e.pageY-y,x>borderOffset&&x<canvas.width-borderOffset&&y>borderOffset&&y<canvas.height-borderOffset){var imagesData=context.getImageData(x,y,1,1),newColor=[imagesData.data[0],imagesData.data[1],imagesData.data[2]];scope.$apply(function(){scope.ngModel=newColor,updateValues(newColor)})}}function onCanvasOut(){canvas.onmousemove=null,canvas.onmouseout=null}function updateValues(newColor){scope.rgb=newColor,scope.hex=rgbToHex(newColor[0],newColor[1],newColor[2]),scope.swatchStyles=scope.swatchStyles||{"background-color":"#"+scope.hex}}function parseStringHexColor(hexColorInString){return[parseInt(hexColorInString.slice(0,2),16),parseInt(hexColorInString.slice(2,4),16),parseInt(hexColorInString.slice(4,6),16)]}var canvas=document.querySelector("#color-picker"),context=canvas.getContext("2d");scope.hex="000000";for(var rgbFields=document.querySelectorAll(".model-field input"),i=0;i<rgbFields.length;i++){var thisInput=rgbFields[i];thisInput.onfocus=function(e){document.addEventListener("keypress",onColorEnter)},thisInput.onblur=function(e){scope.$root.send("changeColor",scope.hex),document.removeEventListener("keypress",onColorEnter)}}var colorPickerSize={width:247,height:78},borderOffset=0,rgbToHex=function(r,g,b){return""+((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1)},hexToRgb=function(hex){var shorthandRegex=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;hex=hex.replace(shorthandRegex,function(m,r,g,b){return r+r+g+g+b+b});var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?[parseInt(result[1],16),parseInt(result[2],16),parseInt(result[3],16)]:null};drawPicker({x:colorPickerSize.width/2,y:colorPickerSize.height/2},"#00994a"),scope.$watch("ngModel",function(value){updateValues(value||[0,0,0])}),scope.ngModel.$render=function(){updateValues(scope.ngModel.$modelValue)},scope.onChangRGB=function(){scope.rgb=scope.ngModel,scope.hex=rgbToHex(Number(scope.ngModel[0]),Number(scope.ngModel[1]),Number(scope.ngModel[2]))},scope.onChangHex=function(){var newColor=hexToRgb(scope.hex);newColor&&(scope.ngModel=newColor,scope.rgb=newColor)},scope.$on("colorpicker:setSwatchColor",function(event,value){value instanceof Array&&(value=value.map(function(c){return(16>c?"0":"")+c.toString(16)}).join("")),scope.$applyAsync(function(){scope.swatchStyles["background-color"]="#"+value})}),scope.onSwatchClick=function(){var colorInString=scope.swatchStyles["background-color"].slice(1),colorRgbParts=parseStringHexColor(colorInString);scope.ngModel=colorRgbParts,updateValues(colorRgbParts),scope.$root.send("changeColor",scope.hex)},canvas.onmousedown=function(e){canvas.onmousemove=userClickToCanvas,canvas.onmouseout=onCanvasOut},canvas.onmouseup=function(e){canvas.onmousemove=null,userClickToCanvas(e),scope.$root.send("changeColor",scope.hex)}}}})}),define("directives/common/DaPitch",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.directives.DaPitch",[]).directive("daPitch",["$log","$location","lgApi","lgSiteApi","trackTargetIds","appConfig",function($log,$location,lgApi,lgSiteApi,trackTargetIds,appConfig){return{templateUrl:lgApi.getLocationUrl("views/da-pitch.html"),restrict:"E",scope:{errors:"=",userModel:"="},link:function(scope,element,attrs){function initScope(){resetErrorState(),scope.submitting=!1}function resetErrorState(){scope.errors=[]}function showDaPitchPopup(isShown){(scope.isShown=!!isShown)&&$("div.animated",element).addClass("bounceInDown")}scope.$on("ShowDaPitch_"+(attrs.id||"0"),function(){resetErrorState(),$log.debug("Da Pitch broadcast received."),showDaPitchPopup(!0)}),scope.gotoDaPage=function(){lgSiteApi.trafficTrackOnce(trackTargetIds.DESIGN_ASSIST_MODAL),location.href=appConfig.legacySiteUrl+"/custom/custom_logo_info_form.php"},scope.onCancelClick=function(){$log.debug("Go away."),showDaPitchPopup(!1)},initScope(),showDaPitchPopup(!1),$log.debug("attrs.id",attrs.id)}}}])}),define("directives/common/popupVideo",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.directives.PopupVideo",[]).directive("popupVideo",function(PopupModalService,$sce,lgApi){return{restrict:"E",scope:{videoId:"@"},link:function(scope,element,attrs){element.bind("click",function(){var videoSrc=$sce.trustAsResourceUrl("https://www.youtube.com/embed/"+scope.videoId+"?iv_load_policy=3&amp;autoplay=1");PopupModalService.show({templateUrl:lgApi.getLocationUrl("views/popup-video.html"),backdrop:{opacity:.3},controller:["$scope","$modal",function($scope,$modal){$scope.videoSrc=videoSrc,$scope.onClose=function(){$modal.hide()}}]})})}}})}),define("directives/common/UserRegistration",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.directives.UserRegistration",[]).directive("userRegistration",function($log,$q,$timeout,lgApi,lgSiteApi){return{templateUrl:lgApi.getLocationUrl("views/user-registration.html"),restrict:"E",scope:{errors:"=",userModel:"=",onSubmit:"&"},link:function(scope,element,attrs){function initScope(){resetErrorState(),scope.userModel=scope.userModel||{},scope.submitting=!1}function resetErrorState(){scope.errors=[]}function showUserRegistrationPopup(isShown){(scope.isShown=!!isShown)&&$("div.animated",element).addClass("bounceInDown")}scope.$on("ShowUserRegistration_"+(attrs.id||"0"),function(){resetErrorState(),showUserRegistrationPopup(!0)}),scope.onFormSubmit=function(){var promise;if(!scope.submitting)return scope.submitting=!0,(promise=scope.onSubmit())?void promise.then(function(){showUserRegistrationPopup(!1)})["finally"](function(){scope.submitting=!1}):void(scope.submitting=!1)},scope.onCancelClick=function(){$log.debug("Cancel from register."),showUserRegistrationPopup(!1)},scope.onFreeLogoClick=function(){jQuery("#free_download").attr("action",lgSiteApi.getApiUrl()+"account/free_download.php").submit()},initScope(),showUserRegistrationPopup(!1)}}})}),define("directives/common/RangeInput",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.directives.RangeInput",[]).directive("rangeInput",function($timeout,$document){return{scope:{ngModel:"=",onInit:"=",onSlide:"=",onSlideEnd:"="},restrict:"A",replace:!1,link:function(scope,element,attrs,ngModel){var defaults={polyfill:!1,rangeClass:"rangeslider",disabledClass:"rangeslider--disabled",fillClass:"rangeslider__fill",handleClass:"rangeslider__handle",startEvent:["mousedown","touchstart","pointerdown"],moveEvent:["mousemove","touchmove","pointermove"],endEvent:["mouseup","touchend","pointerup"]};scope.ops=defaults,scope.ops.onInit=attrs.onInit?scope.onInit:null,scope.ops.onSlide=attrs.onSlide?scope.onSlide:null,scope.ops.onSlideEnd=attrs.onSlideEnd?scope.onSlideEnd:null;var supportsRange=function(){var input=document.createElement("input");return input.setAttribute("type","range"),"text"!==input.type},delay=function(fn,wait){var args=Array.prototype.slice.call(arguments,2);return $timeout(function(){return fn.apply(null,args)},wait)},debounce=function(fn,debounceDuration){return debounceDuration=debounceDuration||100,function(){if(!fn.debouncing){var args=Array.prototype.slice.apply(arguments);fn.lastReturnVal=fn.apply(window,args),fn.debouncing=!0}return clearTimeout(fn.debounceTimeout),fn.debounceTimeout=setTimeout(function(){fn.debouncing=!1},debounceDuration),fn.lastReturnVal}},isHidden=function(element){return element&&(0!==element.offsetWidth||0!==element.offsetHeight)?!1:!0},getHiddenParentNodes=function(element){for(var parents=[],node=element.parentNode;isHidden(node);)parents.push(node),node=node.parentNode;return parents},getDimension=function(element,key){var hiddenParentNodes=getHiddenParentNodes(element),hiddenParentNodesLength=hiddenParentNodes.length,displayProperty=[],dimension=element[key];if(hiddenParentNodesLength){for(var i=0;hiddenParentNodesLength>i;i++)displayProperty[i]=hiddenParentNodes[i].style.display,hiddenParentNodes[i].style.display="block",hiddenParentNodes[i].style.height="0",hiddenParentNodes[i].style.overflow="hidden",hiddenParentNodes[i].style.visibility="hidden";dimension=element[key];for(var j=0;hiddenParentNodesLength>j;j++)hiddenParentNodes[j].style.display=displayProperty[j],hiddenParentNodes[j].style.height="",hiddenParentNodes[j].style.overflow="",hiddenParentNodes[j].style.visibility=""}return dimension};if(defaults.polyfill&&supportsRange())return!1;scope.id=Math.random().toString(36).replace(/[^a-z]+/g,""),scope.min=parseFloat(attrs.min||0),scope.max=parseFloat(attrs.max||100),scope.value=parseFloat(attrs.value||scope.min+(scope.max-scope.min)/2),scope.step=parseFloat(attrs.step||1),scope.$fill=angular.element('<div class="'+scope.ops.fillClass+'" id="fill_'+scope.id+'" />'),scope.$handle=angular.element('<div class="'+scope.ops.handleClass+'" id="handle_'+scope.id+'" />'),scope.$range=angular.element('<div class="'+scope.ops.rangeClass+'" id="'+scope.id+'" />'),element.after(scope.$range[0]),scope.$range.prepend(scope.$handle).prepend(scope.$fill),element.css({position:"absolute",width:"1px",height:"1px",overflow:"hidden",opacity:"0"}),scope.getPositionFromNode=function(node){for(var i=0;null!==node;)i+=node.offsetLeft,node=node.offsetParent;return i},scope.getRelativePosition=function(e){var rangeX=scope.$range[0].getBoundingClientRect().left;return(e.pageX||e.originalEvent.clientX||e.originalEvent.touches[0].clientX||e.currentPoint.x)-rangeX},scope.getPositionFromValue=function(value){var percentage,pos;return percentage=(value-scope.min)/(scope.max-scope.min),pos=percentage*scope.maxHandleX},scope.getValueFromPosition=function(pos){var percentage,value;return percentage=pos/(scope.maxHandleX||1),value=scope.step*Math.round(percentage*(scope.max-scope.min)/scope.step)+scope.min,Number(value.toFixed(2))},scope.setValue=function(value){value!==scope.value&&element.val(value).triggerHandler("change",{origin:"rangeslider"})},scope.cap=function(pos,min,max){return min>pos?min:pos>max?max:pos},scope.setPosition=function(pos){var value,left;value=scope.getValueFromPosition(scope.cap(pos,0,scope.maxHandleX))/scope.step*scope.step,left=scope.getPositionFromValue(value),scope.$fill[0].style.width=left+scope.grabX+"px",scope.$handle[0].style.left=left+"px",scope.setValue(value),scope.position=left,scope.value=value,scope.ops.onSlide&&"function"==typeof scope.ops.onSlide&&scope.ops.onSlide(left,value)},scope.update=function(){scope.handleWidth=getDimension(scope.$handle[0],"offsetWidth"),scope.rangeWidth=getDimension(scope.$range[0],"offsetWidth"),scope.maxHandleX=scope.rangeWidth-scope.handleWidth,scope.grabX=scope.handleWidth/2,scope.position=scope.getPositionFromValue(scope.value),element[0].disabled?scope.$range.addClass(scope.ops.disabledClass):scope.$range.removeClass(scope.ops.disabledClass),scope.setPosition(scope.position)},scope.init=function(){scope.ops.onInit&&"function"==typeof scope.ops.onInit&&scope.ops.onInit(),scope.update(),scope.$watch(function(){return element.attr("disabled")},function(newValue){newValue?scope.$range.addClass(scope.ops.disabledClass):scope.$range.removeClass(scope.ops.disabledClass)}),$timeout(function(){var val=element.val(),pos=scope.getPositionFromValue(val);scope.setPosition(pos)},0)},scope.handleMove=function(e){e.preventDefault();var posX=scope.getRelativePosition(e);scope.setPosition(posX-scope.grabX)},scope.handleEnd=function(e){e.preventDefault();for(var i in scope.ops.moveEvent)$document.off(scope.ops.moveEvent[i],scope.handleMove);for(var i in scope.ops.endEvent)$document.off(scope.ops.endEvent[i],scope.handleEnd);scope.ops.onSlideEnd&&"function"==typeof scope.ops.onSlideEnd&&scope.ops.onSlideEnd(scope.position,scope.value)},scope.handleDown=function(e){if(!element[0].disabled){e.preventDefault();for(var i in scope.ops.moveEvent)$document.on(scope.ops.moveEvent[i],scope.handleMove);for(var i in scope.ops.endEvent)$document.on(scope.ops.endEvent[i],scope.handleEnd);if(!((" "+e.target.className+" ").replace(/[\n\t]/g," ").indexOf(scope.ops.handleClass)>-1)){var posX=scope.getRelativePosition(e),rangeX=scope.$range[0].getBoundingClientRect().left,handleX=scope.getPositionFromNode(scope.$handle[0])-rangeX;scope.setPosition(posX-scope.grabX),posX>=handleX&&posX<handleX+scope.handleWidth&&(scope.grabX=posX-handleX)}}},window.addEventListener("resize",debounce(function(){delay(function(){scope.update()},300)},20));for(var i in scope.ops.startEvent)scope.$range.on(scope.ops.startEvent[i],scope.handleDown);element.on("change",function(e,data){if(!data||"rangeslider"!==data.origin){var value=e.target.value,pos=scope.getPositionFromValue(value);scope.setPosition(pos)}}),scope.init(),scope.$onRootScope("updateRangeSlider",function(e,id,val){if(id===element.attr("id")){var pos=scope.getPositionFromValue(val);scope.setPosition(pos)}})}}})}),function(){function e(){var e={};return e.FRAMERATE=30,e.MAX_VIRTUAL_PIXELS=3e4,e.init=function(t){var n=0;e.UniqueId=function(){return n++,"canvg"+n},e.Definitions={},e.Styles={},e.Animations=[],e.Images=[],e.ctx=t,e.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(e,t){this.viewPorts.push({width:e,height:t})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(e){return null!=e&&"number"==typeof e?e:"x"==e?this.width():"y"==e?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},e.init(),e.ImagesLoaded=function(){for(var t=0;t<e.Images.length;t++)if(!e.Images[t].loaded)return!1;return!0},e.trim=function(e){return e.replace(/^\s+|\s+$/g,"")},e.compressSpaces=function(e){return e.replace(/[\s\r\t\n]+/gm," ")},e.ajax=function(e){var t;return t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),t?(t.open("GET",e,!1),t.send(null),t.responseText):null},e.parseXml=function(e){if(window.DOMParser){var t=new DOMParser;return t.parseFromString(e,"text/xml")}e=e.replace(/<!DOCTYPE svg[^>]*>/,"");var n=new ActiveXObject("Microsoft.XMLDOM");return n.async="false",n.loadXML(e),n},e.Property=function(e,t){this.name=e,this.value=t},e.Property.prototype.getValue=function(){return this.value},e.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},e.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var e=parseFloat(this.value);return(this.value+"").match(/%$/)&&(e/=100),e},e.Property.prototype.valueOrDefault=function(e){return this.hasValue()?this.value:e},e.Property.prototype.numValueOrDefault=function(e){return this.hasValue()?this.numValue():e},e.Property.prototype.addOpacity=function(t){
var n=this.value;if(null!=t&&""!=t&&"string"==typeof this.value){var r=new RGBColor(this.value);r.ok&&(n="rgba("+r.r+", "+r.g+", "+r.b+", "+t+")")}return new e.Property(this.name,n)},e.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);return t&&(t=t[1]),t||(t=this.value),e.Definitions[t]},e.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},e.Property.prototype.getFillStyleDefinition=function(t,n){var r=this.getDefinition();if(null!=r&&r.createGradient)return r.createGradient(e.ctx,t,n);if(null!=r&&r.createPattern){if(r.getHrefAttribute().hasValue()){var i=r.attribute("patternTransform");r=r.getHrefAttribute().getDefinition(),i.hasValue()&&(r.attribute("patternTransform",!0).value=i.value)}return r.createPattern(e.ctx,t)}return null},e.Property.prototype.getDPI=function(e){return 96},e.Property.prototype.getEM=function(t){var n=12,r=new e.Property("fontSize",e.Font.Parse(e.ctx.font).fontSize);return r.hasValue()&&(n=r.toPixels(t)),n},e.Property.prototype.getUnits=function(){var e=this.value+"";return e.replace(/[0-9\.\-]/g,"")},e.Property.prototype.toPixels=function(t,n){if(!this.hasValue())return 0;var r=this.value+"";if(r.match(/em$/))return this.numValue()*this.getEM(t);if(r.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(r.match(/px$/))return this.numValue();if(r.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(r.match(/pc$/))return 15*this.numValue();if(r.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(r.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(r.match(/in$/))return this.numValue()*this.getDPI(t);if(r.match(/%$/))return this.numValue()*e.ViewPort.ComputeSize(t);var i=this.numValue();return n&&1>i?i*e.ViewPort.ComputeSize(t):i},e.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/s$/)?1e3*this.numValue():e.match(/ms$/)?this.numValue():this.numValue()},e.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/deg$/)?this.numValue()*(Math.PI/180):e.match(/grad$/)?this.numValue()*(Math.PI/200):e.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)},e.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(t,n,r,i,s,o){var u=null!=o?this.Parse(o):this.CreateFont("","","","","",e.ctx.font);return{fontFamily:s||u.fontFamily,fontSize:i||u.fontSize,fontStyle:t||u.fontStyle,fontWeight:r||u.fontWeight,fontVariant:n||u.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var t=this;this.Parse=function(n){for(var r={},i=e.trim(e.compressSpaces(n||"")).split(" "),s={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},o="",u=0;u<i.length;u++)s.fontStyle||-1==t.Styles.indexOf(i[u])?s.fontVariant||-1==t.Variants.indexOf(i[u])?s.fontWeight||-1==t.Weights.indexOf(i[u])?s.fontSize?"inherit"!=i[u]&&(o+=i[u]):("inherit"!=i[u]&&(r.fontSize=i[u].split("/")[0]),s.fontStyle=s.fontVariant=s.fontWeight=s.fontSize=!0):("inherit"!=i[u]&&(r.fontWeight=i[u]),s.fontStyle=s.fontVariant=s.fontWeight=!0):("inherit"!=i[u]&&(r.fontVariant=i[u]),s.fontStyle=s.fontVariant=!0):("inherit"!=i[u]&&(r.fontStyle=i[u]),s.fontStyle=!0);return""!=o&&(r.fontFamily=o),r}},e.ToNumberArray=function(t){for(var n=e.trim(e.compressSpaces((t||"").replace(/,/g," "))).split(" "),r=0;r<n.length;r++)n[r]=parseFloat(n[r]);return n},e.Point=function(e,t){this.x=e,this.y=t},e.Point.prototype.angleTo=function(e){return Math.atan2(e.y-this.y,e.x-this.x)},e.Point.prototype.applyTransform=function(e){var t=this.x*e[0]+this.y*e[2]+e[4],n=this.x*e[1]+this.y*e[3]+e[5];this.x=t,this.y=n},e.CreatePoint=function(t){var n=e.ToNumberArray(t);return new e.Point(n[0],n[1])},e.CreatePath=function(t){for(var n=e.ToNumberArray(t),r=[],i=0;i<n.length;i+=2)r.push(new e.Point(n[i],n[i+1]));return r},e.BoundingBox=function(e,t,n,r){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(e,t){null!=e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),null!=t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},this.addX=function(e){this.addPoint(e,null)},this.addY=function(e){this.addPoint(null,e)},this.addBoundingBox=function(e){this.addPoint(e.x1,e.y1),this.addPoint(e.x2,e.y2)},this.addQuadraticCurve=function(e,t,n,r,i,s){var o=e+2/3*(n-e),u=t+2/3*(r-t),a=o+1/3*(i-e),f=u+1/3*(s-t);this.addBezierCurve(e,t,o,a,u,f,i,s)},this.addBezierCurve=function(e,t,n,r,s,o,u,a){var f=[e,t],l=[n,r],c=[s,o],h=[u,a];for(this.addPoint(f[0],f[1]),this.addPoint(h[0],h[1]),i=0;i<=1;i++){var p=function(e){return Math.pow(1-e,3)*f[i]+3*Math.pow(1-e,2)*e*l[i]+3*(1-e)*Math.pow(e,2)*c[i]+Math.pow(e,3)*h[i]},d=6*f[i]-12*l[i]+6*c[i],v=-3*f[i]+9*l[i]-9*c[i]+3*h[i],m=3*l[i]-3*f[i];if(0!=v){var y=Math.pow(d,2)-4*m*v;if(!(0>y)){var b=(-d+Math.sqrt(y))/(2*v);b>0&&1>b&&(0==i&&this.addX(p(b)),1==i&&this.addY(p(b)));var w=(-d-Math.sqrt(y))/(2*v);w>0&&1>w&&(0==i&&this.addX(p(w)),1==i&&this.addY(p(w)))}}else{if(0==d)continue;var g=-m/d;g>0&&1>g&&(0==i&&this.addX(p(g)),1==i&&this.addY(p(g)))}}},this.isPointInBox=function(e,t){return this.x1<=e&&e<=this.x2&&this.y1<=t&&t<=this.y2},this.addPoint(e,t),this.addPoint(n,r)},e.Transform=function(t){var n=this;this.Type={},this.Type.translate=function(t){this.p=e.CreatePoint(t),this.apply=function(e){e.translate(this.p.x||0,this.p.y||0)},this.unapply=function(e){e.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(e){e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(t){var n=e.ToNumberArray(t);this.angle=new e.Property("angle",n[0]),this.cx=n[1]||0,this.cy=n[2]||0,this.apply=function(e){e.translate(this.cx,this.cy),e.rotate(this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.unapply=function(e){e.translate(this.cx,this.cy),e.rotate(-1*this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.applyToPoint=function(e){var t=this.angle.toRadians();e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),e.applyTransform([Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0]),e.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(t){this.p=e.CreatePoint(t),this.apply=function(e){e.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(e){e.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(e){e.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(t){this.m=e.ToNumberArray(t),this.apply=function(e){e.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.applyToPoint=function(e){e.applyTransform(this.m)}},this.Type.SkewBase=function(t){this.base=n.Type.matrix,this.base(t),this.angle=new e.Property("angle",t)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(e){this.base=n.Type.SkewBase,this.base(e),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(e){this.base=n.Type.SkewBase,this.base(e),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].apply(e)},this.unapply=function(e){for(var t=this.transforms.length-1;t>=0;t--)this.transforms[t].unapply(e)},this.applyToPoint=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].applyToPoint(e)};for(var r=e.trim(e.compressSpaces(t)).replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),i=0;i<r.length;i++){var s=e.trim(r[i].split("(")[0]),o=r[i].split("(")[1].replace(")",""),u=new this.Type[s](o);u.type=s,this.transforms.push(u)}},e.AspectRatio=function(t,n,r,i,s,o,u,a,f,l){n=e.compressSpaces(n),n=n.replace(/^defer\s/,"");var c=n.split(" ")[0]||"xMidYMid",h=n.split(" ")[1]||"meet",p=r/i,d=s/o,v=Math.min(p,d),m=Math.max(p,d);"meet"==h&&(i*=v,o*=v),"slice"==h&&(i*=m,o*=m),f=new e.Property("refX",f),l=new e.Property("refY",l),f.hasValue()&&l.hasValue()?t.translate(-v*f.toPixels("x"),-v*l.toPixels("y")):(c.match(/^xMid/)&&("meet"==h&&v==d||"slice"==h&&m==d)&&t.translate(r/2-i/2,0),c.match(/YMid$/)&&("meet"==h&&v==p||"slice"==h&&m==p)&&t.translate(0,s/2-o/2),c.match(/^xMax/)&&("meet"==h&&v==d||"slice"==h&&m==d)&&t.translate(r-i,0),c.match(/YMax$/)&&("meet"==h&&v==p||"slice"==h&&m==p)&&t.translate(0,s-o)),"none"==c?t.scale(p,d):"meet"==h?t.scale(v,v):"slice"==h&&t.scale(m,m),t.translate(null==u?0:-u,null==a?0:-a)},e.Element={},e.EmptyProperty=new e.Property("EMPTY",""),e.Element.ElementBase=function(t){if(this.attributes={},this.styles={},this.children=[],this.attribute=function(t,n){var r=this.attributes[t];return null!=r?r:(1==n&&(r=new e.Property(t,""),this.attributes[t]=r),r||e.EmptyProperty)},this.getHrefAttribute=function(){for(var t in this.attributes)if(t.match(/:href$/))return this.attributes[t];return e.EmptyProperty},this.style=function(t,n){var r=this.styles[t];if(null!=r)return r;var i=this.attribute(t);if(null!=i&&i.hasValue())return this.styles[t]=i,i;var s=this.parent;if(null!=s){var o=s.style(t);if(null!=o&&o.hasValue())return o}return 1==n&&(r=new e.Property(t,""),this.styles[t]=r),r||e.EmptyProperty},this.render=function(e){if("none"!=this.style("display").value&&"hidden"!=this.attribute("visibility").value){if(e.save(),this.attribute("mask").hasValue()){var t=this.attribute("mask").getDefinition();null!=t&&t.apply(e,this)}else if(this.style("filter").hasValue()){var n=this.style("filter").getDefinition();null!=n&&n.apply(e,this)}else this.setContext(e),this.renderChildren(e),this.clearContext(e);e.restore()}},this.setContext=function(e){},this.clearContext=function(e){},this.renderChildren=function(e){for(var t=0;t<this.children.length;t++)this.children[t].render(e)},this.addChild=function(t,n){var r=t;n&&(r=e.CreateElement(t)),r.parent=this,this.children.push(r)},null!=t&&1==t.nodeType){for(var n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1==r.nodeType&&this.addChild(r,!0),this.captureTextNodes&&3==r.nodeType){var i=r.nodeValue||r.text||"";""!=e.trim(e.compressSpaces(i))&&this.addChild(new e.Element.tspan(r),!1)}}for(var n=0;n<t.attributes.length;n++){var s=t.attributes[n];this.attributes[s.nodeName]=new e.Property(s.nodeName,s.nodeValue)}var o=e.Styles[t.nodeName];if(null!=o)for(var u in o)this.styles[u]=o[u];if(this.attribute("class").hasValue())for(var a=e.compressSpaces(this.attribute("class").value).split(" "),f=0;f<a.length;f++){if(o=e.Styles["."+a[f]],null!=o)for(var u in o)this.styles[u]=o[u];if(o=e.Styles[t.nodeName+"."+a[f]],null!=o)for(var u in o)this.styles[u]=o[u]}if(this.attribute("id").hasValue()){var o=e.Styles["#"+this.attribute("id").value];if(null!=o)for(var u in o)this.styles[u]=o[u]}if(this.attribute("style").hasValue())for(var o=this.attribute("style").value.split(";"),n=0;n<o.length;n++)if(""!=e.trim(o[n])){var l=o[n].split(":"),u=e.trim(l[0]),c=e.trim(l[1]);this.styles[u]=new e.Property(u,c)}this.attribute("id").hasValue()&&null==e.Definitions[this.attribute("id").value]&&(e.Definitions[this.attribute("id").value]=this)}},e.Element.RenderedElementBase=function(t){this.base=e.Element.ElementBase,this.base(t),this.setContext=function(t){if(this.style("fill").isUrlDefinition()){var n=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=n&&(t.fillStyle=n)}else if(this.style("fill").hasValue()){var r=this.style("fill");"currentColor"==r.value&&(r.value=this.style("color").value),t.fillStyle="none"==r.value?"rgba(0,0,0,0)":r.value}if(this.style("fill-opacity").hasValue()){var r=new e.Property("fill",t.fillStyle);r=r.addOpacity(this.style("fill-opacity").value),t.fillStyle=r.value}if(this.style("stroke").isUrlDefinition()){var n=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=n&&(t.strokeStyle=n)}else if(this.style("stroke").hasValue()){var i=this.style("stroke");"currentColor"==i.value&&(i.value=this.style("color").value),t.strokeStyle="none"==i.value?"rgba(0,0,0,0)":i.value}if(this.style("stroke-opacity").hasValue()){var i=new e.Property("stroke",t.strokeStyle);i=i.addOpacity(this.style("stroke-opacity").value),t.strokeStyle=i.value}if(this.style("stroke-width").hasValue()){var s=this.style("stroke-width").toPixels();t.lineWidth=0==s?.001:s}if(this.style("stroke-linecap").hasValue()&&(t.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(t.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(t.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()){var o=e.ToNumberArray(this.style("stroke-dasharray").value);"undefined"!=typeof t.setLineDash?t.setLineDash(o):"undefined"!=typeof t.webkitLineDash?t.webkitLineDash=o:"undefined"!=typeof t.mozDash&&(t.mozDash=o);var u=this.style("stroke-dashoffset").numValueOrDefault(1);"undefined"!=typeof t.lineDashOffset?t.lineDashOffset=u:"undefined"!=typeof t.webkitLineDashOffset?t.webkitLineDashOffset=u:"undefined"!=typeof t.mozDashOffset&&(t.mozDashOffset=u)}if("undefined"!=typeof t.font&&(t.font=e.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.attribute("transform").hasValue()){var a=new e.Transform(this.attribute("transform").value);a.apply(t)}if(this.style("clip-path").hasValue()){var f=this.style("clip-path").getDefinition();null!=f&&f.apply(t)}this.style("opacity").hasValue()&&(t.globalAlpha=this.style("opacity").numValue())}},e.Element.RenderedElementBase.prototype=new e.Element.ElementBase,e.Element.PathElementBase=function(t){this.base=e.Element.RenderedElementBase,this.base(t),this.path=function(t){return null!=t&&t.beginPath(),new e.BoundingBox},this.renderChildren=function(t){this.path(t),e.Mouse.checkPath(this,t),""!=t.fillStyle&&(this.attribute("fill-rule").hasValue()?t.fill(this.attribute("fill-rule").value):t.fill()),""!=t.strokeStyle&&t.stroke();var n=this.getMarkers();if(null!=n){if(this.style("marker-start").isUrlDefinition()){var r=this.style("marker-start").getDefinition();r.render(t,n[0][0],n[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var r=this.style("marker-mid").getDefinition(),i=1;i<n.length-1;i++)r.render(t,n[i][0],n[i][1]);if(this.style("marker-end").isUrlDefinition()){var r=this.style("marker-end").getDefinition();r.render(t,n[n.length-1][0],n[n.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},e.Element.PathElementBase.prototype=new e.Element.RenderedElementBase,e.Element.svg=function(t){this.base=e.Element.RenderedElementBase,this.base(t),this.baseClearContext=this.clearContext,this.clearContext=function(t){this.baseClearContext(t),e.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4,this.baseSetContext(t),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var n=e.ViewPort.width(),r=e.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){n=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");var i=0,s=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(i=-this.attribute("refX").toPixels("x"),s=-this.attribute("refY").toPixels("y")),t.beginPath(),t.moveTo(i,s),t.lineTo(n,s),t.lineTo(n,r),t.lineTo(i,r),t.closePath(),t.clip()}if(e.ViewPort.SetCurrent(n,r),this.attribute("viewBox").hasValue()){var o=e.ToNumberArray(this.attribute("viewBox").value),u=o[0],a=o[1];n=o[2],r=o[3],e.AspectRatio(t,this.attribute("preserveAspectRatio").value,e.ViewPort.width(),n,e.ViewPort.height(),r,u,a,this.attribute("refX").value,this.attribute("refY").value),e.ViewPort.RemoveCurrent(),e.ViewPort.SetCurrent(o[2],o[3])}}},e.Element.svg.prototype=new e.Element.RenderedElementBase,e.Element.rect=function(t){this.base=e.Element.PathElementBase,this.base(t),this.path=function(t){var n=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y"),o=this.attribute("rx").toPixels("x"),u=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(u=o),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(o=u),o=Math.min(o,i/2),u=Math.min(u,s/2),null!=t&&(t.beginPath(),t.moveTo(n+o,r),t.lineTo(n+i-o,r),t.quadraticCurveTo(n+i,r,n+i,r+u),t.lineTo(n+i,r+s-u),t.quadraticCurveTo(n+i,r+s,n+i-o,r+s),t.lineTo(n+o,r+s),t.quadraticCurveTo(n,r+s,n,r+s-u),t.lineTo(n,r+u),t.quadraticCurveTo(n,r,n+o,r),t.closePath()),new e.BoundingBox(n,r,n+i,r+s)}},e.Element.rect.prototype=new e.Element.PathElementBase,e.Element.circle=function(t){this.base=e.Element.PathElementBase,this.base(t),this.path=function(t){var n=this.attribute("cx").toPixels("x"),r=this.attribute("cy").toPixels("y"),i=this.attribute("r").toPixels();return null!=t&&(t.beginPath(),t.arc(n,r,i,0,2*Math.PI,!0),t.closePath()),new e.BoundingBox(n-i,r-i,n+i,r+i)}},e.Element.circle.prototype=new e.Element.PathElementBase,e.Element.ellipse=function(t){this.base=e.Element.PathElementBase,this.base(t),this.path=function(t){var n=4*((Math.sqrt(2)-1)/3),r=this.attribute("rx").toPixels("x"),i=this.attribute("ry").toPixels("y"),s=this.attribute("cx").toPixels("x"),o=this.attribute("cy").toPixels("y");return null!=t&&(t.beginPath(),t.moveTo(s,o-i),t.bezierCurveTo(s+n*r,o-i,s+r,o-n*i,s+r,o),t.bezierCurveTo(s+r,o+n*i,s+n*r,o+i,s,o+i),t.bezierCurveTo(s-n*r,o+i,s-r,o+n*i,s-r,o),t.bezierCurveTo(s-r,o-n*i,s-n*r,o-i,s,o-i),t.closePath()),new e.BoundingBox(s-r,o-i,s+r,o+i)}},e.Element.ellipse.prototype=new e.Element.PathElementBase,e.Element.line=function(t){this.base=e.Element.PathElementBase,this.base(t),this.getPoints=function(){return[new e.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new e.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(t){var n=this.getPoints();return null!=t&&(t.beginPath(),t.moveTo(n[0].x,n[0].y),t.lineTo(n[1].x,n[1].y)),new e.BoundingBox(n[0].x,n[0].y,n[1].x,n[1].y)},this.getMarkers=function(){var e=this.getPoints(),t=e[0].angleTo(e[1]);return[[e[0],t],[e[1],t]]}},e.Element.line.prototype=new e.Element.PathElementBase,e.Element.polyline=function(t){this.base=e.Element.PathElementBase,this.base(t),this.points=e.CreatePath(this.attribute("points").value),this.path=function(t){var n=new e.BoundingBox(this.points[0].x,this.points[0].y);null!=t&&(t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y));for(var r=1;r<this.points.length;r++)n.addPoint(this.points[r].x,this.points[r].y),null!=t&&t.lineTo(this.points[r].x,this.points[r].y);return n},this.getMarkers=function(){for(var e=[],t=0;t<this.points.length-1;t++)e.push([this.points[t],this.points[t].angleTo(this.points[t+1])]);return e.push([this.points[this.points.length-1],e[e.length-1][1]]),e}},e.Element.polyline.prototype=new e.Element.PathElementBase,e.Element.polygon=function(t){this.base=e.Element.polyline,this.base(t),this.basePath=this.path,this.path=function(e){var t=this.basePath(e);return null!=e&&(e.lineTo(this.points[0].x,this.points[0].y),e.closePath()),t}},e.Element.polygon.prototype=new e.Element.polyline,e.Element.path=function(t){this.base=e.Element.PathElementBase,this.base(t);var n=this.attribute("d").value;n=n.replace(/,/gm," "),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2"),n=n.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([0-9])([+\-])/gm,"$1 $2"),n=n.replace(/(\.[0-9]*)(\.)/gm,"$1 $2"),n=n.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),n=e.compressSpaces(n),n=e.trim(n),this.PathParser=new function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new e.Point(0,0),this.control=new e.Point(0,0),this.current=new e.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new e.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},this.getAsControlPoint=function(){var e=this.getPoint();return this.control=e,e},this.getAsCurrentPoint=function(){var e=this.getPoint();return this.current=e,e},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase())return this.current;var t=new e.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return t},this.makeAbsolute=function(e){return this.isRelativeCommand()&&(e.x+=this.current.x,e.y+=this.current.y),e},this.addMarker=function(e,t,n){null!=n&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(n)),this.addMarkerAngle(e,null==t?null:t.angleTo(e))},this.addMarkerAngle=function(e,t){this.points.push(e),this.angles.push(t)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var e=0;e<this.angles.length;e++)if(null==this.angles[e])for(var t=e+1;t<this.angles.length;t++)if(null!=this.angles[t]){this.angles[e]=this.angles[t];break}return this.angles}}(n),this.path=function(t){var n=this.PathParser;n.reset();var r=new e.BoundingBox;for(null!=t&&t.beginPath();!n.isEnd();)switch(n.nextCommand(),n.command){case"M":case"m":var i=n.getAsCurrentPoint();for(n.addMarker(i),r.addPoint(i.x,i.y),null!=t&&t.moveTo(i.x,i.y),n.start=n.current;!n.isCommandOrEnd();){var i=n.getAsCurrentPoint();n.addMarker(i,n.start),r.addPoint(i.x,i.y),null!=t&&t.lineTo(i.x,i.y)}break;case"L":case"l":for(;!n.isCommandOrEnd();){var s=n.current,i=n.getAsCurrentPoint();n.addMarker(i,s),r.addPoint(i.x,i.y),null!=t&&t.lineTo(i.x,i.y)}break;case"H":case"h":for(;!n.isCommandOrEnd();){var o=new e.Point((n.isRelativeCommand()?n.current.x:0)+n.getScalar(),n.current.y);n.addMarker(o,n.current),n.current=o,r.addPoint(n.current.x,n.current.y),null!=t&&t.lineTo(n.current.x,n.current.y)}break;case"V":case"v":for(;!n.isCommandOrEnd();){var o=new e.Point(n.current.x,(n.isRelativeCommand()?n.current.y:0)+n.getScalar());n.addMarker(o,n.current),n.current=o,r.addPoint(n.current.x,n.current.y),null!=t&&t.lineTo(n.current.x,n.current.y)}break;case"C":case"c":for(;!n.isCommandOrEnd();){var u=n.current,a=n.getPoint(),f=n.getAsControlPoint(),l=n.getAsCurrentPoint();n.addMarker(l,f,a),r.addBezierCurve(u.x,u.y,a.x,a.y,f.x,f.y,l.x,l.y),null!=t&&t.bezierCurveTo(a.x,a.y,f.x,f.y,l.x,l.y)}break;case"S":case"s":for(;!n.isCommandOrEnd();){var u=n.current,a=n.getReflectedControlPoint(),f=n.getAsControlPoint(),l=n.getAsCurrentPoint();n.addMarker(l,f,a),r.addBezierCurve(u.x,u.y,a.x,a.y,f.x,f.y,l.x,l.y),null!=t&&t.bezierCurveTo(a.x,a.y,f.x,f.y,l.x,l.y)}break;case"Q":case"q":for(;!n.isCommandOrEnd();){var u=n.current,f=n.getAsControlPoint(),l=n.getAsCurrentPoint();n.addMarker(l,f,f),r.addQuadraticCurve(u.x,u.y,f.x,f.y,l.x,l.y),null!=t&&t.quadraticCurveTo(f.x,f.y,l.x,l.y)}break;case"T":case"t":for(;!n.isCommandOrEnd();){var u=n.current,f=n.getReflectedControlPoint();n.control=f;var l=n.getAsCurrentPoint();n.addMarker(l,f,f),r.addQuadraticCurve(u.x,u.y,f.x,f.y,l.x,l.y),null!=t&&t.quadraticCurveTo(f.x,f.y,l.x,l.y)}break;case"A":case"a":for(;!n.isCommandOrEnd();){var u=n.current,c=n.getScalar(),h=n.getScalar(),p=n.getScalar()*(Math.PI/180),d=n.getScalar(),v=n.getScalar(),l=n.getAsCurrentPoint(),m=new e.Point(Math.cos(p)*(u.x-l.x)/2+Math.sin(p)*(u.y-l.y)/2,-Math.sin(p)*(u.x-l.x)/2+Math.cos(p)*(u.y-l.y)/2),g=Math.pow(m.x,2)/Math.pow(c,2)+Math.pow(m.y,2)/Math.pow(h,2);g>1&&(c*=Math.sqrt(g),h*=Math.sqrt(g));var y=(d==v?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(h,2)-Math.pow(c,2)*Math.pow(m.y,2)-Math.pow(h,2)*Math.pow(m.x,2))/(Math.pow(c,2)*Math.pow(m.y,2)+Math.pow(h,2)*Math.pow(m.x,2)));isNaN(y)&&(y=0);var b=new e.Point(y*c*m.y/h,y*-h*m.x/c),w=new e.Point((u.x+l.x)/2+Math.cos(p)*b.x-Math.sin(p)*b.y,(u.y+l.y)/2+Math.sin(p)*b.x+Math.cos(p)*b.y),E=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))},S=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(E(e)*E(t))},x=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(S(e,t))},T=x([1,0],[(m.x-b.x)/c,(m.y-b.y)/h]),N=[(m.x-b.x)/c,(m.y-b.y)/h],C=[(-m.x-b.x)/c,(-m.y-b.y)/h],k=x(N,C);S(N,C)<=-1&&(k=Math.PI),S(N,C)>=1&&(k=0);var L=1-v?1:-1,A=T+L*(k/2),O=new e.Point(w.x+c*Math.cos(A),w.y+h*Math.sin(A));if(n.addMarkerAngle(O,A-L*Math.PI/2),n.addMarkerAngle(l,A-L*Math.PI),r.addPoint(l.x,l.y),null!=t){var S=c>h?c:h,M=c>h?1:c/h,_=c>h?h/c:1;t.translate(w.x,w.y),t.rotate(p),t.scale(M,_),t.arc(0,0,S,T,T+k,1-v),t.scale(1/M,1/_),t.rotate(-p),t.translate(-w.x,-w.y)}}break;case"Z":case"z":null!=t&&t.closePath(),n.current=n.start}return r},this.getMarkers=function(){for(var e=this.PathParser.getMarkerPoints(),t=this.PathParser.getMarkerAngles(),n=[],r=0;r<e.length;r++)n.push([e[r],t[r]]);return n}},e.Element.path.prototype=new e.Element.PathElementBase,e.Element.pattern=function(t){this.base=e.Element.ElementBase,this.base(t),this.createPattern=function(t,n){var r=this.attribute("width").toPixels("x",!0),i=this.attribute("height").toPixels("y",!0),s=new e.Element.svg;s.attributes.viewBox=new e.Property("viewBox",this.attribute("viewBox").value),s.attributes.width=new e.Property("width",r+"px"),s.attributes.height=new e.Property("height",i+"px"),s.attributes.transform=new e.Property("transform",this.attribute("patternTransform").value),s.children=this.children;var o=document.createElement("canvas");o.width=r,o.height=i;var u=o.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&u.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var a=-1;1>=a;a++)for(var f=-1;1>=f;f++)u.save(),u.translate(a*o.width,f*o.height),s.render(u),u.restore();var l=t.createPattern(o,"repeat");return l}},e.Element.pattern.prototype=new e.Element.ElementBase,e.Element.marker=function(t){this.base=e.Element.ElementBase,this.base(t),this.baseRender=this.render,this.render=function(t,n,r){t.translate(n.x,n.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(r),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(t.lineWidth,t.lineWidth),t.save();var i=new e.Element.svg;i.attributes.viewBox=new e.Property("viewBox",this.attribute("viewBox").value),i.attributes.refX=new e.Property("refX",this.attribute("refX").value),i.attributes.refY=new e.Property("refY",this.attribute("refY").value),i.attributes.width=new e.Property("width",this.attribute("markerWidth").value),i.attributes.height=new e.Property("height",this.attribute("markerHeight").value),i.attributes.fill=new e.Property("fill",this.attribute("fill").valueOrDefault("black")),i.attributes.stroke=new e.Property("stroke",this.attribute("stroke").valueOrDefault("none")),i.children=this.children,i.render(t),t.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(-r),t.translate(-n.x,-n.y)}},e.Element.marker.prototype=new e.Element.ElementBase,e.Element.defs=function(t){this.base=e.Element.ElementBase,this.base(t),this.render=function(e){}},e.Element.defs.prototype=new e.Element.ElementBase,e.Element.GradientBase=function(t){this.base=e.Element.ElementBase,this.base(t),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[];for(var n=0;n<this.children.length;n++){var r=this.children[n];"stop"==r.type&&this.stops.push(r)}this.getGradient=function(){},this.createGradient=function(t,n,r){var i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition());var s=function(t){if(r.hasValue()){var n=new e.Property("color",t);return n.addOpacity(r.value).value}return t},o=this.getGradient(t,n);if(null==o)return s(i.stops[i.stops.length-1].color);for(var u=0;u<i.stops.length;u++)o.addColorStop(i.stops[u].offset,s(i.stops[u].color));if(this.attribute("gradientTransform").hasValue()){var a=e.ViewPort.viewPorts[0],f=new e.Element.rect;f.attributes.x=new e.Property("x",-e.MAX_VIRTUAL_PIXELS/3),f.attributes.y=new e.Property("y",-e.MAX_VIRTUAL_PIXELS/3),f.attributes.width=new e.Property("width",e.MAX_VIRTUAL_PIXELS),f.attributes.height=new e.Property("height",e.MAX_VIRTUAL_PIXELS);var l=new e.Element.g;l.attributes.transform=new e.Property("transform",this.attribute("gradientTransform").value),l.children=[f];var c=new e.Element.svg;c.attributes.x=new e.Property("x",0),c.attributes.y=new e.Property("y",0),c.attributes.width=new e.Property("width",a.width),c.attributes.height=new e.Property("height",a.height),c.children=[l];var h=document.createElement("canvas");h.width=a.width,h.height=a.height;var p=h.getContext("2d");return p.fillStyle=o,c.render(p),p.createPattern(h,"no-repeat")}return o}},e.Element.GradientBase.prototype=new e.Element.ElementBase,e.Element.linearGradient=function(t){this.base=e.Element.GradientBase,this.base(t),this.getGradient=function(e,t){var n=t.getBoundingBox();this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var r="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),i="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),s="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),o="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return r==s&&i==o?null:e.createLinearGradient(r,i,s,o)}},e.Element.linearGradient.prototype=new e.Element.GradientBase,e.Element.radialGradient=function(t){this.base=e.Element.GradientBase,this.base(t),this.getGradient=function(e,t){var n=t.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var r="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),i="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),s=r,o=i;
this.attribute("fx").hasValue()&&(s="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(o="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var u="objectBoundingBox"==this.gradientUnits?(n.width()+n.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return e.createRadialGradient(s,o,0,r,i,u)}},e.Element.radialGradient.prototype=new e.Element.GradientBase,e.Element.stop=function(t){this.base=e.Element.ElementBase,this.base(t),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var n=this.style("stop-color");this.style("stop-opacity").hasValue()&&(n=n.addOpacity(this.style("stop-opacity").value)),this.color=n.value},e.Element.stop.prototype=new e.Element.ElementBase,e.Element.AnimateBase=function(t){this.base=e.Element.ElementBase,this.base(t),e.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var e=this.attribute("attributeType").value,t=this.attribute("attributeName").value;return"CSS"==e?this.parent.style(t,!0):this.parent.attribute(t,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(e){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"!=this.attribute("repeatCount").value&&"indefinite"!=this.attribute("repeatDur").value)return"remove"!=this.attribute("fill").valueOrDefault("remove")||this.removed?!1:(this.removed=!0,this.getProperty().value=this.initialValue,!0);this.duration=0}this.duration=this.duration+e;var t=!1;if(this.begin<this.duration){var n=this.calcValue();if(this.attribute("type").hasValue()){var r=this.attribute("type").value;n=r+"("+n+")"}this.getProperty().value=n,t=!0}return t},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var n=t.progress*(this.values.value.length-1),r=Math.floor(n),i=Math.ceil(n);t.from=new e.Property("from",parseFloat(this.values.value[r])),t.to=new e.Property("to",parseFloat(this.values.value[i])),t.progress=(n-r)/(i-r)}else t.from=this.from,t.to=this.to;return t}},e.Element.AnimateBase.prototype=new e.Element.ElementBase,e.Element.animate=function(t){this.base=e.Element.AnimateBase,this.base(t),this.calcValue=function(){var e=this.progress(),t=e.from.numValue()+(e.to.numValue()-e.from.numValue())*e.progress;return t+this.initialUnits}},e.Element.animate.prototype=new e.Element.AnimateBase,e.Element.animateColor=function(t){this.base=e.Element.AnimateBase,this.base(t),this.calcValue=function(){var e=this.progress(),t=new RGBColor(e.from.value),n=new RGBColor(e.to.value);if(t.ok&&n.ok){var r=t.r+(n.r-t.r)*e.progress,i=t.g+(n.g-t.g)*e.progress,s=t.b+(n.b-t.b)*e.progress;return"rgb("+parseInt(r,10)+","+parseInt(i,10)+","+parseInt(s,10)+")"}return this.attribute("from").value}},e.Element.animateColor.prototype=new e.Element.AnimateBase,e.Element.animateTransform=function(t){this.base=e.Element.AnimateBase,this.base(t),this.calcValue=function(){for(var t=this.progress(),n=e.ToNumberArray(t.from.value),r=e.ToNumberArray(t.to.value),i="",s=0;s<n.length;s++)i+=n[s]+(r[s]-n[s])*t.progress+" ";return i}},e.Element.animateTransform.prototype=new e.Element.animate,e.Element.font=function(t){this.base=e.Element.ElementBase,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var n=0;n<this.children.length;n++){var r=this.children[n];"font-face"==r.type?(this.fontFace=r,r.style("font-family").hasValue()&&(e.Definitions[r.style("font-family").value]=this)):"missing-glyph"==r.type?this.missingGlyph=r:"glyph"==r.type&&(""!=r.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[r.unicode]&&(this.glyphs[r.unicode]=[]),this.glyphs[r.unicode][r.arabicForm]=r):this.glyphs[r.unicode]=r)}},e.Element.font.prototype=new e.Element.ElementBase,e.Element.fontface=function(t){this.base=e.Element.ElementBase,this.base(t),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},e.Element.fontface.prototype=new e.Element.ElementBase,e.Element.missingglyph=function(t){this.base=e.Element.path,this.base(t),this.horizAdvX=0},e.Element.missingglyph.prototype=new e.Element.path,e.Element.glyph=function(t){this.base=e.Element.path,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},e.Element.glyph.prototype=new e.Element.path,e.Element.text=function(t){this.captureTextNodes=!0,this.base=e.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e),this.style("dominant-baseline").hasValue()&&(e.textBaseline=this.style("dominant-baseline").value),this.style("alignment-baseline").hasValue()&&(e.textBaseline=this.style("alignment-baseline").value)},this.getBoundingBox=function(){return new e.BoundingBox(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"),0,0)},this.renderChildren=function(e){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.x+=this.getAnchorDelta(e,this,0);for(var t=0;t<this.children.length;t++)this.renderChild(e,this,t)},this.getAnchorDelta=function(e,t,n){var r=this.style("text-anchor").valueOrDefault("start");if("start"!=r){for(var i=0,s=n;s<t.children.length;s++){var o=t.children[s];if(s>n&&o.attribute("x").hasValue())break;i+=o.measureTextRecursive(e)}return-1*("end"==r?i:i/2)}return 0},this.renderChild=function(e,t,n){var r=t.children[n];r.attribute("x").hasValue()?r.x=r.attribute("x").toPixels("x")+this.getAnchorDelta(e,t,n):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),r.attribute("dx").hasValue()&&(this.x+=r.attribute("dx").toPixels("x")),r.x=this.x),this.x=r.x+r.measureText(e),r.attribute("y").hasValue()?r.y=r.attribute("y").toPixels("y"):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),r.attribute("dy").hasValue()&&(this.y+=r.attribute("dy").toPixels("y")),r.y=this.y),this.y=r.y,r.render(e);for(var n=0;n<r.children.length;n++)this.renderChild(e,r,n)}},e.Element.text.prototype=new e.Element.RenderedElementBase,e.Element.TextElementBase=function(t){this.base=e.Element.RenderedElementBase,this.base(t),this.getGlyph=function(e,t,n){var r=t[n],i=null;if(e.isArabic){var s="isolated";(0==n||" "==t[n-1])&&n<t.length-2&&" "!=t[n+1]&&(s="terminal"),n>0&&" "!=t[n-1]&&n<t.length-2&&" "!=t[n+1]&&(s="medial"),n>0&&" "!=t[n-1]&&(n==t.length-1||" "==t[n+1])&&(s="initial"),"undefined"!=typeof e.glyphs[r]&&(i=e.glyphs[r][s],null==i&&"glyph"==e.glyphs[r].type&&(i=e.glyphs[r]))}else i=e.glyphs[r];return null==i&&(i=e.missingGlyph),i},this.renderChildren=function(t){var n=this.parent.style("font-family").getDefinition();if(null==n)""!=t.fillStyle&&t.fillText(e.compressSpaces(this.getText()),this.x,this.y),""!=t.strokeStyle&&t.strokeText(e.compressSpaces(this.getText()),this.x,this.y);else{var r=this.parent.style("font-size").numValueOrDefault(e.Font.Parse(e.ctx.font).fontSize),i=this.parent.style("font-style").valueOrDefault(e.Font.Parse(e.ctx.font).fontStyle),s=this.getText();n.isRTL&&(s=s.split("").reverse().join(""));for(var o=e.ToNumberArray(this.parent.attribute("dx").value),u=0;u<s.length;u++){var a=this.getGlyph(n,s,u),f=r/n.fontFace.unitsPerEm;t.translate(this.x,this.y),t.scale(f,-f);var l=t.lineWidth;t.lineWidth=t.lineWidth*n.fontFace.unitsPerEm/r,"italic"==i&&t.transform(1,0,.4,1,0,0),a.render(t),"italic"==i&&t.transform(1,0,-.4,1,0,0),t.lineWidth=l,t.scale(1/f,-1/f),t.translate(-this.x,-this.y),this.x+=r*(a.horizAdvX||n.horizAdvX)/n.fontFace.unitsPerEm,"undefined"==typeof o[u]||isNaN(o[u])||(this.x+=o[u])}}},this.getText=function(){},this.measureTextRecursive=function(e){for(var t=this.measureText(e),n=0;n<this.children.length;n++)t+=this.children[n].measureTextRecursive(e);return t},this.measureText=function(t){var n=this.parent.style("font-family").getDefinition();if(null!=n){var r=this.parent.style("font-size").numValueOrDefault(e.Font.Parse(e.ctx.font).fontSize),i=0,s=this.getText();n.isRTL&&(s=s.split("").reverse().join(""));for(var o=e.ToNumberArray(this.parent.attribute("dx").value),u=0;u<s.length;u++){var a=this.getGlyph(n,s,u);i+=(a.horizAdvX||n.horizAdvX)*r/n.fontFace.unitsPerEm,"undefined"==typeof o[u]||isNaN(o[u])||(i+=o[u])}return i}var f=e.compressSpaces(this.getText());if(!t.measureText)return 10*f.length;t.save(),this.setContext(t);var l=t.measureText(f).width;return t.restore(),l}},e.Element.TextElementBase.prototype=new e.Element.RenderedElementBase,e.Element.tspan=function(t){this.captureTextNodes=!0,this.base=e.Element.TextElementBase,this.base(t),this.text=t.nodeValue||t.text||"",this.getText=function(){return this.text}},e.Element.tspan.prototype=new e.Element.TextElementBase,e.Element.tref=function(t){this.base=e.Element.TextElementBase,this.base(t),this.getText=function(){var e=this.getHrefAttribute().getDefinition();return null!=e?e.children[0].getText():void 0}},e.Element.tref.prototype=new e.Element.TextElementBase,e.Element.a=function(t){this.base=e.Element.TextElementBase,this.base(t),this.hasText=!0;for(var n=0;n<t.childNodes.length;n++)3!=t.childNodes[n].nodeType&&(this.hasText=!1);this.text=this.hasText?t.childNodes[0].nodeValue:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var n=new e.Property("fontSize",e.Font.Parse(e.ctx.font).fontSize);e.Mouse.checkBoundingBox(this,new e.BoundingBox(this.x,this.y-n.toPixels("y"),this.x+this.measureText(t),this.y))}else{var r=new e.Element.g;r.children=this.children,r.parent=this,r.render(t)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){e.ctx.canvas.style.cursor="pointer"}},e.Element.a.prototype=new e.Element.TextElementBase,e.Element.image=function(t){this.base=e.Element.RenderedElementBase,this.base(t);var n=this.getHrefAttribute().value,r=n.match(/\.svg$/);if(e.Images.push(this),this.loaded=!1,r)this.img=e.ajax(n),this.loaded=!0;else{this.img=document.createElement("img");var i=this;this.img.onload=function(){i.loaded=!0},this.img.onerror=function(){"undefined"!=typeof console&&(console.log('ERROR: image "'+n+'" not found'),i.loaded=!0)},this.img.src=n}this.renderChildren=function(t){var n=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");0!=s&&0!=o&&(t.save(),r?t.drawSvg(this.img,n,i,s,o):(t.translate(n,i),e.AspectRatio(t,this.attribute("preserveAspectRatio").value,s,this.img.width,o,this.img.height,0,0),t.drawImage(this.img,0,0)),t.restore())},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");return new e.BoundingBox(t,n,t+r,n+i)}},e.Element.image.prototype=new e.Element.RenderedElementBase,e.Element.g=function(t){this.base=e.Element.RenderedElementBase,this.base(t),this.getBoundingBox=function(){for(var t=new e.BoundingBox,n=0;n<this.children.length;n++)t.addBoundingBox(this.children[n].getBoundingBox());return t}},e.Element.g.prototype=new e.Element.RenderedElementBase,e.Element.symbol=function(t){this.base=e.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){if(this.baseSetContext(t),this.attribute("viewBox").hasValue()){var n=e.ToNumberArray(this.attribute("viewBox").value),r=n[0],i=n[1];width=n[2],height=n[3],e.AspectRatio(t,this.attribute("preserveAspectRatio").value,this.attribute("width").toPixels("x"),width,this.attribute("height").toPixels("y"),height,r,i),e.ViewPort.SetCurrent(n[2],n[3])}}},e.Element.symbol.prototype=new e.Element.RenderedElementBase,e.Element.style=function(t){this.base=e.Element.ElementBase,this.base(t);for(var n="",r=0;r<t.childNodes.length;r++)n+=t.childNodes[r].nodeValue;n=n.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),n=e.compressSpaces(n);for(var i=n.split("}"),r=0;r<i.length;r++)if(""!=e.trim(i[r]))for(var s=i[r].split("{"),o=s[0].split(","),u=s[1].split(";"),a=0;a<o.length;a++){var f=e.trim(o[a]);if(""!=f){for(var l={},c=0;c<u.length;c++){var h=u[c].indexOf(":"),p=u[c].substr(0,h),d=u[c].substr(h+1,u[c].length-h);null!=p&&null!=d&&(l[e.trim(p)]=new e.Property(e.trim(p),e.trim(d)))}if(e.Styles[f]=l,"@font-face"==f)for(var v=l["font-family"].value.replace(/"/g,""),m=l.src.value.split(","),g=0;g<m.length;g++)if(m[g].indexOf('format("svg")')>0)for(var y=m[g].indexOf("url"),b=m[g].indexOf(")",y),w=m[g].substr(y+5,b-y-6),E=e.parseXml(e.ajax(w)),S=E.getElementsByTagName("font"),x=0;x<S.length;x++){var T=e.CreateElement(S[x]);e.Definitions[v]=T}}}},e.Element.style.prototype=new e.Element.ElementBase,e.Element.use=function(t){this.base=e.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e),this.attribute("x").hasValue()&&e.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&e.translate(0,this.attribute("y").toPixels("y"))},this.getDefinition=function(){var e=this.getHrefAttribute().getDefinition();return this.attribute("width").hasValue()&&(e.attribute("width",!0).value=this.attribute("width").value),this.attribute("height").hasValue()&&(e.attribute("height",!0).value=this.attribute("height").value),e},this.path=function(e){var t=this.getDefinition();null!=t&&t.path(e)},this.getBoundingBox=function(){var e=this.getDefinition();return null!=e?e.getBoundingBox():void 0},this.renderChildren=function(e){var t=this.getDefinition();if(null!=t){var n=t.parent;t.parent=null,t.render(e),t.parent=n}}},e.Element.use.prototype=new e.Element.RenderedElementBase,e.Element.mask=function(t){this.base=e.Element.ElementBase,this.base(t),this.apply=function(t,n){var r=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");if(0==s&&0==o){for(var u=new e.BoundingBox,a=0;a<this.children.length;a++)u.addBoundingBox(this.children[a].getBoundingBox());var r=Math.floor(u.x1),i=Math.floor(u.y1),s=Math.floor(u.width()),o=Math.floor(u.height())}var f=n.attribute("mask").value;n.attribute("mask").value="";var l=document.createElement("canvas");l.width=r+s,l.height=i+o;var c=l.getContext("2d");this.renderChildren(c);var h=document.createElement("canvas");h.width=r+s,h.height=i+o;var p=h.getContext("2d");n.render(p),p.globalCompositeOperation="destination-in",p.fillStyle=c.createPattern(l,"no-repeat"),p.fillRect(0,0,r+s,i+o),t.fillStyle=p.createPattern(h,"no-repeat"),t.fillRect(0,0,r+s,i+o),n.attribute("mask").value=f},this.render=function(e){}},e.Element.mask.prototype=new e.Element.ElementBase,e.Element.clipPath=function(t){this.base=e.Element.ElementBase,this.base(t),this.apply=function(t){for(var n=0;n<this.children.length;n++){var r=this.children[n];if("undefined"!=typeof r.path){var i=null;r.attribute("transform").hasValue()&&(i=new e.Transform(r.attribute("transform").value),i.apply(t)),r.path(t),t.clip(),i&&i.unapply(t)}}},this.render=function(e){}},e.Element.clipPath.prototype=new e.Element.ElementBase,e.Element.filter=function(t){this.base=e.Element.ElementBase,this.base(t),this.apply=function(e,t){var n=t.getBoundingBox(),r=Math.floor(n.x1),i=Math.floor(n.y1),s=Math.floor(n.width()),o=Math.floor(n.height()),u=t.style("filter").value;t.style("filter").value="";for(var a=0,f=0,l=0;l<this.children.length;l++){var c=this.children[l].extraFilterDistance||0;a=Math.max(a,c),f=Math.max(f,c)}var h=document.createElement("canvas");h.width=s+2*a,h.height=o+2*f;var p=h.getContext("2d");p.translate(-r+a,-i+f),t.render(p);for(var l=0;l<this.children.length;l++)this.children[l].apply(p,0,0,s+2*a,o+2*f);e.drawImage(h,0,0,s+2*a,o+2*f,r-a,i-f,s+2*a,o+2*f),t.style("filter",!0).value=u},this.render=function(e){}},e.Element.filter.prototype=new e.Element.ElementBase,e.Element.feMorphology=function(t){this.base=e.Element.ElementBase,this.base(t),this.apply=function(e,t,n,r,i){}},e.Element.feMorphology.prototype=new e.Element.ElementBase,e.Element.feColorMatrix=function(t){function n(e,t,n,r,i,s){return e[n*r*4+4*t+s]}function r(e,t,n,r,i,s,o){e[n*r*4+4*t+s]=o}this.base=e.Element.ElementBase,this.base(t),this.apply=function(e,t,i,s,o){for(var u=e.getImageData(0,0,s,o),i=0;o>i;i++)for(var t=0;s>t;t++){var a=n(u.data,t,i,s,o,0),f=n(u.data,t,i,s,o,1),l=n(u.data,t,i,s,o,2),c=(a+f+l)/3;r(u.data,t,i,s,o,0,c),r(u.data,t,i,s,o,1,c),r(u.data,t,i,s,o,2,c)}e.clearRect(0,0,s,o),e.putImageData(u,0,0)}},e.Element.feColorMatrix.prototype=new e.Element.ElementBase,e.Element.feGaussianBlur=function(t){this.base=e.Element.ElementBase,this.base(t),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(t,n,r,i,s){return"undefined"==typeof stackBlurCanvasRGBA?void("undefined"!=typeof console&&console.log("ERROR: StackBlur.js must be included for blur to work")):(t.canvas.id=e.UniqueId(),t.canvas.style.display="none",document.body.appendChild(t.canvas),stackBlurCanvasRGBA(t.canvas.id,n,r,i,s,this.blurRadius),void document.body.removeChild(t.canvas))}},e.Element.feGaussianBlur.prototype=new e.Element.ElementBase,e.Element.title=function(e){},e.Element.title.prototype=new e.Element.ElementBase,e.Element.desc=function(e){},e.Element.desc.prototype=new e.Element.ElementBase,e.Element.MISSING=function(e){"undefined"!=typeof console&&console.log("ERROR: Element '"+e.nodeName+"' not yet implemented.")},e.Element.MISSING.prototype=new e.Element.ElementBase,e.CreateElement=function(t){var n=t.nodeName.replace(/^[^:]+:/,"");n=n.replace(/\-/g,"");var r=null;return r="undefined"!=typeof e.Element[n]?new e.Element[n](t):new e.Element.MISSING(t),r.type=t.nodeName,r},e.load=function(t,n){e.loadXml(t,e.ajax(n))},e.loadXml=function(t,n){e.loadXmlDoc(t,e.parseXml(n))},e.loadXmlDoc=function(t,n){e.init(t);var r=function(e){for(var n=t.canvas;n;)e.x-=n.offsetLeft,e.y-=n.offsetTop,n=n.offsetParent;return window.scrollX&&(e.x+=window.scrollX),window.scrollY&&(e.y+=window.scrollY),e};1!=e.opts.ignoreMouse&&(t.canvas.onclick=function(t){var n=r(new e.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));e.Mouse.onclick(n.x,n.y)},t.canvas.onmousemove=function(t){var n=r(new e.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));e.Mouse.onmousemove(n.x,n.y)});var i=e.CreateElement(n.documentElement);i.root=!0;var s=!0,o=function(){e.ViewPort.Clear(),t.canvas.parentNode&&e.ViewPort.SetCurrent(t.canvas.parentNode.clientWidth,t.canvas.parentNode.clientHeight),1!=e.opts.ignoreDimensions&&(i.style("width").hasValue()&&(t.canvas.width=i.style("width").toPixels("x"),t.canvas.style.width=t.canvas.width+"px"),i.style("height").hasValue()&&(t.canvas.height=i.style("height").toPixels("y"),t.canvas.style.height=t.canvas.height+"px"));var r=t.canvas.clientWidth||t.canvas.width,o=t.canvas.clientHeight||t.canvas.height;if(1==e.opts.ignoreDimensions&&i.style("width").hasValue()&&i.style("height").hasValue()&&(r=i.style("width").toPixels("x"),o=i.style("height").toPixels("y")),e.ViewPort.SetCurrent(r,o),null!=e.opts.offsetX&&(i.attribute("x",!0).value=e.opts.offsetX),null!=e.opts.offsetY&&(i.attribute("y",!0).value=e.opts.offsetY),null!=e.opts.scaleWidth&&null!=e.opts.scaleHeight){var u=1,a=1,f=e.ToNumberArray(i.attribute("viewBox").value);i.attribute("width").hasValue()?u=i.attribute("width").toPixels("x")/e.opts.scaleWidth:isNaN(f[2])||(u=f[2]/e.opts.scaleWidth),i.attribute("height").hasValue()?a=i.attribute("height").toPixels("y")/e.opts.scaleHeight:isNaN(f[3])||(a=f[3]/e.opts.scaleHeight),i.attribute("width",!0).value=e.opts.scaleWidth,i.attribute("height",!0).value=e.opts.scaleHeight,i.attribute("viewBox",!0).value="0 0 "+r*u+" "+o*a,i.attribute("preserveAspectRatio",!0).value="none"}1!=e.opts.ignoreClear&&t.clearRect(0,0,r,o),i.render(t),s&&(s=!1,"function"==typeof e.opts.renderCallback&&e.opts.renderCallback(n))},u=!0;e.ImagesLoaded()&&(u=!1,o()),e.intervalID=setInterval(function(){var t=!1;if(u&&e.ImagesLoaded()&&(u=!1,t=!0),1!=e.opts.ignoreMouse&&(t|=e.Mouse.hasEvents()),1!=e.opts.ignoreAnimation)for(var n=0;n<e.Animations.length;n++)t|=e.Animations[n].update(1e3/e.FRAMERATE);"function"==typeof e.opts.forceRedraw&&1==e.opts.forceRedraw()&&(t=!0),t&&(o(),e.Mouse.runEvents())},1e3/e.FRAMERATE)},e.stop=function(){e.intervalID&&clearInterval(e.intervalID)},e.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(e,t){this.events.push({type:"onclick",x:e,y:t,run:function(e){e.onclick&&e.onclick()}})},this.onmousemove=function(e,t){this.events.push({type:"onmousemove",x:e,y:t,run:function(e){e.onmousemove&&e.onmousemove()}})},this.eventElements=[],this.checkPath=function(e,t){for(var n=0;n<this.events.length;n++){var r=this.events[n];t.isPointInPath&&t.isPointInPath(r.x,r.y)&&(this.eventElements[n]=e)}},this.checkBoundingBox=function(e,t){for(var n=0;n<this.events.length;n++){var r=this.events[n];t.isPointInBox(r.x,r.y)&&(this.eventElements[n]=e)}},this.runEvents=function(){e.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++)for(var n=this.events[t],r=this.eventElements[t];r;)n.run(r),r=r.parent;this.events=[],this.eventElements=[]}},e}this.canvg=function(t,n,r){if(null!=t||null!=n||null!=r){r=r||{},"string"==typeof t&&(t=document.getElementById(t)),null!=t.svg&&t.svg.stop();var f=e();(1!=t.childNodes.length||"OBJECT"!=t.childNodes[0].nodeName)&&(t.svg=f),f.opts=r;var l=t.getContext("2d");"undefined"!=typeof n.documentElement?f.loadXmlDoc(l,n):"<"==n.substr(0,1)?f.loadXml(l,n):f.load(l,n)}else for(var i=document.getElementsByTagName("svg"),s=0;s<i.length;s++){var o=i[s],u=document.createElement("canvas");u.width=o.clientWidth,u.height=o.clientHeight,o.parentNode.insertBefore(u,o),o.parentNode.removeChild(o);var a=document.createElement("div");a.appendChild(o),canvg(u,a.innerHTML)}}}(),"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(e,t,n,r,i){canvg(this.canvas,e,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:t,offsetY:n,scaleWidth:r,scaleHeight:i})}),define("canvg",function(){}),define("directives/symbol/SymbolCatalog",["angular","spin","canvg"],function(angular,spinner,canvg){"use strict";var SYMBOL_CONTAINER_WIDTH=58,SYMBOL_CONTAINER_HEIGHT=72,INFINITY_LOADER_SCROLL_TRIGGER_SIZE=200,STATE_IDLE="idle",STATE_LOADING="loading",STATE_ERROR="error",STATE_EMPTY="emptyCatalog",ITEMS_PER_PAGE=24;angular.module("logoBuilderApp.directives.SymbolCatalog",[]).factory("SymbolCatalogService",["$q",function($q){return{transformSymbols:function transformSymbolsFn(symbols,parentId,parentName){return angular.forEach(symbols,function(symbol){symbol.symbols&&symbol.symbols.length&&(symbol.symbols=transformSymbolsFn(symbol.symbols,symbol.id,symbol.name))}),(symbols||[]).map(function(symbol){return symbol.parentId=parentId,symbol.name=symbol.name||parentName,!symbol.preview_url&&symbol.symbols&&symbol.symbols.length&&(symbol.preview_url=symbol.symbols[0].preview_url),symbol})},findParentSymbolsBySymbolId:function findParentSymbolsBySymbolIdFn(symbolId,symbols){var i,subSymbols;if(!symbols||!symbolId)return null;for(i=0;i<symbols.length;++i){if(symbols[i].id==symbolId)return symbols;if(symbols[i].symbols&&symbols[i].symbols.length&&(subSymbols=findParentSymbolsBySymbolIdFn(symbolId,symbols[i].symbols)))return subSymbols}return null}}}]).directive("symbolCatalog",["$log","$q","$timeout","SymbolCatalogService","lgApi",function($log,$q,$timeout,SymbolCatalogService,lgApi){return{templateUrl:lgApi.getLocationUrl("views/SymbolCatalog.directive.html"),restrict:"E",require:"symbolCatalog",scope:{symbols:"=",viewPageIndex:"=",onFetchData:"&",onItemClick:"&",onStateChanges:"&"},controller:["$scope",function($scope){var thisController=this;this.setPreviewItemProcess=function(state,symbol){var previewPromise=$scope.previewPromiseMap[symbol.id]=$scope.previewPromiseMap[symbol.id]||$q.defer();return state===STATE_IDLE?previewPromise.resolve(symbol):state===STATE_ERROR&&previewPromise.reject(symbol),previewPromise},this.setViewPageIndex=function(pageIndexValue,isFlush){var oldPageViewIndex=$scope.viewPageIndex;$scope.viewPageIndex=Math.max(Math.min(~~pageIndexValue,$scope.viewPagesCount-1),0),$scope.viewPageIndex-oldPageViewIndex>0&&$scope.viewPagesCount>1&&$scope.viewPageIndex+1==$scope.viewPagesCount&&$scope.onFetchData({flush:isFlush}),this.updateView()},this.getViewPageIndex=function(pageIndexValue){return $scope.viewPageIndex},this.appendViewPage=function(){$scope.viewItemsPerPage+=ITEMS_PER_PAGE,$scope.viewItemsPerPage=Math.min($scope.viewItemsPerPage,$scope.symbols.length)},this.setCatalogState=function(state){state==STATE_EMPTY?$scope.isViewEmpty=!0:$scope.isViewEmpty=!1,$scope.state=state},this.startProcess=function(){this.setCatalogState(STATE_LOADING),$scope.onStateChanges({state:$scope.state,viewSymbols:$scope.viewSymbols||[]})},this.endProcess=function(){this.setCatalogState($scope.viewSymbols&&$scope.viewSymbols.length?STATE_IDLE:STATE_EMPTY),$scope.onStateChanges({state:$scope.state,symbols:$scope.viewSymbols||[]})},this.updateView=function(){thisController.startProcess();var startSliceIndex=$scope.viewPageIndex*$scope.viewItemsPerPage,promise=$scope.viewSymbols&&$scope.viewSymbols.slice(startSliceIndex,startSliceIndex+$scope.viewItemsPerPage).map(function(symbol){return $scope.previewPromiseMap[symbol.id]=$scope.previewPromiseMap[symbol.id]||$q.defer(),$scope.previewPromiseMap[symbol.id].promise});return promise=promise||$q.resolve([]),$scope.requestingNewViewPage=!1,$q.all(promise)["finally"](function(symbolPreviews){thisController.endProcess()})},this.updateModel=function(symbols){var i,idsSeq=$scope.viewSymbols.map(function(sym){return sym.id}),isModelExtending=!0;if($scope.viewSymbols=[],symbols&&void 0!==symbols.length&&($scope.viewSymbols=symbols||[]),idsSeq.length>$scope.viewSymbols.length)isModelExtending=!1;else for(i=0;i<idsSeq.length;++i)if(idsSeq[i]!==$scope.viewSymbols[i].id){isModelExtending=!1;break}$scope.viewPagesCount=~~($scope.viewSymbols.length/$scope.viewItemsPerPage),$scope.viewSymbols.length%$scope.viewItemsPerPage>0&&($scope.viewPagesCount+=1),$scope.isPaging=$scope.viewPagesCount>1,thisController.setViewPageIndex(isModelExtending?$scope.viewPageIndex:0),$scope.requestingNewViewPage=!1,isModelExtending||($scope.viewItemsPerPage=ITEMS_PER_PAGE),thisController.updateView()}}],link:function(scope,element,attrs,selfController){function initModel(){scope.state=STATE_IDLE,scope.isPaging=!1,scope.previewPromiseMap={},initViewModel()}function initViewModel(){scope.isViewEmpty=!1,scope.itemSize={width:100,height:90},scope.viewSymbols=[],scope.viewItemsPerPage=ITEMS_PER_PAGE,scope.viewPageIndex=scope.viewPageIndex||0,scope.viewPagesCount=0}function loadSymbolsOnScrollSymbols(){scope.$applyAsync(function(){selfController.appendViewPage(),selfController.updateView()}),scope.requestingNewViewPage=!0}function onScrollSymbols(event){var ulElement=$(event.target);return ulElement.prop("scrollHeight")>2*ulElement.height()&&ulElement.prop("scrollHeight")-ulElement.height()-ulElement.scrollTop()<INFINITY_LOADER_SCROLL_TRIGGER_SIZE&&!scope.requestingNewViewPage?void loadSymbolsOnScrollSymbols():void(ulElement.prop("scrollWidth")>2*ulElement.width()&&ulElement.prop("scrollWidth")-ulElement.width()-ulElement.scrollLeft()<INFINITY_LOADER_SCROLL_TRIGGER_SIZE&&!scope.requestingNewViewPage&&loadSymbolsOnScrollSymbols())}function initInfinityScroll(){$("div.lg-symbols-container").unbind("scroll",onScrollSymbols).bind("scroll",onScrollSymbols),$("div.lg-symbols-container ul").unbind("scroll",onScrollSymbols).bind("scroll",onScrollSymbols)}function onViewSymbolsChanging(hashValue){void 0!==scope.symbols&&(initInfinityScroll(),selfController.updateModel(scope.symbols),$("div.lg-symbols-container").scrollTop(0))}scope.requestingNewViewPage=!1,scope.$watch(function(){var symbolIndex=1;return scope.symbols&&scope.symbols.length&&scope.symbols.reduce(function(sum,symbol){return~~sum+ ++symbolIndex*symbol.id})||+(void 0!==scope.symbols)},onViewSymbolsChanging),initModel(),scope.onStateChanges({state:scope.state,symbols:[]}),scope.onCatalogItemClick=function(symbol){scope.onItemClick({symbol:symbol})}}}}]).directive("symbolCatalogItem",["$log","$q","$timeout","lgApi",function($log,$q,$timeout){return{template:'<span ng-click="onCatalogItemClick({symbol: symbol})"><symbol-catalog-item-preview ng-if="!symbol.html"></symbol-catalog-item-preview><symbol-catalog-item-html ng-if="symbol.html"></symbol-catalog-item-preview></span>',restrict:"A",require:"^symbolCatalog",scope:{symbol:"=",viewIndex:"=",itemSize:"=",onCatalogItemClick:"&"},link:function(scope,element,attrs,symbolCatalogCtrl){symbolCatalogCtrl.setPreviewItemProcess(STATE_LOADING,scope.symbol),jQuery(element).css({width:scope.itemSize.width+"px",height:scope.itemSize.height+"px"})}}}]).directive("symbolCatalogItemPreview",[function(){return{scope:!1,restrict:"E",require:"^symbolCatalog",template:'<span><span class="symbol-container"><img style="visibility: hidden" ng-src="{{symbol.preview_url}}"></span><span class="lg-count-symbol" ng-show="symbol.symbols.length > 1" ng-bind="symbol.symbols.length +  \' choices\'"></span></span>',link:function(scope,element,attrs,symbolCatalogCtrl){function setSizeForPreviewImage(element){var ratio=element.width/element.height,width=SYMBOL_CONTAINER_HEIGHT*ratio,height=SYMBOL_CONTAINER_WIDTH/ratio;SYMBOL_CONTAINER_WIDTH/SYMBOL_CONTAINER_HEIGHT>ratio?height=SYMBOL_CONTAINER_HEIGHT:width=SYMBOL_CONTAINER_WIDTH,angular.element(element).css({visibility:"visible",display:"none","margin-top":(SYMBOL_CONTAINER_HEIGHT-height>>1)+"px",width:width+"px",height:height+"px"}).fadeIn("fast")}function onLoadPreviewImage(){jQuery(awaitSpinner.el).fadeOut("fast",function(){awaitSpinner.stop(),element.children("div.loading").remove()}),symbolCatalogCtrl.setPreviewItemProcess(STATE_IDLE,scope.symbol)}function processPreviewImage(){imageElement=element.find("span.symbol-container > img").get(0),imageElement?(element.append('<div class="loading"></div>').children("div.loading").append($(awaitSpinner.el)).children("div.spinner").css({display:"block"}),imageElement.onload=function(event){setSizeForPreviewImage(imageElement),onLoadPreviewImage()},imageElement.onerror=function(event){awaitSpinner.stop(),symbolCatalogCtrl.setPreviewItemProcess(STATE_ERROR,scope.symbol)}):symbolCatalogCtrl.setPreviewItemProcess(STATE_IDLE,scope.symbol)}var imageElement,awaitSpinner=new spinner({zIndex:2,color:"#8F0887"}).spin();scope.$on("$destroy",function(){onLoadPreviewImage()}),jQuery(element).parentsUntil("li").parent().removeClass("alphaBox"),processPreviewImage()}}}]).directive("symbolCatalogItemHtml",[function(){return{scope:!1,restrict:"E",require:"^symbolCatalog",template:'<span><span ng-bind-html="symbol.html"></span><br><b>See Choices</b></span>',link:function(scope,element,attrs,symbolCatalogCtrl){jQuery(element).parentsUntil("li").parent().addClass("alphaBox"),jQuery(element).children().css({
display:"none"}).fadeIn("fast"),symbolCatalogCtrl.setPreviewItemProcess(STATE_IDLE,scope.symbol)}}}]).directive("symbolCatalogPagination",[function(){return{restrict:"A",template:'<div class="items-pagination"><div class="centerInDiv"><button class="prevBtn icon-arrow-left-fat" ng-class="currentPage == 0?\'btnDisabled\':\'\'" ng-disabled="currentPage == 0" ng-click="onPrevPageClick()"></button><span>See More:<br> ({{currentPage + 1}} of {{totalPages}})</span><button class="nextBtn icon-arrow-right-fat" ng-class="currentPage + 1 == totalPages ? \'btnDisabled\':\'\'" ng-disabled="currentPage + 1 == totalPages" ng-click="onNextPageClick()"></button></div></div>',require:"^symbolCatalog",scope:{currentPage:"=",totalPages:"="},link:function(scope,element,attrs,symbolCatalogCtrl){scope.onPrevPageClick=function(){symbolCatalogCtrl.setViewPageIndex(scope.currentPage-1)},scope.onNextPageClick=function(){symbolCatalogCtrl.setViewPageIndex(scope.currentPage+1)}}}}]).directive("symbolCatalogBreadcrumb",[function(){return{restrict:"A",template:'<span ng-repeat="path in symbolCatalogBreadcrumb | limitTo:(symbolCatalogBreadcrumb.length-1)"><a href="javascript:;" ng-click="onItemClick({item: path})" ng-bind="path.name"></a>&gt;</span><span class="sub-category" ng-if="symbolCatalogBreadcrumb.length > 0" ng-bind="symbolCatalogBreadcrumb.slice(-1)[0].name"></span>',scope:{symbolCatalogBreadcrumb:"=",onItemClick:"&"}}}])}),define("directives/symbol/SearchBox",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.directives.SearchBox",[]).directive("searchBox",function($timeout,logoData,lgApi){return{template:function(){return'<input type="text" id="search-text" ng-model="currentSearchTerms" placeholder="Search Symbols" data-callback="getSearchResults()"><button><svg viewBox="0 0 24 23" class="flipH"><use xlink:href="#search-icon"></use></svg></button>'},restrict:"A",link:function(scope,elem,attrs){function splitWords(val){return val.split(/\s+/)}function extractLastWord(term){return splitWords(term).pop()}function searchSymbols(){""!==inputElem.val()&&(scope.getSearchResults(inputElem.val()),inputElem.blur())}var inputElem=elem.find("input"),buttonElem=elem.find("button");scope.$on("lg:searchByKeywords",function(event,value){value&&(scope.currentSearchTerms=value,searchSymbols())}),$(inputElem).bind("keydown",function(event){event.keyCode===$.ui.keyCode.TAB&&$(this).autocomplete("instance").menu.active&&event.preventDefault()}).autocomplete({minLength:3,source:function(request,responseToControl){var q=extractLastWord(request.term);lgApi.getKeywordsHints(q).then(function(response){responseToControl($.ui.autocomplete.filter(response&&response.data||[],q))})},focus:function(){return!1},search:function(){var term=extractLastWord(this.value);return term.length>2},select:function(event,ui){var terms=splitWords(this.value);return terms.pop(),terms.push(ui.item.value),terms.push(""),this.value=terms.join(" "),searchSymbols(),!1}}),inputElem.bind("keydown keypress",function(event){13===event.which&&searchSymbols()}),buttonElem.on("click",searchSymbols)}}})});var hookEvent=function(element,eventName,callback){"string"==typeof element&&(element=document.getElementById(element)),null!=element&&(element.addEventListener?element.addEventListener(eventName,callback,!1):element.attachEvent&&element.attachEvent("on"+eventName,callback))},unhookEvent=function(element,eventName,callback){"string"==typeof element&&(element=document.getElementById(element)),null!=element&&(element.removeEventListener?element.removeEventListener(eventName,callback,!1):element.detachEvent&&element.detachEvent("on"+eventName,callback))},cancelEvent=function(e){return e=e?e:window.event,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.cancel=!0,e.returnValue=!1,!1},Position=function(x,y){this.X=x,this.Y=y,this.Add=function(val){var newPos=new Position(this.X,this.Y);return null!=val&&(isNaN(val.X)||(newPos.X+=val.X),isNaN(val.Y)||(newPos.Y+=val.Y)),newPos},this.Subtract=function(val){var newPos=new Position(this.X,this.Y);return null!=val&&(isNaN(val.X)||(newPos.X-=val.X),isNaN(val.Y)||(newPos.Y-=val.Y)),newPos},this.Min=function(val){var newPos=new Position(this.X,this.Y);return null==val?newPos:(!isNaN(val.X)&&this.X>val.X&&(newPos.X=val.X),!isNaN(val.Y)&&this.Y>val.Y&&(newPos.Y=val.Y),newPos)},this.Max=function(val){var newPos=new Position(this.X,this.Y);return null==val?newPos:(!isNaN(val.X)&&this.X<val.X&&(newPos.X=val.X),!isNaN(val.Y)&&this.Y<val.Y&&(newPos.Y=val.Y),newPos)},this.Bound=function(lower,upper){var newPos=this.Max(lower);return newPos.Min(upper)},this.Check=function(){var newPos=new Position(this.X,this.Y);return isNaN(newPos.X)&&(newPos.X=0),isNaN(newPos.Y)&&(newPos.Y=0),newPos},this.Apply=function(element){"string"==typeof element&&(element=document.getElementById(element)),null!=element&&(isNaN(this.X)||(element.style.left=this.X+"px"),isNaN(this.Y)||(element.style.top=this.Y+"px"))}},absoluteCursorPostion=function(eventObj){return eventObj=eventObj?eventObj:window.event,eventObj.changedTouches&&(eventObj=eventObj.changedTouches[0]),isNaN(window.scrollX)?new Position(eventObj.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,eventObj.clientY+document.documentElement.scrollTop+document.body.scrollTop):new Position(eventObj.clientX+window.scrollX,eventObj.clientY+window.scrollY)},dragObject=function(element,attachElement,lowerBound,upperBound,startCallback,moveCallback,endCallback,attachLater){function dragStart(eventObj){if(!dragging&&listening&&!disposed){dragging=!0;var elem=document.getElementsByTagName("body")[0];elem.classList?elem.classList.add("grabbing"):elem.className+=" grabbing",null!=startCallback&&startCallback(eventObj,element),cursorStartPos=absoluteCursorPostion(eventObj);var posX,posY;if(isNaN(this.X)){var pRect=element.parentNode.getBoundingClientRect(),eRect=element.getBoundingClientRect();posY=eRect.top-pRect.top,posX=eRect.left-pRect.left}else posX=parseInt(element.style.left),posY=parseInt(element.style.top);return elementStartPos=new Position(posX,posY),elementStartPos=elementStartPos.Check(),hookEvent(document,"mousemove",dragGo),hookEvent(document,"touchmove",dragGo),hookEvent(document,"mouseup",dragStopHook),hookEvent(document,"touchend",dragStopHook),cancelEvent(eventObj)}}function dragGo(eventObj){if(dragging&&!disposed){var newPos=absoluteCursorPostion(eventObj);return newPos=newPos.Add(elementStartPos).Subtract(cursorStartPos),newPos=newPos.Bound(lowerBound,upperBound),newPos.Apply(element),null!=moveCallback&&moveCallback(newPos,element),cancelEvent(eventObj)}}function dragStopHook(eventObj){return dragStop(),cancelEvent(eventObj)}function dragStop(){if(dragging&&!disposed){var elem=document.getElementsByTagName("body")[0],cls=elem.className||"";elem.className=cls.replace(new RegExp("\\bgrabbing\\b"),""),unhookEvent(document,"mousemove",dragGo),unhookEvent(document,"touchmove",dragGo),unhookEvent(document,"mouseup",dragStopHook),unhookEvent(document,"touchend",dragStopHook),cursorStartPos=null,elementStartPos=null,null!=endCallback&&endCallback(element),dragging=!1}}if("string"==typeof element&&(element=document.getElementById(element)),null!=element){if(null!=lowerBound&&null!=upperBound){var temp=lowerBound.Min(upperBound);upperBound=lowerBound.Max(upperBound),lowerBound=temp}var cursorStartPos=null,elementStartPos=null,dragging=!1,listening=!1,disposed=!1;this.Dispose=function(){disposed||(this.StopListening(!0),element=null,attachElement=null,lowerBound=null,upperBound=null,startCallback=null,moveCallback=null,endCallback=null,disposed=!0)},this.StartListening=function(){listening||disposed||(listening=!0,hookEvent(attachElement,"mousedown",dragStart),hookEvent(attachElement,"touchstart",dragStart))},this.StopListening=function(stopCurrentDragging){listening&&!disposed&&(unhookEvent(attachElement,"mousedown",dragStart),unhookEvent(attachElement,"touchstart",dragStart),listening=!1,stopCurrentDragging&&dragging&&dragStop())},this.IsDragging=function(){return dragging},this.IsListening=function(){return listening},this.IsDisposed=function(){return disposed},"string"==typeof attachElement&&(attachElement=document.getElementById(attachElement)),null==attachElement&&(attachElement=element),attachLater||this.StartListening()}};define("draggable",function(){}),define("directives/editor/FontPanel",["angular","draggable","transform"],function(angular,drag,senoc){"use strict";angular.module("logoBuilderApp.directives.FontPanel",[]).directive("fontPanel",function($log,lgApi,logoData,svgService,$compile,$timeout,$document){return{templateUrl:lgApi.getLocationUrl("views/font-panel.html"),restrict:"E",replace:!0,transclude:!0,link:function(scope,element,attrs){var ss=svgService;scope.currentFont="Open Sans",scope.filterIcon="#search-icon",scope.selectedBold=!1,scope.selectedItalic=!1,scope.selectedShapeUp=!1,scope.selectedShapeDn=!1,scope.selectedNoShape=!0,scope.letterSpacing=0,scope.shapeSizing=3,scope.fpVisible=!0,scope.fontSize=16,scope.usedFonts={},scope.usedFontFilter=!1,scope.changeFontSizeWithId=function(id,currentSize,newSize){var mtx=scope.updateFontSizeMatrix(currentSize,newSize);scope.$root.send("transform-tool_updateDisplayListTextFieldWithId",id,mtx)},scope.changeFontSize=function(d){var inc="up"===d?1:-1,currentSize="string"!=typeof d?scope.getFontSize():parseInt(scope.fontSize),newSize="string"!=typeof d?d:currentSize+inc;if(newSize>5&&101>newSize){scope.fontSize=newSize;var mx=(scope.updateFontSizeMatrix(currentSize,currentSize),scope.updateFontSizeMatrix(currentSize,newSize)),id=scope.selectedTextField[0].id.replace(/text-/,"text-wrapper-");scope.send("updateDisplayListTextField",mx);var history={id:id,type:"fontSizeChange",oldSize:currentSize,newSize:newSize,data:{}};scope.$root.send("addHistory",history),scope.$root.send("refreshSelectedObjectEffects")}},scope.updateFontSizeMatrix=function(currentSize,newSize){var ratio=newSize/currentSize,m=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix();m.a=parseFloat(scope.fontMatrix.a),m.b=parseFloat(scope.fontMatrix.b),m.c=parseFloat(scope.fontMatrix.c),m.d=parseFloat(scope.fontMatrix.d),m.e=parseFloat(scope.fontMatrix.x),m.f=parseFloat(scope.fontMatrix.y),m=m.scale(ratio);var mx=new Matrix(parseFloat(m.a),parseFloat(m.b),parseFloat(m.c),parseFloat(m.d),parseFloat(m.e),parseFloat(m.f));return mx},scope.getFontSize=function(){if(scope.sel){var itemIndex=scope.sel[0].id.split("-").pop(),mString=document.getElementById("text-wrapper-"+itemIndex).getAttribute("transform"),m=ss.getMatrixFromStyle(mString);scope.fontMatrix=m;var mx=ss.decomposeMatrix(m);return Math.abs(Math.floor(16*(mx.scaleY+.01)))}},scope.changeFontWithId=function(id,font){var elem=document.getElementById(id);elem.setAttribute("data-font",font),ss.renderFont(elem),scope.$root.send("refreshSelectedObjectEffects")},scope.getStyleVal=function(){return scope.selectedBold&&scope.selectedItalic?"z":scope.selectedBold&&!scope.selectedItalic?"b":!scope.selectedBold&&scope.selectedItalic?"i":scope.selectedBold||scope.selectedItalic?"":"n"},scope.getShapeVal=function(){return scope.selectedShapeUp?"up":scope.selectedShapeDn?"down":(scope.selectedNoShape,"")},scope.setStyleVal=function(val){("b"===val||"z"===val)&&(scope.selectedBold=!0),("i"===val||"z"===val)&&(scope.selectedItalic=!0),("n"===val||""===val)&&(scope.selectedBold=scope.selectedItalic=!1)},scope.setShapeVal=function(val){"down"===val&&scope.toggleShapeDn(!0),"up"===val&&scope.toggleShapeUp(!0),(void 0===val||""===val)&&scope.toggleNoShape(!0)},scope.isTextFieldSelected=function(){return!!scope.selectedTextField},scope.updateSpacing=function(){if(scope.selectedTextField){var id=scope.selectedTextField[0].id.replace(/text-/,"text-wrapper-"),oldSpacing=scope.selectedTextField.attr("data-letter-spacing"),newSpacing=scope.letterSpacing,history={id:id,type:"letterSpacing",oldSpacing:oldSpacing,newSpacing:newSpacing,data:{}};scope.$root.send("addHistory",history),scope.updateSpacingWithId(scope.selectedTextField[0].id,scope.letterSpacing)}},scope.updateSpacingWithId=function(id,spacing){var elem=document.getElementById(id);scope.selectedTextField.attr("data-letter-spacing",spacing),ss.renderFont(elem)},scope.updateSizing=function(){scope.selectedTextField.attr("data-radius",scope.shapeSizing),ss.renderFont(scope.selectedTextField[0])},scope.loadAnimation=function(stop){if(stop)clearInterval(scope["int"]),scope["int"]=0,scope.currentFont=scope.loadingFont,scope.loadingFont=null,scope.selectedTextField=scope.loadedTextField,scope.loadedTextField=null;else{scope.loadedTextField=scope.selectedTextField,scope.selectedTextField=null,scope.loadingFont=scope.currentFont,scope.currentFont="Loading Font";var count=0;scope["int"]&&clearInterval(scope["int"]),scope["int"]=setInterval(function(){count++,scope.currentFont="Loading Font"+new Array(count%10+1).join("."),scope.$apply()},500)}},scope.updateStyle=function(){var style=scope.getStyleVal(),id=scope.selectedTextField[0].id,oldStyle=scope.selectedTextField[0].getAttribute("data-style"),history={id:id.replace(/text-/,"text-wrapper-"),type:"styleChange",oldStyle:oldStyle,newStyle:style,data:{}};scope.$root.send("addHistory",history),scope.updateStyleWithId(id,style),scope.$root.send("refreshSelectedObjectEffects")},scope.updateStyleWithId=function(id,style){var elem=document.getElementById(id);scope.selectedTextField.attr("data-style",style),ss.renderFont(elem)},scope.updateShape=function(){var shapeVal=scope.getShapeVal();scope.selectedTextField.attr("data-path",shapeVal),ss.renderFont(scope.selectedTextField[0])},scope.toggleBold=function(){scope.selectedBold=!scope.selectedBold,scope.updateStyle()},scope.toggleItalic=function(){scope.selectedItalic=!scope.selectedItalic,scope.updateStyle()},scope.toggleShape=function(skipRender,direction,addHistory){var childId=scope.selectedTextField[0].id,id=childId.replace(/(text-)/g,"text-wrapper-"),elem=document.getElementById(childId),oldState=elem.getAttribute("data-path");null===oldState&&(oldState="straight");var addHist=!0;if((void 0!==addHistory||null!==addHistory||""!==addHistory)&&(addHist=addHistory),addHist===!0){var history={id:id,type:"shape",direction:direction,oldShapeState:oldState,data:{}};scope.$root.send("addHistory",history)}"up"===direction?(scope.selectedShapeUp=!0,scope.selectedShapeDn=!1,scope.selectedNoShape=!1):"down"===direction?(scope.selectedShapeUp=!1,scope.selectedShapeDn=!0,scope.selectedNoShape=!1):(scope.selectedShapeUp=!1,scope.selectedShapeDn=!1,scope.selectedNoShape=!0),skipRender||scope.updateShape()},scope.toggleShapeUp=function(skipRender){scope.toggleShape(skipRender,"up",!0)},scope.toggleShapeDn=function(skipRender){scope.toggleShape(skipRender,"down",!0)},scope.toggleNoShape=function(skipRender){scope.toggleShape(skipRender,"straight",!0)};var fp=document.querySelector("#fnt-panel");fp=angular.element(fp);var fi=document.querySelector(".font-filter-input");fi=angular.element(fi);var fs=document.querySelector("#fnt-select");fs=angular.element(fs);var fsi=document.querySelector("#fs-input");fsi=angular.element(fsi),scope.closeSelect=function(){scope.fontFilter="",fp.addClass("closed"),fi[0].blur()},fi.bind("keydown keypress",function(event){(27===event.which||13===event.which)&&scope.closeSelect()});var fd=document.getElementById("fnt-draggable");fd=angular.element(fd),fd.on("mousedown touchend",function(e){scope.closeSelect()}),fp.parent().on("mousedown touchend",function(e){var tag=e.target.tagName,ids=["fnt-filter","fnt-select","flt-icon","flt-icon-svg","filter-use"];"UL"===tag||"LI"===tag||e.target.id&&-1!==ids.indexOf(e.target.id)||scope.closeSelect()});var fl=document.querySelector(".font-list");fl=angular.element(fl),fl.on("scroll",function(e){var tag=e.target.tagName;"UL"===tag&&e.target.id&&"fnt-list"===e.target.id&&fi[0].focus()});var fu=document.getElementById("filter-use");scope.selectFont=function($event,font,fontObject){var fl=document.querySelector(".font-list"),vp=fl.getBoundingClientRect(),rt=vp.left+fl.offsetWidth-(angular.isUndefined($event.pageX)?$event.changedTouches[0]||{}:$event).pageX;if(fl=angular.element(fl),rt>=20){var fontID=scope.selectedTextField[0].id.replace(/text-/,"text-wrapper-");$log.debug("Changing font to: ***"+font+"***"),scope.usedFonts[font]||(scope.usedFonts[font]=fontObject),logoData.usedStyles.usedLastFont=font;var history={id:fontID,oldFont:scope.currentFont,newFont:font,type:"fontChange",data:{}};scope.$root.send("addHistory",history),scope.currentFont=font,scope.tID=$timeout(function(){scope.toggleSelect(),scope.$root.send("refreshSelectedObjectEffects")},0)}else $event.preventDefault()},scope.toggleSelect=function($event){if($timeout.cancel(scope.tID),fp.hasClass("closed")&&scope.fpVisible){fl.css({visibility:"hidden",top:"71px",bottom:"auto"}),fp.removeClass("closed"),fp.removeClass("up");var ht,flRect=fl[0].getBoundingClientRect(),fpRect=fp[0].getBoundingClientRect(),pRect=fp[0].parentNode.getBoundingClientRect(),builderH=555,fpTop=Math.abs(fpRect.top-pRect.top)+40;if(fpTop>builderH/2){fp.addClass("up");var btm=flRect.top-fpRect.top+40;fl.css({top:"auto",bottom:btm+"px"}),ht=fpTop-40}else ht=builderH-fpTop-40;var rows=Math.floor(ht/35),newHeight=35*rows;fl.css("max-height",newHeight+"px"),$timeout(function(){var sel=document.querySelector(".font-list li.selected");sel&&(sel.parentNode.scrollTop=sel.offsetTop),document.querySelector(".font-filter-input").focus(),fl.css("visibility","visible")})}else scope.fontFilter="",fp.addClass("closed")},scope.$watch("fontFilter",function(newval,oldval){newval&&(fl[0].scrollTop=0)}),scope.$watch("fontSize",function(newval,oldval){}),scope.clearFilter=function(){$timeout.cancel(scope.tID),scope.fontFilter="",$timeout(function(){var sel=document.querySelector(".font-list li.selected");sel&&(sel.parentNode.scrollTop=sel.offsetTop),document.querySelector(".font-filter-input").focus()})},scope.customFilter=function(items){var result={};return scope.fontFilter?(scope.usedFontFilter=!0,fu.setAttribute("transform","scale(.72)")):(scope.usedFontFilter=!1,fu.setAttribute("transform","scale(.92)")),angular.forEach(items,function(value,key){scope.fontFilter?(scope.filterIcon="#close-icon",0===key.toUpperCase().indexOf(scope.fontFilter.toUpperCase())&&(result[key]=value)):(scope.filterIcon="#search-icon",result[key]=value)}),result},scope.$onRootScope("startLoadingFont",function(e){scope.loadAnimation()}),scope.$onRootScope("stopLoadingFont",function(e){scope.loadAnimation(!0),scope.selectedTextField=scope.sel,scope.selectedTextField&&ss.renderFont(scope.selectedTextField[0])}),scope.$onRootScope("updateFontSize",function(e){scope.fontSize=scope.getFontSize()}),scope.$onRootScope("font-panel_changeFontWithId",function(e,id,font){scope.changeFontWithId(id,font),scope.skipCurrentFontWatchFunc=!0,scope.currentFont=font}),scope.$onRootScope("font-panel_changeLetterSpacingWithId",function(e,id,spacing){scope.updateSpacingWithId(id,spacing)}),scope.$onRootScope("font-panel_changeFontSizeWithId",function(e,id,currentSize,newSize){scope.changeFontSizeWithId(id,currentSize,newSize)}),scope.$onRootScope("font-panel_changeStyleWithId",function(e,id,style){scope.updateStyleWithId(id,style),"b"===style?scope.selectedBold=!0:"i"===style?scope.selectedItalic=!0:"z"===style?(scope.selectedBold=!0,scope.selectedItalic=!0):(scope.selectedBold=!1,scope.selectedItalic=!1)}),scope.$onRootScope("selectTextField",function(e,id){if(void 0!==id&&id){scope.sel=angular.element(document.getElementById(id)),scope.selectedTextField=scope.sel;var fnt=scope.sel.attr("data-font"),color=scope.sel.parent().attr("fill");logoData.usedStyles.usedLastFont=fnt,logoData.usedStyles.usedLastColor=color;var style=scope.sel.attr("data-style"),shape=scope.sel.attr("data-path");scope.setStyleVal(style),scope.setShapeVal(shape),scope.loadingFont=fnt,scope.currentFont=fnt,scope.letterSpacing=parseFloat(scope.sel.attr("data-letter-spacing")),scope.shapeSizing=parseFloat(scope.sel.attr("data-radius")||3),scope.fontSize=scope.getFontSize(),scope.send("updateRangeSlider","lspacing",scope.letterSpacing),scope.send("updateRangeSlider","ssizing",scope.shapeSizing)}else scope.loadingFont=null,scope.selectedTextField=null,scope.letterSpacing=0,scope.shapeSizing=3,scope.selectedNoShape=!0,scope.fontSize=16,fsi[0].blur(),scope.$applyAsync()}),scope.skipCurrentFontWatchFunc=!1,scope.$watch("currentFont",function(newval,oldval){if(newval&&oldval){if(scope.skipCurrentFontWatchFunc)scope.skipCurrentFontWatchFunc=!1;else{var regex=/Loading\ Font/g,newContainsLoading=null===newval.match(regex),oldContainsLoading=null===oldval.match(regex);if(oldContainsLoading&&newContainsLoading&&newval&&newval!==oldval&&scope.selectedTextField){var id=(scope.currentFont,scope.selectedTextField[0].id);scope.changeFontWithId(id,scope.currentFont)}}scope.$root.send("refreshSelectedObjectEffects")}})}}})}),define("directives/editor/Grid",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.directives.Grid",[]).directive("grid",function($log){return{template:function(){return'<div><canvas width="{{gridW}}" height="{{gridH}}"></canvas></div>'},restrict:"E",replace:!0,link:function(scope,element,attrs){function drawGridLines(cnv,lineOptions){var ctx=cnv.getContext("2d");ctx.strokeStyle=lineOptions.color,ctx.strokeWidth=1,ctx.beginPath();var iCount=null,i=null,x=null,y=null;for(iCount=Math.floor(scope.gridW/lineOptions.separation),i=1;iCount>=i;i++)x=i*lineOptions.separation,x=Math.floor(x)+.5,ctx.moveTo(x,0),ctx.lineTo(x,scope.gridH),ctx.stroke();for(iCount=Math.floor(scope.gridH/lineOptions.separation),i=1;iCount>=i;i++)y=i*lineOptions.separation,y=Math.floor(y)+.5,ctx.moveTo(0,y),ctx.lineTo(scope.gridW,y),ctx.stroke();ctx.closePath()}scope.gridW=element[0].clientWidth,scope.gridH=element[0].clientHeight,$log.debug("grid info"),$log.debug(element[0].clientWidth),$log.debug(element[0].clientWidth),setTimeout(function(){drawGridLines(element.find("canvas")[0],{color:attrs.color||"#cccccc",separation:parseFloat(attrs.separation)||15})},0)}}})}),define("directives/editor/LogoEditor",["angular","transform-dom","transform","svgjs"],function(angular,senocular,senoc,svgjs){"use strict";angular.module("logoBuilderApp.directives.LogoEditor",[]).directive("logoEditor",function($log,$rootScope,svgService,EditorCommonService,EditorEffectsService,logoData,lgApi,$timeout,$q,SymbolFacade,SharedCode,wizardService,historyService,lgSiteApi,trackTargetIds,appConfig){function prepareToEdit(stageReadyDefer,industry,symbol){logoData.industry=industry.id&&{id:industry.id,name:industry.name,keywords:industry.main_keyword}||{},logoData.industry.idDefault=appConfig.firstTimeIndustryId,logoData.symbol_ID=symbol.id,logoData.svg_content=symbol.svgContent,logoData.currentSymbol={id:symbol.id},stageReadyDefer.resolve(logoData)}function loadDefaultFirstTimeSymbol(stageReadyDefer){SymbolFacade.loadDefaultFirstTimeSymbol().then(function(response){logoData.selectedSymbol=response.symbol.svgContent,prepareToEdit(stageReadyDefer,{},{id:response.symbol.id,svgContent:response.symbol.svgContent})})}function initEditor(){var stageReadyDefer=$q.defer();return svgService.loadResource(lgApi.getLocationUrl("scripts/fonts.json")).then(function(data){if(logoData.fontList=data,logoData.editing)lgApi.loadLogo(logoData.apiVars.logo_id).then(function(response){var data=response.data.data;prepareToEdit(stageReadyDefer,{id:data.logo_data.industry_id,name:data.industry_name},{id:data.logo_data.symbol_id,svgContent:data.logo_data.svg_content})});else if(window.apiVars.preload_logo_texts){try{window.apiVars.preload_logo_texts=JSON.parse('"'+window.apiVars.preload_logo_texts.replace(/\\'/g,"'")+'"')}catch(e){console.log(e),window.apiVars.preload_logo_texts=""}$rootScope.data.businessName=window.apiVars.preload_logo_texts||$rootScope.data.businessName,SymbolFacade.findFirstSymbolBySequenceKeywordScanning(window.apiVars.preload_industry_id,window.apiVars.preload_logo_texts).then(function(response){return!window.apiVars.preload_industry_id&&response.data.is_industry?loadDefaultFirstTimeSymbol(stageReadyDefer):(logoData.selectedSymbol=response.symbol.svgContent,logoData.predefinedSearchData=response.data,void prepareToEdit(stageReadyDefer,response.data.is_industry&&{id:response.industry.id,name:response.industry.name}||{},{id:response.symbol.id,svgContent:response.symbol.svgContent}))})}else loadDefaultFirstTimeSymbol(stageReadyDefer)}),stageReadyDefer.promise}function getSVGElementID(){return"#svg"}return logoData.apiVars=window.apiVars||{},logoData.editing=logoData.apiVars.logo_id?!0:!1,logoData.usedStyles=logoData.usedStyles||{},wizardService.startLoader(),{template:"",restrict:"A",scope:{transformTool:"=",targets:"=",id:"@id",customFont:"@customfont",customSymbol:"@customsymbol",tinyList:"@tinylist"},link:function(scope,element,attrs,ngModel){function stopLgLoadingProgress(){if(window.__lg_loading_progress__){var progressElement=window.__lg_loading_progress__;delete window.__lg_loading_progress__,$(progressElement.el).fadeOut("normal",function(){progressElement.stop(),$("#EditorControl > div.overlay-content").fadeOut("slow")})}}function removeSelectedTextElement(){"true"===scope.selectedItem.item.getAttribute("data-distress")&&EditorEffectsService.toggleDistress(scope),"true"===scope.selectedItem.item.getAttribute("data-reflection")&&EditorEffectsService.toggleReflection(scope),"true"===scope.selectedItem.item.getAttribute("data-shadow")&&EditorEffectsService.toggleShadow(scope),"true"===scope.selectedItem.item.getAttribute("data-shine")&&EditorEffectsService.toggleShine(scope);var ok=removeStageElementById("text-wrapper-"+scope.selectedItem.item.id.split("-").pop());return ok&&deselectItem(),ok}function removeStageElementById(id){try{$("#"+id).remove(),scope.$root.send("removeDisplayListItem",id,scope.transformTool.tool),svgService.removeTextFromLogoData(id.replace(/-wrapper/,""))}catch(err){return $log.error("ERROR in removeStageElementById: ",err),!1}return!0}function removeElement(){var app=scope.transformTool,id="text-wrapper-"+scope.selectedItem.item.id.split("-").pop(),history={id:id,type:"removeText",oldNode:document.getElementById(id).cloneNode(!0),data:{}};scope.$root.send("addHistory",history);var elemType=getSelectedElementType();if("text"===elemType){removeSelectedTextElement(),logo.numTextfields--;var idIndex=app.displayIDHash.indexOf(id);app.displayIDHash.splice(idIndex,1),scope.$root.send("transform-tool_removeTarget",id)}}function removeTextElementById(id){var ok=(document.getElementById(id),removeStageElementById(id));ok&&deselectItem(),logo.numTextfields--;var app=scope.transformTool,idIndex=app.displayIDHash.indexOf(id);app.displayIDHash.splice(idIndex,1)}function changeColor(hex){var thisType=getSelectedElementType();if("symbol"===thisType){logoData.symbol.color="#"+hex,scope.$root.send("changeBgColor",logoData.symbol.color);var targetElem=scope.selectedItem.item.parentNode.querySelector("#symbol-bg-base")||scope.selectedItem.item,oldColor=targetElem.getAttribute("fill"),newColor="#"+hex,id=targetElem.id,history={id:id,type:"colorChange",oldColor:oldColor,newColor:"#"+hex,data:{}};scope.$root.send("addHistory",history),colorChangeWithId(id,newColor)}else{var textIndex=scope.selectedItem.item.id.split("-").pop(),id="text-wrapper-"+textIndex,tw=document.querySelector("#"+id),oldColor=tw.getAttribute("fill"),newColor="#"+hex,history={id:id,type:"colorChange",oldColor:oldColor,newColor:newColor,data:{}};if(scope.$root.send("addHistory",history),colorChangeWithId(id,newColor),scope.selectedItem.reflection){var trw=document.querySelector("#text-reflection-wrapper-"+textIndex);trw.setAttribute("fill","#"+hex),trw.setAttribute("stroke","#"+hex)}}}function colorChangeWithId(id,newColor){var elem=document.getElementById(id);!model.states.isBackgroundActive&&id&&0===id.indexOf("symbol-")?svgService.setSymbolColorStyles(newColor):(elem.setAttribute("data-fill",newColor),elem.setAttribute("fill",newColor),elem.hasAttribute("stroke")&&elem.getAttribute("stroke")&&elem.setAttribute("stroke",newColor))}function getOverlappingAreaRatio(rect1,rect2){return Math.max(0,Math.min(rect1[2],rect2[2])-Math.max(rect1[0],rect2[0]))*Math.max(0,Math.min(rect1[3],rect2[3])-Math.max(rect1[1],rect2[1]))}function getSceneElementsBBoxes(){var bboxes=[];return scope.transformTool.displayList.forEach(function(e){var bbox=svgjs.adopt(e.image).tbox();bboxes.push([bbox.x,bbox.y,bbox.x2,bbox.y2,bbox.width,bbox.height])}),bboxes}function getSceneFreeSpace(width,height){for(var i,someX,someY,ovrRatio,GRID_PADDING=40,GRID_WIDTH=738,GRID_HEIGHT=365,MAX_ITERATIONS=100,passIndex=MAX_ITERATIONS,rects=getSceneElementsBBoxes(),isWasAnyZeroOverlap=!1,minOvrRatioX=width,minOvrRatioY=height,bestX=width,bestY=height,bestDist=1e10,minOvrRatio=1e10;passIndex--;){for(someX=GRID_PADDING+Math.random()*(GRID_WIDTH-width-GRID_PADDING),someY=GRID_PADDING+Math.random()*(GRID_HEIGHT-height-GRID_PADDING),ovrRatio=0,i=0;i<rects.length;i+=1)ovrRatio+=getOverlappingAreaRatio([someX,someY,width+someX,height+someY,width,height],rects[i]);minOvrRatio>=ovrRatio&&(minOvrRatio=ovrRatio,minOvrRatioX=someX,minOvrRatioY=someY,0==ovrRatio&&bestDist>Math.sqrt(someX*someX+someY*someY)&&(bestDist=Math.sqrt(someX*someX+someY*someY),bestX=someX,bestY=someY,isWasAnyZeroOverlap=!0))}return[~~(isWasAnyZeroOverlap?bestX:minOvrRatioX),~~(isWasAnyZeroOverlap?bestY:minOvrRatioY)]}function addTextfield(isShape,customMatrix,id,addHistory){var DEFAULT_TEXT_WIDTH=90,DEFAULT_TEXT_HEIGHT=35,PADDING_WIDTH=80,PADDING_HEIGHT=30,bestFreePosition=getSceneFreeSpace(DEFAULT_TEXT_WIDTH+PADDING_WIDTH,DEFAULT_TEXT_HEIGHT+PADDING_HEIGHT),theMatrix="matrix(3,0,0,3,"+(bestFreePosition[0]+(PADDING_WIDTH>>1))+","+(bestFreePosition[1]+(PADDING_HEIGHT>>1))+")",newTextID=0;newTextID=null!==id&&void 0!==id?id:generateTextfieldID();var addHist=!0;void 0!==addHistory&&null!==addHistory&&(addHist=addHistory),null!==customMatrix&&void 0!==customMatrix&&""!==customMatrix&&(theMatrix=customMatrix);var stockText={text:"Text",mtx:theMatrix,font:logoData.usedStyles.usedLastFont||"Open Sans",color:logoData.usedStyles.usedLastColor||"#000000"};svgService.addTextfield(stockText,newTextID,isShape,addHist);var fullID="text-wrapper-"+newTextID,textIdIndex=scope.targets.indexOf(fullID);textIdIndex>-1&&scope.targets.splice(textIdIndex),scope.targets.push(fullID),logo.numTextfields++,svgService.renderFont(document.getElementById("text-"+newTextID)),scope.$root.send("updateDisplayList",!1),scope.$root.send("selectTextField","text-"+newTextID),scope.$parent.selectWithTool("#text-wrapper-"+newTextID)}function onTextContentChange(e){var ENTER_KEY=13,key=e.keyCode?e.keyCode:e.which;key===ENTER_KEY&&updateText(e)}function onTextContentBlur(e){updateText(e)}function updateText(e){e.preventDefault(),document.removeEventListener("keypress",onTextContentChange);var textInput=document.querySelector("#svg-edit-text");textInput.removeEventListener("blur",onTextContentBlur);var thisText=scope.selectedItem.item,content=(textInput.value||"").trim(),maxlength=100;if(content.length>maxlength&&(content=content.substring(0,maxlength)),content.length>=1){var oldText=thisText.getAttribute("data-content");if($log.debug("oldText:",oldText,"newText:",content),oldText!=content){var history={id:thisText.parentNode.getAttribute("id"),type:"textChange",oldText:oldText,data:""},_scope=angular.element(document.getElementById("svg")).scope();_scope.send("addHistory",history),thisText.setAttribute("data-content",content),svgService.renderFont(thisText)}}textInput.parentNode.removeChild(textInput);var inputWrapper=document.querySelector(".blur-click-blocker");inputWrapper.parentNode.removeChild(inputWrapper),selectItem("#"+thisText.id),scope.$parent.hideTheTips(),$(thisText).css("opacity",""),scope.$root.send("refreshSelectedObjectEffects")}function editText(){var thisText=scope.selectedItem.item;
$(thisText).css("opacity","0.1");var poly=angular.element(getTransformToolPolygon());poly.css("opacity","1");var lt=0,tp=1,wt=scope.transformTool.tool.target.width,ht=scope.transformTool.tool.target.height,m=scope.transformTool.tool.target.matrix,content=thisText.getAttribute("data-content"),inputWrapper=document.createElement("div");inputWrapper.setAttribute("class","blur-click-blocker");var textInput=document.createElement("input"),iParent=document.querySelector("#bottomPane"),inputRealWidth=m.a*wt+m.c*ht+m.x,inputW=wt;inputRealWidth>739&&(inputW=(739-m.c*ht-m.x)/m.a),m=m.toString(),textInput.setAttribute("style","left: "+lt+"px; top: "+tp+"px; width: "+inputW+"px; height: "+(ht+0)+"px; -webkit-transform-origin: 0 0; -webkit-transform: "+m+";-moz-transform-origin: 0 0; -moz-transform: "+m+";-ms-transform-origin: 0 0; -ms-transform: "+m+"; transform-origin: 0 0; transform: "+m),textInput.setAttribute("type","text"),textInput.setAttribute("id","svg-edit-text"),textInput.setAttribute("value",content),textInput.setAttribute("name","new-text"),iParent.appendChild(inputWrapper),iParent.appendChild(textInput),textInput.focus(),textInput.setSelectionRange(0,content.length),document.addEventListener("keypress",onTextContentChange),textInput.addEventListener("blur",onTextContentBlur)}function deselectItem(){selectItem(null)}function selectItem(thisItem){if(thisItem){if(scope.selectedItem.item===document.querySelector(thisItem))return;scope.selectedItem.item=document.querySelector(thisItem),moveSelectedItemToTop(),"text"===getSelectedElementType()?scope.$root.send("selectTextField","text-"+scope.selectedItem.item.id.split("-").pop()):(scope.$root.send("selectTextField"),scope.$parent.hideTheTips("symbol"))}else scope.selectedItem.item=null,scope.$root.send("selectTextField"),scope.$parent.uncheckAll();$timeout(function(){EditorEffectsService.updateFXButtons(scope)},0)}function initStage(){if(logoData.glyphUsePool.length<1&&svgService.stockGlyphUsePool(),logoData.editing||logoData.swappingSymbol){findExistingLogoElements();var stage=document.querySelector(getSVGElementID());stage.hasAttributeNS("xmlns","xlink")||stage.setAttributeNS(svgjs.xmlns,"xmlns:xlink",svgjs.xlink);var lastTextElement=$("g[id^=text-wrapper-] > g[id^=text-]",stage).last().get(0);!lastTextElement||logoData.usedStyles.usedLastColor||logoData.usedStyles.usedLastFont||(logoData.usedStyles={usedLastColor:lastTextElement.parentNode.getAttribute("fill"),usedLastFont:lastTextElement.getAttribute("data-font")});var symbol=document.querySelector("#symbol-wrapper-1"),symbolCenter=svgService.getReferenceCenter(stage,symbol);if(scope.transformTool.tool.setTarget(null),scope.transformTool.selectImage(symbolCenter.x,symbolCenter.y),scope.transformTool.renderSelected(),logoData.symbol.bgid>0){var bgid=Number(logoData.symbol.bgid);EditorEffectsService.removeSymbolBG(scope,logoData.symbol.bgid),EditorEffectsService.addSymbolBG(scope,bgid)}else svgService.setSymbolColorStyles(logoData.props[0].fill);if("true"===logoData.props[0].distress&&(EditorEffectsService.removeSymbolDistress("1",scope),EditorEffectsService.addSymbolDistress("1",scope)),"true"===logoData.props[0].shine&&(EditorEffectsService.removeSymbolShine("1",scope),EditorEffectsService.addSymbolShine("1",scope)),"true"===logoData.props[0].shadow,"true"===logoData.props[0].reflection,logoData.editing){var textIds=scope.targets.filter(function(t){return 0===t.indexOf("text-")}).map(function(t){return"#text-"+t.match(/-([\d]+)/)[1]});textIds.length?textIds.forEach(function(textId){svgService.renderFont($(textId)[0]).then(function(){stopLgLoadingProgress(),svgService.renderFont($(textId)[0],!0)})}):stopLgLoadingProgress()}}else createNewLogo();logoData.isSwappingSymbol||scope.$root.send("stageReady")}function resetSymbolOriginPositionInWrapper(symbolNumber){var symbol=svgjs.get("gsymbol-"+symbolNumber),bbox=symbol&&symbol.bbox()||null;bbox&&symbol.translate(-bbox.x,-bbox.y)}function createNewLogo(){$log.debug("customfont"),$log.debug(scope.customFont),$log.debug("customsymbol"),$log.debug(scope.customSymbol),stage=document.getElementById("svg"),stage.hasAttributeNS("xmlns","xlink")||stage.setAttributeNS(svgjs.xmlns,"xmlns:xlink",svgjs.xlink);var symbolNumber=1,sw=document.createElementNS(svgjs.ns,"g");sw.setAttribute("id","symbol-wrapper-"+symbolNumber),stage.appendChild(sw);var sb=document.createElementNS(svgjs.ns,"g");sb.setAttribute("id","symbol-bg-wrapper-"+symbolNumber);var symbol=document.createElementNS(svgjs.ns,"g");symbol.setAttribute("id","symbol-"+symbolNumber),symbol.appendChild(svgService.transformToCompatibleSvg(scope.$root.data.selectedSymbol)),angular.element(symbol).attr({fill:logoData.symbol.color,cursor:"default","data-distress":!1,"data-reflection":!1,"data-shadow":!1,"data-shine":!1,"data-element-type":"symbol"}),sb.appendChild(symbol),sw.appendChild(sb),$(element[0]).prepend(stage);var thisBBox=sw.getBBox(),scaleValue=1;logoData.symbol.defaultWidth=thisBBox.width,logoData.symbol.defaultHeight=thisBBox.height,logoData.symbol.initScale=scaleValue=svgService.getMaxScale(thisBBox.width,thisBBox.height,logoData.SYMBOL_MAX_DEFAULT_WIDTH,logoData.SYMBOL_MAX_DEFAULT_HEIGHT),"true"===scope.tinyList&&(scaleValue=.3),resetSymbolOriginPositionInWrapper(symbolNumber),symbol.setAttribute("transform","scale("+scaleValue+")");var swMatrix,symbolScale=1,initX=0,initY=10;void 0===scope.tinyList&&(initX=logoData.SYMBOL_DEFAULT_X-logoData.symbol.initScale*thisBBox.width/2,initY=logoData.SYMBOL_DEFAULT_Y-logoData.symbol.initScale*thisBBox.height/2),swMatrix="matrix("+symbolScale+", 0, 0, "+symbolScale+", "+initX+", "+initY+")",sw.setAttribute("transform",swMatrix),scope.targets&&scope.targets.push("symbol-wrapper-1");var i,newTextID,defaultTextFields=generateTextDefaults();for(i=0;i<defaultTextFields.length;i++)newTextID=generateTextfieldID(),svgService.addTextfield(defaultTextFields[i],newTextID,!1,!1),scope.targets&&scope.targets.push("text-wrapper-"+newTextID),logo.numTextfields++,svgService.renderFont(document.getElementById("text-"+newTextID));logoData.swappingSymbol=!0}function findExistingLogoElements(){var textIds=[];stage=document.querySelector(getSVGElementID());for(var i=1;i<logoData.props.length;i++)if(scope.targets.push("text-wrapper-"+logoData.props[i].tid),textIds.push(parseInt(logoData.props[i].tid)),9==EditorCommonService.getIEVersion()||10==EditorCommonService.getIEVersion()){var innerText=document.querySelector("#text-"+logoData.props[i].tid);if(resetTextUseElements(innerText),"true"===logoData.props[i].distress){var dUse=document.querySelector("#text-distress-use-"+logoData.props[i].tid),dLink=dUse.getAttributeNS("xlink","href");dUse.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",dLink)}if("true"===logoData.props[i].reflection){var rUse=document.querySelector("#text-reflection-use-"+logoData.props[i].tid),rLink=rUse.getAttributeNS("xlink","href");rUse.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",rLink)}if("true"===logoData.props[i].shadow){var innerShadow=document.querySelector("#text-shadow-"+logoData.props[i].tid);resetTextUseElements(innerShadow)}if("true"===logoData.props[i].shine){var sUse=document.querySelector("#text-shine-use-"+logoData.props[i].tid),sLink=sUse.getAttributeNS("xlink","href");sUse.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",sLink);var innerShine=document.querySelector("#text-shine-clone-"+logoData.props[i].tid);resetTextUseElements(innerShine)}}textIds.length>0&&(textIds.sort(function(a,b){return a-b}),logo.lastTextId=textIds.slice(-1));var symbol=document.querySelector("#symbol-1");if(logoData.swappingSymbol){for(;symbol.lastChild;)symbol.removeChild(symbol.lastChild);symbol.appendChild(logoData.symbol.content)}var symbolClone=symbol.cloneNode(!0);symbolClone.setAttribute("id","symbol-clone"),symbolClone.removeAttribute("transform"),stage.appendChild(symbolClone);var cloneBox=symbolClone.getBBox();logoData.symbol.defaultWidth=cloneBox.width,logoData.symbol.defaultHeight=cloneBox.height,logoData.symbol.initScale=svgService.getMaxScale(cloneBox.width,cloneBox.height,logoData.SYMBOL_MAX_DEFAULT_WIDTH,logoData.SYMBOL_MAX_DEFAULT_HEIGHT),stage.removeChild(symbolClone),symbolClone=null,scope.targets.push("symbol-wrapper-1"),logoData.symbol.bgid=parseInt(logoData.props[0].bgid),logoData.symbol.bgid>0?(logoData.symbol.bg[logoData.symbol.bgid-1]=!0,$timeout(function(){scope.$root.send("setBackgroundButton",logoData.symbol.bgid)},0)):symbol.setAttribute("transform","scale("+logoData.symbol.initScale+")"),resetSymbolOriginPositionInWrapper("1"),EditorCommonService.getIEVersion()>9&&"true"===logoData.props[0].distress&&EditorCommonService.addIERect(),logoData.symbol.color=logoData.props[0].fill,logoData.swappingSymbol=!0,scope.$parent.hideLoader()}function resetTextUseElements(charGroup){charGroup.childNodes}function generateTextDefaults(){var defaults=[],theFont="Open Sans",theMatrix="matrix(3,0,0,3,240,230)";return void 0!==scope.customFont&&(theFont=scope.customFont,$log.debug("Loading default with font: "+theFont)),"true"===scope.tinyList&&(theMatrix="matrix(1.05,0,0,1.05,70,50)"),defaults.push({text:scope.$root.data.businessName||"Your name here",mtx:theMatrix,font:theFont}),logoData.editing?[]:defaults}function generateTextfieldID(){return++logo.lastTextId}function moveSelectedItemToTop(){var thisItem,thisItemShine,thisIDNumber=scope.selectedItem.item.id.split("-").pop(),doShine=!1;scope.selectedItem&&"regular-text"===scope.selectedItem.item.getAttribute("data-element-type")?(thisItem=document.querySelector("#text-wrapper-"+thisIDNumber),thisItem.parentNode.removeChild(thisItem)):"symbol"===scope.selectedItem.item.getAttribute("data-element-type")&&("true"===scope.selectedItem.item.getAttribute("data-distress")?(thisItem=document.querySelector("#symbol-distress-wrapper-"+thisIDNumber),thisItem.parentNode.removeChild(thisItem)):(thisItem=document.querySelector("#symbol-wrapper-"+thisIDNumber),thisItem.parentNode.removeChild(thisItem),thisItemShine=document.querySelector("#symbol-shine-wrapper-"+thisIDNumber),null!==thisItemShine&&(thisItemShine.parentNode.removeChild(thisItemShine),doShine=!0))),document.querySelector(getSVGElementID()).appendChild(thisItem),doShine&&document.querySelector(getSVGElementID()).appendChild(thisItemShine)}function getSelectedElementType(){return scope.selectedItem.item.id.split("-")[0]}function getTransformToolPolygon(){return scope.transformTool.tool.container.querySelector("polygon")}function createStageSvgElement(){var stage=document.createElementNS(svgjs.ns,"svg");return stage.setAttribute("xmlns",svgjs.ns),stage.setAttribute("id","svg"),stage.setAttribute("version","1.1"),stage.setAttribute("baseProfile","full"),void 0===scope.tinyList&&(stage.setAttribute("width","100%"),stage.setAttribute("height","100%")),stage}var stage=null,svg=null,logo={numTextfields:0,lastTextId:0},model={states:{isBackgroundActive:!1}};scope.model=model,logoData.symbol={bgid:0,bg:[!1,!1,!1,!1,!1,!1],color:"#000000",initScale:1},scope.selectedItem=scope.$parent.selectedItem||{item:null,distress:!1,reflection:!1,shadow:!1,shine:!1},scope.stash={distress:!1,reflection:!1,shadow:!1,shine:!1},scope.$onRootScope("toggleFX",function(e,thisFX){if(scope.selectedItem.item)switch(thisFX){case"distress":EditorEffectsService.toggleDistress(scope);break;case"reflection":EditorEffectsService.toggleReflection(scope);break;case"shadow":EditorEffectsService.toggleShadow(scope);break;case"shine":EditorEffectsService.toggleShine(scope)}}),scope.$onRootScope("logo-editor_updateSymbolBG",function(e,newSymbol,addHistory){EditorEffectsService.updateSymbolBG(scope,newSymbol,addHistory)}),scope.$onRootScope("logo-editor_removeTextElementById",function(e,id){removeTextElementById(id)}),scope.$onRootScope("toolReady",function(e,tool){scope.transformTool=tool,scope.transformTool.setSelectedItem=selectItem}),scope.$onRootScope("symbolBgChanged",function(e){EditorEffectsService.getSelectedSymbolBG(scope,!1)}),scope.$onRootScope("removeElem",function(e){removeElement()}),scope.$onRootScope("logo-editor_removeStageElem",function(e,item){removeStageElementById(item)}),scope.$onRootScope("logo-editor_deselect",function(e,item){setTimeout(function(){deselectItem()},0)}),scope.$onRootScope("toolDoubleclick",function(e){scope.selectedItem.item&&"text"===getSelectedElementType()&&editText()}),scope.$onRootScope("initStage",function(e){svg=svgjs(getSVGElementID().substr(1)),initStage()}),scope.$onRootScope("addRegularText",function(e){addTextfield(!1,null)}),scope.$onRootScope("logo-editor_changeColorWithId",function(e,id,color){colorChangeWithId(id,color)}),scope.$onRootScope("logo-editor_addRegularTextWithData",function(e,data){addTextfield(!1,data.matrix,data.id,!1)}),scope.$onRootScope("stashTextEffects",function(e){scope.transformTool&&scope.transformTool.tool.target&&EditorEffectsService.stashTextEffects(scope)});var isPositionAligned=!1;scope.$onRootScope("renderAfterLoadingFont",function(e){scope.targets||svgService.renderFont(document.getElementById("text-1")),lgSiteApi.trafficTrackOnce(trackTargetIds.LOADED),stopLgLoadingProgress(),isPositionAligned||logoData.editing||(isPositionAligned=!0,$rootScope.send("transform-tool_alignObjects","symbol-wrapper-1","text-wrapper-1",[.5,.5]))}),scope.$onRootScope("reinstateTextEffects",function(e){EditorEffectsService.reinstateTextEffects(scope)}),scope.$onRootScope("refreshAllObjectsEffects",function(e){EditorEffectsService.refreshAllObjectsEffects(scope)}),scope.$onRootScope("refreshSelectedObjectEffects",function(e){EditorEffectsService.refreshSelectedObjectEffects(scope)}),scope.$onRootScope("recalculateTextEffects",function(e){EditorEffectsService.recalculateTextEffects(scope)}),scope.$onRootScope("addShapeText",function(e){addTextfield(!0,null)}),scope.$onRootScope("changeColor",function(e,hex){scope.selectedItem.item&&($rootScope.$broadcast("colorpicker:setSwatchColor",hex),changeColor(hex))}),scope.$onRootScope("recalculateToolRectangle",function(){var histItem=historyService.getLastUndoHistoryItem()||historyService.getCurrentHistoryItem();if(histItem){var obj=document.querySelector("#"+histItem.id),objCenter=svgService.getReferenceCenter(stage,obj);(scope.transformTool.displayList||[]).forEach(function(picture){var bbox=picture.image.getBBox();picture.transform.width=bbox.width,picture.transform.height=bbox.height}),scope.transformTool.selectImage(-1,-1),scope.transformTool.selectImage(objCenter.x,objCenter.y),scope.transformTool.renderSelected()}}),svgService.loadSVG(lgApi.getLocationUrl("images/fx.svg")).then(function(doc){stage=createStageSvgElement(),initEditor().then(function(){EditorEffectsService.loadFXDefs(scope,stage,element,doc)&&initStage()})})}}})}),define("directives/editor/SymbolEffects",["angular","svgjs"],function(angular,svgjs){"use strict";angular.module("logoBuilderApp.directives.SymbolEffects",[]).directive("symbolEffects",function($rootScope,$log,logoData,svgService){return{template:"<div></div>",scope:{showTooltip:"&"},restrict:"E",replace:!0,link:function(scope,element,attrs){function removeButtons(){$("#symbol-bg-selector-glow-div").remove(),$("#symbol-bg-selector-container").remove()}function initSymbolBackgroundButtons(e){document.getElementsByClassName("lg-select-symbols-effects").length&&(angular.element(document.getElementsByClassName("lg-select-symbols-effects")[0]).addClass("active"),document.getElementsByClassName("lg-select-symbols-effects")[0].getElementsByClassName("lg-select-option-bg")[0].removeAttribute("style")),removeButtons(),createButtonGlow(),createButtons(),document.getElementsByClassName("lg-select-symbols-effects").length&&(angular.element(document.getElementsByClassName("lg-select-symbols-effects")[0]).removeClass("active"),document.getElementsByClassName("lg-select-symbols-effects")[0].getElementsByClassName("lg-select-option-bg")[0].removeAttribute("style")),scope.RGB&&3===scope.RGB.length&&setBgColor("#"+scope.RGB.map(function(v){return(16>v?"0":"")+v.toString(16)}).join(""))}var svgRootElement=null,svgWidth=58,svgHeight=396,buttonScale=.46,glowScale=.04,bgSpacing=62,numBgs=6,offsetTop=(svgHeight-numBgs*bgSpacing)/2,glowColor="#"+logoData.apiVars.partner_color_1||"#8F0887",ld=logoData,thisP=document.createElement("p");thisP.innerHTML="",element[0].appendChild(thisP);var currentBG=0,createButtonGlow=function(){var glowDiv=document.createElement("div");glowDiv.setAttribute("id","symbol-bg-selector-glow-div");var glowSVG=createBaseSVG();glowSVG.setAttribute("id","symbol-bg-selector-glow-container");var glowDefs=document.createElementNS("http://www.w3.org/2000/svg","defs"),glowFilter=document.createElementNS("http://www.w3.org/2000/svg","filter");glowFilter.setAttribute("id","symbol-bg-selector-glow-filter");var glowBlur=document.createElementNS("http://www.w3.org/2000/svg","feGaussianBlur");glowBlur.setAttribute("stdDeviation",3),glowFilter.appendChild(glowBlur),glowDefs.appendChild(glowFilter),glowSVG.appendChild(glowDefs),glowDiv.appendChild(glowSVG),element[0].appendChild(glowDiv);for(var i=0;numBgs>i;i++){var glowBase=document.querySelector("#symbol-bg-"+(i+1)).cloneNode(!0);glowBase.setAttribute("id","symbol-bg-glow-"+(i+1)),glowBase.querySelector(".symbol-bg-trim").setAttribute("fill",glowColor),glowBase.querySelector(".symbol-bg-trim").removeAttribute("filter"),glowBase.querySelector(".symbol-bg-base").setAttribute("fill",glowColor),glowBase.setAttribute("filter","url(#symbol-bg-selector-glow-filter)"),glowBase.setAttribute("visibility","hidden"),glowSVG.appendChild(glowBase);var baseBox=glowBase.getBoundingClientRect(),bgOffset=Number(glowBase.getAttribute("data-offset-y")),buttonOffsetY=offsetTop+i*bgSpacing-glowScale*baseBox.height*buttonScale/2,buttonOffsetX=(svgWidth-baseBox.width*buttonScale)/2+bgOffset-glowScale*baseBox.width*buttonScale/2;glowBase.setAttribute("transform","translate("+buttonOffsetX+", "+buttonOffsetY+") scale("+buttonScale*(1+glowScale)+")")}},createButtons=function(){var thisSVG=createBaseSVG();thisSVG.setAttribute("id","symbol-bg-selector-container"),element[0].appendChild(thisSVG);var baseColor,theSymbol=document.querySelector("#symbol-1"),firstChild=theSymbol.parentNode.firstChild;baseColor=theSymbol.id===firstChild.id?ld.symbol.color||"#000000":firstChild.querySelector(".symbol-bg-base").getAttribute("fill");for(var tempBox=theSymbol.getBBox(),i=0;numBgs>i;i++){var thisButton=document.querySelector("#symbol-bg-"+(i+1)).cloneNode(!0);thisButton.setAttribute("id","symbol-bg-button-"+(i+1)),thisButton.querySelector(".symbol-bg-base").setAttribute("fill",baseColor),thisButton.querySelector(".symbol-bg-trim").setAttribute("fill","url(#bg-button-gradient)"),thisButton.setAttribute("data-active","false"),thisButton.addEventListener("click",onBgClick),thisButton.addEventListener("mouseover",onBgMouseover),thisButton.addEventListener("mouseout",onBgMouseout);var symbolCopy=theSymbol.cloneNode(!0),symbolWrapper=document.createElementNS("http://www.w3.org/2000/svg","g");symbolWrapper.appendChild(symbolCopy),thisButton.setAttribute("cursor","pointer"),thisButton.appendChild(symbolWrapper),thisSVG.appendChild(thisButton);var initScale=getMaxScale(tempBox.width,tempBox.height,ld.SYMBOL_MAX_DEFAULT_WIDTH,ld.SYMBOL_MAX_DEFAULT_HEIGHT);symbolCopy.setAttribute("transform","scale("+initScale+")"),symbolCopy.setAttribute("id","symbol-bg-button-symbol-"+(i+1)),symbolCopy.setAttribute("pointer-events","none"),symbolCopy.removeAttribute("data-distress"),symbolCopy.removeAttribute("data-reflection"),symbolCopy.removeAttribute("data-shadow"),symbolCopy.removeAttribute("data-shine"),symbolCopy.removeAttribute("data-element-type");var baseBox=$("#symbol-bg-button-"+(i+1))[0].getBoundingClientRect(),symbolBox=symbolWrapper.getBoundingClientRect(),bgOffset=Number(thisButton.getAttribute("data-offset-y")),buttonOffsetX=(svgWidth-baseBox.width*buttonScale)/2+bgOffset;thisButton.setAttribute("transform","translate("+buttonOffsetX+", "+(offsetTop+i*bgSpacing)+") scale("+buttonScale+")");var symbolScale=getMaxScale(symbolBox.width,symbolBox.height,ld.SYMBOL_BG_STD_WIDTH*ld.SYMBOL_BG_INSET,ld.SYMBOL_BG_STD_HEIGHT*ld.SYMBOL_BG_INSET),xOffset=(baseBox.width-symbolBox.width*symbolScale)/2-bgOffset,yOffset=(baseBox.height-symbolBox.height*symbolScale)/2;symbolWrapper.setAttribute("transform","translate("+xOffset+", "+yOffset+") scale("+symbolScale+")"),svgService.setSymbolColorStyles("url(#bg-button-gradient)",svgjs.select("#symbol-bg-button-symbol-"+(i+1)).first())}},createBaseSVG=function(){var thisSVG=document.createElementNS("http://www.w3.org/2000/svg","svg");svgRootElement=svgjs("svg"),thisSVG.setAttribute("viewBox","0 0 "+svgWidth+" "+svgHeight),thisSVG.setAttribute("width",svgWidth),thisSVG.setAttribute("height",svgHeight);var thisDefs=document.createElementNS("http://www.w3.org/2000/svg","defs"),thisGrad=document.querySelector("#symbolGradient").cloneNode(!0);return thisGrad.setAttribute("id","bg-button-gradient"),thisDefs.appendChild(thisGrad),thisSVG.appendChild(thisDefs),thisSVG},deselectButton=function(thisBG){thisBG&&(document.querySelector("#symbol-bg-button-"+thisBG).setAttribute("data-active","false"),document.querySelector("#symbol-bg-glow-"+thisBG).setAttribute("visibility","hidden"))},onBgClick=function(e){var newBG=Number(this.id.split("-").pop());newBG===currentBG?(deselectButton(newBG),currentBG=0):(currentBG>0&&deselectButton(currentBG),currentBG=newBG,this.setAttribute("data-active","true"),document.querySelector("#symbol-bg-glow-"+newBG).setAttribute("visibility","visible")),scope.$root.send("symbolBgChanged",currentBG)},setActiveButton=function(bgid){deselectButton(currentBG),bgid&&(document.querySelector("#symbol-bg-button-"+bgid).setAttribute("data-active","true"),document.querySelector("#symbol-bg-glow-"+bgid).setAttribute("visibility","visible")),currentBG=bgid},onBgMouseover=function(e){scope.showTooltip();var thisBG=Number(this.id.split("-").pop());thisBG!==currentBG&&document.querySelector("#symbol-bg-glow-"+thisBG).setAttribute("visibility","visible")},onBgMouseout=function(e){var thisBG=Number(this.id.split("-").pop());thisBG!==currentBG&&deselectButton(thisBG)},setBgColor=function(color){for(var newColor=color||"#000000",i=0;numBgs>i;i++)document.querySelector("#symbol-bg-button-"+(i+1)).querySelector(".symbol-bg-base").setAttribute("fill",newColor)},getMaxScale=function(thisWidth,thisHeight,maxWidth,maxHeight){var widthScale=thisWidth>0?maxWidth/thisWidth:.5,heightScale=thisHeight>0?maxHeight/thisHeight:.5;return heightScale>widthScale?widthScale:heightScale};scope.$onRootScope("changeBgColor",function(e,hex){setBgColor(hex)}),scope.$onRootScope("setBackgroundButton",function(e,bgid){setActiveButton(bgid)}),scope.$onRootScope("logo-editor_updateSymbolBG",function(e,bgid){setActiveButton(bgid)}),scope.$onRootScope("symbol-effects_initButtons",initSymbolBackgroundButtons),scope.$onRootScope("stageReady",initSymbolBackgroundButtons)}}})}),define("directives/editor/TransformTool",["angular","transform-dom","transform","svgjs"],function(angular,senocular,senoc,svgjs){"use strict";var IE=-1;window.ie9||document.all&&!window.atob?IE=9:document.all&&window.atob?IE=10:navigator.userAgent.match(/Trident.*rv[ :]*11\./)?IE=11:navigator.userAgent.match(new RegExp("Edge/"))&&(IE=13),angular.module("logoBuilderApp.directives.TransformTool",[]).directive("transformTool",function($log,$timeout,svgService,logoData,historyService,pictureService,SvgTransformService,SvgSerializer,AlignmentObjectsService){return{template:'<svg  xmlns="http://www.w3.org/2000/svg"></svg>',restrict:"E",scope:{controls:"=",targets:"=",selected:"=",options:"="},replace:!0,transclude:!0,link:function(scope,element,attrs){function serializeLogo(){return curTransformTool&&curTransformTool.displayList?logoData.svg_content=SvgSerializer.Stringify(curTransformTool.displayList.map(function(pic){return pic.image.id})):null}function updateDisplayListTextFieldWithId(id,mtx){for(var textTarget=svgjs.adopt(document.getElementById(id)),stage=document.querySelector("#svg"),center=svgService.getReferenceCenter(stage,textTarget.node),bbox=textTarget.bbox(),tbox=textTarget.tbox(),i=0;i<curTransformTool.displayList.length;i++)curTransformTool.displayList[i].image.id===id&&null!==curTransformTool.tool.target&&(curTransformTool.displayList[i].transform.x=bbox.x,curTransformTool.displayList[i].transform.y=bbox.y,curTransformTool.displayList[i].transform.width=bbox.width,curTransformTool.displayList[i].transform.height=bbox.height,mtx&&(curTransformTool.displayList[i].transform.matrix=mtx));return{x:center.x,y:center.y,left:tbox.x,top:tbox.y}}var curTransformTool;scope.$watch("options",function(options){options&&curTransformTool&&options.align&&curTransformTool.setAlignmentBehaviorOptions(options.align.toStage,options.align.toObjects)},!0),scope.$onRootScope("transform-tool_spliceIDHash",function(e,index,num){scope.transformer.displayIDHash.splice(index,num)}),scope.$onRootScope("transform-tool_spliceIDHashWithID",function(e,id){scope.transformer.displayIDHash.splice(scope.transformer.displayIDHash.indexOf(id),1)}),scope.$onRootScope("transform-tool_removeTarget",function(e,id){$log.debug(scope.targets),$log.debug(id),$log.debug(scope.targets)}),scope.$onRootScope("undoHistory",function(e){historyService.undoHistory()}),scope.$onRootScope("redoHistory",function(e){historyService.redoHistory()}),scope.$onRootScope("addHistory",function(e,history){historyService.addHistoryItem(history)}),scope.$onRootScope("transform-tool_undoAllHistory",function(e){historyService.undoAllHistory()});var unwatchTargets=scope.$watch("targets",function(newval,oldval){newval&&(scope[attrs.variable]=curTransformTool=AlignmentObjectsService.TransformToolAlignmentDecorator(SvgTransformService.TransformTool,new SvgTransformService.TransformTool(scope,element,attrs)),unwatchTargets(),scope.$root.send("toolReady",curTransformTool))});scope.$onRootScope("rotateTarget",function(e,incr){if(curTransformTool.tool.target){var targetID=angular.element(document.getElementById("svg")).scope().selectedItem.item.id.replace(/(text-)/g,"text-wrapper-");targetID=targetID.replace(/symbol-/,"symbol-wrapper-");var history={id:targetID,type:"transform",oldMatrix:document.getElementById(targetID).getAttribute("transform"),data:{}},ttool=curTransformTool.tool,target=ttool.target,ocx=ttool.regX,ocy=ttool.regY,mtx=target.matrix,u=Math.cos(incr),v=Math.sin(incr),temp=mtx.a;mtx.a=u*mtx.a-v*mtx.b,mtx.b=v*temp+u*mtx.b,temp=mtx.c,mtx.c=u*mtx.c-v*mtx.d,mtx.d=v*temp+u*mtx.d,target.matrix=mtx,ttool.setTarget(null),ttool.setTarget(target);var ncx=ttool.regX,ncy=ttool.regY,ax=ncx-ocx,ay=ncy-ocy;mtx.x=mtx.x-ax,mtx.y=mtx.y-ay,target.matrix=mtx,ttool.setTarget(null),ttool.setTarget(target),curTransformTool.renderSelected(),scope.$root.send("addHistory",history),scope.$root.send("refreshSelectedObjectEffects")}}),scope.$onRootScope("transform-tool_UpdateMatrixWithString",function(e,id,newMatrix){var mtx=null,mtxArr=newMatrix.replace("matrix(","");mtxArr=mtxArr.replace(")",""),mtxArr=mtxArr.split(/[ ,]/);var mtxLen=mtxArr.length;6===mtxLen&&(mtx=new Matrix(parseFloat(mtxArr[0]),parseFloat(mtxArr[1]),parseFloat(mtxArr[2]),parseFloat(mtxArr[3]),parseFloat(mtxArr[4]),parseFloat(mtxArr[5])));var trans=null,len=scope.transformer.displayList.length,i=0;for(i=0;len>i;i++)scope.transformer.displayList[i].image.id===id&&(trans=scope.transformer.displayList[i]);var target=trans.transform;target.matrix=mtx;var ttool=scope.transformer.tool;ttool.setTarget(null),ttool.setTarget(target),scope.transformer.renderSelected()}),scope.$onRootScope("transform-tool_UpdateMatrix",function(e,id,newMatrix){var mtx=newMatrix,trans=null,len=scope.transformer.displayList.length,i=0;for(i=0;len>i;i++)scope.transformer.displayList[i].image.id===id&&(trans=scope.transformer.displayList[i]);var target=trans.transform;target.matrix=mtx;var ttool=scope.transformer.tool;ttool.setTarget(null),ttool.setTarget(target),scope.transformer.renderSelected()}),scope.$onRootScope("setTargetRotation",function(e,rot){if(curTransformTool.tool.target){var rad=curTransformTool.tool.target.matrix.getRotationX(),rotRad=svgService.deg2rad(parseFloat(rot)),incr=rotRad-rad;scope.$root.send("rotateTarget",incr)}}),scope.$onRootScope("prepareSave",function(e){IE>9&&logoData.symbol.shineRectHeight&&scope.resetIESymbolReflection(),scope.$parent.prepareSavedLogo(serializeLogo())}),scope.$onRootScope("prepareStash",function(e,step){serializeLogo(),scope.$parent.stashLogo(step)}),scope.resetIESymbolReflection=function(){var rMask=document.querySelector("#symbol-reflection-mask-1 rect");rMask.setAttribute("y",logoData.symbol.shineRectY),rMask.setAttribute("height",logoData.symbol.shineRectHeight)},scope.$onRootScope("transform-tool_serializeLogo",function(e){serializeLogo()}),scope.$onRootScope("updateDisplayList",function(e,renderAll){if(curTransformTool){renderAll=void 0===renderAll?!0:renderAll;for(var numTargets=scope.targets.length,i=0;numTargets>i;i++)if(curTransformTool.displayIDHash.indexOf(scope.targets[i])<0){var image=document.getElementById(scope.targets[i]);null!==image&&(curTransformTool.displayList.push(pictureService.create(scope.targets[i])),curTransformTool.displayIDHash.push(scope.targets[i]))}curTransformTool.tool.setTarget(null),scope.targets.length&&(logoData.editing||$timeout(function(){var selectItem=document.getElementById(scope.targets[numTargets-1]),stage=document.querySelector("#svg"),itemCenter=svgService.getReferenceCenter(stage,selectItem);curTransformTool.selectImage(itemCenter.x,itemCenter.y)},0)),renderAll?curTransformTool.render():curTransformTool.renderSelected()}}),scope.$onRootScope("removeDisplayListItem",function(e,id,ttool){for(var index=curTransformTool.displayList.length;index--;)if(curTransformTool.displayList[index].image.id===id){curTransformTool.displayList.splice(index,1),ttool.setTarget(null);break}}),scope.$onRootScope("updateDisplayListItem",function(e,id,newOptions){for(var i=0;i<curTransformTool.displayList.length;i++)if(curTransformTool.displayList[i].image.id===id){var mtx=new Matrix(parseFloat(newOptions.m.a),parseFloat(newOptions.m.b),parseFloat(newOptions.m.c),parseFloat(newOptions.m.d),parseFloat(newOptions.m.e+newOptions.adjust.x),parseFloat(newOptions.m.f+newOptions.adjust.y)),dm=svgService.decomposeMatrix(mtx);curTransformTool.displayList[i].transform.width=newOptions.w/dm.scaleX,curTransformTool.displayList[i].transform.height=newOptions.h/dm.scaleY,curTransformTool.displayList[i].transform.matrix=mtx,newOptions.tool.tool.setTarget(null),newOptions.tool.selectImage(newOptions.adjust.cx,newOptions.adjust.cy),curTransformTool.renderSelected()}}),scope.$onRootScope("updateDisplayListTextField",function(e,mtx){var selected=scope.$parent.selectedItem,targetID="text-wrapper-"+selected.item.id.split("-").pop(),center=updateDisplayListTextFieldWithId(targetID,mtx);curTransformTool.tool.setTarget(null),curTransformTool.selectImage(center.left+1,center.top+1),curTransformTool.renderSelected()}),scope.$onRootScope("transform-tool_updateDisplayListTextFieldWithId",function(e,id,mtx){updateDisplayListTextFieldWithId(id,mtx),curTransformTool.render()}),scope.$onRootScope("transform-tool_alignObjects",function(e,slaveObjectId,masterObjectId,hSide,vSide){$log.debug("Transform tool: align object",slaveObjectId,"by",masterObjectId,hSide,vSide);var slaveObject=svgjs.adopt(document.getElementById(slaveObjectId)),masterObject=svgjs.adopt(document.getElementById(masterObjectId)),slaveBbox=slaveObject.tbox(),masterBbox=masterObject.tbox(),slavePosition=[slaveBbox.x,slaveBbox.y];hSide instanceof Array&&2==hSide.length&&(slavePosition[0]=masterBbox.x+masterBbox.w*hSide[1]-slaveBbox.w*hSide[0]),vSide instanceof Array&&2==vSide.length&&(slavePosition[1]=masterBbox.y+masterBbox.h*vSide[1]-slaveBbox.h*vSide[0]),slaveObject.transform({x:slavePosition[0],y:slavePosition[1]}),curTransformTool.displayList.filter(function(d){return d.image.id==slaveObjectId;
}).forEach(function(d){d.transform.matrix.x=slavePosition[0],d.transform.matrix.y=slavePosition[1]})})}}})}),define("controllers/Editor",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.controllers.EditorCtrl",[]).controller("EditorCtrl",function(appConfig,wizardService,$log,$scope,$location,$q,$timeout,$compile,$cookies,lgApi,lgSiteApi,trackTargetIds,svgService,logoData,$window,SymbolFacade,EditorEffectsService,SharedCode,$document,$rootScope,historyService){function closeTutorial(event){var isClickedElementToast=angular.element(document.querySelector("#tutorial-toast")).find(event.target).length>0||"tutorial-toast"==event.target.id||angular.element(event.target).hasClass("tutorial-btn");isClickedElementToast||($scope.tutorialSkip(),$(document).unbind("click",closeTutorial))}function isUsedSite(){return window.apiVars.use_site}function isUsedSiteRegistration(){return!window.apiVars.logo_id&&isUsedSite()}function getCurrentSymbolColor(){return parseInt(logoData.symbol.color.slice(1),16)}function getIndustryId(){return $scope.selectedIndustry&&$scope.selectedIndustry.id?$scope.selectedIndustry.id>1e5?logoData.industry.idDefault:$scope.selectedIndustry.id:appConfig.firstTimeIndustryId}function composeArrayColorComponents(arrayComponents){return 3!=arrayComponents.length?"#000000":"#"+arrayComponents.slice(0,3).map(function(n){return(16>n?"0":"")+n.toString(16)}).join("")}function decomposeToArrayColorComponents(hexColorString){return 7!=hexColorString.length?[0,0,0]:[parseInt(hexColorString.substr(1,2),16)||0,parseInt(hexColorString.substr(3,2),16)||0,parseInt(hexColorString.substr(5,2),16)||0]}function playAnimationHideEditor(){$scope.wizard.startLoader(),$scope.wizard.ignoreTransitions=[],$scope.wizard.transitionEvent="back1",$scope.wizard.showTransitions(3,"back1")}function hideToolTip(){var tooltipEl=document.getElementById("html5tooltip-box");tooltipEl&&tooltipEl.addEventListener("click",$scope.tips.tt.hideAll),clearTimeout(timeoutToolTip),timeoutToolTip=setTimeout($scope.tips.tt.hideAll,5e3)}function bindSaveButtonEvents(saveBtn){saveBtn&&saveBtn.addEventListener("click",function(event){$scope.$apply("testSave()")})}function bindSaveDaButtonEvents(saveDaBtn){saveDaBtn&&saveDaBtn.addEventListener("click",function(event){$scope.$apply("saveDaLogo()")})}var timeoutToolTip;document.getElementById("tool");$scope.isAffiliateProgram=!!$cookies.get("aff_code"),$scope.hideTip=function(){},$scope.transformerOptions={align:{toStage:!1,toObjects:!1}},$scope.okToSubmit=!1,$scope.hideBottomPane=!1,$scope.hideButtons=!1,$scope.tooltip1=!1,$scope.tooltip2=!1,$scope.tooltipAlign=!1,$scope.tooltipSymbolEffects=!1,$scope.isEffectsEnable=SharedCode.getIEVersion()<0,$scope.registerUserModel={logoId:0,name:"Anonymous",email:"",password:"",svgContent:""},logoData.showTips=void 0===logoData.showTips?!0:logoData.showTips,$scope.saveButtonTitle="Save & Download Your Logo »",$scope.saveDaButtonTitle="Make My Logo For Me",$scope.toolTargets=[],$scope.selectedItem={deg:0,angleIncrement:10},$scope.RGB=[0,0,0],$scope.tutorialSkip=function(){document.getElementById("tutorial-toast")&&(document.getElementById("tutorial-toast").className="",document.getElementById("tutorial-toast").parentNode.removeChild(document.getElementById("tutorial-toast")))},$scope.tutorialNext=function(idTutorial){$scope.tutorialSkip();var tutorialId="toolHolder"+idTutorial,tutorialEl=document.getElementById(tutorialId),param4="";if(4==idTutorial&&($(document).bind("click",closeTutorial),document.getElementById("toolHolder4").parentNode.parentNode.clientHeight<90&&(param4=" sm-left-center")),tutorialEl){tutorialEl=angular.element(document.getElementById(tutorialId));var tutorialText=tutorialEl.attr("tutorial-text"),templateTutorial=document.createElement("div");templateTutorial.id="tutorial-toast";var nextTutorialId=parseInt(idTutorial)+1;templateTutorial.innerHTML="<p>"+tutorialText+'</p><div class="tutorial-footer"><button class="skip tutorial-btn" data-ng-click="tutorialSkip()">Skip</button><button class="next tutorial-btn" data-ng-click="tutorialNext('+nextTutorialId+')">Next</button>',tutorialEl.eq(0).append($compile(templateTutorial)($scope));var tutorialPositionLg=tutorialEl.attr("tutorial-position-lg")&&tutorialEl.attr("tutorial-position-lg").split(" "),tutorialPositionSm=tutorialEl.attr("tutorial-position-sm")&&tutorialEl.attr("tutorial-position-sm").split(" ");templateTutorial.className="visible",tutorialEl.attr("tutorial-position-lg")&&(templateTutorial.className+=" lg-"+tutorialPositionLg[0]+"-"+tutorialPositionLg[1]),tutorialEl.attr("tutorial-position-sm")&&(templateTutorial.className+=param4?param4:" sm-"+tutorialPositionSm[0]+"-"+tutorialPositionSm[1])}},angular.element(document).ready(function(){}),logoData.showTips=!1,!logoData.editing&&logoData.showTips&&$timeout(function(){$scope.tutorialNext("1")},0),$scope.closeSelectSettings=function(){angular.element(document.querySelector(".lg-select-setting.active")).removeClass("active")},$(document).bind("click",function(event){var isClickedElementChildOfPopup=angular.element(document.querySelector(".lg-select-setting.active")).find(event.target).length>0;$(event.target).parents("#fnt-panel").length||0!=$("#fnt-panel").hasClass("closed")||angular.element("#fnt-panel").addClass("closed"),isClickedElementChildOfPopup||$scope.closeSelectSettings()}),$(document).bind("keydown keypress",function(event){if(27==event.keyCode){var isClickedElementChildOfPopup=document.querySelector(".lg-select-setting.active")&&angular.element(document.querySelector(".lg-select-setting.active")).find(event.target).length>0;if(isClickedElementChildOfPopup)return;$scope.closeSelectSettings()}}),$scope.toggleSelectSetting=function($event){var elSelect=function(){for(var tmpEl=$event.target,i=0;"DIV"!=tmpEl.nodeName&&10>i;)i++,tmpEl=tmpEl.parentNode;return angular.element(tmpEl)}(),elParent=elSelect.parent();elSelect.next();elParent.hasClass("active")?elParent.removeClass("active"):($scope.closeSelectSettings(),elParent.addClass("active"))},/iPhone|iPod|Android|BlackBerry/.test(navigator.userAgent)?$("#viewport").attr("content","width=960, initial-scale=0.4, maximum-scale=0.4"):/iPad/.test(navigator.userAgent)&&$("#viewport").attr("content","width=960, initial-scale=0.9, maximum-scale=0.9"),$scope.selectedIndustry={},$scope.currentIndustry={},$scope.industries=[],lgApi.getAllIndustriesSymbols().then(function(industries){$scope.industries=industries||[]}),$scope.$watch(function(){return logoData.industry&&logoData.industry.id||null},function(){$scope.selectedIndustry=logoData.industry}),$scope.onIndustrySelected=function(industry){$scope.currentIndustry=industry,lgSiteApi.trafficTrackOnce(trackTargetIds.SELECTED_CATEGORY),$("#industrySelect").blur(),$scope.$broadcast("lg:symbolsCatalog:updateIndustry",industry),industry.id<1e5&&(logoData.industry.idDefault=industry.id)},$scope.$onRootScope("editor_changeSymbol",function(e,symbol,snapshotHistory){$scope.selectSymbol(symbol,snapshotHistory)}),$scope.selectSymbol=function(symbol,notSnapshotHistory){function processSvgContent(svgContent){lgSiteApi.trafficTrackOnce(trackTargetIds.SELECTED_SYMBOL),logoData.symbol_ID=sym.id,logoData.svg_content=svgContent,logoData.selectedSymbol=svgContent,logoData.symbol.content=svgService.transformToCompatibleSvg(svgContent),logoData.isSwappingSymbol=!0,EditorEffectsService.hideEffects("symbol","1"),$scope.transformer.tool.setTarget(null);var stage=document.getElementById("svg"),symbol=stage.querySelector("#symbol-1"),o={type:"symbol"};o.fill=symbol.firstChild&&symbol.firstChild.getAttribute("fill")||"#000000",o.shine=symbol.getAttribute("data-shine"),o.distress=symbol.getAttribute("data-distress"),o.shadow=symbol.getAttribute("data-shadow"),o.reflection=symbol.getAttribute("data-reflection");var sw=stage.querySelector("#symbol-wrapper-1");o.mtx=sw.getAttribute("transform");var firstChild=symbol.parentNode.firstChild;if(symbol.id===firstChild.id)o.bgid=0;else{var idArray=firstChild.id.split("-");o.bgid=idArray[idArray.length-1],o.fill=firstChild.querySelector(".symbol-bg-base").getAttribute("fill")}logoData.props=[o],$scope.send("initStage"),$scope.send("symbol-effects_initButtons");var symbol=document.querySelector("#symbol-wrapper-1"),symbolCenter=svgService.getReferenceCenter(stage,symbol);EditorEffectsService.showEffects("symbol","1");var picture=$scope.transformer.displayList.filter(function(item){return 0===item.image.id.indexOf("symbol-")}).pop(),newBBox=picture.image.getBBox();picture.transform.width=newBBox.width,picture.transform.height=newBBox.height,$scope.transformer.selectImage(-1,-1),$scope.$applyAsync(function(){$scope.transformer.selectImage(symbolCenter.x,symbolCenter.y),$scope.transformer.renderSelected()})}var sym=symbol;notSnapshotHistory||$scope.send("addHistory",{id:"symbol-1",type:"changeSymbol",symbol_prev:{id:logoData.currentSymbol.id},symbol_next:{id:symbol.id}}),logoData.currentSymbol=symbol,$scope.selectedIndustry=$scope.currentIndustry,$rootScope.$broadcast("progress-viewer:start","^editor-area$",{debounceTimeout:50}),symbol.is_foreign?lgApi.getForeignSymbol(symbol.data_url).then(function(content){return logoData.symbol_ID=2147483647,processSvgContent(content)})["finally"](function(){$rootScope.$broadcast("progress-viewer:stop","^editor-area$")}):lgApi.getSymbolById(symbol.id).then(processSvgContent)["finally"](function(){$rootScope.$broadcast("progress-viewer:stop","^editor-area$")})},$scope.prepareSavedLogo=function(svgContent){lgSiteApi.trafficTrackOnce(trackTargetIds.SAVE_DOWNLOAD),isUsedSiteRegistration()?(angular.extend($scope.registerUserModel,{industryId:getIndustryId()||1,svgContent:svgContent,symbolId:logoData.symbol_ID,symbolColor:getCurrentSymbolColor()}),$rootScope.$broadcast("progress-viewer:start","^editor$"),$scope.saveLogo(!1,svgContent,!0).then(function(lgApiResponse){return logoData.logo_id=logoData.logo_id||lgApiResponse.data.data.logoID,$scope.registerUserModel.logoId=logoData.logo_id,$scope.registerUserModel.logoImageUrl=appConfig.s3PreviewUrl+"/bitmaps/"+(""+logoData.logo_id).split("").reverse().join("")+"/"+logoData.logo_id+".png?_t="+ +new Date,$scope.isAffiliateProgram||$scope.$broadcast("ShowUserRegistration_register-user"),lgSiteApi.storeLogoData({logoref:logoData.logo_id||lgApiResponse.data.data.logoID,industryId:getIndustryId()||1,symbolColor:getCurrentSymbolColor()}).then(function(response){return $scope.isAffiliateProgram?$scope.onUserRegistrationClick($scope.registerUserModel):response})})["finally"](function(){$rootScope.$broadcast("progress-viewer:stop","^editor$"),wizardService.stopLoader()})):isUsedSite()?lgSiteApi.updateUserLogo({industryId:getIndustryId(),logoId:logoData.logo_id,symbolColor:getCurrentSymbolColor()}).then(function(){$scope.saveLogo("/account/",svgContent)}):$scope.saveLogo(!1,svgContent)},$scope.onUserRegistrationClick=function(userModel){if(!$scope.isAffiliateProgram&&!userModel.email)return!1;wizardService.startLoader();var registrationPromise;return registrationPromise=$scope.isAffiliateProgram?lgSiteApi.storeAffiliateData({code:$cookies.get("aff_code")}).then(function(response){return(window.location.href||"").indexOf(appConfig.legacySiteUrl)<0&&$cookies.remove("aff_code"),response}):lgSiteApi.registerUserAndSaveLogo({name:userModel.name,phone:userModel.phone,email:userModel.email,password:userModel.password||lgSiteApi.generateRandomString(16,3,0),svgContent:userModel.svgContent,symbolColor:userModel.symbolColor})["catch"](function(errors){return errors&&errors.length||($log.error("REGISTER USER [FAILED]:",errors),errors=["Error occurred on the server side."]),$scope.registerUserModelErrors=errors||[],$q.reject(errors)}).then(function(lgApiResponse){return lgSiteApi.updateUserLogoDetails({logoId:logoData.logo_id,symbolColor:getCurrentSymbolColor()})})["catch"](function(errors){return $log.error("REGISTER USER [FAILED]:",errors),wizardService.stopLoader(),$q.reject(errors)}),registrationPromise.then(function(response){playAnimationHideEditor(),window.top.location.href=lgSiteApi.getApiUrl()+($scope.isAffiliateProgram?"pitch-page.php":"account/")})},$scope.onSetAlignment=function(){var alignOptions=$scope.transformerOptions.align;alignOptions.toStage=alignOptions.toObjects=!alignOptions.toObjects,$scope.alignmentBtnStyle=alignOptions.toStage?{"background-color":"#bbb"}:{}},$scope.getSpriteSVGLocation=function(){return lgApi.getLocationUrl("images/sprites.svg")},$scope.selectWithTool=function(selector){var stage=document.getElementById("svg"),item=document.querySelector(selector),mtxPoint=svgService.getReferenceCenter(stage,item);$scope.transformer.selectImage(mtxPoint.x,mtxPoint.y),$scope.transformer.tool.draw()},$scope.updateTargets=function(){$scope.send("updateDisplayList")},$scope.addRegularText=function(){$scope.send("addRegularText"),$scope.hideTip()},$scope.addShapeText=function(){$scope.send("addShapeText")};var isTextSelected=!1;$scope.$onRootScope("selectTextField",function(event,textId){isTextSelected=textId&&0===textId.indexOf("text-")}),$scope.$onRootScope("changeColor",function(){isTextSelected&&(logoData.usedStyles.usedLastColor=composeArrayColorComponents($scope.RGB))}),$scope.$onRootScope("stageReady",function(e){$scope.send("updateDisplayList"),$scope.wizard.stopLoader(),$scope.wizard.transitionEvent="first",$scope.wizard.showTransitions(3,"first"),logoData.symbol.color&&(isTextSelected=!1,$scope.RGB=decomposeToArrayColorComponents(logoData.symbol.color)),!$scope.isEffectsEnable}),$scope.$onRootScope("editor_changeEffects",function(e,elementId,effectType){EditorEffectsService.toggleEffectById(elementId,effectType),EditorEffectsService.updateFXButtons($scope)}),$scope.toggleFX=function($event,thisFX){var input=angular.element($event.target);$scope.selectedItem.item||input.attr("checked",""),$scope.send("toggleFX",thisFX)},$scope.uncheckAll=function(){},$scope.rotateTarget=function($event,direction){if($scope.selectedItem.item){var incr;"clockwise"===direction?(incr=svgService.deg2rad($scope.selectedItem.angleIncrement),$scope.selectedItem.deg+=$scope.selectedItem.angleIncrement):"counterClockwise"===direction&&(incr=-svgService.deg2rad($scope.selectedItem.angleIncrement),$scope.selectedItem.deg-=$scope.selectedItem.angleIncrement),$scope.selectedItem.deg=svgService.positiveAngle($scope.selectedItem.deg),$scope.send("rotateTarget",incr)}},$scope.hideTheTips=function(type){type="symbol"===type?"symbol":"text",void 0!==$scope.tips&&logoData.showTips&&($scope.tooltip1||"text"!==type?$scope.tooltip1&&!$scope.tooltip2&&"symbol"===type&&($scope.tooltip2=!0,$scope.tips.tt.hideAll(),logoData.showTips=!1):($scope.tooltip1=!0,$scope.tips.tt.hideAll(),$scope.showTip(document.getElementById("toolHolder2"),500),hideToolTip()))},$scope.gotoStep=function(step){logoData.logoStashed=!0,$log.debug("step is: "+step),step=step||"symbol",$scope.send("prepareStash",step)},$scope.gotoSymbols=function(skip){$scope.wizard.ignoreTransitions=[],$scope.wizard.transitionEvent="back1",$scope.wizard.showTransitions(3,"back1"),$scope.fpVisible=!1,$scope.hideTip(),$location.path("/step/2")},$scope.gotoIndustry=function(){$scope.data.tree="main",$scope.wizard.ignoreTransitions=[],$scope.wizard.transitionEvent="back1",$scope.wizard.showTransitions(3,"back1"),$scope.fpVisible=!1,$scope.hideTip(),$location.path("/step/1")},$scope.prepareStage=function(){var stageDiv=document.getElementById("svg-stage"),ttool=document.querySelector("#tool"),fontDefs=document.querySelector("#fontDefs defs");stageDiv.removeChild(ttool);var svg=svgService.parseXML(logoData.svg_content);svg.firstChild.removeAttribute("viewBox");var n=svgService.importNode(svg.documentElement,document);n.setAttribute("id","saved-svg"),n.setAttribute("width","100%"),n.setAttribute("height","100%");var stage=document.querySelector("#svg"),createdDefs=n.querySelector("#created-defs");createdDefs&&createdDefs.parentNode.removeChild(createdDefs);var oldStockDefs=n.querySelector("#stock-defs");oldStockDefs&&oldStockDefs.parentNode.removeChild(oldStockDefs),fontDefs&&n.querySelector("defs")&&($(fontDefs).empty(),fontDefs.appendChild(n.querySelector("defs")),fontDefs.querySelector("defs").removeAttribute("id"));var stageDefs=stage.querySelector("defs");for(stageDefs&&createdDefs&&stageDefs.appendChild(createdDefs);n.lastChild;)stage.appendChild(n.firstChild);n.children;stageDiv.appendChild(ttool);var symbol=stage.querySelector("#symbol-1"),o={type:"symbol"};o.fill=symbol.firstChild&&symbol.firstChild.getAttribute("fill")||"#000000",o.shine=symbol.getAttribute("data-shine"),o.distress=symbol.getAttribute("data-distress"),o.shadow=symbol.getAttribute("data-shadow"),o.reflection=symbol.getAttribute("data-reflection");var sw=stage.querySelector("#symbol-wrapper-1");o.mtx=sw.getAttribute("transform");var firstChild=symbol.parentNode.firstChild;if(symbol.id===firstChild.id)o.bgid=0;else{var idArray=firstChild.id.split("-");o.bgid=idArray[idArray.length-1],o.fill=firstChild.querySelector(".symbol-bg-base").getAttribute("fill")}logoData.selectedSymbol=symbol,logoData.props=[o];var textFields=stage.querySelectorAll('svg g[id^="text-wrapper-"]');logoData.fontsNeeded=[];for(var i=0;i<textFields.length;i++){var t={type:"text"};t.mtx=textFields[i].getAttribute("transform");var idArray=textFields[i].id.split("-"),textID=idArray[idArray.length-1],inner=textFields[i].querySelector("#text-"+textID);t.tid=textID,t.fill=inner.getAttribute("data-fill")||"#000000",t.shine=inner.getAttribute("data-shine"),t.distress=inner.getAttribute("data-distress"),t.shadow=inner.getAttribute("data-shadow"),t.reflection=inner.getAttribute("data-reflection"),t.content=inner.getAttribute("data-content"),t.style=inner.getAttribute("data-style"),t.letterSpacing=inner.getAttribute("data-letter-spacing"),t.path=inner.getAttribute("data-path")||null,t.radius=inner.getAttribute("data-radius")||3,t.font=inner.getAttribute("data-font"),logoData.fontsNeeded.indexOf(t.font)<0&&logoData.fontsNeeded.push(t.font),logoData.props.push(t)}loadFonts()};var loadFonts=function(){if(logoData.fontsNeeded.length>0){var fam=logoData.fontsNeeded.pop(),folderName=logoData.fontList[fam].folderName;svgService.loadResource(logoData.assets_url+"/proxy/fonts/"+folderName+".fntz").then(function(data){svgService.parseFontStyles(data)}).then(function(data){loadFonts()})}else $timeout(function(){$scope.send("initStage")},0)};$scope.testSave=function(){$scope.send("prepareSave")},$scope.saveDaLogo=function(){lgSiteApi.trafficTrackOnce(trackTargetIds.DESIGN_ASSIST),$scope.$broadcast("ShowDaPitch_da-pitch")},$scope.stashLogo=function(step){switch(step){case"industry":$scope.gotoIndustry();break;case"symbol":$scope.gotoSymbols()}},$scope.showLoader=function(){$scope.wizard.startLoader()},$scope.hideLoader=function(){$scope.wizard.stopLoader()},$scope.saveLogo=function(redirectWhenFinish,svg,isNotAnimatalbe){$log.debug("event: save "+logoData.branch.name+" ("+logoData.symbol_ID+")"),ga("send","event","logo","save",logoData.branch.name+" ("+logoData.symbol_ID+")"),$scope.wizard.startLoader();var postData={action:logoData.editing||logoData.logo_id?"update_logo":"create_user",partner_ID:logoData.apiVars.partner_id,logo_svg:svg,industry_ID:getIndustryId(),symbol_ID:logoData.symbol_ID,symbol_color_UI:getCurrentSymbolColor()};return postData.logo_id=logoData.logo_id,logoData.editing&&(postData.logo_id=logoData.apiVars.logo_id),lgApi.saveLogo(postData).success(function(data,status,headers,config){return $scope.okToSubmit=!0,isNotAnimatalbe||playAnimationHideEditor(),$scope.fpVisible=!1,$scope.hideTip(),window.apiVars.use_site||("partner_redirect_url"in window.apiVars?lgApi.saveLogoSession(data.data.logoID).success(function(data,status,headers,config){$log.debug("savesession success"),$log.debug(data),window.top.location.href=data.redirect}).error(function(data,status,headers,config){}):alert("No redirect URL specified")),redirectWhenFinish&&(SharedCode.bindConfirmOnUnload(),window.top.location.href=lgSiteApi.getApiUrl(redirectWhenFinish)),window.onLogoSave?window.onLogoSave(data.data.userID,data.data.logoID):$log.debug(data),data.data}).error(function(data,status,headers,config){$scope.wizard.emit("alert",{headline:"Sorry! An Error Occurred",message:"Please try again.",button:"OK"})})},$scope.showButtons=function(){},$scope.svgUndo=function(){$scope.send("undoHistory",""),$scope.send("refreshAllObjectsEffects"),$scope.send("recalculateToolRectangle")},$scope.svgRedo=function(){$scope.send("redoHistory",""),$scope.send("refreshAllObjectsEffects"),$scope.send("recalculateToolRectangle")},$scope.svgReset=function(){$scope.send("transform-tool_undoAllHistory",""),$scope.send("recalculateToolRectangle")},$scope.$onRootScope("stageReady",function(e){if(document.querySelector(".lg-header-logo-maker")){var headerEl=angular.element(document.querySelector(".lg-header-logo-maker")).children();if(headerEl.length){var daBtnBg=document.getElementById("da-btn-bg")||document.createElement("div"),saveDaBtn=document.getElementById("saveDaBtn"),saveDaBtnMobile=saveDaBtn.cloneNode(!0);saveDaBtn.className+=" hide show-md",saveDaBtnMobile.className+=" hide-md",saveDaBtnMobile.id="saveDaBtnMobile";var saveDaBtnBgMobile=document.createElement("div");saveDaBtnBgMobile.appendChild(saveDaBtnMobile),daBtnBg.appendChild(saveDaBtn),headerEl.append(daBtnBg);var builderEl=angular.element(document.getElementById("builder"));builderEl.length&&builderEl.append(saveDaBtnBgMobile);var saveBtnBg=document.getElementById("save-btn-bg")||document.createElement("div"),saveBtn=document.getElementById("saveBtn"),saveBtnMobile=saveBtn.cloneNode(!0);saveBtn.className+=" hide show-md",saveBtnMobile.className+=" hide-md",saveBtnMobile.id="saveBtnMobile";var saveBtnBgMobile=document.createElement("div");saveBtnBgMobile.appendChild(saveBtnMobile),saveBtnBg.appendChild(saveBtn),headerEl.append(saveBtnBg);var builderEl=angular.element(document.getElementById("builder"));builderEl.length&&builderEl.append(saveBtnBgMobile)}}bindSaveButtonEvents(saveBtn||document.getElementById("saveBtn")),bindSaveButtonEvents(saveBtnMobile||document.getElementById("saveBtnMobile")),bindSaveDaButtonEvents(saveDaBtn||document.getElementById("saveDaBtn")),bindSaveDaButtonEvents(saveDaBtnMobile||document.getElementById("saveDaBtnMobile"))})})}),define("controllers/Symbols",["angular"],function(angular){"use strict";angular.module("logoBuilderApp.controllers.SymbolsCtrl",[]).controller("SymbolsCtrl",function($log,$rootScope,$scope,$timeout,$q,lgApi,SharedCode,wizardService,SymbolCatalogService,logoData,appConfig,trackTargetIds,lgSiteApi){function isEmptySymbolsQuery(){return!getSymbolsQueryKeywords()}function getSymbolsQueryKeywords(){return logoData.querySymbols&&logoData.querySymbols.keywords||""}function breadcrumbItem(id,name){return{id:id,name:name}}function resetCatalogBreadcrumb($scope){$scope.catalogBreadcrumb=[breadcrumbItem("home","Symbols Home")]}function setCurrentSymbolsModel(symbols){return uiModel.symbols=symbols||[]}function UngroupSymbols(data){var ungroupedSymbols=[],uniqueSymbolsIds={};return data.forEach(function(symbol){Array.prototype.push.apply(ungroupedSymbols,(symbol.symbols&&symbol.symbols.length>1?symbol.symbols:[symbol]).filter(function(symbol){return!uniqueSymbolsIds[symbol.id]}).map(function(symbol){return uniqueSymbolsIds[symbol.id]=1,symbol}))}),uniqueSymbolsIds=null,ungroupedSymbols}function getDefaultCatalogState($scope){return logoData.predefinedSearchData?($scope.currentSearchTerms=uiModel.storedSearchTerms=logoData.predefinedSearchData.keyword,new SymbolCatalogStateSearch(logoData.predefinedSearchData)):isEmptySymbolsQuery()?($scope.currentSearchTerms=uiModel.storedSearchTerms="",logoData.industry.id?999999===logoData.industry.id?new SymbolCatalogStateShape:999998===logoData.industry.id?new SymbolCatalogStateAlphabet:new SymbolCatalogStateIndustry(logoData.industry.id,logoData.industry.name,logoData.industry.main_keyword):new SymbolCatalogStateManual("Default",appConfig.firstTimeCategorySymbols)):($scope.currentSearchTerms=uiModel.storedSearchTerms=getSymbolsQueryKeywords(),new SymbolCatalogStateSearch(getSymbolsQueryKeywords()))}$scope.viewSymbols=void 0,resetCatalogBreadcrumb($scope);var UiModelProvider=function(){function SetSymbolsViewModel(symbols,isIncremental){var transformedSymbols=SymbolCatalogService.transformSymbols(symbols);return isIncremental?transformedSymbols.forEach(function(symbol){$scope.viewSymbols.push(symbol)}):$scope.viewSymbols=transformedSymbols,setCurrentSymbolsModel($scope.viewSymbols)}function ApplySymbolsByPromise(promise,isIncremental){return promise.then(function(data){return data||[]},function(response){SetSymbolsViewModel([]),$log.error(response)}).then(function(symbols){return SetSymbolsViewModel(symbols,isIncremental),symbols})}function UiModelProvider(){this.$scope=$scope,this.storedViewSymbols=void 0,this.symbols=[],this.storedSearchTerms="",this.state=null,this.prevState=null}return UiModelProvider.prototype.setScope=function(originalScope){return $scope=originalScope,this.state&&this.state.setScope(originalScope),this.prevState&&this.prevState.setScope(originalScope),this},UiModelProvider.prototype.fetchMoreData=function(flush){var _this=this;return void 0===this.state.page||this.state.preventFetchData?$q.resolve([]):(this.state.page+=1,ApplySymbolsByPromise(this.state.fetchData(),!0).then(function(result){return result.length<24&&(_this.state.preventFetchData=!0),result}))},UiModelProvider.prototype.applyState=function(newState){if(!newState||newState===this.state)return $q.resolve({});$rootScope.$broadcast("progress-viewer:start","symbols-catalog");var promise,_this=this;return promise=this.state?this.state.leave().then(function(){return newState.enter()}):newState.enter(),promise.then(function(result){return _this.prevState=_this.state,_this.state=newState,_this.state.preventFetchData?result:ApplySymbolsByPromise(_this.state.fetchData())["finally"](function(result){return $rootScope.$broadcast("progress-viewer:stop","symbols-catalog"),result})})},UiModelProvider}(),uiModel=$scope.uiModel=new UiModelProvider,SymbolCatalogState=function(){function SymbolCatalogState(){this.$scope=$scope,this.preventFetchData=!1}return angular.extend(SymbolCatalogState.prototype,{setScope:function($scope){return this.$scope=$scope,this},getTitle:function(){return""},enter:function(){return this.setBreadcrumbs(),$q.resolve(this)},leave:function(){return $q.resolve(this)},fetchData:function(){return $q.resolve({data:[]})},setBreadcrumbs:function(){resetCatalogBreadcrumb(this.$scope),this.$scope.catalogBreadcrumb.push(breadcrumbItem(this.getTitle(),this.getTitle()))},getNextStateOnSymbolCatalogClick:function(symbol){return null},getNextStateOnBreadcrumbClick:function(item){return getDefaultCatalogState(this.$scope)}}),SymbolCatalogState}(),SymbolCatalogStateSubsymbols=function(SymbolCatalogState){return SharedCode.inherit(function SymbolCatalogStateSubsymbols(previousState,symbol){SymbolCatalogStateSubsymbols["super"].constructor.apply(this,arguments),this.preventFetchData=!0,this.previousState=previousState,this.symbol=symbol},SymbolCatalogState,{setScope:function($scope){return this.previousState.setScope($scope),SymbolCatalogStateSubsymbols["super"].setScope.call(this,$scope)},getTitle:function(){return this.symbol.name},enter:function(){var _this=this;return SymbolCatalogStateSubsymbols["super"].enter.call(this).then(function(){return _this.symbol.symbols&&_this.symbol.symbols.length&&(_this.$scope.viewSymbols=_this.symbol.symbols),_this})},getNextStateOnBreadcrumbClick:function(item){var symbols=this.$scope.viewSymbols;return this.previousState.preventFetchData=!0,symbols&&symbols.length&&symbols[0].parentId&&(symbols=SymbolCatalogService.findParentSymbolsBySymbolId(symbols[0].parentId,uiModel.symbols),symbols&&(this.$scope.viewSymbols=symbols)),this.previousState}})}(SymbolCatalogState),SymbolCatalogStateManual=function(SymbolCatalogState){return SharedCode.inherit(function(title,symbolsIds){SymbolCatalogStateManual["super"].constructor.apply(this,arguments),this.title=title||"custom",this.symbolsIds=symbolsIds||[]},SymbolCatalogState,{getTitle:function(){return this.title},enter:function(){var _this=this;return SymbolCatalogStateManual["super"].enter.call(this).then(function(res){return _this.$scope.currentSearchTerms="",res})},setBreadcrumbs:function(){this.$scope.catalogBreadcrumb=[],this.$scope.catalogBreadcrumb.push(breadcrumbItem(this.getTitle(),this.getTitle()))},fetchData:function(){var _this=this;return lgApi.getSpecifiedSymbolsByIds(this.symbolsIds).then(function(symbols){var sortedSymbols=[];return _this.symbolsIds.forEach(function(symbolId){var symbol=symbols.filter(function(s){return s.id==symbolId}).pop();symbol&&sortedSymbols.push(symbol)}),sortedSymbols})}})}(SymbolCatalogState),SymbolCatalogStateIndustry=function(SymbolCatalogState){var symbolsCache={};return SharedCode.inherit(function SymbolCatalogStateIndustry(industryId,industryTitle,industryKeywords){SymbolCatalogStateIndustry["super"].constructor.apply(this,arguments),this.industryId=industryId,this.industryTitle=industryTitle||"",this.industryKeywords=industryKeywords||""},SymbolCatalogState,{getTitle:function(){return this.industryTitle},enter:function(){return SymbolCatalogStateIndustry["super"].enter.call(this).then(function(res){return $scope.currentSearchTerms="",res})},setBreadcrumbs:function(){this.$scope.catalogBreadcrumb=[],this.$scope.catalogBreadcrumb.push(breadcrumbItem(this.getTitle(),this.getTitle()))},fetchData:function(){var _this=this;return symbolsCache[_this.industryId]?$q.resolve(symbolsCache[_this.industryId]):this.industryKeywords?lgApi.getObjectsByKeywords("objects",this.industryKeywords).then(function(data){return symbolsCache[_this.industryId]=UngroupSymbols(data)}):lgApi.getIndustrySymbols(this.industryId).then(function(response){return symbolsCache[_this.industryId]=UngroupSymbols(response)})}})}(SymbolCatalogState),SymbolCatalogStateSearch=function(SymbolCatalogState){return SharedCode.inherit(function SymbolCatalogStateSearch(searchTerms){SymbolCatalogStateSearch["super"].constructor.apply(this,arguments),this.predefinedSearchData="string"!=typeof searchTerms?searchTerms:void 0,this.searchTerms=searchTerms,this.predefinedSearchData&&(this.searchTerms=this.predefinedSearchData.is_industry?"":searchTerms.keyword),this.page=1},SymbolCatalogState,{getTitle:function(){return"Search"},enter:function(){var _this=this;return SymbolCatalogStateSearch["super"].enter.call(this).then(function(res){return _this.$scope.currentSearchTerms=_this.searchTerms,res})},leave:function(){return uiModel.storedSearchTerms=this.searchTerms,$q.resolve(this)},fetchData:function(){var preDefResponse;return this.predefinedSearchData?(preDefResponse=$q.resolve(UngroupSymbols(this.predefinedSearchData.objects)),this.predefinedSearchData=null,preDefResponse):lgApi.getObjectsByKeywords("symbols",this.searchTerms,this.page).then(function(data){return UngroupSymbols(data)})}})}(SymbolCatalogState),SymbolCatalogStateShape=function(SymbolCatalogState){return SharedCode.inherit(function SymbolCatalogStateShape(){SymbolCatalogStateShape["super"].constructor.apply(this,arguments)},SymbolCatalogState,{getTitle:function(){return"Shapes"},enter:function(){return SymbolCatalogStateShape["super"].enter.call(this).then(function(res){return $scope.currentSearchTerms="",res})},fetchData:function(){return lgApi.getAllAbstractedSymbols().then(function(data){return data.map(function(symbol){return symbol.name="abstract",symbol})})}})}(SymbolCatalogState),SymbolCatalogStateAllLetters=function(SymbolCatalogState){return SharedCode.inherit(function SymbolCatalogStateAllLetters(){SymbolCatalogStateAllLetters["super"].constructor.apply(this,arguments)},SymbolCatalogState,{getTitle:function(){return"Alphabet"},enter:function(){return SymbolCatalogStateAllLetters["super"].enter.call(this).then(function(res){return $scope.currentSearchTerms="",
res})},setBreadcrumbs:function(){var _this=this;resetCatalogBreadcrumb(this.$scope),this.$scope.catalogBreadcrumb.push(breadcrumbItem("Letters","Letters")),this.$scope.catalogBreadcrumb.push(breadcrumbItem(_this.letter,_this.letter))},fetchData:function(){return lgApi.getSymbolsByAlphabetLetter("all").then(function(data){return data.map(function(symbol){return symbol.name="letter",symbol})})},getNextStateOnBreadcrumbClick:function(item){return getDefaultCatalogState(this.$scope)}})}(SymbolCatalogState);$scope.onCatalogBreadcrumbItemClick=function(item){var nextState=uiModel.state.getNextStateOnBreadcrumbClick(item);nextState&&uiModel.applyState(nextState)},$scope.onSymbolCatalogItemClick=function(symbol){var nextState,subSymbols=symbol.symbols||null;subSymbols&&subSymbols.length>1?uiModel.applyState(new SymbolCatalogStateSubsymbols(uiModel.state,symbol)):(nextState=uiModel.state.getNextStateOnSymbolCatalogClick(symbol),nextState?uiModel.applyState(nextState):$scope.selectSymbol(subSymbols&&subSymbols.length&&subSymbols[0]||symbol))},$scope.onFetchData=function(flush){uiModel.fetchMoreData(flush)},$scope.onLetterSymbolsClick=function(){uiModel.applyState(new SymbolCatalogStateAlphabet)},$scope.onShapeSymbolsClick=function(){uiModel.applyState(new SymbolCatalogStateShape)},$scope.getSearchResults=function(searchTerms,page){uiModel.applyState(new SymbolCatalogStateSearch(searchTerms))},$scope.$onRootScope("stageReady",function(e){uiModel.applyState(getDefaultCatalogState($scope))}),$scope.$on("lg:symbolsCatalog:updateIndustry",function(e,industry){$scope.viewSymbols=void 0,industry.is_alphabet?uiModel.applyState(new SymbolCatalogStateAllLetters):industry.is_shapes?uiModel.applyState(new SymbolCatalogStateShape):uiModel.applyState(new SymbolCatalogStateIndustry(industry.id,industry.name,industry.main_keyword))})})}),define("app",["jquery","angular","ngTouch","hammerjs","angular-cookies","services/AlignmentObjectsService","services/ApiService","services/EditorCommonService","services/EditorEffectsService","services/HistoryService","services/LgSiteApiService","services/LogoData","services/PictureService","services/ProcessHelper","services/SharedCode","services/SvgSerializer","services/SvgService","services/SvgTransformService","services/SymbolFacade","services/PopupModal","services/WizardService","directives/common/ColorPicker","directives/common/DaPitch","directives/common/popupVideo","directives/common/UserRegistration","directives/common/RangeInput","directives/symbol/SymbolCatalog","directives/symbol/SearchBox","directives/editor/FontPanel","directives/editor/Grid","directives/editor/LogoEditor","directives/editor/SymbolEffects","directives/editor/TransformTool","controllers/Editor","controllers/Symbols"],function($,angular){"use strict";try{angular.module("logoBuilderApp.partials")}catch(err){angular.module("logoBuilderApp.partials",[])}return angular.module("logoBuilderApp",["ngTouch","ngResource","ngSanitize","ngRoute","ngCookies","logoBuilderApp.config","logoBuilderApp.partials","logoBuilderApp.services.AlignmentObjectsService","logoBuilderApp.services.EditorCommonService","logoBuilderApp.services.EditorEffectsService","logoBuilderApp.services.HistoryService","logoBuilderApp.services.LgApi","logoBuilderApp.services.LgSiteApi","logoBuilderApp.services.LogoData","logoBuilderApp.services.PictureService","logoBuilderApp.services.PopupModal","logoBuilderApp.services.ProcessHelper","logoBuilderApp.services.SharedCode","logoBuilderApp.services.SvgService","logoBuilderApp.services.SvgSerializer","logoBuilderApp.services.SvgTransformService","logoBuilderApp.services.SymbolFacade","logoBuilderApp.services.WizardService","logoBuilderApp.directives.ColorPicker","logoBuilderApp.directives.DaPitch","logoBuilderApp.directives.FontPanel","logoBuilderApp.directives.Grid","logoBuilderApp.directives.LogoEditor","logoBuilderApp.directives.SearchBox","logoBuilderApp.directives.SymbolCatalog","logoBuilderApp.directives.RangeInput","logoBuilderApp.directives.SymbolEffects","logoBuilderApp.directives.PopupVideo","logoBuilderApp.directives.TransformTool","logoBuilderApp.directives.UserRegistration","logoBuilderApp.controllers.EditorCtrl","logoBuilderApp.controllers.SymbolsCtrl"]).config(function($logProvider,$routeProvider,$locationProvider,lgApiProvider,lgSiteApiProvider,appConfig){$logProvider.debugEnabled(appConfig.debugging),lgApiProvider.setLocationPrefix(window.apiVars.script_location||"/"),lgApiProvider.setApiUrl(appConfig.lgApiUrl),lgApiProvider.setPartnerRedirectionUrl(window.apiVars&&window.apiVars.partner_redirect_url||""),lgSiteApiProvider.setTrafficTrackEnabled(!appConfig.isTrafficTrackDisabled),lgSiteApiProvider.setApiUrl(appConfig.legacySiteUrl),function(i,s,o,g,r,a,m){i.GoogleAnalyticsObject=r,i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date,a=s.createElement(o),m=s.getElementsByTagName(o)[0],a.async=1,a.src=g,m.parentNode.insertBefore(a,m)}(window,document,"script","//www.google-analytics.com/analytics.js","ga");var gaid=window.location.hostname.indexOf("localhost")>-1?"UA-70308905-1":"UA-65698455-1";ga("create",gaid,"auto"),$routeProvider.when("/",{templateUrl:function(rp){angular.element($(window.apiVars.container_id).get(0)).scope();return lgApiProvider.getLocationUrl("views/editor.html")},controller:"EditorCtrl"}).otherwise({redirectTo:"/"})}).config(["$provide",function($provide){$provide.decorator("$rootScope",["$delegate",function($delegate){try{Object.defineProperty($delegate.constructor.prototype,"$onRootScope",{value:function(name,listener){var unsubscribe=$delegate.$on(name,listener);this.$on("$destroy",unsubscribe)},enumerable:!1})}catch(error){$delegate.constructor.prototype.$onRootScope=function(name,listener){var unsubscribe=$delegate.$on(name,listener);this.$on("$destroy",unsubscribe)}}return $delegate}])}]).config(["$httpProvider",function($httpProvider){$httpProvider.defaults.useXDomain=!0,delete $httpProvider.defaults.headers.common["X-Requested-With"]}]).run(["$rootScope","logoData","wizardService","$templateCache","lgApi","SharedCode",function($rootScope,logoData,wizardService,$templateCache,lgApi,SharedCode){$rootScope.data=logoData,$rootScope.wizard=wizardService,["views/SymbolCatalog.directive.html","views/color-picker.html","views/da-pitch.html","views/editor.html","views/font-panel.html","views/popup-video.html","views/user-registration.html"].forEach(function(viewPath){$templateCache.get(viewPath)&&($templateCache.put(lgApi.getLocationUrl(viewPath),$templateCache.get(viewPath)),$templateCache.remove(viewPath))}),$rootScope.send=function(message,arg1,arg2,arg3,arg4){$rootScope.$emit(message,arg1,arg2,arg3,arg4)}}])}),function(window,angular,undefined){"use strict";function $RouteProvider(){function inherit(parent,extra){return angular.extend(Object.create(parent),extra)}function pathRegExp(path,opts){var insensitive=opts.caseInsensitiveMatch,ret={originalPath:path,regexp:path},keys=ret.keys=[];return path=path.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[\?\*])?/g,function(_,slash,key,option){var optional="?"===option||"*?"===option?"?":null,star="*"===option||"*?"===option?"*":null;return keys.push({name:key,optional:!!optional}),slash=slash||"",""+(optional?"":slash)+"(?:"+(optional?slash:"")+(star&&"(.+?)"||"([^/]+)")+(optional||"")+")"+(optional||"")}).replace(/([\/$\*])/g,"\\$1"),ret.regexp=new RegExp("^"+path+"$",insensitive?"i":""),ret}var routes={};this.when=function(path,route){var routeCopy=angular.copy(route);if(angular.isUndefined(routeCopy.reloadOnSearch)&&(routeCopy.reloadOnSearch=!0),angular.isUndefined(routeCopy.caseInsensitiveMatch)&&(routeCopy.caseInsensitiveMatch=this.caseInsensitiveMatch),routes[path]=angular.extend(routeCopy,path&&pathRegExp(path,routeCopy)),path){var redirectPath="/"==path[path.length-1]?path.substr(0,path.length-1):path+"/";routes[redirectPath]=angular.extend({redirectTo:path},pathRegExp(redirectPath,routeCopy))}return this},this.caseInsensitiveMatch=!1,this.otherwise=function(params){return"string"==typeof params&&(params={redirectTo:params}),this.when(null,params),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce",function($rootScope,$location,$routeParams,$q,$injector,$templateRequest,$sce){function switchRouteMatcher(on,route){var keys=route.keys,params={};if(!route.regexp)return null;var m=route.regexp.exec(on);if(!m)return null;for(var i=1,len=m.length;len>i;++i){var key=keys[i-1],val=m[i];key&&val&&(params[key.name]=val)}return params}function prepareRoute($locationEvent){var lastRoute=$route.current;preparedRoute=parseRoute(),preparedRouteIsUpdateOnly=preparedRoute&&lastRoute&&preparedRoute.$$route===lastRoute.$$route&&angular.equals(preparedRoute.pathParams,lastRoute.pathParams)&&!preparedRoute.reloadOnSearch&&!forceReload,preparedRouteIsUpdateOnly||!lastRoute&&!preparedRoute||$rootScope.$broadcast("$routeChangeStart",preparedRoute,lastRoute).defaultPrevented&&$locationEvent&&$locationEvent.preventDefault()}function commitRoute(){var lastRoute=$route.current,nextRoute=preparedRoute;preparedRouteIsUpdateOnly?(lastRoute.params=nextRoute.params,angular.copy(lastRoute.params,$routeParams),$rootScope.$broadcast("$routeUpdate",lastRoute)):(nextRoute||lastRoute)&&(forceReload=!1,$route.current=nextRoute,nextRoute&&nextRoute.redirectTo&&(angular.isString(nextRoute.redirectTo)?$location.path(interpolate(nextRoute.redirectTo,nextRoute.params)).search(nextRoute.params).replace():$location.url(nextRoute.redirectTo(nextRoute.pathParams,$location.path(),$location.search())).replace()),$q.when(nextRoute).then(function(){if(nextRoute){var template,templateUrl,locals=angular.extend({},nextRoute.resolve);return angular.forEach(locals,function(value,key){locals[key]=angular.isString(value)?$injector.get(value):$injector.invoke(value,null,null,key)}),angular.isDefined(template=nextRoute.template)?angular.isFunction(template)&&(template=template(nextRoute.params)):angular.isDefined(templateUrl=nextRoute.templateUrl)&&(angular.isFunction(templateUrl)&&(templateUrl=templateUrl(nextRoute.params)),angular.isDefined(templateUrl)&&(nextRoute.loadedTemplateUrl=$sce.valueOf(templateUrl),template=$templateRequest(templateUrl))),angular.isDefined(template)&&(locals.$template=template),$q.all(locals)}}).then(function(locals){nextRoute==$route.current&&(nextRoute&&(nextRoute.locals=locals,angular.copy(nextRoute.params,$routeParams)),$rootScope.$broadcast("$routeChangeSuccess",nextRoute,lastRoute))},function(error){nextRoute==$route.current&&$rootScope.$broadcast("$routeChangeError",nextRoute,lastRoute,error)}))}function parseRoute(){var params,match;return angular.forEach(routes,function(route,path){!match&&(params=switchRouteMatcher($location.path(),route))&&(match=inherit(route,{params:angular.extend({},$location.search(),params),pathParams:params}),match.$$route=route)}),match||routes[null]&&inherit(routes[null],{params:{},pathParams:{}})}function interpolate(string,params){var result=[];return angular.forEach((string||"").split(":"),function(segment,i){if(0===i)result.push(segment);else{var segmentMatch=segment.match(/(\w+)(?:[?*])?(.*)/),key=segmentMatch[1];result.push(params[key]),result.push(segmentMatch[2]||""),delete params[key]}}),result.join("")}var preparedRoute,preparedRouteIsUpdateOnly,forceReload=!1,$route={routes:routes,reload:function(){forceReload=!0;var fakeLocationEvent={defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0,forceReload=!1}};$rootScope.$evalAsync(function(){prepareRoute(fakeLocationEvent),fakeLocationEvent.defaultPrevented||commitRoute()})},updateParams:function(newParams){if(!this.current||!this.current.$$route)throw $routeMinErr("norout","Tried updating route when with no current route");newParams=angular.extend({},this.current.params,newParams),$location.path(interpolate(this.current.$$route.originalPath,newParams)),$location.search(newParams)}};return $rootScope.$on("$locationChangeStart",prepareRoute),$rootScope.$on("$locationChangeSuccess",commitRoute),$route}]}function $RouteParamsProvider(){this.$get=function(){return{}}}function ngViewFactory($route,$anchorScroll,$animate){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(scope,$element,attr,ctrl,$transclude){function cleanupLastView(){previousLeaveAnimation&&($animate.cancel(previousLeaveAnimation),previousLeaveAnimation=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&(previousLeaveAnimation=$animate.leave(currentElement),previousLeaveAnimation.then(function(){previousLeaveAnimation=null}),currentElement=null)}function update(){var locals=$route.current&&$route.current.locals,template=locals&&locals.$template;if(angular.isDefined(template)){var newScope=scope.$new(),current=$route.current,clone=$transclude(newScope,function(clone){$animate.enter(clone,null,currentElement||$element).then(function(){!angular.isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()}),cleanupLastView()});currentElement=clone,currentScope=current.scope=newScope,currentScope.$emit("$viewContentLoaded"),currentScope.$eval(onloadExp)}else cleanupLastView()}var currentScope,currentElement,previousLeaveAnimation,autoScrollExp=attr.autoscroll,onloadExp=attr.onload||"";scope.$on("$routeChangeSuccess",update),update()}}}function ngViewFillContentFactory($compile,$controller,$route){return{restrict:"ECA",priority:-400,link:function(scope,$element){var current=$route.current,locals=current.locals;$element.html(locals.$template);var link=$compile($element.contents());if(current.controller){locals.$scope=scope;var controller=$controller(current.controller,locals);current.controllerAs&&(scope[current.controllerAs]=controller),$element.data("$ngControllerController",controller),$element.children().data("$ngControllerController",controller)}link(scope)}}}var ngRouteModule=angular.module("ngRoute",["ng"]).provider("$route",$RouteProvider),$routeMinErr=angular.$$minErr("ngRoute");ngRouteModule.provider("$routeParams",$RouteParamsProvider),ngRouteModule.directive("ngView",ngViewFactory),ngRouteModule.directive("ngView",ngViewFillContentFactory),ngViewFactory.$inject=["$route","$anchorScroll","$animate"],ngViewFillContentFactory.$inject=["$compile","$controller","$route"]}(window,window.angular),define("angular-route",["angular"],function(){}),function(window,angular,undefined){"use strict";function $SanitizeProvider(){this.$get=["$$sanitizeUri",function($$sanitizeUri){return function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe/.test($$sanitizeUri(uri,isImage))})),buf.join("")}}]}function sanitizeText(chars){var buf=[],writer=htmlSanitizeWriter(buf,angular.noop);return writer.chars(chars),buf.join("")}function makeMap(str,lowercaseKeys){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[lowercaseKeys?angular.lowercase(items[i]):items[i]]=!0;return obj}function htmlParser(html,handler){function parseStartTag(tag,tagName,rest,unary){if(tagName=angular.lowercase(tagName),blockElements[tagName])for(;stack.last()&&inlineElements[stack.last()];)parseEndTag("",stack.last());optionalEndTagElements[tagName]&&stack.last()==tagName&&parseEndTag("",tagName),unary=voidElements[tagName]||!!unary,unary||stack.push(tagName);var attrs={};rest.replace(ATTR_REGEXP,function(match,name,doubleQuotedValue,singleQuotedValue,unquotedValue){var value=doubleQuotedValue||singleQuotedValue||unquotedValue||"";attrs[name]=decodeEntities(value)}),handler.start&&handler.start(tagName,attrs,unary)}function parseEndTag(tag,tagName){var i,pos=0;if(tagName=angular.lowercase(tagName))for(pos=stack.length-1;pos>=0&&stack[pos]!=tagName;pos--);if(pos>=0){for(i=stack.length-1;i>=pos;i--)handler.end&&handler.end(stack[i]);stack.length=pos}}"string"!=typeof html&&(html=null===html||"undefined"==typeof html?"":""+html);var index,chars,match,text,stack=[],last=html;for(stack.last=function(){return stack[stack.length-1]};html;){if(text="",chars=!0,stack.last()&&specialElements[stack.last()]?(html=html.replace(new RegExp("([\\W\\w]*)<\\s*\\/\\s*"+stack.last()+"[^>]*>","i"),function(all,text){return text=text.replace(COMMENT_REGEXP,"$1").replace(CDATA_REGEXP,"$1"),handler.chars&&handler.chars(decodeEntities(text)),""}),parseEndTag("",stack.last())):(0===html.indexOf("<!--")?(index=html.indexOf("--",4),index>=0&&html.lastIndexOf("-->",index)===index&&(handler.comment&&handler.comment(html.substring(4,index)),html=html.substring(index+3),chars=!1)):DOCTYPE_REGEXP.test(html)?(match=html.match(DOCTYPE_REGEXP),match&&(html=html.replace(match[0],""),chars=!1)):BEGING_END_TAGE_REGEXP.test(html)?(match=html.match(END_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(END_TAG_REGEXP,parseEndTag),chars=!1)):BEGIN_TAG_REGEXP.test(html)&&(match=html.match(START_TAG_REGEXP),match?(match[4]&&(html=html.substring(match[0].length),match[0].replace(START_TAG_REGEXP,parseStartTag)),chars=!1):(text+="<",html=html.substring(1))),chars&&(index=html.indexOf("<"),text+=0>index?html:html.substring(0,index),html=0>index?"":html.substring(index),handler.chars&&handler.chars(decodeEntities(text)))),html==last)throw $sanitizeMinErr("badparse","The sanitizer was unable to parse the following block of html: {0}",html);last=html}parseEndTag()}function decodeEntities(value){return value?(hiddenPre.innerHTML=value.replace(/</g,"&lt;"),hiddenPre.textContent):""}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(value){var hi=value.charCodeAt(0),low=value.charCodeAt(1);return"&#"+(1024*(hi-55296)+(low-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf,uriValidator){var ignore=!1,out=angular.bind(buf,buf.push);return{start:function(tag,attrs,unary){tag=angular.lowercase(tag),!ignore&&specialElements[tag]&&(ignore=tag),ignore||validElements[tag]!==!0||(out("<"),out(tag),angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key),isImage="img"===tag&&"src"===lkey||"background"===lkey;validAttrs[lkey]!==!0||uriAttrs[lkey]===!0&&!uriValidator(value,isImage)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(unary?"/>":">"))},end:function(tag){tag=angular.lowercase(tag),ignore||validElements[tag]!==!0||(out("</"),out(tag),out(">")),tag==ignore&&(ignore=!1)},chars:function(chars){ignore||out(encodeEntities(chars))}}}var $sanitizeMinErr=angular.$$minErr("$sanitize"),START_TAG_REGEXP=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,END_TAG_REGEXP=/^<\/\s*([\w:-]+)[^>]*>/,ATTR_REGEXP=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,BEGIN_TAG_REGEXP=/^</,BEGING_END_TAGE_REGEXP=/^<\//,COMMENT_REGEXP=/<!--(.*?)-->/g,DOCTYPE_REGEXP=/<!DOCTYPE([^>]*?)>/i,CDATA_REGEXP=/<!\[CDATA\[(.*?)]]>/g,SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~| |!])/g,voidElements=makeMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=makeMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=angular.extend({},optionalEndTagBlockElements,makeMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),inlineElements=angular.extend({},optionalEndTagInlineElements,makeMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),svgElements=makeMap("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan,use"),specialElements=makeMap("script,style"),validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements,svgElements),uriAttrs=makeMap("background,cite,href,longdesc,src,usemap,xlink:href"),htmlAttrs=makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),svgAttrs=makeMap("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),validAttrs=angular.extend({},uriAttrs,svgAttrs,htmlAttrs),hiddenPre=document.createElement("pre");angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider),angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,MAILTO_REGEXP=/^mailto:/i;return function(text,target){function addText(text){text&&html.push(sanitizeText(text))}function addLink(url,text){html.push("<a "),angular.isDefined(target)&&html.push('target="',target,'" '),html.push('href="',url.replace(/"/g,"&quot;"),'">'),addText(text),html.push("</a>")}if(!text)return text;for(var match,url,i,raw=text,html=[];match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]||match[4]||(url=(match[3]?"http://":"mailto:")+url),i=match.index,addText(raw.substr(0,i)),addLink(url,match[0].replace(MAILTO_REGEXP,"")),raw=raw.substring(i+match[0].length);return addText(raw),$sanitize(html.join(""))}}])}(window,window.angular),define("angular-sanitize",["angular"],function(){}),function(window,angular,undefined){"use strict";function isValidDottedPath(path){return null!=path&&""!==path&&"hasOwnProperty"!==path&&MEMBER_NAME_REGEX.test("."+path)}function lookupDottedPath(obj,path){if(!isValidDottedPath(path))throw $resourceMinErr("badmember",'Dotted member path "@{0}" is invalid.',path);for(var keys=path.split("."),i=0,ii=keys.length;ii>i&&angular.isDefined(obj);i++){var key=keys[i];obj=null!==obj?obj[key]:undefined}return obj}function shallowClearAndCopy(src,dst){dst=dst||{},angular.forEach(dst,function(value,key){delete dst[key]});for(var key in src)!src.hasOwnProperty(key)||"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key]);return dst}var $resourceMinErr=angular.$$minErr("$resource"),MEMBER_NAME_REGEX=/^(\.[a-zA-Z_$@][0-9a-zA-Z_$@]*)+$/;angular.module("ngResource",["ng"]).provider("$resource",function(){var PROTOCOL_AND_DOMAIN_REGEX=/^https?:\/\/[^\/]*/,provider=this;this.defaults={stripTrailingSlashes:!0,actions:{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}}},this.$get=["$http","$log","$q",function($http,$log,$q){function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function Route(template,defaults){this.template=template,this.defaults=extend({},provider.defaults,defaults),this.urlParams={}}function resourceFactory(url,paramDefaults,actions,options){function extractParams(data,actionParams){var ids={};return actionParams=extend({},paramDefaults,actionParams),forEach(actionParams,function(value,key){isFunction(value)&&(value=value()),ids[key]=value&&value.charAt&&"@"==value.charAt(0)?lookupDottedPath(data,value.substr(1)):value}),ids}function defaultResponseInterceptor(response){return response.resource}function Resource(value){shallowClearAndCopy(value||{},this)}var route=new Route(url,options);return actions=extend({},provider.defaults.actions,actions),Resource.prototype.toJSON=function(){var data=extend({},this);return delete data.$promise,delete data.$resolved,data},forEach(actions,function(action,name){var hasBody=/^(POST|PUT|PATCH)$/i.test(action.method);Resource[name]=function(a1,a2,a3,a4){var data,success,error,params={};switch(arguments.length){case 4:error=a4,success=a3;case 3:case 2:if(!isFunction(a2)){params=a1,data=a2,success=a3;break}if(isFunction(a1)){success=a1,error=a2;break}success=a2,error=a3;case 1:isFunction(a1)?success=a1:hasBody?data=a1:params=a1;break;case 0:break;default:throw $resourceMinErr("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var isInstanceCall=this instanceof Resource,value=isInstanceCall?data:action.isArray?[]:new Resource(data),httpConfig={},responseInterceptor=action.interceptor&&action.interceptor.response||defaultResponseInterceptor,responseErrorInterceptor=action.interceptor&&action.interceptor.responseError||undefined;forEach(action,function(value,key){switch(key){default:httpConfig[key]=copy(value);break;case"params":case"isArray":case"interceptor":break;case"timeout":value&&!angular.isNumber(value)&&$log.debug("ngResource:\n  Only numeric values are allowed as `timeout`.\n  Promises are not supported in $resource, because the same value would be used for multiple requests.\n  If you need support for cancellable $resource actions, you should upgrade to version 1.5 or higher.")}}),hasBody&&(httpConfig.data=data),route.setUrlParams(httpConfig,extend({},extractParams(data,action.params||{}),params),action.url);var promise=$http(httpConfig).then(function(response){var data=response.data,promise=value.$promise;if(data){if(angular.isArray(data)!==!!action.isArray)throw $resourceMinErr("badcfg","Error in resource configuration for action `{0}`. Expected response to contain an {1} but got an {2} (Request: {3} {4})",name,action.isArray?"array":"object",angular.isArray(data)?"array":"object",httpConfig.method,httpConfig.url);action.isArray?(value.length=0,forEach(data,function(item){"object"==typeof item?value.push(new Resource(item)):value.push(item)})):(shallowClearAndCopy(data,value),value.$promise=promise)}return value.$resolved=!0,response.resource=value,response},function(response){return value.$resolved=!0,(error||noop)(response),$q.reject(response)});return promise=promise.then(function(response){var value=responseInterceptor(response);return(success||noop)(value,response.headers),value},responseErrorInterceptor),isInstanceCall?promise:(value.$promise=promise,value.$resolved=!1,value)},Resource.prototype["$"+name]=function(params,success,error){isFunction(params)&&(error=success,success=params,params={});var result=Resource[name].call(this,params,this,success,error);return result.$promise||result}}),Resource.bind=function(additionalParamDefaults){return resourceFactory(url,extend({},paramDefaults,additionalParamDefaults),actions)},Resource}var noop=angular.noop,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,isFunction=angular.isFunction;return Route.prototype={setUrlParams:function(config,params,actionUrl){var val,encodedVal,self=this,url=actionUrl||self.template,protocolAndDomain="",urlParams=self.urlParams={};forEach(url.split(/\W/),function(param){if("hasOwnProperty"===param)throw $resourceMinErr("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(param)&&param&&new RegExp("(^|[^\\\\]):"+param+"(\\W|$)").test(url)&&(urlParams[param]=!0)}),url=url.replace(/\\:/g,":"),url=url.replace(PROTOCOL_AND_DOMAIN_REGEX,function(match){return protocolAndDomain=match,""}),params=params||{},forEach(self.urlParams,function(_,urlParam){val=params.hasOwnProperty(urlParam)?params[urlParam]:self.defaults[urlParam],angular.isDefined(val)&&null!==val?(encodedVal=encodeUriSegment(val),url=url.replace(new RegExp(":"+urlParam+"(\\W|$)","g"),function(match,p1){return encodedVal+p1})):url=url.replace(new RegExp("(/?):"+urlParam+"(\\W|$)","g"),function(match,leadingSlashes,tail){return"/"==tail.charAt(0)?tail:leadingSlashes+tail})}),self.defaults.stripTrailingSlashes&&(url=url.replace(/\/+$/,"")||"/"),url=url.replace(/\/\.(?=\w+($|\?))/,"."),config.url=protocolAndDomain+url.replace(/\/\\\./,"/."),forEach(params,function(value,key){self.urlParams[key]||(config.params=config.params||{},config.params[key]=value)})}},resourceFactory}]})}(window,window.angular),define("angular-resource",["angular"],function(){}),function(factory){"function"==typeof define&&define.amd?define("../bower_components/jquery-ui/ui/version",["jquery"],factory):factory(jQuery)}(function($){return $.ui=$.ui||{},$.ui.version="1.12.0"}),function(factory){"function"==typeof define&&define.amd?define("../bower_components/jquery-ui/ui/keycode",["jquery","./version"],factory):factory(jQuery)}(function($){return $.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),function(factory){"function"==typeof define&&define.amd?define("../bower_components/jquery-ui/ui/position",["jquery","./version"],factory):factory(jQuery)}(function($){return function(){function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)]}function parseCss(element,property){return parseInt($.css(element,property),10)||0}function getDimensions(elem){var raw=elem[0];return 9===raw.nodeType?{width:elem.width(),height:elem.height(),offset:{top:0,left:0}}:$.isWindow(raw)?{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}}:raw.preventDefault?{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}}:{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()}}var cachedScrollbarWidth,supportsOffsetFractions,max=Math.max,abs=Math.abs,round=Math.round,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;supportsOffsetFractions=function(){var element=$("<div>").css("position","absolute").appendTo("body").offset({top:1.5,left:1.5}),support=1.5===element.offset().top;return element.remove(),supportsOffsetFractions=function(){return support},support},$.position={scrollbarWidth:function(){if(void 0!==cachedScrollbarWidth)return cachedScrollbarWidth;var w1,w2,div=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];return $("body").append(div),w1=innerDiv.offsetWidth,div.css("overflow","scroll"),w2=innerDiv.offsetWidth,w1===w2&&(w2=div[0].clientWidth),div.remove(),cachedScrollbarWidth=w1-w2},getScrollInfo:function(within){
var overflowX=within.isWindow||within.isDocument?"":within.element.css("overflow-x"),overflowY=within.isWindow||within.isDocument?"":within.element.css("overflow-y"),hasOverflowX="scroll"===overflowX||"auto"===overflowX&&within.width<within.element[0].scrollWidth,hasOverflowY="scroll"===overflowY||"auto"===overflowY&&within.height<within.element[0].scrollHeight;return{width:hasOverflowY?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0}},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]),isDocument=!!withinElement[0]&&9===withinElement[0].nodeType,hasOffset=!isWindow&&!isDocument;return{element:withinElement,isWindow:isWindow,isDocument:isDocument,offset:hasOffset?$(element).offset():{left:0,top:0},scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:withinElement.outerWidth(),height:withinElement.outerHeight()}}},$.fn.position=function(options){if(!options||!options.of)return _position.apply(this,arguments);options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};return dimensions=getDimensions(target),target[0].preventDefault&&(options.at="left top"),targetWidth=dimensions.width,targetHeight=dimensions.height,targetOffset=dimensions.offset,basePosition=$.extend({},targetOffset),$.each(["my","at"],function(){var horizontalOffset,verticalOffset,pos=(options[this]||"").split(" ");1===pos.length&&(pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"]),pos[0]=rhorizontal.test(pos[0])?pos[0]:"center",pos[1]=rvertical.test(pos[1])?pos[1]:"center",horizontalOffset=roffset.exec(pos[0]),verticalOffset=roffset.exec(pos[1]),offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0],options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]]}),1===collision.length&&(collision[1]=collision[0]),"right"===options.at[0]?basePosition.left+=targetWidth:"center"===options.at[0]&&(basePosition.left+=targetWidth/2),"bottom"===options.at[1]?basePosition.top+=targetHeight:"center"===options.at[1]&&(basePosition.top+=targetHeight/2),atOffset=getOffsets(offsets.at,targetWidth,targetHeight),basePosition.left+=atOffset[0],basePosition.top+=atOffset[1],this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());"right"===options.my[0]?position.left-=elemWidth:"center"===options.my[0]&&(position.left-=elemWidth/2),"bottom"===options.my[1]?position.top-=elemHeight:"center"===options.my[1]&&(position.top-=elemHeight/2),position.left+=myOffset[0],position.top+=myOffset[1],supportsOffsetFractions()||(position.left=round(position.left),position.top=round(position.top)),collisionPosition={marginLeft:marginLeft,marginTop:marginTop},$.each(["left","top"],function(i,dir){$.ui.position[collision[i]]&&$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem})}),options.using&&(using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:0>right?"left":left>0?"right":"center",vertical:0>bottom?"top":top>0?"bottom":"middle"};elemWidth>targetWidth&&abs(left+right)<targetWidth&&(feedback.horizontal="center"),elemHeight>targetHeight&&abs(top+bottom)<targetHeight&&(feedback.vertical="middle"),max(abs(left),abs(right))>max(abs(top),abs(bottom))?feedback.important="horizontal":feedback.important="vertical",options.using.call(this,props,feedback)}),elem.offset($.extend(position,{using:using}))})},$.ui.position={fit:{left:function(position,data){var newOverRight,within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset;data.collisionWidth>outerWidth?overLeft>0&&0>=overRight?(newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset,position.left+=overLeft-newOverRight):overRight>0&&0>=overLeft?position.left=withinOffset:overLeft>overRight?position.left=withinOffset+outerWidth-data.collisionWidth:position.left=withinOffset:overLeft>0?position.left+=overLeft:overRight>0?position.left-=overRight:position.left=max(position.left-collisionPosLeft,position.left)},top:function(position,data){var newOverBottom,within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset;data.collisionHeight>outerHeight?overTop>0&&0>=overBottom?(newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset,position.top+=overTop-newOverBottom):overBottom>0&&0>=overTop?position.top=withinOffset:overTop>overBottom?position.top=withinOffset+outerHeight-data.collisionHeight:position.top=withinOffset:overTop>0?position.top+=overTop:overBottom>0?position.top-=overBottom:position.top=max(position.top-collisionPosTop,position.top)}},flip:{left:function(position,data){var newOverRight,newOverLeft,within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset="left"===data.my[0]?-data.elemWidth:"right"===data.my[0]?data.elemWidth:0,atOffset="left"===data.at[0]?data.targetWidth:"right"===data.at[0]?-data.targetWidth:0,offset=-2*data.offset[0];0>overLeft?(newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset,(0>newOverRight||newOverRight<abs(overLeft))&&(position.left+=myOffset+atOffset+offset)):overRight>0&&(newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft,(newOverLeft>0||abs(newOverLeft)<overRight)&&(position.left+=myOffset+atOffset+offset))},top:function(position,data){var newOverTop,newOverBottom,within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,top="top"===data.my[1],myOffset=top?-data.elemHeight:"bottom"===data.my[1]?data.elemHeight:0,atOffset="top"===data.at[1]?data.targetHeight:"bottom"===data.at[1]?-data.targetHeight:0,offset=-2*data.offset[1];0>overTop?(newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset,(0>newOverBottom||newOverBottom<abs(overTop))&&(position.top+=myOffset+atOffset+offset)):overBottom>0&&(newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop,(newOverTop>0||abs(newOverTop)<overBottom)&&(position.top+=myOffset+atOffset+offset))}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments),$.ui.position.fit.left.apply(this,arguments)},top:function(){$.ui.position.flip.top.apply(this,arguments),$.ui.position.fit.top.apply(this,arguments)}}}}(),$.ui.position}),function(factory){"function"==typeof define&&define.amd?define("../bower_components/jquery-ui/ui/safe-active-element",["jquery","./version"],factory):factory(jQuery)}(function($){return $.ui.safeActiveElement=function(document){var activeElement;try{activeElement=document.activeElement}catch(error){activeElement=document.body}return activeElement||(activeElement=document.body),activeElement.nodeName||(activeElement=document.body),activeElement}}),function(factory){"function"==typeof define&&define.amd?define("../bower_components/jquery-ui/ui/unique-id",["jquery","./version"],factory):factory(jQuery)}(function($){return $.fn.extend({uniqueId:function(){var uuid=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++uuid)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&$(this).removeAttr("id")})}})}),function(factory){"function"==typeof define&&define.amd?define("../bower_components/jquery-ui/ui/widget",["jquery","./version"],factory):factory(jQuery)}(function($){var widgetUuid=0,widgetSlice=Array.prototype.slice;return $.cleanData=function(orig){return function(elems){var events,elem,i;for(i=0;null!=(elem=elems[i]);i++)try{events=$._data(elem,"events"),events&&events.remove&&$(elem).triggerHandler("remove")}catch(e){}orig(elems)}}($.cleanData),$.widget=function(name,base,prototype){var existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];var fullName=namespace+"-"+name;return prototype||(prototype=base,base=$.Widget),$.isArray(prototype)&&(prototype=$.extend.apply(null,[{}].concat(prototype))),$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)},$[namespace]=$[namespace]||{},existingConstructor=$[namespace][name],constructor=$[namespace][name]=function(options,element){return this._createWidget?void(arguments.length&&this._createWidget(options,element)):new constructor(options,element)},$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]}),basePrototype=new base,basePrototype.options=$.widget.extend({},basePrototype.options),$.each(prototype,function(prop,value){return $.isFunction(value)?void(proxiedPrototype[prop]=function(){function _super(){return base.prototype[prop].apply(this,arguments)}function _superApply(args){return base.prototype[prop].apply(this,args)}return function(){var returnValue,__super=this._super,__superApply=this._superApply;return this._super=_super,this._superApply=_superApply,returnValue=value.apply(this,arguments),this._super=__super,this._superApply=__superApply,returnValue}}()):void(proxiedPrototype[prop]=value)}),constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix||name:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName}),existingConstructor?($.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)}),delete existingConstructor._childConstructors):base._childConstructors.push(constructor),$.widget.bridge(name,constructor),constructor},$.widget.extend=function(target){for(var key,value,input=widgetSlice.call(arguments,1),inputIndex=0,inputLength=input.length;inputLength>inputIndex;inputIndex++)for(key in input[inputIndex])value=input[inputIndex][key],input[inputIndex].hasOwnProperty(key)&&void 0!==value&&($.isPlainObject(value)?target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value):target[key]=value);return target},$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall="string"==typeof options,args=widgetSlice.call(arguments,1),returnValue=this;return isMethodCall?this.each(function(){var methodValue,instance=$.data(this,fullName);return"instance"===options?(returnValue=instance,!1):instance?$.isFunction(instance[options])&&"_"!==options.charAt(0)?(methodValue=instance[options].apply(instance,args),methodValue!==instance&&void 0!==methodValue?(returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue,!1):void 0):$.error("no such method '"+options+"' for "+name+" widget instance"):$.error("cannot call methods on "+name+" prior to initialization; attempted to call method '"+options+"'")}):(args.length&&(options=$.widget.extend.apply(null,[options].concat(args))),this.each(function(){var instance=$.data(this,fullName);instance?(instance.option(options||{}),instance._init&&instance._init()):$.data(this,fullName,new object(options,this))})),returnValue}},$.Widget=function(){},$.Widget._childConstructors=[],$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0],this.element=$(element),this.uuid=widgetUuid++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=$(),this.hoverable=$(),this.focusable=$(),this.classesElementLookup={},element!==this&&($.data(element,this.widgetFullName,this),this._on(!0,this.element,{remove:function(event){event.target===element&&this.destroy()}}),this.document=$(element.style?element.ownerDocument:element.document||element),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this.options=$.widget.extend({},this.options,this._getCreateOptions(),options),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){var that=this;this._destroy(),$.each(this.classesElementLookup,function(key,value){that._removeClass(value,key)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var parts,curOption,i,options=key;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof key)if(options={},parts=key.split("."),key=parts.shift(),parts.length){for(curOption=options[key]=$.widget.extend({},this.options[key]),i=0;i<parts.length-1;i++)curOption[parts[i]]=curOption[parts[i]]||{},curOption=curOption[parts[i]];if(key=parts.pop(),1===arguments.length)return void 0===curOption[key]?null:curOption[key];curOption[key]=value}else{if(1===arguments.length)return void 0===this.options[key]?null:this.options[key];options[key]=value}return this._setOptions(options),this},_setOptions:function(options){var key;for(key in options)this._setOption(key,options[key]);return this},_setOption:function(key,value){return"classes"===key&&this._setOptionClasses(value),this.options[key]=value,"disabled"===key&&this._setOptionDisabled(value),this},_setOptionClasses:function(value){var classKey,elements,currentElements;for(classKey in value)currentElements=this.classesElementLookup[classKey],value[classKey]!==this.options.classes[classKey]&&currentElements&&currentElements.length&&(elements=$(currentElements.get()),this._removeClass(currentElements,classKey),elements.addClass(this._classes({element:elements,keys:classKey,classes:value,add:!0})))},_setOptionDisabled:function(value){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!value),value&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(options){function processClassString(classes,checkOption){var current,i;for(i=0;i<classes.length;i++)current=that.classesElementLookup[classes[i]]||$(),current=$(options.add?$.unique(current.get().concat(options.element.get())):current.not(options.element).get()),that.classesElementLookup[classes[i]]=current,full.push(classes[i]),checkOption&&options.classes[classes[i]]&&full.push(options.classes[classes[i]])}var full=[],that=this;return options=$.extend({element:this.element,classes:this.options.classes||{}},options),options.keys&&processClassString(options.keys.match(/\S+/g)||[],!0),options.extra&&processClassString(options.extra.match(/\S+/g)||[]),full.join(" ")},_removeClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,!1)},_addClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,!0)},_toggleClass:function(element,keys,extra,add){add="boolean"==typeof add?add:extra;var shift="string"==typeof element||null===element,options={extra:shift?keys:extra,keys:shift?element:keys,element:shift?this.element:element,add:add};return options.element.toggleClass(this._classes(options),add),this},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;"boolean"!=typeof suppressDisabledCheck&&(handlers=element,element=suppressDisabledCheck,suppressDisabledCheck=!1),handlers?(element=delegateElement=$(element),this.bindings=this.bindings.add(element)):(handlers=element,element=this.element,delegateElement=this.widget()),$.each(handlers,function(event,handler){function handlerProxy(){return suppressDisabledCheck||instance.options.disabled!==!0&&!$(this).hasClass("ui-state-disabled")?("string"==typeof handler?instance[handler]:handler).apply(instance,arguments):void 0}"string"!=typeof handler&&(handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++);var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];selector?delegateElement.on(eventName,selector,handlerProxy):element.on(eventName,handlerProxy)})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,element.off(eventName).off(eventName),this.bindings=$(this.bindings.not(element).get()),this.focusable=$(this.focusable.not(element).get()),this.hoverable=$(this.hoverable.not(element).get())},_delay:function(handler,delay){function handlerProxy(){return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element),this._on(element,{mouseenter:function(event){this._addClass($(event.currentTarget),null,"ui-state-hover")},mouseleave:function(event){this._removeClass($(event.currentTarget),null,"ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element),this._on(element,{focusin:function(event){this._addClass($(event.currentTarget),null,"ui-state-focus")},focusout:function(event){this._removeClass($(event.currentTarget),null,"ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];if(data=data||{},event=$.Event(event),event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase(),event.target=this.element[0],orig=event.originalEvent)for(prop in orig)prop in event||(event[prop]=orig[prop]);return this.element.trigger(event,data),!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===!1||event.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){"string"==typeof options&&(options={effect:options});var hasOptions,effectName=options?options===!0||"number"==typeof options?defaultEffect:options.effect||defaultEffect:method;options=options||{},"number"==typeof options&&(options={duration:options}),hasOptions=!$.isEmptyObject(options),options.complete=callback,options.delay&&element.delay(options.delay),hasOptions&&$.effects&&$.effects.effect[effectName]?element[method](options):effectName!==method&&element[effectName]?element[effectName](options.duration,options.easing,callback):element.queue(function(next){$(this)[method](),callback&&callback.call(element[0]),next()})}}),$.widget}),function(factory){"function"==typeof define&&define.amd?define("../bower_components/jquery-ui/ui/widgets/menu",["jquery","../keycode","../position","../safe-active-element","../unique-id","../version","../widget"],factory):factory(jQuery)}(function($){return $.widget("ui.menu",{version:"1.12.0",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(event){event.preventDefault()},"click .ui-menu-item":function(event){var target=$(event.target),active=$($.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&target.not(".ui-state-disabled").length&&(this.select(event),event.isPropagationStopped()||(this.mouseHandled=!0),target.has(".ui-menu").length?this.expand(event):!this.element.is(":focus")&&active.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(event){if(!this.previousFilter){var actualTarget=$(event.target).closest(".ui-menu-item"),target=$(event.currentTarget);actualTarget[0]===target[0]&&(this._removeClass(target.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(event,target))}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(event,keepActiveItem){var item=this.active||this.element.find(this.options.items).eq(0);keepActiveItem||this.focus(event,item)},blur:function(event){this._delay(function(){var notContained=!$.contains(this.element[0],$.ui.safeActiveElement(this.document[0]));notContained&&this.collapseAll(event)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(event){this._closeOnDocumentClick(event)&&this.collapseAll(event),this.mouseHandled=!1}})},_destroy:function(){var items=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),submenus=items.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),submenus.children().each(function(){var elem=$(this);elem.data("ui-menu-submenu-caret")&&elem.remove()})},_keydown:function(event){var match,prev,character,skip,preventDefault=!0;switch(event.keyCode){case $.ui.keyCode.PAGE_UP:this.previousPage(event);break;case $.ui.keyCode.PAGE_DOWN:this.nextPage(event);break;case $.ui.keyCode.HOME:this._move("first","first",event);break;case $.ui.keyCode.END:this._move("last","last",event);break;case $.ui.keyCode.UP:this.previous(event);break;case $.ui.keyCode.DOWN:this.next(event);break;case $.ui.keyCode.LEFT:this.collapse(event);break;case $.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(event);break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:this._activate(event);break;case $.ui.keyCode.ESCAPE:this.collapse(event);break;default:preventDefault=!1,prev=this.previousFilter||"",character=String.fromCharCode(event.keyCode),skip=!1,clearTimeout(this.filterTimer),character===prev?skip=!0:character=prev+character,match=this._filterMenuItems(character),match=skip&&-1!==match.index(this.active.next())?this.active.nextAll(".ui-menu-item"):match,match.length||(character=String.fromCharCode(event.keyCode),match=this._filterMenuItems(character)),match.length?(this.focus(event,match),this.previousFilter=character,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}preventDefault&&event.preventDefault()},_activate:function(event){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(event):this.select(event))},refresh:function(){var menus,items,newSubmenus,newItems,newWrappers,that=this,icon=this.options.icons.submenu,submenus=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),newSubmenus=submenus.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var menu=$(this),item=menu.prev(),submenuCaret=$("<span>").data("ui-menu-submenu-caret",!0);that._addClass(submenuCaret,"ui-menu-icon","ui-icon "+icon),item.attr("aria-haspopup","true").prepend(submenuCaret),menu.attr("aria-labelledby",item.attr("id"))}),this._addClass(newSubmenus,"ui-menu","ui-widget ui-widget-content ui-front"),menus=submenus.add(this.element),items=menus.find(this.options.items),items.not(".ui-menu-item").each(function(){var item=$(this);that._isDivider(item)&&that._addClass(item,"ui-menu-divider","ui-widget-content")}),newItems=items.not(".ui-menu-item, .ui-menu-divider"),newWrappers=newItems.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(newItems,"ui-menu-item")._addClass(newWrappers,"ui-menu-item-wrapper"),items.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!$.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(key,value){if("icons"===key){var icons=this.element.find(".ui-menu-icon");this._removeClass(icons,null,this.options.icons.submenu)._addClass(icons,null,value.submenu)}this._super(key,value)},_setOptionDisabled:function(value){this._super(value),this.element.attr("aria-disabled",String(value)),this._toggleClass(null,"ui-state-disabled",!!value)},focus:function(event,item){var nested,focused,activeParent;this.blur(event,event&&"focus"===event.type),this._scrollIntoView(item),this.active=item.first(),focused=this.active.children(".ui-menu-item-wrapper"),this._addClass(focused,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",focused.attr("id")),activeParent=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(activeParent,null,"ui-state-active"),event&&"keydown"===event.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),nested=item.children(".ui-menu"),nested.length&&event&&/^mouse/.test(event.type)&&this._startOpening(nested),this.activeMenu=item.parent(),this._trigger("focus",event,{item:item})},_scrollIntoView:function(item){var borderTop,paddingTop,offset,scroll,elementHeight,itemHeight;this._hasScroll()&&(borderTop=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0,paddingTop=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0,offset=item.offset().top-this.activeMenu.offset().top-borderTop-paddingTop,scroll=this.activeMenu.scrollTop(),elementHeight=this.activeMenu.height(),itemHeight=item.outerHeight(),0>offset?this.activeMenu.scrollTop(scroll+offset):offset+itemHeight>elementHeight&&this.activeMenu.scrollTop(scroll+offset-elementHeight+itemHeight))},blur:function(event,fromFocus){fromFocus||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",event,{item:this.active}),this.active=null)},_startOpening:function(submenu){clearTimeout(this.timer),"true"===submenu.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(submenu)},this.delay))},_open:function(submenu){var position=$.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(submenu.parents(".ui-menu")).hide().attr("aria-hidden","true"),submenu.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(position)},collapseAll:function(event,all){clearTimeout(this.timer),this.timer=this._delay(function(){var currentMenu=all?this.element:$(event&&event.target).closest(this.element.find(".ui-menu"));currentMenu.length||(currentMenu=this.element),this._close(currentMenu),this.blur(event),this._removeClass(currentMenu.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=currentMenu},this.delay)},_close:function(startMenu){startMenu||(startMenu=this.active?this.active.parent():this.element),startMenu.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(event){return!$(event.target).closest(".ui-menu").length},_isDivider:function(item){return!/[^\-\u2014\u2013\s]/.test(item.text())},collapse:function(event){var newItem=this.active&&this.active.parent().closest(".ui-menu-item",this.element);newItem&&newItem.length&&(this._close(),this.focus(event,newItem))},expand:function(event){var newItem=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();newItem&&newItem.length&&(this._open(newItem.parent()),this._delay(function(){this.focus(event,newItem)}))},next:function(event){this._move("next","first",event)},previous:function(event){this._move("prev","last",event)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(direction,filter,event){var next;this.active&&(next="first"===direction||"last"===direction?this.active["first"===direction?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[direction+"All"](".ui-menu-item").eq(0)),next&&next.length&&this.active||(next=this.activeMenu.find(this.options.items)[filter]()),this.focus(event,next)},nextPage:function(event){var item,base,height;return this.active?void(this.isLastItem()||(this._hasScroll()?(base=this.active.offset().top,height=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return item=$(this),item.offset().top-base-height<0}),this.focus(event,item)):this.focus(event,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(event)},previousPage:function(event){var item,base,height;return this.active?void(this.isFirstItem()||(this._hasScroll()?(base=this.active.offset().top,height=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return item=$(this),item.offset().top-base+height>0}),this.focus(event,item)):this.focus(event,this.activeMenu.find(this.options.items).first()))):void this.next(event)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(event){this.active=this.active||$(event.target).closest(".ui-menu-item");var ui={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(event,!0),this._trigger("select",event,ui)},_filterMenuItems:function(character){var escapedCharacter=character.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),regex=new RegExp("^"+escapedCharacter,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return regex.test($.trim($(this).children(".ui-menu-item-wrapper").text()))})}})}),function(factory){"function"==typeof define&&define.amd?define("../bower_components/jquery-ui/ui/widgets/autocomplete",["jquery","./menu","../keycode","../position","../safe-active-element","../version","../widget"],factory):factory(jQuery);
}(function($){return $.widget("ui.autocomplete",{version:"1.12.0",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var suppressKeyPress,suppressKeyPressRepeat,suppressInput,nodeName=this.element[0].nodeName.toLowerCase(),isTextarea="textarea"===nodeName,isInput="input"===nodeName;this.isMultiLine=isTextarea||!isInput&&this._isContentEditable(this.element),this.valueMethod=this.element[isTextarea||isInput?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(event){if(this.element.prop("readOnly"))return suppressKeyPress=!0,suppressInput=!0,void(suppressKeyPressRepeat=!0);suppressKeyPress=!1,suppressInput=!1,suppressKeyPressRepeat=!1;var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:suppressKeyPress=!0,this._move("previousPage",event);break;case keyCode.PAGE_DOWN:suppressKeyPress=!0,this._move("nextPage",event);break;case keyCode.UP:suppressKeyPress=!0,this._keyEvent("previous",event);break;case keyCode.DOWN:suppressKeyPress=!0,this._keyEvent("next",event);break;case keyCode.ENTER:this.menu.active&&(suppressKeyPress=!0,event.preventDefault(),this.menu.select(event));break;case keyCode.TAB:this.menu.active&&this.menu.select(event);break;case keyCode.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(event),event.preventDefault());break;default:suppressKeyPressRepeat=!0,this._searchTimeout(event)}},keypress:function(event){if(suppressKeyPress)return suppressKeyPress=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&event.preventDefault());if(!suppressKeyPressRepeat){var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:this._move("previousPage",event);break;case keyCode.PAGE_DOWN:this._move("nextPage",event);break;case keyCode.UP:this._keyEvent("previous",event);break;case keyCode.DOWN:this._keyEvent("next",event)}}},input:function(event){return suppressInput?(suppressInput=!1,void event.preventDefault()):void this._searchTimeout(event)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(event){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(event),void this._change(event))}}),this._initSource(),this.menu=$("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(event){event.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,this.element[0]!==$.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")})},menufocus:function(event,ui){var label,item;return this.isNewMenu&&(this.isNewMenu=!1,event.originalEvent&&/^mouse/.test(event.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){$(event.target).trigger(event.originalEvent)})):(item=ui.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",event,{item:item})&&event.originalEvent&&/^key/.test(event.originalEvent.type)&&this._value(item.value),label=ui.item.attr("aria-label")||item.value,void(label&&$.trim(label).length&&(this.liveRegion.children().hide(),$("<div>").text(label).appendTo(this.liveRegion))))},menuselect:function(event,ui){var item=ui.item.data("ui-autocomplete-item"),previous=this.previous;this.element[0]!==$.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=previous,this._delay(function(){this.previous=previous,this.selectedItem=item})),!1!==this._trigger("select",event,{item:item})&&this._value(item.value),this.term=this._value(),this.close(event),this.selectedItem=item}}),this.liveRegion=$("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(key,value){this._super(key,value),"source"===key&&this._initSource(),"appendTo"===key&&this.menu.element.appendTo(this._appendTo()),"disabled"===key&&value&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(event){var menuElement=this.menu.element[0];return event.target===this.element[0]||event.target===menuElement||$.contains(menuElement,event.target)},_closeOnClickOutside:function(event){this._isEventTargetInWidget(event)||this.close()},_appendTo:function(){var element=this.options.appendTo;return element&&(element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0)),element&&element[0]||(element=this.element.closest(".ui-front, dialog")),element.length||(element=this.document[0].body),element},_initSource:function(){var array,url,that=this;$.isArray(this.options.source)?(array=this.options.source,this.source=function(request,response){response($.ui.autocomplete.filter(array,request.term))}):"string"==typeof this.options.source?(url=this.options.source,this.source=function(request,response){that.xhr&&that.xhr.abort(),that.xhr=$.ajax({url:url,data:request,dataType:"json",success:function(data){response(data)},error:function(){response([])}})}):this.source=this.options.source},_searchTimeout:function(event){clearTimeout(this.searching),this.searching=this._delay(function(){var equalValues=this.term===this._value(),menuVisible=this.menu.element.is(":visible"),modifierKey=event.altKey||event.ctrlKey||event.metaKey||event.shiftKey;(!equalValues||equalValues&&!menuVisible&&!modifierKey)&&(this.selectedItem=null,this.search(null,event))},this.options.delay)},search:function(value,event){return value=null!=value?value:this._value(),this.term=this._value(),value.length<this.options.minLength?this.close(event):this._trigger("search",event)!==!1?this._search(value):void 0},_search:function(value){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:value},this._response())},_response:function(){var index=++this.requestIndex;return $.proxy(function(content){index===this.requestIndex&&this.__response(content),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")},this)},__response:function(content){content&&(content=this._normalize(content)),this._trigger("response",null,{content:content}),!this.options.disabled&&content&&content.length&&!this.cancelSearch?(this._suggest(content),this._trigger("open")):this._close()},close:function(event){this.cancelSearch=!0,this._close(event)},_close:function(event){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",event))},_change:function(event){this.previous!==this._value()&&this._trigger("change",event,{item:this.selectedItem})},_normalize:function(items){return items.length&&items[0].label&&items[0].value?items:$.map(items,function(item){return"string"==typeof item?{label:item,value:item}:$.extend({},item,{label:item.label||item.value,value:item.value||item.label})})},_suggest:function(items){var ul=this.menu.element.empty();this._renderMenu(ul,items),this.isNewMenu=!0,this.menu.refresh(),ul.show(),this._resizeMenu(),ul.position($.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var ul=this.menu.element;ul.outerWidth(Math.max(ul.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(ul,items){var that=this;$.each(items,function(index,item){that._renderItemData(ul,item)})},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-autocomplete-item",item)},_renderItem:function(ul,item){return $("<li>").append($("<div>").text(item.label)).appendTo(ul)},_move:function(direction,event){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(direction)||this.menu.isLastItem()&&/^next/.test(direction)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[direction](event):void this.search(null,event)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(keyEvent,event){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(keyEvent,event),event.preventDefault())},_isContentEditable:function(element){if(!element.length)return!1;var editable=element.prop("contentEditable");return"inherit"===editable?this._isContentEditable(element.parent()):"true"===editable}}),$.extend($.ui.autocomplete,{escapeRegex:function(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value)})}}),$.widget("ui.autocomplete",$.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(amount){return amount+(amount>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(content){var message;this._superApply(arguments),this.options.disabled||this.cancelSearch||(message=content&&content.length?this.options.messages.results(content.length):this.options.messages.noResults,this.liveRegion.children().hide(),$("<div>").text(message).appendTo(this.liveRegion))}}),$.ui.autocomplete}),function(factory){"function"==typeof define&&define.amd?define("jqueryhammerjs",["jquery","hammerjs"],factory):"object"==typeof exports?factory(require("jquery"),require("hammerjs")):factory(jQuery,Hammer)}(function($,Hammer){function hammerify(el,options){var $el=$(el);$el.data("hammer")||$el.data("hammer",new Hammer($el[0],options))}$.fn.hammer=function(options){return this.each(function(){hammerify(this,options)})},Hammer.Manager.prototype.emit=function(originalEmit){return function(type,data){originalEmit.call(this,type,data),$(this.element).trigger({type:type,gesture:data})}}(Hammer.Manager.prototype.emit)});var baseUrl=(window&&window.apiVars&&window.apiVars.script_location||"")+"/scripts/";require.config({waitSeconds:60,paths:{jquery:"../bower_components/jquery/dist/jquery",spin:"../bower_components/spin.js/spin",hammerjs:"../bower_components/hammerjs/hammer",jqueryhammerjs:"../scripts/vendor/jquery.hammer","angular-cookies":"../bower_components/angular-cookies/angular-cookies","angular-scenario":"../bower_components/angular-scenario/angular-scenario","angular-sanitize":"../bower_components/angular-sanitize/angular-sanitize","angular-route":"../bower_components/angular-route/angular-route","angular-resource":"../bower_components/angular-resource/angular-resource","angular-mocks":"../bower_components/angular-mocks/angular-mocks",ngTouch:"../bower_components/angular-touch/angular-touch",angular:"../bower_components/angular/angular",svgjs:"../bower_components/svg.js/dist/svg",WebFont:"../scripts/vendor/webfontloader/webfont",Utilities:"../scripts/vendor/logogarden/utils",easings:"../bower_components/morpheus/src/easings",morpheus:"../bower_components/morpheus/morpheus",canvg:"../scripts/vendor/canvg/canvg.min",transform:"../scripts/vendor/senocular/TransformTool","transform-dom":"../scripts/vendor/senocular/DOMTransformTool","transform-utils":"../scripts/vendor/senocular/Utils",draggable:"../scripts/vendor/draggable",tooltip:"../scripts/vendor/html5tooltips",xml:"../bower_components/xml-to-json/xml.min",json2xml:"../bower_components/xml-to-json/json2xml.min","jquery.xml":"../bower_components/xml-to-json/jquery.xml.min","angular-touch":"../bower_components/angular-touch/angular-touch",svg:"../bower_components/svg.js/dist/svg","jquery-ui":"../bower_components/jquery-ui/jquery-ui"},shim:{angular:{deps:["jquery"],exports:"angular"},"angular-route":["angular"],"angular-sanitize":["angular"],ngTouch:["angular"],"angular-resource":["angular"],"angular-cookies":["angular"],"angular-mocks":{deps:["angular"],exports:"angular.mock"},morpheus:{deps:["easings"],exports:"morpheus"},"transform-dom":{deps:["transform-utils","transform"]}},priority:["angular"]}),window.name="NG_DEFER_BOOTSTRAP!",require(["angular","app","config","angular-route","angular-sanitize","angular-resource","hammerjs","../bower_components/jquery-ui/ui/widgets/autocomplete","jqueryhammerjs"],function(angular,app,ngRoutes,ngSanitize,ngResource){"use strict";var $html=angular.element(document.getElementsByTagName("html")[0]);window.ie9=$html.hasClass("ie9")?!0:!1,"function"==typeof patchAngular&&patchAngular(app),angular.element().ready(function(){try{angular.resumeBootstrap([app.name])}catch(e){console.error(e.stack||e.message||e)}})}),define("main",function(){})}();
;angular.module('logoBuilderApp.partials', []);
'use strict';

angular.module('logoBuilderApp.partials').
run(['$templateCache', function($templateCache) {
  $templateCache.put('views/SymbolCatalog.directive.html', '<div class="symbol-list"><ul ng-if="!isViewEmpty"><li symbol-catalog-item symbol="symbol" view-index="$index" item-size="itemSize" ng-repeat="symbol in viewSymbols | limitTo:viewItemsPerPage:(viewItemsPerPage*viewPageIndex) track by symbol.id" on-catalog-item-click="onCatalogItemClick(symbol)"></li></ul><div ng-if="isViewEmpty"><span id="NoResults" class="noresults">No Results Found. &nbsp; Please Try Again.<br><br><strong>Search Suggestions:</strong><br><br>&bull; Try an object like "cup" or "house"<br>&bull; Try an description like "fast" or "slow"<br>&bull; Try a phrase like "high tech"<br></span></div></div>');
  $templateCache.put('views/color-picker.html', '<div class="color-picker-container"><div id="cp-panel"><canvas id="color-picker" style="cursor: crosshair; float: left">Sorry, in order to view this element you need a web browser that supports HTML5 canvas.</canvas></div><div class="color-model"><label>R</label><div class="model-field rgb"><input ng-change="onChangRGB()" type="text" ng-model="ngModel[0]"></div><label>G</label><div class="model-field rgb"><input ng-change="onChangRGB()" type="text" ng-model="ngModel[1]"></div><label>B</label><div class="model-field rgb"><input ng-change="onChangRGB()" type="text" ng-model="ngModel[2]"></div><label>&#x7c;</label><label>HEX</label><div class="model-field hex"><input ng-change="onChangHex()" type="text" ng-model="hex"></div><div class="model-field hex"><span ng-click="onSwatchClick()" style="cursor:crosshair; position:relative; top:6px; left: 4px; border:1px solid gray; display:inline-block; width:22px; height:21px" ng-style="swatchStyles"></span></div></div></div>');
  $templateCache.put('views/da-pitch.html',
    '<div id="overlay" class="user-registration-modal" data-ng-show="isShown"><div class="popup animated"><div class="cancel" data-ng-click="onCancelClick()"></div><div class="pop_heading header"><h1 style="font-size: 2.0em">Your Logo Professionally Finished!</h1><p>Sit back and relax. Our design team will create a professional logo for you without breaking the bank.</p></div><div class="body" style="font-size: 1.2em"><div class="clearfix"><div style="float: left; padding-bottom: 12px">You get:</div></div><div class="clearfix"><div style="float: left">A professionally finished logo design.</div><div style="float: right">$39.99</div></div><div class="clearfix"><div style="float: left">Up to 3 design revisions.</div><div style="float: right">FREE!</div></div><div class="clearfix"><div style="float: left">High quality files, ready for printing and the web.</div><div style="float: right"><span style="text-decoration: line-through">$12.50</span> FREE!</div></div><div class="clearfix"><hr style="height:2px;border:none;color:#333;background-color:#8a8a8a"></div><div class="clearfix"><div style="float: right">All for only <span style="font-size: 1.5em; color: #8f0887; padding-left: 10px">$39.99</span></div></div><div class="clearfix" style="margin-top: 20px; text-align: center"><button id="chooseDaBtn" class="submit" data-ng-click="gotoDaPage()"><span style="font-size: 1.3em; padding-left: 40px; padding-right: 40px">MAKE MY LOGO NOW</span></button></div><div class="clearfix" style="margin-top: 20px; margin-left: 10%; margin-right: 10%"><div style="float: left">Results in 1 business day.</div><div style="float: right">Money back guarantee.</div></div><div class="da-trust"><div class="verified"></div><div class="guaranteed"></div><!--<div class="accredited">\n' +
    '          </div>--></div></div></div></div>'
  );
  $templateCache.put('views/editor.html', '<div id="EditorControl" progress-viewer="editor"><div class="lg-editor-left" progress-viewer="symbols-catalog"><!--panel with symbols start--><div class="symbol-catalog" ng-controller="SymbolsCtrl"><div class="control-panel"><h3>Symbol</h3><div class="form-element"><div id="search-box" data-search-box="Search Symbols"></div><div id="toolHolder2" class="tool-tip-tutorial" tutorial-id="2" tutorial-text="Search for a symbol and select it from the grid below to add it to the canvas." tutorial-position-lg="right center" tutorial-position-sm="center bottom"></div></div><div class="form-element"><select id="industrySelect" data-ng-model="selectedIndustry" data-ng-change="onIndustrySelected(selectedIndustry)" data-ng-options="industry as industry.name for industry in industries track by industry.id"><option value="" disabled>Select a category</select></div></div><div class="lg-symbols-container"><symbol-catalog id="symbolList" symbols="viewSymbols" view-page-index="uiModel.viewPageIndex" on-fetch-data="onFetchData(flush)" on-item-click="onSymbolCatalogItemClick(symbol)" on-state-changes="onSymbolCatalogStateChanges(state)"></symbol-catalog></div></div><!--panel with symbols end--></div><div class="lg-editor-right" progress-viewer="editor-area"><div class="lg-editor-toolbar clearfix"><div class="editor-btn-row"><div class="editor-btn-group"><button id="btnUndo" class="editor-btn" ng-click="svgUndo()" title="Undo"></button> <button id="btnRedo" class="editor-btn" ng-click="svgRedo()" title="Redo"></button></div></div><div class="toolbar-delim"></div><div class="editor-btn-row"><div class="editor-btn-group"><button id="textBtn" class="editor-btn" data-ng-click="addRegularText()" title="Add Text"></button></div><div class="editor-btn-group"><font-panel></font-panel></div></div><div class="toolbar-delim"></div><!--panel ColorPicker start--><div class="editor-btn-row"><div class="editor-btn-group"><div class="lg-select-setting lg-select-colorpicker"><div class="editor-btn" ng-click="toggleSelectSetting($event)" title="Select Color"><span ng-style="{\'background-color\':\'rgb(\' + RGB + \')\'}"></span></div><div class="lg-select-option-bg"><color-picker ng-model="RGB"></color-picker></div></div></div><div class="editor-btn-group"><button id="alignmentBtn" class="editor-btn" ng-class="{active: transformerOptions.align.toStage}" ng-click="onSetAlignment()" ng-mouseover="showTooltipAlign()" title="Alignment Mode"></button><div class="lg-select-setting lg-select-text-effects" data-ng-style="!isEffectsEnable&&{display:\'none\'}"><div id="btnTextEffect" class="editor-btn lg-select-btn" ng-click="toggleSelectSetting($event)" title="Symbol &amp; Text Effects" ng-class="{\'active\': selectedItem.distress || selectedItem.reflection || selectedItem.shadow || selectedItem.shine }"></div><div class="lg-select-option-bg"><label><input type="checkbox" name="distress" data-ng-model="selectedItem.distress" data-ng-click="toggleFX($event, \'distress\')"><span></span>Distress</label><label><input type="checkbox" name="reflection" data-ng-model="selectedItem.reflection" data-ng-click="toggleFX($event, \'reflection\')"><span></span>Reflection</label><label><input type="checkbox" name="shadow" data-ng-model="selectedItem.shadow" data-ng-click="toggleFX($event, \'shadow\')"><span></span>Shadow</label><label><input type="checkbox" name="shine" data-ng-model="selectedItem.shine" data-ng-click="toggleFX($event, \'shine\')"><span></span>Shine</label></div></div></div><div id="toolHolder4" class="tool-tip-tutorial" tutorial-id="5" tutorial-text="Apply effects with a click. Click again to unapply." tutorial-position-lg="center bottom" tutorial-position-sm="center bottom"></div><div class="editor-btn-group"><div class="lg-select-setting lg-select-symbols-effects active"><div id="btnSymbolEffect" class="editor-btn lg-select-btn" ng-click="toggleSelectSetting($event)" title="Symbol Shields"></div><div class="lg-select-option-bg" style="opacity: 0"><div class="lg-symbol-effects-panel"><symbol-effects data-sym="symbol" show-tooltip="showTooltipSymbol()"></symbol-effects></div></div></div></div></div><!--panel ColorPicker end--></div><div class="lg-editor-body"><grid id="editorGrid" ng-hide="hideBottomPane" color="#e1e1e1" separation="13"></grid><div id="bottomPane" ng-hide="hideBottomPane"><div id="toolHolder1" class="tool-tip-tutorial" tutorial-id="1" tutorial-text="Select to edit text, change font, size, effects, and color." tutorial-position-lg="left center" tutorial-position-sm="center bottom"></div><div id="toolHolder3" class="tool-tip-tutorial" tutorial-id="3" tutorial-text="Click symbol to add color and effects." tutorial-position-lg="left center" tutorial-position-sm="left center"></div><div id="svg-stage" data-logo-editor data-transform-tool="transformer" data-targets="toolTargets"><transform-tool id="tool" data-dom="svg-stage" data-targets="toolTargets" data-controls="tempControls" data-selected="selectedItem" data-variable="transformer" data-options="transformerOptions"></transform-tool></div><button id="saveDaBtn" ng-bind="saveDaButtonTitle"></button> <button id="saveBtn" ng-bind="saveButtonTitle"></button></div></div></div><div ng-include="getSpriteSVGLocation()" onload="showButtons()" style=""></div><div id="overlay" ng-show="data.alert"><div class="popup animated bounceInDown"><div class="pop_heading"><h4 ng-bind="data.alert.headline"></h4></div><span class="step-two-pitch" bind-html-unsafe="data.alert.message"></span> <button id="chooseBtn" ng-click="data.alert=null;" ng-bind="data.alert.button"></button></div></div><da-pitch id="da-pitch" data-errors="registerUserModelErrors" data-user-model="registerUserModel" data-on-submit="onUserRegistrationClick(registerUserModel)"></da-pitch><user-registration id="register-user" data-errors="registerUserModelErrors" data-user-model="registerUserModel" data-on-submit="onUserRegistrationClick(registerUserModel)"></user-registration><div class="overlay-content"></div></div>');
  $templateCache.put('views/font-panel.html', '<div id="fnt-panel" class="closed"><div id="fnt-content"><div class="editor-btn-bg"><span class="name">Font</span><div id="fnt-select" class="select-box" ng-bind="!isTextFieldSelected() && !loadingFont ? \'No Text Selected\' : currentFont" ng-class="{disabled: !isTextFieldSelected()}" ng-click="!isTextFieldSelected() || toggleSelect($event)"></div></div><div class="fnt-select-dropdown-bg"><input id="fnt-filter" class="font-filter-input" type="text" ng-model="fontFilter"> <a id="flt-icon" class="font-filter-icon" ng-click="clearFilter()"><svg id="flt-icon-svg" viewBox="0 0 20 20" width="20px" height="20px"><use id="filter-use" xlink:href="{{filterIcon}}"></use></svg></a><ul id="fnt-list" class="font-list"><li ng-repeat="(k,v) in usedFonts" ng-click="selectFont($event,k,v)" ng-class="{selected: k === currentFont}" ng-style="{\'background-position\': \'5px \'+(v.offsetY + 7)+\'px\'}" ng-show="!usedFontFilter">&nbsp;</li><li class="separator" ng-show="!angular.equals({}, usedFonts) && !usedFontFilter"></li><li ng-repeat="(k,v) in customFilter(data.fontList)" ng-click="selectFont($event,k,v)" ng-class="{selected: k === currentFont}" ng-style="{\'background-position\': \'5px \'+(v.offsetY + 7)+\'px\'}">&nbsp;</li></ul></div><button id="btnBold" class="editor-btn" ng-class="{disabled: !isTextFieldSelected() || data.fontList[currentFont].disable.indexOf(\'B\') > -1, active: !!isTextFieldSelected() && selectedBold}" ng-click="(!isTextFieldSelected() && data.fontList[currentFont].disable.indexOf(\'B\') > -1) || toggleBold()" title="Bold"></button> <button id="btnItalic" class="editor-btn" ng-class="{disabled: !isTextFieldSelected() || data.fontList[currentFont].disable.indexOf(\'I\') > -1, active: !!isTextFieldSelected() && selectedItalic}" ng-click="(!isTextFieldSelected() || data.fontList[currentFont].disable.indexOf(\'I\') > -1) || toggleItalic()" title="Italic"></button><div class="editor-btn-bg"><span class="name">Size</span><div id="btnSize"><input id="fs-input" type="number" ng-model="fontSize" maxlength="3" data-ng-change="changeFontSize(fontSize)" data-ng-disabled="!isTextFieldSelected()"></div></div><div class="editor-btn-bg lg-select-setting lg-fnt-letter-spacing"><span class="name">Spacing</span><div id="fnt-letter-spacing" class="lg-select-btn" ng-click="!isTextFieldSelected() || toggleSelectSetting($event)" ng-class="{ disabled: !isTextFieldSelected() }"><span id="ls-output">{{ letterSpacing }}</span></div><div class="lg-select-option-bg"><input name="lspacing" id="lspacing" type="range" min="-3" max="10" step="0.5" ng-change="updateSpacing()" ng-model="letterSpacing" ng-disabled="!isTextFieldSelected()" range-input></div></div><div id="fnt-shape-ops" class="editor-btn-bg lg-select-setting"><span class="name">Text Shape</span><div ng-click="!isTextFieldSelected() || toggleSelectSetting($event)" title="Shape-Text Options" class="lg-select-btn" ng-class="{ disabled: !isTextFieldSelected() }"><span class="top-shape-btn" ng-class="{ noShape: selectedNoShape, shapeUp: selectedShapeUp, shapeDn: selectedShapeDn}"></span></div><div class="lg-select-option-bg shape-size"><div class="clearfix"><button class="noShape" class="editor-btn" ng-class="{disabled: !isTextFieldSelected(), active: !!isTextFieldSelected() && selectedNoShape}" ng-click="!isTextFieldSelected() || toggleNoShape()"></button> <button class="shapeUp" class="editor-btn" ng-class="{disabled: !isTextFieldSelected(), active: !!isTextFieldSelected() && selectedShapeUp}" ng-click="!isTextFieldSelected() || toggleShapeUp()"></button> <button class="shapeDn" class="editor-btn" ng-class="{disabled: !isTextFieldSelected(), active: !!isTextFieldSelected() && selectedShapeDn}" ng-click="!isTextFieldSelected() || toggleShapeDn()"></button></div><div class="spacing" ng-class="{show: !selectedNoShape}"><div class="name">Spacing</div><div class="clearfix lg-shape-radius"><div class="text"><span id="ss-output">{{ shapeSizing }}</span></div><div class="val"><input name="ssizing" id="ssizing" type="range" min="0.5" max="5" step="0.5" ng-change="updateSizing()" ng-model="shapeSizing" ng-disabled="!isTextFieldSelected()" range-input></div></div></div></div></div></div></div>');
  $templateCache.put('views/popup-video.html', '<popup-modal class="popup-modal popup-symbols-hint popup-video"><div class="close" ng-click="onClose()"></div><div class="content"><iframe width="560" height="315" ng-src="{{videoSrc}}" frameborder="0" allowfullscreen></iframe></div></popup-modal>');
  $templateCache.put('views/user-registration.html', '<div id="overlay" class="user-registration-modal" data-ng-show="isShown"><div class="popup animated"><div class="cancel" data-ng-click="onCancelClick()"></div><div class="pop_heading header"><h1>Great logo!</h1><p>Save your work now. Download in a variety of high resolution and vector graphic formats.</p></div><div class="body"><ul><li>- Unlimited Edits</li><li>- Access to your files 24/7/365</li><li>- Create branded merchandise in seconds</li></ul><form data-ng-submit="onFormSubmit(userModel)"><div class="user-inputs clearfix"><label class="input"><input class="email" type="text" data-ng-model="userModel.email" required placeholder="Enter your email address"></label><button id="chooseBtn" class="submit" data-ng-disable="submitting" type="submit">Save My Logo</button><p class="mark">We will not share your email address.</p></div><div class="input-errors clearfix"><ul><li data-ng-repeat="error in errors" data-ng-bind="error"></li></ul></div></form><div class="logo-simples"><div class="website"><img data-ng-src="{{userModel.logoImageUrl}}"><p>WEBSITE</p></div><div class="shirt"><img data-ng-src="{{userModel.logoImageUrl}}"><p>T-SHIRT</p></div><div class="card"><img data-ng-src="{{userModel.logoImageUrl}}"><p>BUSINESS CARD</p></div></div></div></div></div>');
}]);

;